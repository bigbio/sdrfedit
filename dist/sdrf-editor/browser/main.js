import{a as Hi,b as Hr,c as Ur,d as Fn,e as Ip,f as Vl,g as qr,h as Pp,i as Op,j as Wr,k as Ap}from"./chunk-OYZGYKHQ.js";import{a as E,b as O,c as Tp,d as z0,e as $0,f as k,g as nt,h as Sn,i as wn}from"./chunk-KAWQVD33.js";var p0=z0((Zu,Ju)=>{"use strict";((n,e)=>{typeof define=="function"&&define.amd?define([],e):typeof Ju=="object"&&typeof Zu<"u"?Ju.exports=e():n.Papa=e()})(Zu,function n(){var e=typeof self<"u"?self:typeof window<"u"?window:e!==void 0?e:{},t,i=!e.document&&!!e.postMessage,o=e.IS_PAPA_WORKER||!1,r={},s=0,a={};function u(M){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(D){var R=Et(D);R.chunkSize=parseInt(R.chunkSize),D.step||D.chunk||(R.chunkSize=null),this._handle=new C(R),(this._handle.streamer=this)._config=R}).call(this,M),this.parseChunk=function(D,R){var H=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<H){let ue=this._config.newline;ue||(G=this._config.quoteChar||'"',ue=this._handle.guessLineEndings(D,G)),D=[...D.split(ue).slice(H)].join(ue)}this.isFirstChunk&&Ce(this._config.beforeFirstChunk)&&(G=this._config.beforeFirstChunk(D))!==void 0&&(D=G),this.isFirstChunk=!1,this._halted=!1;var H=this._partialLine+D,G=(this._partialLine="",this._handle.parse(H,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(D=G.meta.cursor,H=(this._finished||(this._partialLine=H.substring(D-this._baseIndex),this._baseIndex=D),G&&G.data&&(this._rowCount+=G.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),o)e.postMessage({results:G,workerId:a.WORKER_ID,finished:H});else if(Ce(this._config.chunk)&&!R){if(this._config.chunk(G,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=G=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(G.data),this._completeResults.errors=this._completeResults.errors.concat(G.errors),this._completeResults.meta=G.meta),this._completed||!H||!Ce(this._config.complete)||G&&G.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),H||G&&G.meta.paused||this._nextChunk(),G}this._halted=!0},this._sendError=function(D){Ce(this._config.error)?this._config.error(D):o&&this._config.error&&e.postMessage({workerId:a.WORKER_ID,error:D,finished:!1})}}function f(M){var D;(M=M||{}).chunkSize||(M.chunkSize=a.RemoteChunkSize),u.call(this,M),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(R){this._input=R,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(D=new XMLHttpRequest,this._config.withCredentials&&(D.withCredentials=this._config.withCredentials),i||(D.onload=Re(this._chunkLoaded,this),D.onerror=Re(this._chunkError,this)),D.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var R,H=this._config.downloadRequestHeaders;for(R in H)D.setRequestHeader(R,H[R])}var G;this._config.chunkSize&&(G=this._start+this._config.chunkSize-1,D.setRequestHeader("Range","bytes="+this._start+"-"+G));try{D.send(this._config.downloadRequestBody)}catch(ue){this._chunkError(ue.message)}i&&D.status===0&&this._chunkError()}},this._chunkLoaded=function(){D.readyState===4&&(D.status<200||400<=D.status?this._chunkError():(this._start+=this._config.chunkSize||D.responseText.length,this._finished=!this._config.chunkSize||this._start>=(R=>(R=R.getResponseHeader("Content-Range"))!==null?parseInt(R.substring(R.lastIndexOf("/")+1)):-1)(D),this.parseChunk(D.responseText)))},this._chunkError=function(R){R=D.statusText||R,this._sendError(new Error(R))}}function g(M){(M=M||{}).chunkSize||(M.chunkSize=a.LocalChunkSize),u.call(this,M);var D,R,H=typeof FileReader<"u";this.stream=function(G){this._input=G,R=G.slice||G.webkitSlice||G.mozSlice,H?((D=new FileReader).onload=Re(this._chunkLoaded,this),D.onerror=Re(this._chunkError,this)):D=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var G=this._input,ue=(this._config.chunkSize&&(ue=Math.min(this._start+this._config.chunkSize,this._input.size),G=R.call(G,this._start,ue)),D.readAsText(G,this._config.encoding));H||this._chunkLoaded({target:{result:ue}})},this._chunkLoaded=function(G){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(G.target.result)},this._chunkError=function(){this._sendError(D.error)}}function h(M){var D;u.call(this,M=M||{}),this.stream=function(R){return D=R,this._nextChunk()},this._nextChunk=function(){var R,H;if(!this._finished)return R=this._config.chunkSize,D=R?(H=D.substring(0,R),D.substring(R)):(H=D,""),this._finished=!D,this.parseChunk(H)}}function b(M){u.call(this,M=M||{});var D=[],R=!0,H=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(G){this._input=G,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){H&&D.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),D.length?this.parseChunk(D.shift()):R=!0},this._streamData=Re(function(G){try{D.push(typeof G=="string"?G:G.toString(this._config.encoding)),R&&(R=!1,this._checkIsFinished(),this.parseChunk(D.shift()))}catch(ue){this._streamError(ue)}},this),this._streamError=Re(function(G){this._streamCleanUp(),this._sendError(G)},this),this._streamEnd=Re(function(){this._streamCleanUp(),H=!0,this._streamData("")},this),this._streamCleanUp=Re(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function C(M){var D,R,H,G,ue=Math.pow(2,53),Xe=-ue,Rt=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,Ft=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,me=this,je=0,ie=0,gt=!1,se=!1,ge=[],Q={data:[],errors:[],meta:{}};function et(he){return M.skipEmptyLines==="greedy"?he.join("").trim()==="":he.length===1&&he[0].length===0}function Ke(){if(Q&&H&&(Vt("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),H=!1),M.skipEmptyLines&&(Q.data=Q.data.filter(function(Ae){return!et(Ae)})),lt()){let Ae=function(ot,Ne){Ce(M.transformHeader)&&(ot=M.transformHeader(ot,Ne)),ge.push(ot)};var pe=Ae;if(Q)if(Array.isArray(Q.data[0])){for(var he=0;lt()&&he<Q.data.length;he++)Q.data[he].forEach(Ae);Q.data.splice(0,1)}else Q.data.forEach(Ae)}function be(Ae,ot){for(var Ne=M.header?{}:[],Ie=0;Ie<Ae.length;Ie++){var fe=Ie,ht=Ae[Ie],ht=((Se,ke)=>(tt=>(M.dynamicTypingFunction&&M.dynamicTyping[tt]===void 0&&(M.dynamicTyping[tt]=M.dynamicTypingFunction(tt)),(M.dynamicTyping[tt]||M.dynamicTyping)===!0))(Se)?ke==="true"||ke==="TRUE"||ke!=="false"&&ke!=="FALSE"&&((tt=>{if(Rt.test(tt)&&(tt=parseFloat(tt),Xe<tt&&tt<ue))return 1})(ke)?parseFloat(ke):Ft.test(ke)?new Date(ke):ke===""?null:ke):ke)(fe=M.header?Ie>=ge.length?"__parsed_extra":ge[Ie]:fe,ht=M.transform?M.transform(ht,fe):ht);fe==="__parsed_extra"?(Ne[fe]=Ne[fe]||[],Ne[fe].push(ht)):Ne[fe]=ht}return M.header&&(Ie>ge.length?Vt("FieldMismatch","TooManyFields","Too many fields: expected "+ge.length+" fields but parsed "+Ie,ie+ot):Ie<ge.length&&Vt("FieldMismatch","TooFewFields","Too few fields: expected "+ge.length+" fields but parsed "+Ie,ie+ot)),Ne}var ze;Q&&(M.header||M.dynamicTyping||M.transform)&&(ze=1,!Q.data.length||Array.isArray(Q.data[0])?(Q.data=Q.data.map(be),ze=Q.data.length):Q.data=be(Q.data,0),M.header&&Q.meta&&(Q.meta.fields=ge),ie+=ze)}function lt(){return M.header&&ge.length===0}function Vt(he,be,ze,pe){he={type:he,code:be,message:ze},pe!==void 0&&(he.row=pe),Q.errors.push(he)}Ce(M.step)&&(G=M.step,M.step=function(he){Q=he,lt()?Ke():(Ke(),Q.data.length!==0&&(je+=he.data.length,M.preview&&je>M.preview?R.abort():(Q.data=Q.data[0],G(Q,me))))}),this.parse=function(he,be,ze){var pe=M.quoteChar||'"',pe=(M.newline||(M.newline=this.guessLineEndings(he,pe)),H=!1,M.delimiter?Ce(M.delimiter)&&(M.delimiter=M.delimiter(he),Q.meta.delimiter=M.delimiter):((pe=((Ae,ot,Ne,Ie,fe)=>{var ht,Se,ke,tt;fe=fe||[",","	","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var $i=0;$i<fe.length;$i++){for(var rn,ko=fe[$i],_t=0,sn=0,rt=0,Mt=(ke=void 0,new F({comments:Ie,delimiter:ko,newline:ot,preview:10}).parse(Ae)),xn=0;xn<Mt.data.length;xn++)Ne&&et(Mt.data[xn])?rt++:(rn=Mt.data[xn].length,sn+=rn,ke===void 0?ke=rn:0<rn&&(_t+=Math.abs(rn-ke),ke=rn));0<Mt.data.length&&(sn/=Mt.data.length-rt),(Se===void 0||_t<=Se)&&(tt===void 0||tt<sn)&&1.99<sn&&(Se=_t,ht=ko,tt=sn)}return{successful:!!(M.delimiter=ht),bestDelimiter:ht}})(he,M.newline,M.skipEmptyLines,M.comments,M.delimitersToGuess)).successful?M.delimiter=pe.bestDelimiter:(H=!0,M.delimiter=a.DefaultDelimiter),Q.meta.delimiter=M.delimiter),Et(M));return M.preview&&M.header&&pe.preview++,D=he,R=new F(pe),Q=R.parse(D,be,ze),Ke(),gt?{meta:{paused:!0}}:Q||{meta:{paused:!1}}},this.paused=function(){return gt},this.pause=function(){gt=!0,R.abort(),D=Ce(M.chunk)?"":D.substring(R.getCharIndex())},this.resume=function(){me.streamer._halted?(gt=!1,me.streamer.parseChunk(D,!0)):setTimeout(me.resume,3)},this.aborted=function(){return se},this.abort=function(){se=!0,R.abort(),Q.meta.aborted=!0,Ce(M.complete)&&M.complete(Q),D=""},this.guessLineEndings=function(Ae,pe){Ae=Ae.substring(0,1048576);var pe=new RegExp(T(pe)+"([^]*?)"+T(pe),"gm"),ze=(Ae=Ae.replace(pe,"")).split("\r"),pe=Ae.split(`
`),Ae=1<pe.length&&pe[0].length<ze[0].length;if(ze.length===1||Ae)return`
`;for(var ot=0,Ne=0;Ne<ze.length;Ne++)ze[Ne][0]===`
`&&ot++;return ot>=ze.length/2?`\r
`:"\r"}}function T(M){return M.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function F(M){var D=(M=M||{}).delimiter,R=M.newline,H=M.comments,G=M.step,ue=M.preview,Xe=M.fastMode,Rt=null,Ft=!1,me=M.quoteChar==null?'"':M.quoteChar,je=me;if(M.escapeChar!==void 0&&(je=M.escapeChar),(typeof D!="string"||-1<a.BAD_DELIMITERS.indexOf(D))&&(D=","),H===D)throw new Error("Comment character same as delimiter");H===!0?H="#":(typeof H!="string"||-1<a.BAD_DELIMITERS.indexOf(H))&&(H=!1),R!==`
`&&R!=="\r"&&R!==`\r
`&&(R=`
`);var ie=0,gt=!1;this.parse=function(se,ge,Q){if(typeof se!="string")throw new Error("Input must be a string");var et=se.length,Ke=D.length,lt=R.length,Vt=H.length,he=Ce(G),be=[],ze=[],pe=[],Ae=ie=0;if(!se)return _t();if(Xe||Xe!==!1&&se.indexOf(me)===-1){for(var ot=se.split(R),Ne=0;Ne<ot.length;Ne++){if(pe=ot[Ne],ie+=pe.length,Ne!==ot.length-1)ie+=R.length;else if(Q)return _t();if(!H||pe.substring(0,Vt)!==H){if(he){if(be=[],tt(pe.split(D)),sn(),gt)return _t()}else tt(pe.split(D));if(ue&&ue<=Ne)return be=be.slice(0,ue),_t(!0)}}return _t()}for(var Ie=se.indexOf(D,ie),fe=se.indexOf(R,ie),ht=new RegExp(T(je)+T(me),"g"),Se=se.indexOf(me,ie);;)if(se[ie]===me)for(Se=ie,ie++;;){if((Se=se.indexOf(me,Se+1))===-1)return Q||ze.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:be.length,index:ie}),rn();if(Se===et-1)return rn(se.substring(ie,Se).replace(ht,me));if(me===je&&se[Se+1]===je)Se++;else if(me===je||Se===0||se[Se-1]!==je){Ie!==-1&&Ie<Se+1&&(Ie=se.indexOf(D,Se+1));var ke=$i((fe=fe!==-1&&fe<Se+1?se.indexOf(R,Se+1):fe)===-1?Ie:Math.min(Ie,fe));if(se.substr(Se+1+ke,Ke)===D){pe.push(se.substring(ie,Se).replace(ht,me)),se[ie=Se+1+ke+Ke]!==me&&(Se=se.indexOf(me,ie)),Ie=se.indexOf(D,ie),fe=se.indexOf(R,ie);break}if(ke=$i(fe),se.substring(Se+1+ke,Se+1+ke+lt)===R){if(pe.push(se.substring(ie,Se).replace(ht,me)),ko(Se+1+ke+lt),Ie=se.indexOf(D,ie),Se=se.indexOf(me,ie),he&&(sn(),gt))return _t();if(ue&&be.length>=ue)return _t(!0);break}ze.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:be.length,index:ie}),Se++}}else if(H&&pe.length===0&&se.substring(ie,ie+Vt)===H){if(fe===-1)return _t();ie=fe+lt,fe=se.indexOf(R,ie),Ie=se.indexOf(D,ie)}else if(Ie!==-1&&(Ie<fe||fe===-1))pe.push(se.substring(ie,Ie)),ie=Ie+Ke,Ie=se.indexOf(D,ie);else{if(fe===-1)break;if(pe.push(se.substring(ie,fe)),ko(fe+lt),he&&(sn(),gt))return _t();if(ue&&be.length>=ue)return _t(!0)}return rn();function tt(rt){be.push(rt),Ae=ie}function $i(rt){var Mt=0;return Mt=rt!==-1&&(rt=se.substring(Se+1,rt))&&rt.trim()===""?rt.length:Mt}function rn(rt){return Q||(rt===void 0&&(rt=se.substring(ie)),pe.push(rt),ie=et,tt(pe),he&&sn()),_t()}function ko(rt){ie=rt,tt(pe),pe=[],fe=se.indexOf(R,ie)}function _t(rt){if(M.header&&!ge&&be.length&&!Ft){var Mt=be[0],xn=Object.create(null),Fl=new Set(Mt);let Mp=!1;for(let Bi=0;Bi<Mt.length;Bi++){let an=Mt[Bi];if(xn[an=Ce(M.transformHeader)?M.transformHeader(an,Bi):an]){let Ro,Dp=xn[an];for(;Ro=an+"_"+Dp,Dp++,Fl.has(Ro););Fl.add(Ro),Mt[Bi]=Ro,xn[an]++,Mp=!0,(Rt=Rt===null?{}:Rt)[Ro]=an}else xn[an]=1,Mt[Bi]=an;Fl.add(an)}Mp&&console.warn("Duplicate headers found and renamed."),Ft=!0}return{data:be,errors:ze,meta:{delimiter:D,linebreak:R,aborted:gt,truncated:!!rt,cursor:Ae+(ge||0),renamedHeaders:Rt}}}function sn(){G(_t()),be=[],ze=[]}},this.abort=function(){gt=!0},this.getCharIndex=function(){return ie}}function U(M){var D=M.data,R=r[D.workerId],H=!1;if(D.error)R.userError(D.error,D.file);else if(D.results&&D.results.data){var G={abort:function(){H=!0,K(D.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:We,resume:We};if(Ce(R.userStep)){for(var ue=0;ue<D.results.data.length&&(R.userStep({data:D.results.data[ue],errors:D.results.errors,meta:D.results.meta},G),!H);ue++);delete D.results}else Ce(R.userChunk)&&(R.userChunk(D.results,G,D.file),delete D.results)}D.finished&&!H&&K(D.workerId,D.results)}function K(M,D){var R=r[M];Ce(R.userComplete)&&R.userComplete(D),R.terminate(),delete r[M]}function We(){throw new Error("Not implemented.")}function Et(M){if(typeof M!="object"||M===null)return M;var D,R=Array.isArray(M)?[]:{};for(D in M)R[D]=Et(M[D]);return R}function Re(M,D){return function(){M.apply(D,arguments)}}function Ce(M){return typeof M=="function"}return a.parse=function(M,D){var R=(D=D||{}).dynamicTyping||!1;if(Ce(R)&&(D.dynamicTypingFunction=R,R={}),D.dynamicTyping=R,D.transform=!!Ce(D.transform)&&D.transform,!D.worker||!a.WORKERS_SUPPORTED)return R=null,a.NODE_STREAM_INPUT,typeof M=="string"?(M=(H=>H.charCodeAt(0)!==65279?H:H.slice(1))(M),R=new(D.download?f:h)(D)):M.readable===!0&&Ce(M.read)&&Ce(M.on)?R=new b(D):(e.File&&M instanceof File||M instanceof Object)&&(R=new g(D)),R.stream(M);(R=(()=>{var H;return!!a.WORKERS_SUPPORTED&&(H=(()=>{var G=e.URL||e.webkitURL||null,ue=n.toString();return a.BLOB_URL||(a.BLOB_URL=G.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",ue,")();"],{type:"text/javascript"})))})(),(H=new e.Worker(H)).onmessage=U,H.id=s++,r[H.id]=H)})()).userStep=D.step,R.userChunk=D.chunk,R.userComplete=D.complete,R.userError=D.error,D.step=Ce(D.step),D.chunk=Ce(D.chunk),D.complete=Ce(D.complete),D.error=Ce(D.error),delete D.worker,R.postMessage({input:M,config:D,workerId:R.id})},a.unparse=function(M,D){var R=!1,H=!0,G=",",ue=`\r
`,Xe='"',Rt=Xe+Xe,Ft=!1,me=null,je=!1,ie=((()=>{if(typeof D=="object"){if(typeof D.delimiter!="string"||a.BAD_DELIMITERS.filter(function(ge){return D.delimiter.indexOf(ge)!==-1}).length||(G=D.delimiter),typeof D.quotes!="boolean"&&typeof D.quotes!="function"&&!Array.isArray(D.quotes)||(R=D.quotes),typeof D.skipEmptyLines!="boolean"&&typeof D.skipEmptyLines!="string"||(Ft=D.skipEmptyLines),typeof D.newline=="string"&&(ue=D.newline),typeof D.quoteChar=="string"&&(Xe=D.quoteChar),typeof D.header=="boolean"&&(H=D.header),Array.isArray(D.columns)){if(D.columns.length===0)throw new Error("Option columns is empty");me=D.columns}D.escapeChar!==void 0&&(Rt=D.escapeChar+Xe),D.escapeFormulae instanceof RegExp?je=D.escapeFormulae:typeof D.escapeFormulae=="boolean"&&D.escapeFormulae&&(je=/^[=+\-@\t\r].*$/)}})(),new RegExp(T(Xe),"g"));if(typeof M=="string"&&(M=JSON.parse(M)),Array.isArray(M)){if(!M.length||Array.isArray(M[0]))return gt(null,M,Ft);if(typeof M[0]=="object")return gt(me||Object.keys(M[0]),M,Ft)}else if(typeof M=="object")return typeof M.data=="string"&&(M.data=JSON.parse(M.data)),Array.isArray(M.data)&&(M.fields||(M.fields=M.meta&&M.meta.fields||me),M.fields||(M.fields=Array.isArray(M.data[0])?M.fields:typeof M.data[0]=="object"?Object.keys(M.data[0]):[]),Array.isArray(M.data[0])||typeof M.data[0]=="object"||(M.data=[M.data])),gt(M.fields||[],M.data||[],Ft);throw new Error("Unable to serialize unrecognized input");function gt(ge,Q,et){var Ke="",lt=(typeof ge=="string"&&(ge=JSON.parse(ge)),typeof Q=="string"&&(Q=JSON.parse(Q)),Array.isArray(ge)&&0<ge.length),Vt=!Array.isArray(Q[0]);if(lt&&H){for(var he=0;he<ge.length;he++)0<he&&(Ke+=G),Ke+=se(ge[he],he);0<Q.length&&(Ke+=ue)}for(var be=0;be<Q.length;be++){var ze=(lt?ge:Q[be]).length,pe=!1,Ae=lt?Object.keys(Q[be]).length===0:Q[be].length===0;if(et&&!lt&&(pe=et==="greedy"?Q[be].join("").trim()==="":Q[be].length===1&&Q[be][0].length===0),et==="greedy"&&lt){for(var ot=[],Ne=0;Ne<ze;Ne++){var Ie=Vt?ge[Ne]:Ne;ot.push(Q[be][Ie])}pe=ot.join("").trim()===""}if(!pe){for(var fe=0;fe<ze;fe++){0<fe&&!Ae&&(Ke+=G);var ht=lt&&Vt?ge[fe]:fe;Ke+=se(Q[be][ht],fe)}be<Q.length-1&&(!et||0<ze&&!Ae)&&(Ke+=ue)}}return Ke}function se(ge,Q){var et,Ke;return ge==null?"":ge.constructor===Date?JSON.stringify(ge).slice(1,25):(Ke=!1,je&&typeof ge=="string"&&je.test(ge)&&(ge="'"+ge,Ke=!0),et=ge.toString().replace(ie,Rt),(Ke=Ke||R===!0||typeof R=="function"&&R(ge,Q)||Array.isArray(R)&&R[Q]||((lt,Vt)=>{for(var he=0;he<Vt.length;he++)if(-1<lt.indexOf(Vt[he]))return!0;return!1})(et,a.BAD_DELIMITERS)||-1<et.indexOf(G)||et.charAt(0)===" "||et.charAt(et.length-1)===" ")?Xe+et+Xe:et)}},a.RECORD_SEP="",a.UNIT_SEP="",a.BYTE_ORDER_MARK="\uFEFF",a.BAD_DELIMITERS=["\r",`
`,'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!i&&!!e.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=F,a.ParserHandle=C,a.NetworkStreamer=f,a.FileStreamer=g,a.StringStreamer=h,a.ReadableStreamStreamer=b,e.jQuery&&((t=e.jQuery).fn.parse=function(M){var D=M.config||{},R=[];return this.each(function(ue){if(!(t(this).prop("tagName").toUpperCase()==="INPUT"&&t(this).attr("type").toLowerCase()==="file"&&e.FileReader)||!this.files||this.files.length===0)return!0;for(var Xe=0;Xe<this.files.length;Xe++)R.push({file:this.files[Xe],inputElem:this,instanceConfig:t.extend({},D)})}),H(),this;function H(){if(R.length===0)Ce(M.complete)&&M.complete();else{var ue,Xe,Rt,Ft,me=R[0];if(Ce(M.before)){var je=M.before(me.file,me.inputElem);if(typeof je=="object"){if(je.action==="abort")return ue="AbortError",Xe=me.file,Rt=me.inputElem,Ft=je.reason,void(Ce(M.error)&&M.error({name:ue},Xe,Rt,Ft));if(je.action==="skip")return void G();typeof je.config=="object"&&(me.instanceConfig=t.extend(me.instanceConfig,je.config))}else if(je==="skip")return void G()}var ie=me.instanceConfig.complete;me.instanceConfig.complete=function(gt){Ce(ie)&&ie(gt,me.file,me.inputElem),G()},a.parse(me.file,me.instanceConfig)}}function G(){R.splice(0,1),H()}}),o&&(e.onmessage=function(M){M=M.data,a.WORKER_ID===void 0&&M&&(a.WORKER_ID=M.workerId),typeof M.input=="string"?e.postMessage({workerId:a.WORKER_ID,results:a.parse(M.input,M.config),finished:!0}):(e.File&&M.input instanceof File||M.input instanceof Object)&&(M=a.parse(M.input,M.config))&&e.postMessage({workerId:a.WORKER_ID,results:M,finished:!0})}),(f.prototype=Object.create(u.prototype)).constructor=f,(g.prototype=Object.create(u.prototype)).constructor=g,(h.prototype=Object.create(h.prototype)).constructor=h,(b.prototype=Object.create(u.prototype)).constructor=b,a})});var Ll;function Gr(){return Ll}function ln(n){let e=Ll;return Ll=n,e}var Np=Symbol("NotFound");function Ui(n){return n===Np||n?.name==="\u0275NotFound"}var Ct=null,Qr=!1,jl=1,B0=null,Dt=Symbol("SIGNAL");function J(n){let e=Ct;return Ct=n,e}function Jr(){return Ct}var ti={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Xr(n){if(Qr)throw new Error("");if(Ct===null)return;Ct.consumerOnSignalRead(n);let e=Ct.producersTail;if(e!==void 0&&e.producer===n)return;let t,i=Ct.recomputing;if(i&&(t=e!==void 0?e.nextProducer:Ct.producers,t!==void 0&&t.producer===n)){Ct.producersTail=t,t.lastReadVersion=n.version;return}let o=n.consumersTail;if(o!==void 0&&o.consumer===Ct&&(!i||U0(o,Ct)))return;let r=Gi(Ct),s={producer:n,consumer:Ct,nextProducer:t,prevConsumer:o,lastReadVersion:n.version,nextConsumer:void 0};Ct.producersTail=s,e!==void 0?e.nextProducer=s:Ct.producers=s,r&&Vp(n,s)}function kp(){jl++}function es(n){if(!(Gi(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===jl)){if(!n.producerMustRecompute(n)&&!Lo(n)){Zr(n);return}n.producerRecomputeValue(n),Zr(n)}}function zl(n){if(n.consumers===void 0)return;let e=Qr;Qr=!0;try{for(let t=n.consumers;t!==void 0;t=t.nextConsumer){let i=t.consumer;i.dirty||H0(i)}}finally{Qr=e}}function $l(){return Ct?.consumerAllowSignalWrites!==!1}function H0(n){n.dirty=!0,zl(n),n.consumerMarkedDirty?.(n)}function Zr(n){n.dirty=!1,n.lastCleanEpoch=jl}function qi(n){return n&&Rp(n),J(n)}function Rp(n){n.producersTail=void 0,n.recomputing=!0}function Vo(n,e){J(e),n&&Fp(n)}function Fp(n){n.recomputing=!1;let e=n.producersTail,t=e!==void 0?e.nextProducer:n.producers;if(t!==void 0){if(Gi(n))do t=Bl(t);while(t!==void 0);e!==void 0?e.nextProducer=void 0:n.producers=void 0}}function Lo(n){for(let e=n.producers;e!==void 0;e=e.nextProducer){let t=e.producer,i=e.lastReadVersion;if(i!==t.version||(es(t),i!==t.version))return!0}return!1}function Wi(n){if(Gi(n)){let e=n.producers;for(;e!==void 0;)e=Bl(e)}n.producers=void 0,n.producersTail=void 0,n.consumers=void 0,n.consumersTail=void 0}function Vp(n,e){let t=n.consumersTail,i=Gi(n);if(t!==void 0?(e.nextConsumer=t.nextConsumer,t.nextConsumer=e):(e.nextConsumer=void 0,n.consumers=e),e.prevConsumer=t,n.consumersTail=e,!i)for(let o=n.producers;o!==void 0;o=o.nextProducer)Vp(o.producer,o)}function Bl(n){let e=n.producer,t=n.nextProducer,i=n.nextConsumer,o=n.prevConsumer;if(n.nextConsumer=void 0,n.prevConsumer=void 0,i!==void 0?i.prevConsumer=o:e.consumersTail=o,o!==void 0)o.nextConsumer=i;else if(e.consumers=i,!Gi(e)){let r=e.producers;for(;r!==void 0;)r=Bl(r)}return t}function Gi(n){return n.consumerIsAlwaysLive||n.consumers!==void 0}function ts(n){B0?.(n)}function U0(n,e){let t=e.producersTail;if(t!==void 0){let i=e.producers;do{if(i===n)return!0;if(i===t)break;i=i.nextProducer}while(i!==void 0)}return!1}function ns(n,e){return Object.is(n,e)}function is(n,e){let t=Object.create(q0);t.computation=n,e!==void 0&&(t.equal=e);let i=()=>{if(es(t),Xr(t),t.value===Fo)throw t.error;return t.value};return i[Dt]=t,ts(t),i}var Yr=Symbol("UNSET"),Kr=Symbol("COMPUTING"),Fo=Symbol("ERRORED"),q0=O(E({},ti),{value:Yr,dirty:!0,error:null,equal:ns,kind:"computed",producerMustRecompute(n){return n.value===Yr||n.value===Kr},producerRecomputeValue(n){if(n.value===Kr)throw new Error("");let e=n.value;n.value=Kr;let t=qi(n),i,o=!1;try{i=n.computation(),J(null),o=e!==Yr&&e!==Fo&&i!==Fo&&n.equal(e,i)}catch(r){i=Fo,n.error=r}finally{Vo(n,t)}if(o){n.value=e;return}n.value=i,n.version++}});function W0(){throw new Error}var Lp=W0;function jp(n){Lp(n)}function Hl(n){Lp=n}var G0=null;function Ul(n,e){let t=Object.create($p);t.value=n,e!==void 0&&(t.equal=e);let i=()=>zp(t);return i[Dt]=t,ts(t),[i,s=>os(t,s),s=>ql(t,s)]}function zp(n){return Xr(n),n.value}function os(n,e){$l()||jp(n),n.equal(n.value,e)||(n.value=e,Q0(n))}function ql(n,e){$l()||jp(n),os(n,e(n.value))}var $p=O(E({},ti),{equal:ns,value:void 0,kind:"signal"});function Q0(n){n.version++,kp(),zl(n),G0?.(n)}function we(n){return typeof n=="function"}function rs(n){let t=n(i=>{Error.call(i),i.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var ss=rs(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((i,o)=>`${o+1}) ${i.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function jo(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var bt=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let r of t)r.remove(this);else t.remove(this);let{initialTeardown:i}=this;if(we(i))try{i()}catch(r){e=r instanceof ss?r.errors:[r]}let{_finalizers:o}=this;if(o){this._finalizers=null;for(let r of o)try{Bp(r)}catch(s){e=e??[],s instanceof ss?e=[...e,...s.errors]:e.push(s)}}if(e)throw new ss(e)}}add(e){var t;if(e&&e!==this)if(this.closed)Bp(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&jo(t,e)}remove(e){let{_finalizers:t}=this;t&&jo(t,e),e instanceof n&&e._removeParent(this)}};bt.EMPTY=(()=>{let n=new bt;return n.closed=!0,n})();var Wl=bt.EMPTY;function as(n){return n instanceof bt||n&&"closed"in n&&we(n.remove)&&we(n.add)&&we(n.unsubscribe)}function Bp(n){we(n)?n():n.unsubscribe()}var Gt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Qi={setTimeout(n,e,...t){let{delegate:i}=Qi;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Qi;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function ls(n){Qi.setTimeout(()=>{let{onUnhandledError:e}=Gt;if(e)e(n);else throw n})}function Gl(){}var Hp=Ql("C",void 0,void 0);function Up(n){return Ql("E",void 0,n)}function qp(n){return Ql("N",n,void 0)}function Ql(n,e,t){return{kind:n,value:e,error:t}}var ni=null;function Yi(n){if(Gt.useDeprecatedSynchronousErrorHandling){let e=!ni;if(e&&(ni={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:i}=ni;if(ni=null,t)throw i}}else n()}function Wp(n){Gt.useDeprecatedSynchronousErrorHandling&&ni&&(ni.errorThrown=!0,ni.error=n)}var ii=class extends bt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,as(e)&&e.add(this)):this.destination=Z0}static create(e,t,i){return new Ki(e,t,i)}next(e){this.isStopped?Kl(qp(e),this):this._next(e)}error(e){this.isStopped?Kl(Up(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Kl(Hp,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},Y0=Function.prototype.bind;function Yl(n,e){return Y0.call(n,e)}var Zl=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){cs(i)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){cs(i)}else cs(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){cs(t)}}},Ki=class extends ii{constructor(e,t,i){super();let o;if(we(e)||!e)o={next:e??void 0,error:t??void 0,complete:i??void 0};else{let r;this&&Gt.useDeprecatedNextContext?(r=Object.create(e),r.unsubscribe=()=>this.unsubscribe(),o={next:e.next&&Yl(e.next,r),error:e.error&&Yl(e.error,r),complete:e.complete&&Yl(e.complete,r)}):o=e}this.destination=new Zl(o)}};function cs(n){Gt.useDeprecatedSynchronousErrorHandling?Wp(n):ls(n)}function K0(n){throw n}function Kl(n,e){let{onStoppedNotification:t}=Gt;t&&Qi.setTimeout(()=>t(n,e))}var Z0={closed:!0,next:Gl,error:K0,complete:Gl};var Zi=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Gp(n){return n}function Qp(n){return n.length===0?Gp:n.length===1?n[0]:function(t){return n.reduce((i,o)=>o(i),t)}}var Ge=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,o){let r=X0(t)?t:new Ki(t,i,o);return Yi(()=>{let{operator:s,source:a}=this;r.add(s?s.call(r,a):a?this._subscribe(r):this._trySubscribe(r))}),r}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return i=Yp(i),new i((o,r)=>{let s=new Ki({next:a=>{try{t(a)}catch(u){r(u),s.unsubscribe()}},error:r,complete:o});this.subscribe(s)})}_subscribe(t){var i;return(i=this.source)===null||i===void 0?void 0:i.subscribe(t)}[Zi](){return this}pipe(...t){return Qp(t)(this)}toPromise(t){return t=Yp(t),new t((i,o)=>{let r;this.subscribe(s=>r=s,s=>o(s),()=>i(r))})}}return n.create=e=>new n(e),n})();function Yp(n){var e;return(e=n??Gt.Promise)!==null&&e!==void 0?e:Promise}function J0(n){return n&&we(n.next)&&we(n.error)&&we(n.complete)}function X0(n){return n&&n instanceof ii||J0(n)&&as(n)}function e_(n){return we(n?.lift)}function Ji(n){return e=>{if(e_(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Xi(n,e,t,i,o){return new Jl(n,e,t,i,o)}var Jl=class extends ii{constructor(e,t,i,o,r,s){super(e),this.onFinalize=r,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(u){e.error(u)}}:super._next,this._error=o?function(a){try{o(a)}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};var Kp=rs(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var cn=(()=>{class n extends Ge{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let i=new ds(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new Kp}next(t){Yi(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let i of this.currentObservers)i.next(t)}})}error(t){Yi(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Yi(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:i,isStopped:o,observers:r}=this;return i||o?Wl:(this.currentObservers=null,r.push(t),new bt(()=>{this.currentObservers=null,jo(r,t)}))}_checkFinalizedStatuses(t){let{hasError:i,thrownError:o,isStopped:r}=this;i?t.error(o):r&&t.complete()}asObservable(){let t=new Ge;return t.source=this,t}}return n.create=(e,t)=>new ds(e,t),n})(),ds=class extends cn{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.next)===null||i===void 0||i.call(t,e)}error(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.error)===null||i===void 0||i.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,i;return(i=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&i!==void 0?i:Wl}};var zo=class extends cn{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}};function t_(n){return n[n.length-1]}function Zp(n){return we(t_(n))?n.pop():void 0}function Xp(n,e,t,i){function o(r){return r instanceof t?r:new t(function(s){s(r)})}return new(t||(t=Promise))(function(r,s){function a(g){try{f(i.next(g))}catch(h){s(h)}}function u(g){try{f(i.throw(g))}catch(h){s(h)}}function f(g){g.done?r(g.value):o(g.value).then(a,u)}f((i=i.apply(n,e||[])).next())})}function Jp(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function oi(n){return this instanceof oi?(this.v=n,this):new oi(n)}function ef(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),o,r=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),o[Symbol.asyncIterator]=function(){return this},o;function s(C){return function(T){return Promise.resolve(T).then(C,h)}}function a(C,T){i[C]&&(o[C]=function(F){return new Promise(function(U,K){r.push([C,F,U,K])>1||u(C,F)})},T&&(o[C]=T(o[C])))}function u(C,T){try{f(i[C](T))}catch(F){b(r[0][3],F)}}function f(C){C.value instanceof oi?Promise.resolve(C.value.v).then(g,h):b(r[0][2],C)}function g(C){u("next",C)}function h(C){u("throw",C)}function b(C,T){C(T),r.shift(),r.length&&u(r[0][0],r[0][1])}}function tf(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof Jp=="function"?Jp(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=n[r]&&function(s){return new Promise(function(a,u){s=n[r](s),o(a,u,s.done,s.value)})}}function o(r,s,a,u){Promise.resolve(u).then(function(f){r({value:f,done:a})},s)}}var us=n=>n&&typeof n.length=="number"&&typeof n!="function";function ps(n){return we(n?.then)}function fs(n){return we(n[Zi])}function ms(n){return Symbol.asyncIterator&&we(n?.[Symbol.asyncIterator])}function gs(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function n_(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var hs=n_();function _s(n){return we(n?.[hs])}function Cs(n){return ef(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:i,done:o}=yield oi(t.read());if(o)return yield oi(void 0);yield yield oi(i)}}finally{t.releaseLock()}})}function vs(n){return we(n?.getReader)}function Vn(n){if(n instanceof Ge)return n;if(n!=null){if(fs(n))return i_(n);if(us(n))return o_(n);if(ps(n))return r_(n);if(ms(n))return nf(n);if(_s(n))return s_(n);if(vs(n))return a_(n)}throw gs(n)}function i_(n){return new Ge(e=>{let t=n[Zi]();if(we(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function o_(n){return new Ge(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function r_(n){return new Ge(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,ls)})}function s_(n){return new Ge(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function nf(n){return new Ge(e=>{l_(n,e).catch(t=>e.error(t))})}function a_(n){return nf(Cs(n))}function l_(n,e){var t,i,o,r;return Xp(this,void 0,void 0,function*(){try{for(t=tf(n);i=yield t.next(),!i.done;){let s=i.value;if(e.next(s),e.closed)return}}catch(s){o={error:s}}finally{try{i&&!i.done&&(r=t.return)&&(yield r.call(t))}finally{if(o)throw o.error}}e.complete()})}function dn(n,e,t,i=0,o=!1){let r=e.schedule(function(){t(),o?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(r),!o)return r}function ys(n,e=0){return Ji((t,i)=>{t.subscribe(Xi(i,o=>dn(i,n,()=>i.next(o),e),()=>dn(i,n,()=>i.complete(),e),o=>dn(i,n,()=>i.error(o),e)))})}function bs(n,e=0){return Ji((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function of(n,e){return Vn(n).pipe(bs(e),ys(e))}function rf(n,e){return Vn(n).pipe(bs(e),ys(e))}function sf(n,e){return new Ge(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}function af(n,e){return new Ge(t=>{let i;return dn(t,e,()=>{i=n[hs](),dn(t,e,()=>{let o,r;try{({value:o,done:r}=i.next())}catch(s){t.error(s);return}r?t.complete():t.next(o)},0,!0)}),()=>we(i?.return)&&i.return()})}function xs(n,e){if(!n)throw new Error("Iterable cannot be null");return new Ge(t=>{dn(t,e,()=>{let i=n[Symbol.asyncIterator]();dn(t,e,()=>{i.next().then(o=>{o.done?t.complete():t.next(o.value)})},0,!0)})})}function lf(n,e){return xs(Cs(n),e)}function cf(n,e){if(n!=null){if(fs(n))return of(n,e);if(us(n))return sf(n,e);if(ps(n))return rf(n,e);if(ms(n))return xs(n,e);if(_s(n))return af(n,e);if(vs(n))return lf(n,e)}throw gs(n)}function Xl(n,e){return e?cf(n,e):Vn(n)}function ri(n,e){return Ji((t,i)=>{let o=0;t.subscribe(Xi(i,r=>{i.next(n.call(e,r,o++))}))})}var{isArray:c_}=Array;function d_(n,e){return c_(e)?n(...e):n(e)}function df(n){return ri(e=>d_(n,e))}var{isArray:u_}=Array,{getPrototypeOf:p_,prototype:f_,keys:m_}=Object;function uf(n){if(n.length===1){let e=n[0];if(u_(e))return{args:e,keys:null};if(g_(e)){let t=m_(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}function g_(n){return n&&typeof n=="object"&&p_(n)===f_}function pf(n,e){return n.reduce((t,i,o)=>(t[i]=e[o],t),{})}function ec(...n){let e=Zp(n),{args:t,keys:i}=uf(n),o=new Ge(r=>{let{length:s}=t;if(!s){r.complete();return}let a=new Array(s),u=s,f=s;for(let g=0;g<s;g++){let h=!1;Vn(t[g]).subscribe(Xi(r,b=>{h||(h=!0,f--),a[g]=b},()=>u--,void 0,()=>{(!u||!h)&&(f||r.next(i?pf(i,a):a),r.complete())}))}});return e?o.pipe(df(e)):o}function ff(n){let e=J(null);try{return n()}finally{J(e)}}var mf=O(E({},ti),{consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!0,dirty:!0,kind:"effect"});function gf(n){if(n.dirty=!1,n.version>0&&!Lo(n))return;n.version++;let e=qi(n);try{n.cleanup(),n.fn()}finally{Vo(n,e)}}var uc="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",ne=class extends Error{code;constructor(e,t){super(qo(e,t)),this.code=e}};function h_(n){return`NG0${Math.abs(n)}`}function qo(n,e){return`${h_(n)}${e?": "+e:""}`}var di=globalThis;function Pe(n){for(let e in n)if(n[e]===Pe)return e;throw Error("")}function Cf(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Ln(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(Ln).join(", ")}]`;if(n==null)return""+n;let e=n.overriddenName||n.name;if(e)return`${e}`;let t=n.toString();if(t==null)return""+t;let i=t.indexOf(`
`);return i>=0?t.slice(0,i):t}function Ms(n,e){return n?e?`${n} ${e}`:n:e||""}var __=Pe({__forward_ref__:Pe});function Pt(n){return n.__forward_ref__=Pt,n.toString=function(){return Ln(this())},n}function ct(n){return pc(n)?n():n}function pc(n){return typeof n=="function"&&n.hasOwnProperty(__)&&n.__forward_ref__===Pt}function oe(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function $n(n){return{providers:n.providers||[],imports:n.imports||[]}}function Ds(n){return C_(n,Ts)}function C_(n,e){return n.hasOwnProperty(e)&&n[e]||null}function v_(n){let e=n?.[Ts]??null;return e||null}function nc(n){return n&&n.hasOwnProperty(ws)?n[ws]:null}var Ts=Pe({\u0275prov:Pe}),ws=Pe({\u0275inj:Pe}),le=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=oe({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function fc(n){return n&&!!n.\u0275providers}var mc=Pe({\u0275cmp:Pe}),gc=Pe({\u0275dir:Pe}),hc=Pe({\u0275pipe:Pe});var Bo=Pe({\u0275fac:Pe}),ui=Pe({__NG_ELEMENT_ID__:Pe}),hf=Pe({__NG_ENV_ID__:Pe});function Ze(n){return typeof n=="string"?n:n==null?"":String(n)}function vf(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():Ze(n)}var yf=Pe({ngErrorCode:Pe}),y_=Pe({ngErrorMessage:Pe}),b_=Pe({ngTokenPath:Pe});function _c(n,e){return bf("",-200,e)}function Is(n,e){throw new ne(-201,!1)}function bf(n,e,t){let i=new ne(e,n);return i[yf]=e,i[y_]=n,t&&(i[b_]=t),i}function x_(n){return n[yf]}var ic;function xf(){return ic}function xt(n){let e=ic;return ic=n,e}function Cc(n,e,t){let i=Ds(n);if(i&&i.providedIn=="root")return i.value===void 0?i.value=i.factory():i.value;if(t&8)return null;if(e!==void 0)return e;Is(n,"Injector")}var S_={},si=S_,w_="__NG_DI_FLAG__",oc=class{injector;constructor(e){this.injector=e}retrieve(e,t){let i=ai(t)||0;try{return this.injector.get(e,i&8?null:si,i)}catch(o){if(Ui(o))return o;throw o}}};function E_(n,e=0){let t=Gr();if(t===void 0)throw new ne(-203,!1);if(t===null)return Cc(n,void 0,e);{let i=M_(e),o=t.retrieve(n,i);if(Ui(o)){if(i.optional)return null;throw o}return o}}function De(n,e=0){return(xf()||E_)(ct(n),e)}function q(n,e){return De(n,ai(e))}function ai(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function M_(n){return{optional:!!(n&8),host:!!(n&1),self:!!(n&2),skipSelf:!!(n&4)}}function rc(n){let e=[];for(let t=0;t<n.length;t++){let i=ct(n[t]);if(Array.isArray(i)){if(i.length===0)throw new ne(900,!1);let o,r=0;for(let s=0;s<i.length;s++){let a=i[s],u=D_(a);typeof u=="number"?u===-1?o=a.token:r|=u:o=a}e.push(De(o,r))}else e.push(De(i))}return e}function D_(n){return n[w_]}function jn(n,e){let t=n.hasOwnProperty(Bo);return t?n[Bo]:null}function Sf(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let o=n[i],r=e[i];if(t&&(o=t(o),r=t(r)),r!==o)return!1}return!0}function wf(n){return n.flat(Number.POSITIVE_INFINITY)}function Ps(n,e){n.forEach(t=>Array.isArray(t)?Ps(t,e):e(t))}function vc(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Wo(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function Ef(n,e,t,i){let o=n.length;if(o==e)n.push(t,i);else if(o===1)n.push(i,n[0]),n[0]=t;else{for(o--,n.push(n[o-1],n[o]);o>e;){let r=o-2;n[o]=n[r],o--}n[e]=t,n[e+1]=i}}function Os(n,e,t){let i=to(n,e);return i>=0?n[i|1]=t:(i=~i,Ef(n,i,e,t)),i}function As(n,e){let t=to(n,e);if(t>=0)return n[t|1]}function to(n,e){return T_(n,e,1)}function T_(n,e,t){let i=0,o=n.length>>t;for(;o!==i;){let r=i+(o-i>>1),s=n[r<<t];if(e===s)return r<<t;s>e?o=r:i=r+1}return~(o<<t)}var Bn={},St=[],pi=new le(""),yc=new le("",-1),bc=new le(""),Ho=class{get(e,t=si){if(t===si){let o=bf("",-201);throw o.name="\u0275NotFound",o}return t}};function fi(n){return n[mc]||null}function xc(n){return n[gc]||null}function Mf(n){return n[hc]||null}function Df(...n){return{\u0275providers:Sc(!0,n),\u0275fromNgModule:!0}}function Sc(n,...e){let t=[],i=new Set,o,r=s=>{t.push(s)};return Ps(e,s=>{let a=s;Es(a,r,[],i)&&(o||=[],o.push(a))}),o!==void 0&&Tf(o,r),t}function Tf(n,e){for(let t=0;t<n.length;t++){let{ngModule:i,providers:o}=n[t];wc(o,r=>{e(r,i)})}}function Es(n,e,t,i){if(n=ct(n),!n)return!1;let o=null,r=nc(n),s=!r&&fi(n);if(!r&&!s){let u=n.ngModule;if(r=nc(u),r)o=u;else return!1}else{if(s&&!s.standalone)return!1;o=n}let a=i.has(o);if(s){if(a)return!1;if(i.add(o),s.dependencies){let u=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let f of u)Es(f,e,t,i)}}else if(r){if(r.imports!=null&&!a){i.add(o);let f;try{Ps(r.imports,g=>{Es(g,e,t,i)&&(f||=[],f.push(g))})}finally{}f!==void 0&&Tf(f,e)}if(!a){let f=jn(o)||(()=>new o);e({provide:o,useFactory:f,deps:St},o),e({provide:bc,useValue:o,multi:!0},o),e({provide:pi,useValue:()=>De(o),multi:!0},o)}let u=r.providers;if(u!=null&&!a){let f=n;wc(u,g=>{e(g,f)})}}else return!1;return o!==n&&n.providers!==void 0}function wc(n,e){for(let t of n)fc(t)&&(t=t.\u0275providers),Array.isArray(t)?wc(t,e):e(t)}var I_=Pe({provide:String,useValue:Pe});function If(n){return n!==null&&typeof n=="object"&&I_ in n}function P_(n){return!!(n&&n.useExisting)}function O_(n){return!!(n&&n.useFactory)}function li(n){return typeof n=="function"}function Pf(n){return!!n.useClass}var Go=new le(""),Ss={},_f={},tc;function Qo(){return tc===void 0&&(tc=new Ho),tc}var Lt=class{},ci=class extends Lt{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,i,o){super(),this.parent=t,this.source=i,this.scopes=o,ac(e,s=>this.processProvider(s)),this.records.set(yc,eo(void 0,this)),o.has("environment")&&this.records.set(Lt,eo(void 0,this));let r=this.records.get(Go);r!=null&&typeof r.value=="string"&&this.scopes.add(r.value),this.injectorDefTypes=new Set(this.get(bc,St,{self:!0}))}retrieve(e,t){let i=ai(t)||0;try{return this.get(e,si,i)}catch(o){if(Ui(o))return o;throw o}}destroy(){$o(this),this._destroyed=!0;let e=J(null);try{for(let i of this._ngOnDestroyHooks)i.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let i of t)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),J(e)}}onDestroy(e){return $o(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){$o(this);let t=ln(this),i=xt(void 0),o;try{return e()}finally{ln(t),xt(i)}}get(e,t=si,i){if($o(this),e.hasOwnProperty(hf))return e[hf](this);let o=ai(i),r,s=ln(this),a=xt(void 0);try{if(!(o&4)){let f=this.records.get(e);if(f===void 0){let g=F_(e)&&Ds(e);g&&this.injectableDefInScope(g)?f=eo(sc(e),Ss):f=null,this.records.set(e,f)}if(f!=null)return this.hydrate(e,f,o)}let u=o&2?Qo():this.parent;return t=o&8&&t===si?null:t,u.get(e,t)}catch(u){let f=x_(u);throw f===-200||f===-201?new ne(f,null):u}finally{xt(a),ln(s)}}resolveInjectorInitializers(){let e=J(null),t=ln(this),i=xt(void 0),o;try{let r=this.get(pi,St,{self:!0});for(let s of r)s()}finally{ln(t),xt(i),J(e)}}toString(){let e=[],t=this.records;for(let i of t.keys())e.push(Ln(i));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=ct(e);let t=li(e)?e:ct(e&&e.provide),i=N_(e);if(!li(e)&&e.multi===!0){let o=this.records.get(t);o||(o=eo(void 0,Ss,!0),o.factory=()=>rc(o.multi),this.records.set(t,o)),t=e,o.multi.push(e)}this.records.set(t,i)}hydrate(e,t,i){let o=J(null);try{if(t.value===_f)throw _c(Ln(e));return t.value===Ss&&(t.value=_f,t.value=t.factory(void 0,i)),typeof t.value=="object"&&t.value&&R_(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{J(o)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=ct(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function sc(n){let e=Ds(n),t=e!==null?e.factory:jn(n);if(t!==null)return t;if(n instanceof le)throw new ne(204,!1);if(n instanceof Function)return A_(n);throw new ne(204,!1)}function A_(n){if(n.length>0)throw new ne(204,!1);let t=v_(n);return t!==null?()=>t.factory(n):()=>new n}function N_(n){if(If(n))return eo(void 0,n.useValue);{let e=Ec(n);return eo(e,Ss)}}function Ec(n,e,t){let i;if(li(n)){let o=ct(n);return jn(o)||sc(o)}else if(If(n))i=()=>ct(n.useValue);else if(O_(n))i=()=>n.useFactory(...rc(n.deps||[]));else if(P_(n))i=(o,r)=>De(ct(n.useExisting),r!==void 0&&r&8?8:void 0);else{let o=ct(n&&(n.useClass||n.provide));if(k_(n))i=()=>new o(...rc(n.deps));else return jn(o)||sc(o)}return i}function $o(n){if(n.destroyed)throw new ne(205,!1)}function eo(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function k_(n){return!!n.deps}function R_(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function F_(n){return typeof n=="function"||typeof n=="object"&&n.ngMetadataName==="InjectionToken"}function ac(n,e){for(let t of n)Array.isArray(t)?ac(t,e):t&&fc(t)?ac(t.\u0275providers,e):e(t)}function Ns(n,e){let t;n instanceof ci?($o(n),t=n):t=new oc(n);let i,o=ln(t),r=xt(void 0);try{return e()}finally{ln(o),xt(r)}}function Of(){return xf()!==void 0||Gr()!=null}var Yt=0,Y=1,X=2,it=3,zt=4,$t=5,no=6,io=7,Qe=8,Mn=9,Dn=10,Oe=11,oo=12,Mc=13,mi=14,Ot=15,Hn=16,gi=17,pn=18,Yo=19,Dc=20,En=21,ks=22,Tn=23,At=24,hi=25,_i=26,$e=27,Af=1,Tc=6,Un=7,Ko=8,Ci=9,Be=10;function fn(n){return Array.isArray(n)&&typeof n[Af]=="object"}function Kt(n){return Array.isArray(n)&&n[Af]===!0}function Ic(n){return(n.flags&4)!==0}function qn(n){return n.componentOffset>-1}function Rs(n){return(n.flags&1)===1}function mn(n){return!!n.template}function ro(n){return(n[X]&512)!==0}function vi(n){return(n[X]&256)===256}var Nf="svg",kf="math";function Bt(n){for(;Array.isArray(n);)n=n[Yt];return n}function Pc(n,e){return Bt(e[n])}function Zt(n,e){return Bt(e[n.index])}function Zo(n,e){return n.data[e]}function Jo(n,e){return n[e]}function Oc(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}function Ht(n,e){let t=e[n];return fn(t)?t:t[Yt]}function Rf(n){return(n[X]&4)===4}function Fs(n){return(n[X]&128)===128}function Ff(n){return Kt(n[it])}function gn(n,e){return e==null?null:n[e]}function Ac(n){n[gi]=0}function Nc(n){n[X]&1024||(n[X]|=1024,Fs(n)&&Wn(n))}function Vf(n,e){for(;n>0;)e=e[mi],n--;return e}function Xo(n){return!!(n[X]&9216||n[At]?.dirty)}function Vs(n){n[Dn].changeDetectionScheduler?.notify(8),n[X]&64&&(n[X]|=1024),Xo(n)&&Wn(n)}function Wn(n){n[Dn].changeDetectionScheduler?.notify(0);let e=zn(n);for(;e!==null&&!(e[X]&8192||(e[X]|=8192,!Fs(e)));)e=zn(e)}function kc(n,e){if(vi(n))throw new ne(911,!1);n[En]===null&&(n[En]=[]),n[En].push(e)}function Lf(n,e){if(n[En]===null)return;let t=n[En].indexOf(e);t!==-1&&n[En].splice(t,1)}function zn(n){let e=n[it];return Kt(e)?e[it]:e}function Rc(n){return n[io]??=[]}function Fc(n){return n.cleanup??=[]}function jf(n,e,t,i){let o=Rc(e);o.push(t),n.firstCreatePass&&Fc(n).push(i,o.length-1)}var ae={lFrame:Jf(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var lc=!1;function zf(){return ae.lFrame.elementDepthCount}function $f(){ae.lFrame.elementDepthCount++}function Vc(){ae.lFrame.elementDepthCount--}function Bf(){return ae.bindingsEnabled}function Hf(){return ae.skipHydrationRootTNode!==null}function Lc(n){return ae.skipHydrationRootTNode===n}function jc(){ae.skipHydrationRootTNode=null}function Z(){return ae.lFrame.lView}function Ye(){return ae.lFrame.tView}function v(n){return ae.lFrame.contextLView=n,n[Qe]}function y(n){return ae.lFrame.contextLView=null,n}function dt(){let n=zc();for(;n!==null&&n.type===64;)n=n.parent;return n}function zc(){return ae.lFrame.currentTNode}function Uf(){let n=ae.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function so(n,e){let t=ae.lFrame;t.currentTNode=n,t.isParent=e}function $c(){return ae.lFrame.isParent}function qf(){ae.lFrame.isParent=!1}function Wf(){return ae.lFrame.contextLView}function Bc(){return lc}function ao(n){let e=lc;return lc=n,e}function Ls(){let n=ae.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function lo(){return ae.lFrame.bindingIndex}function Hc(n){return ae.lFrame.bindingIndex=n}function Gn(){return ae.lFrame.bindingIndex++}function yi(n){let e=ae.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function Gf(){return ae.lFrame.inI18n}function Qf(n,e){let t=ae.lFrame;t.bindingIndex=t.bindingRootIndex=n,js(e)}function Yf(){return ae.lFrame.currentDirectiveIndex}function js(n){ae.lFrame.currentDirectiveIndex=n}function Kf(n){let e=ae.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function Uc(){return ae.lFrame.currentQueryIndex}function zs(n){ae.lFrame.currentQueryIndex=n}function V_(n){let e=n[Y];return e.type===2?e.declTNode:e.type===1?n[$t]:null}function qc(n,e,t){if(t&4){let o=e,r=n;for(;o=o.parent,o===null&&!(t&1);)if(o=V_(r),o===null||(r=r[mi],o.type&10))break;if(o===null)return!1;e=o,n=r}let i=ae.lFrame=Zf();return i.currentTNode=e,i.lView=n,!0}function $s(n){let e=Zf(),t=n[Y];ae.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function Zf(){let n=ae.lFrame,e=n===null?null:n.child;return e===null?Jf(n):e}function Jf(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function Xf(){let n=ae.lFrame;return ae.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var Wc=Xf;function Bs(){let n=Xf();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function em(n){return(ae.lFrame.contextLView=Vf(n,ae.lFrame.contextLView))[Qe]}function Tt(){return ae.lFrame.selectedIndex}function Qn(n){ae.lFrame.selectedIndex=n}function er(){let n=ae.lFrame;return Zo(n.tView,n.selectedIndex)}function tm(){return ae.lFrame.currentNamespace}var nm=!0;function Hs(){return nm}function Us(n){nm=n}function cc(n,e=null,t=null,i){let o=im(n,e,t,i);return o.resolveInjectorInitializers(),o}function im(n,e=null,t=null,i,o=new Set){let r=[t||St,Df(n)];return i=i||(typeof n=="object"?void 0:Ln(n)),new ci(r,e||Qo(),i||null,o)}var Qt=class n{static THROW_IF_NOT_FOUND=si;static NULL=new Ho;static create(e,t){if(Array.isArray(e))return cc({name:""},t,e,"");{let i=e.name??"";return cc({name:i},e.parent,e.providers,i)}}static \u0275prov=oe({token:n,providedIn:"any",factory:()=>De(yc)});static __NG_ELEMENT_ID__=-1},Jt=new le(""),In=(()=>{class n{static __NG_ELEMENT_ID__=L_;static __NG_ENV_ID__=t=>t}return n})(),Uo=class extends In{_lView;constructor(e){super(),this._lView=e}get destroyed(){return vi(this._lView)}onDestroy(e){let t=this._lView;return kc(t,e),()=>Lf(t,e)}};function L_(){return new Uo(Z())}var jt=class{_console=console;handleError(e){this._console.error("ERROR",e)}},Pn=new le("",{providedIn:"root",factory:()=>{let n=q(Lt),e;return t=>{n.destroyed&&!e?setTimeout(()=>{throw t}):(e??=n.get(jt),e.handleError(t))}}}),om={provide:pi,useValue:()=>void q(jt),multi:!0};function Gc(n){return typeof n=="function"&&n[Dt]!==void 0}function w(n,e){let[t,i,o]=Ul(n,e?.equal),r=t,s=r[Dt];return r.set=i,r.update=o,r.asReadonly=Qc.bind(r),r}function Qc(){let n=this[Dt];if(n.readonlyFn===void 0){let e=()=>this();e[Dt]=n,n.readonlyFn=e}return n.readonlyFn}function Yc(n){return Gc(n)&&typeof n.set=="function"}var co=(()=>{class n{view;node;constructor(t,i){this.view=t,this.node=i}static __NG_ELEMENT_ID__=j_}return n})();function j_(){return new co(Z(),dt())}var un=class{},qs=new le("",{providedIn:"root",factory:()=>!1});var Kc=new le(""),Zc=new le(""),bi=(()=>{class n{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new zo(!1);get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new Ge(t=>{t.next(!1),t.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=oe({token:n,providedIn:"root",factory:()=>new n})}return n})();function xi(...n){}var tr=(()=>{class n{static \u0275prov=oe({token:n,providedIn:"root",factory:()=>new dc})}return n})(),dc=class{dirtyEffectCount=0;queues=new Map;add(e){this.enqueue(e),this.schedule(e)}schedule(e){e.dirty&&this.dirtyEffectCount++}remove(e){let t=e.zone,i=this.queues.get(t);i.has(e)&&(i.delete(e),e.dirty&&this.dirtyEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let i=this.queues.get(t);i.has(e)||i.add(e)}flush(){for(;this.dirtyEffectCount>0;){let e=!1;for(let[t,i]of this.queues)t===null?e||=this.flushQueue(i):e||=t.run(()=>this.flushQueue(i));e||(this.dirtyEffectCount=0)}}flushQueue(e){let t=!1;for(let i of e)i.dirty&&(this.dirtyEffectCount--,t=!0,i.run());return t}};function pr(n){return{toString:n}.toString()}function K_(n){return typeof n=="function"}var Xs=class{previousValue;currentValue;firstChange;constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}};function km(n,e,t,i){e!==null?e.applyValueToInputSignal(e,i):n[t]=i}var Fe=(()=>{let n=()=>Rm;return n.ngInherit=!0,n})();function Rm(n){return n.type.prototype.ngOnChanges&&(n.setInput=J_),Z_}function Z_(){let n=Vm(this),e=n?.current;if(e){let t=n.previous;if(t===Bn)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function J_(n,e,t,i,o){let r=this.declaredInputs[i],s=Vm(n)||X_(n,{previous:Bn,current:null}),a=s.current||(s.current={}),u=s.previous,f=u[r];a[r]=new Xs(f&&f.currentValue,t,u===Bn),km(n,e,o,t)}var Fm="__ngSimpleChanges__";function Vm(n){return n[Fm]||null}function X_(n,e){return n[Fm]=e}var rm=[];var Te=function(n,e=null,t){for(let i=0;i<rm.length;i++){let o=rm[i];o(n,e,t)}};function eC(n,e,t){let{ngOnChanges:i,ngOnInit:o,ngDoCheck:r}=e.type.prototype;if(i){let s=Rm(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}o&&(t.preOrderHooks??=[]).push(0-n,o),r&&((t.preOrderHooks??=[]).push(n,r),(t.preOrderCheckHooks??=[]).push(n,r))}function tC(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){let r=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:f,ngOnDestroy:g}=r;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),u&&(n.viewHooks??=[]).push(-t,u),f&&((n.viewHooks??=[]).push(t,f),(n.viewCheckHooks??=[]).push(t,f)),g!=null&&(n.destroyHooks??=[]).push(t,g)}}function Qs(n,e,t){Lm(n,e,3,t)}function Ys(n,e,t,i){(n[X]&3)===t&&Lm(n,e,t,i)}function Jc(n,e){let t=n[X];(t&3)===e&&(t&=16383,t+=1,n[X]=t)}function Lm(n,e,t,i){let o=i!==void 0?n[gi]&65535:0,r=i??-1,s=e.length-1,a=0;for(let u=o;u<s;u++)if(typeof e[u+1]=="number"){if(a=e[u],i!=null&&a>=i)break}else e[u]<0&&(n[gi]+=65536),(a<r||r==-1)&&(nC(n,t,e,u),n[gi]=(n[gi]&4294901760)+u+2),u++}function sm(n,e){Te(4,n,e);let t=J(null);try{e.call(n)}finally{J(t),Te(5,n,e)}}function nC(n,e,t,i){let o=t[i]<0,r=t[i+1],s=o?-t[i]:t[i],a=n[s];o?n[X]>>14<n[gi]>>16&&(n[X]&3)===e&&(n[X]+=16384,sm(a,r)):sm(a,r)}var po=-1,wi=class{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,i,o){this.factory=e,this.name=o,this.canSeeViewProviders=t,this.injectImpl=i}};function iC(n){return(n.flags&8)!==0}function oC(n){return(n.flags&16)!==0}function rC(n,e,t){let i=0;for(;i<t.length;){let o=t[i];if(typeof o=="number"){if(o!==0)break;i++;let r=t[i++],s=t[i++],a=t[i++];n.setAttribute(e,s,a,r)}else{let r=o,s=t[++i];aC(r)?n.setProperty(e,r,s):n.setAttribute(e,r,s),i++}}return i}function sC(n){return n===3||n===4||n===6}function aC(n){return n.charCodeAt(0)===64}function fo(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){let o=e[i];typeof o=="number"?t=o:t===0||(t===-1||t===2?am(n,t,o,null,e[++i]):am(n,t,o,null,null))}}return n}function am(n,e,t,i,o){let r=0,s=n.length;if(e===-1)s=-1;else for(;r<n.length;){let a=n[r++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=r-1;break}}}for(;r<n.length;){let a=n[r];if(typeof a=="number")break;if(a===t){o!==null&&(n[r+1]=o);return}r++,o!==null&&r++}s!==-1&&(n.splice(s,0,e),r=s+1),n.splice(r++,0,t),o!==null&&n.splice(r++,0,o)}function jm(n){return n!==po}function ea(n){return n&32767}function lC(n){return n>>16}function ta(n,e){let t=lC(n),i=e;for(;t>0;)i=i[mi],t--;return i}var cd=!0;function na(n){let e=cd;return cd=n,e}var cC=256,zm=cC-1,$m=5,dC=0,hn={};function uC(n,e,t){let i;typeof t=="string"?i=t.charCodeAt(0)||0:t.hasOwnProperty(ui)&&(i=t[ui]),i==null&&(i=t[ui]=dC++);let o=i&zm,r=1<<o;e.data[n+(o>>$m)]|=r}function ia(n,e){let t=Bm(n,e);if(t!==-1)return t;let i=e[Y];i.firstCreatePass&&(n.injectorIndex=e.length,Xc(i.data,n),Xc(e,null),Xc(i.blueprint,null));let o=Hd(n,e),r=n.injectorIndex;if(jm(o)){let s=ea(o),a=ta(o,e),u=a[Y].data;for(let f=0;f<8;f++)e[r+f]=a[s+f]|u[s+f]}return e[r+8]=o,r}function Xc(n,e){n.push(0,0,0,0,0,0,0,0,e)}function Bm(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function Hd(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,i=null,o=e;for(;o!==null;){if(i=Gm(o),i===null)return po;if(t++,o=o[mi],i.injectorIndex!==-1)return i.injectorIndex|t<<16}return po}function dd(n,e,t){uC(n,e,t)}function Hm(n,e,t){if(t&8||n!==void 0)return n;Is(e,"NodeInjector")}function Um(n,e,t,i){if(t&8&&i===void 0&&(i=null),(t&3)===0){let o=n[Mn],r=xt(void 0);try{return o?o.get(e,i,t&8):Cc(e,i,t&8)}finally{xt(r)}}return Hm(i,e,t)}function qm(n,e,t,i=0,o){if(n!==null){if(e[X]&2048&&!(i&2)){let s=gC(n,e,t,i,hn);if(s!==hn)return s}let r=Wm(n,e,t,i,hn);if(r!==hn)return r}return Um(e,t,i,o)}function Wm(n,e,t,i,o){let r=fC(t);if(typeof r=="function"){if(!qc(e,n,i))return i&1?Hm(o,t,i):Um(e,t,i,o);try{let s;if(s=r(i),s==null&&!(i&8))Is(t);else return s}finally{Wc()}}else if(typeof r=="number"){let s=null,a=Bm(n,e),u=po,f=i&1?e[Ot][$t]:null;for((a===-1||i&4)&&(u=a===-1?Hd(n,e):e[a+8],u===po||!cm(i,!1)?a=-1:(s=e[Y],a=ea(u),e=ta(u,e)));a!==-1;){let g=e[Y];if(lm(r,a,g.data)){let h=pC(a,e,t,s,i,f);if(h!==hn)return h}u=e[a+8],u!==po&&cm(i,e[Y].data[a+8]===f)&&lm(r,a,e)?(s=g,a=ea(u),e=ta(u,e)):a=-1}}return o}function pC(n,e,t,i,o,r){let s=e[Y],a=s.data[n+8],u=i==null?qn(a)&&cd:i!=s&&(a.type&3)!==0,f=o&1&&r===a,g=Ks(a,s,t,u,f);return g!==null?or(e,s,g,a,o):hn}function Ks(n,e,t,i,o){let r=n.providerIndexes,s=e.data,a=r&1048575,u=n.directiveStart,f=n.directiveEnd,g=r>>20,h=i?a:a+g,b=o?a+g:f;for(let C=h;C<b;C++){let T=s[C];if(C<u&&t===T||C>=u&&T.type===t)return C}if(o){let C=s[u];if(C&&mn(C)&&C.type===t)return u}return null}function or(n,e,t,i,o){let r=n[t],s=e.data;if(r instanceof wi){let a=r;if(a.resolving){let C=vf(s[t]);throw _c(C)}let u=na(a.canSeeViewProviders);a.resolving=!0;let f=s[t].type||s[t],g,h=a.injectImpl?xt(a.injectImpl):null,b=qc(n,i,0);try{r=n[t]=a.factory(void 0,o,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&eC(t,s[t],e)}finally{h!==null&&xt(h),na(u),a.resolving=!1,Wc()}}return r}function fC(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(ui)?n[ui]:void 0;return typeof e=="number"?e>=0?e&zm:mC:e}function lm(n,e,t){let i=1<<n;return!!(t[e+(n>>$m)]&i)}function cm(n,e){return!(n&2)&&!(n&1&&e)}var Si=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return qm(this._tNode,this._lView,e,ai(i),t)}};function mC(){return new Si(dt(),Z())}function An(n){return pr(()=>{let e=n.prototype.constructor,t=e[Bo]||ud(e),i=Object.prototype,o=Object.getPrototypeOf(n.prototype).constructor;for(;o&&o!==i;){let r=o[Bo]||ud(o);if(r&&r!==t)return r;o=Object.getPrototypeOf(o)}return r=>new r})}function ud(n){return pc(n)?()=>{let e=ud(ct(n));return e&&e()}:jn(n)}function gC(n,e,t,i,o){let r=n,s=e;for(;r!==null&&s!==null&&s[X]&2048&&!ro(s);){let a=Wm(r,s,t,i|2,hn);if(a!==hn)return a;let u=r.parent;if(!u){let f=s[Dc];if(f){let g=f.get(t,hn,i);if(g!==hn)return g}u=Gm(s),s=s[mi]}r=u}return o}function Gm(n){let e=n[Y],t=e.type;return t===2?e.declTNode:t===1?n[$t]:null}function hC(){return Co(dt(),Z())}function Co(n,e){return new Nt(Zt(n,e))}var Nt=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=hC}return n})();function _C(n){return n instanceof Nt?n.nativeElement:n}function CC(){return this._results[Symbol.iterator]()}var oa=class{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new cn}constructor(e=!1){this._emitDistinctChangesOnly=e}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;let i=wf(e);(this._changesDetected=!Sf(this._results,i,t))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=CC};function Qm(n){return(n.flags&128)===128}var Ud=(function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n})(Ud||{}),Ym=new Map,vC=0;function yC(){return vC++}function bC(n){Ym.set(n[Yo],n)}function pd(n){Ym.delete(n[Yo])}var dm="__ngContext__";function mo(n,e){fn(e)?(n[dm]=e[Yo],bC(e)):n[dm]=e}function Km(n){return Jm(n[oo])}function Zm(n){return Jm(n[zt])}function Jm(n){for(;n!==null&&!Kt(n);)n=n[zt];return n}var fd;function qd(n){fd=n}function Xm(){if(fd!==void 0)return fd;if(typeof document<"u")return document;throw new ne(210,!1)}var ga=new le("",{providedIn:"root",factory:()=>xC}),xC="ng",ha=new le(""),fr=new le("",{providedIn:"platform",factory:()=>"unknown"});var _a=new le("",{providedIn:"root",factory:()=>Xm().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var SC="h",wC="b";var eg="r";var tg="di";var ng=!1,ig=new le("",{providedIn:"root",factory:()=>ng});var EC=(n,e,t,i)=>{};function MC(n,e,t,i){EC(n,e,t,i)}function Wd(n){return(n.flags&32)===32}var DC=()=>null;function og(n,e,t=!1){return DC(n,e,t)}function rg(n,e){let t=n.contentQueries;if(t!==null){let i=J(null);try{for(let o=0;o<t.length;o+=2){let r=t[o],s=t[o+1];if(s!==-1){let a=n.data[s];zs(r),a.contentQueries(2,e[s],s)}}}finally{J(i)}}}function md(n,e,t){zs(0);let i=J(null);try{e(n,t)}finally{J(i)}}function sg(n,e,t){if(Ic(e)){let i=J(null);try{let o=e.directiveStart,r=e.directiveEnd;for(let s=o;s<r;s++){let a=n.data[s];if(a.contentQueries){let u=t[s];a.contentQueries(1,u,s)}}}finally{J(i)}}}var On=(function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n})(On||{});var gd=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${uc})`}};function Gd(n){return n instanceof gd?n.changingThisBreaksApplicationSecurity:n}function TC(n,e){return n.createText(e)}function IC(n,e,t){n.setValue(e,t)}function ag(n,e,t){return n.createElement(e,t)}function ra(n,e,t,i,o){n.insertBefore(e,t,i,o)}function lg(n,e,t){n.appendChild(e,t)}function um(n,e,t,i,o){i!==null?ra(n,e,t,i,o):lg(n,e,t)}function cg(n,e,t,i){n.removeChild(null,e,t,i)}function PC(n,e,t){n.setAttribute(e,"style",t)}function OC(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function dg(n,e,t){let{mergedAttrs:i,classes:o,styles:r}=t;i!==null&&rC(n,e,i),o!==null&&OC(n,e,o),r!==null&&PC(n,e,r)}function Qd(n){return n.ownerDocument}function AC(n,e,t){let i=n.length;for(;;){let o=n.indexOf(e,t);if(o===-1)return o;if(o===0||n.charCodeAt(o-1)<=32){let r=e.length;if(o+r===i||n.charCodeAt(o+r)<=32)return o}t=o+1}}var ug="ng-template";function NC(n,e,t,i){let o=0;if(i){for(;o<e.length&&typeof e[o]=="string";o+=2)if(e[o]==="class"&&AC(e[o+1].toLowerCase(),t,0)!==-1)return!0}else if(Yd(n))return!1;if(o=e.indexOf(1,o),o>-1){let r;for(;++o<e.length&&typeof(r=e[o])=="string";)if(r.toLowerCase()===t)return!0}return!1}function Yd(n){return n.type===4&&n.value!==ug}function kC(n,e,t){let i=n.type===4&&!t?ug:n.value;return e===i}function RC(n,e,t){let i=4,o=n.attrs,r=o!==null?LC(o):0,s=!1;for(let a=0;a<e.length;a++){let u=e[a];if(typeof u=="number"){if(!s&&!Xt(i)&&!Xt(u))return!1;if(s&&Xt(u))continue;s=!1,i=u|i&1;continue}if(!s)if(i&4){if(i=2|i&1,u!==""&&!kC(n,u,t)||u===""&&e.length===1){if(Xt(i))return!1;s=!0}}else if(i&8){if(o===null||!NC(n,o,u,t)){if(Xt(i))return!1;s=!0}}else{let f=e[++a],g=FC(u,o,Yd(n),t);if(g===-1){if(Xt(i))return!1;s=!0;continue}if(f!==""){let h;if(g>r?h="":h=o[g+1].toLowerCase(),i&2&&f!==h){if(Xt(i))return!1;s=!0}}}}return Xt(i)||s}function Xt(n){return(n&1)===0}function FC(n,e,t,i){if(e===null)return-1;let o=0;if(i||!t){let r=!1;for(;o<e.length;){let s=e[o];if(s===n)return o;if(s===3||s===6)r=!0;else if(s===1||s===2){let a=e[++o];for(;typeof a=="string";)a=e[++o];continue}else{if(s===4)break;if(s===0){o+=4;continue}}o+=r?1:2}return-1}else return jC(e,n)}function VC(n,e,t=!1){for(let i=0;i<e.length;i++)if(RC(n,e[i],t))return!0;return!1}function LC(n){for(let e=0;e<n.length;e++){let t=n[e];if(sC(t))return e}return n.length}function jC(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let i=n[t];if(typeof i=="number")return-1;if(i===e)return t;t++}return-1}function pm(n,e){return n?":not("+e.trim()+")":e}function zC(n){let e=n[0],t=1,i=2,o="",r=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(i&2){let a=n[++t];o+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else i&8?o+="."+s:i&4&&(o+=" "+s);else o!==""&&!Xt(s)&&(e+=pm(r,o),o=""),i=s,r=r||!Xt(i);t++}return o!==""&&(e+=pm(r,o)),e}function $C(n){return n.map(zC).join(",")}function BC(n){let e=[],t=[],i=1,o=2;for(;i<n.length;){let r=n[i];if(typeof r=="string")o===2?r!==""&&e.push(r,n[++i]):o===8&&t.push(r);else{if(!Xt(o))break;o=r}i++}return t.length&&e.push(1,...t),e}var He={};function Kd(n,e,t,i,o,r,s,a,u,f,g){let h=$e+i,b=h+o,C=HC(h,b),T=typeof f=="function"?f():f;return C[Y]={type:n,blueprint:C,template:t,queries:null,viewQuery:a,declTNode:e,data:C.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:b,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof r=="function"?r():r,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:u,consts:T,incompleteFirstPass:!1,ssrId:g}}function HC(n,e){let t=[];for(let i=0;i<e;i++)t.push(i<n?null:He);return t}function UC(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=Kd(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function Zd(n,e,t,i,o,r,s,a,u,f,g){let h=e.blueprint.slice();return h[Yt]=o,h[X]=i|4|128|8|64|1024,(f!==null||n&&n[X]&2048)&&(h[X]|=2048),Ac(h),h[it]=h[mi]=n,h[Qe]=t,h[Dn]=s||n&&n[Dn],h[Oe]=a||n&&n[Oe],h[Mn]=u||n&&n[Mn]||null,h[$t]=r,h[Yo]=yC(),h[no]=g,h[Dc]=f,h[Ot]=e.type==2?n[Ot]:h,h}function qC(n,e,t){let i=Zt(e,n),o=UC(t),r=n[Dn].rendererFactory,s=Jd(n,Zd(n,o,null,pg(t),i,e,null,r.createRenderer(i,t),null,null,null));return n[e.index]=s}function pg(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function fg(n,e,t,i){if(t===0)return-1;let o=e.length;for(let r=0;r<t;r++)e.push(i),n.blueprint.push(i),n.data.push(null);return o}function Jd(n,e){return n[oo]?n[Mc][zt]=e:n[oo]=e,n[Mc]=e,e}function p(n=1){mg(Ye(),Z(),Tt()+n,!1)}function mg(n,e,t,i){if(!i)if((e[X]&3)===3){let r=n.preOrderCheckHooks;r!==null&&Qs(e,r,t)}else{let r=n.preOrderHooks;r!==null&&Ys(e,r,0,t)}Qn(t)}var Ca=(function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n})(Ca||{});function hd(n,e,t,i){let o=J(null);try{let[r,s,a]=n.inputs[t],u=null;(s&Ca.SignalBased)!==0&&(u=e[r][Dt]),u!==null&&u.transformFn!==void 0?i=u.transformFn(i):a!==null&&(i=a.call(e,i)),n.setInput!==null?n.setInput(e,u,i,t,r):km(e,u,r,i)}finally{J(o)}}var _n=(function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n})(_n||{}),WC;function Xd(n,e){return WC(n,e)}var Ei=new Set,va=(function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n})(va||{}),Ti=new le(""),fm=new Set;function Ii(n){fm.has(n)||(fm.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var gg=!1,_d=class extends cn{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,Of()&&(this.destroyRef=q(In,{optional:!0})??void 0,this.pendingTasks=q(bi,{optional:!0})??void 0)}emit(e){let t=J(null);try{super.next(e)}finally{J(t)}}subscribe(e,t,i){let o=e,r=t||(()=>null),s=i;if(e&&typeof e=="object"){let u=e;o=u.next?.bind(u),r=u.error?.bind(u),s=u.complete?.bind(u)}this.__isAsync&&(r=this.wrapInTimeout(r),o&&(o=this.wrapInTimeout(o)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:o,error:r,complete:s});return e instanceof bt&&e.add(a),a}wrapInTimeout(e){return t=>{let i=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{i!==void 0&&this.pendingTasks?.remove(i)}})}}},W=_d;function hg(n){let e,t;function i(){n=xi;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),i()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),i()})),()=>i()}function mm(n){return queueMicrotask(()=>n()),()=>{n=xi}}var eu="isAngularZone",sa=eu+"_ID",GC=0,Je=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new W(!1);onMicrotaskEmpty=new W(!1);onStable=new W(!1);onError=new W(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:o=!1,scheduleInRootZone:r=gg}=e;if(typeof Zone>"u")throw new ne(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!o&&i,s.shouldCoalesceRunChangeDetection=o,s.callbackScheduled=!1,s.scheduleInRootZone=r,KC(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(eu)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new ne(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new ne(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,o){let r=this._inner,s=r.scheduleEventTask("NgZoneEvent: "+o,e,QC,xi,xi);try{return r.runTask(s,t,i)}finally{r.cancelTask(s)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}},QC={};function tu(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function YC(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){hg(()=>{n.callbackScheduled=!1,Cd(n),n.isCheckStableRunning=!0,tu(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),Cd(n)}function KC(n){let e=()=>{YC(n)},t=GC++;n._inner=n._inner.fork({name:"angular",properties:{[eu]:!0,[sa]:t,[sa+t]:!0},onInvokeTask:(i,o,r,s,a,u)=>{if(ZC(u))return i.invokeTask(r,s,a,u);try{return gm(n),i.invokeTask(r,s,a,u)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),hm(n)}},onInvoke:(i,o,r,s,a,u,f)=>{try{return gm(n),i.invoke(r,s,a,u,f)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!JC(u)&&e(),hm(n)}},onHasTask:(i,o,r,s)=>{i.hasTask(r,s),o===r&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,Cd(n),tu(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(i,o,r,s)=>(i.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function Cd(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function gm(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function hm(n){n._nesting--,tu(n)}var aa=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new W;onMicrotaskEmpty=new W;onStable=new W;onError=new W;run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,o){return e.apply(t,i)}};function ZC(n){return _g(n,"__ignore_ng_zone__")}function JC(n){return _g(n,"__scheduler_tick__")}function _g(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var nu=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=oe({token:n,providedIn:"root",factory:()=>new n})}return n})(),Cg=[0,1,2,3],vg=(()=>{class n{ngZone=q(Je);scheduler=q(un);errorHandler=q(jt,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){q(Ti,{optional:!0})}execute(){let t=this.sequences.size>0;t&&Te(16),this.executing=!0;for(let i of Cg)for(let o of this.sequences)if(!(o.erroredOrDestroyed||!o.hooks[i]))try{o.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>{let r=o.hooks[i];return r(o.pipelinedValue)},o.snapshot))}catch(r){o.erroredOrDestroyed=!0,this.errorHandler?.handleError(r)}this.executing=!1;for(let i of this.sequences)i.afterRun(),i.once&&(this.sequences.delete(i),i.destroy());for(let i of this.deferredRegistrations)this.sequences.add(i);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),t&&Te(17)}register(t){let{view:i}=t;i!==void 0?((i[hi]??=[]).push(t),Wn(i),i[X]|=8192):this.executing?this.deferredRegistrations.add(t):this.addSequence(t)}addSequence(t){this.sequences.add(t),this.scheduler.notify(7)}unregister(t){this.executing&&this.sequences.has(t)?(t.erroredOrDestroyed=!0,t.pipelinedValue=void 0,t.once=!0):(this.sequences.delete(t),this.deferredRegistrations.delete(t))}maybeTrace(t,i){return i?i.run(va.AFTER_NEXT_RENDER,t):t()}static \u0275prov=oe({token:n,providedIn:"root",factory:()=>new n})}return n})(),la=class{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(e,t,i,o,r,s=null){this.impl=e,this.hooks=t,this.view=i,this.once=o,this.snapshot=s,this.unregisterOnDestroy=r?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();let e=this.view?.[hi];e&&(this.view[hi]=e.filter(t=>t!==this))}};function iu(n,e){let t=e?.injector??q(Qt);return Ii("NgAfterNextRender"),ev(n,t,e,!0)}function XC(n){return n instanceof Function?[void 0,void 0,n,void 0]:[n.earlyRead,n.write,n.mixedReadWrite,n.read]}function ev(n,e,t,i){let o=e.get(nu);o.impl??=e.get(vg);let r=e.get(Ti,null,{optional:!0}),s=t?.manualCleanup!==!0?e.get(In):null,a=e.get(co,null,{optional:!0}),u=new la(o.impl,XC(n),a?.view,i,s,r?.snapshot(null));return o.impl.register(u),u}var yg=new le("",{providedIn:"root",factory:()=>({queue:new Set,isScheduled:!1,scheduler:null})});function bg(n,e,t){let i=n.get(yg);if(Array.isArray(e))for(let o of e)i.queue.add(o),t?.detachedLeaveAnimationFns?.push(o);else i.queue.add(e),t?.detachedLeaveAnimationFns?.push(e);i.scheduler&&i.scheduler(n)}function tv(n,e){let t=n.get(yg);if(e.detachedLeaveAnimationFns){for(let i of e.detachedLeaveAnimationFns)t.queue.delete(i);e.detachedLeaveAnimationFns=void 0}}function nv(n,e){for(let[t,i]of e)bg(n,i.animateFns)}function _m(n,e,t,i){let o=n?.[_i]?.enter;e!==null&&o&&o.has(t.index)&&nv(i,o)}function uo(n,e,t,i,o,r,s,a){if(o!=null){let u,f=!1;Kt(o)?u=o:fn(o)&&(f=!0,o=o[Yt]);let g=Bt(o);n===0&&i!==null?(_m(a,i,r,t),s==null?lg(e,i,g):ra(e,i,g,s||null,!0)):n===1&&i!==null?(_m(a,i,r,t),ra(e,i,g,s||null,!0)):n===2?Cm(a,r,t,h=>{cg(e,g,f,h)}):n===3&&Cm(a,r,t,()=>{e.destroyNode(g)}),u!=null&&gv(e,n,t,u,r,i,s)}}function iv(n,e){xg(n,e),e[Yt]=null,e[$t]=null}function ov(n,e,t,i,o,r){i[Yt]=o,i[$t]=e,ba(n,i,t,1,o,r)}function xg(n,e){e[Dn].changeDetectionScheduler?.notify(9),ba(n,e,e[Oe],2,null,null)}function rv(n){let e=n[oo];if(!e)return ed(n[Y],n);for(;e;){let t=null;if(fn(e))t=e[oo];else{let i=e[Be];i&&(t=i)}if(!t){for(;e&&!e[zt]&&e!==n;)fn(e)&&ed(e[Y],e),e=e[it];e===null&&(e=n),fn(e)&&ed(e[Y],e),t=e&&e[zt]}e=t}}function ou(n,e){let t=n[Ci],i=t.indexOf(e);t.splice(i,1)}function ya(n,e){if(vi(e))return;let t=e[Oe];t.destroyNode&&ba(n,e,t,3,null,null),rv(e)}function ed(n,e){if(vi(e))return;let t=J(null);try{e[X]&=-129,e[X]|=256,e[At]&&Wi(e[At]),lv(n,e),av(n,e),e[Y].type===1&&e[Oe].destroy();let i=e[Hn];if(i!==null&&Kt(e[it])){i!==e[it]&&ou(i,e);let o=e[pn];o!==null&&o.detachView(n)}pd(e)}finally{J(t)}}function Cm(n,e,t,i){let o=n?.[_i];if(o==null||o.leave==null||!o.leave.has(e.index))return i(!1);n&&Ei.add(n),bg(t,()=>{if(o.leave&&o.leave.has(e.index)){let s=o.leave.get(e.index),a=[];if(s){for(let u=0;u<s.animateFns.length;u++){let f=s.animateFns[u],{promise:g}=f();a.push(g)}o.detachedLeaveAnimationFns=void 0}o.running=Promise.allSettled(a),sv(n,i)}else n&&Ei.delete(n),i(!1)},o)}function sv(n,e){let t=n[_i]?.running;if(t){t.then(()=>{n[_i].running=void 0,Ei.delete(n),e(!0)});return}e(!1)}function av(n,e){let t=n.cleanup,i=e[io];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let a=t[s+3];a>=0?i[a]():i[-a].unsubscribe(),s+=2}else{let a=i[t[s+1]];t[s].call(a)}i!==null&&(e[io]=null);let o=e[En];if(o!==null){e[En]=null;for(let s=0;s<o.length;s++){let a=o[s];a()}}let r=e[Tn];if(r!==null){e[Tn]=null;for(let s of r)s.destroy()}}function lv(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let i=0;i<t.length;i+=2){let o=e[t[i]];if(!(o instanceof wi)){let r=t[i+1];if(Array.isArray(r))for(let s=0;s<r.length;s+=2){let a=o[r[s]],u=r[s+1];Te(4,a,u);try{u.call(a)}finally{Te(5,a,u)}}else{Te(4,o,r);try{r.call(o)}finally{Te(5,o,r)}}}}}function cv(n,e,t){return dv(n,e.parent,t)}function dv(n,e,t){let i=e;for(;i!==null&&i.type&168;)e=i,i=e.parent;if(i===null)return t[Yt];if(qn(i)){let{encapsulation:o}=n.data[i.directiveStart+i.componentOffset];if(o===On.None||o===On.Emulated)return null}return Zt(i,t)}function uv(n,e,t){return fv(n,e,t)}function pv(n,e,t){return n.type&40?Zt(n,t):null}var fv=pv,vm;function ru(n,e,t,i){let o=cv(n,i,e),r=e[Oe],s=i.parent||e[$t],a=uv(s,i,e);if(o!=null)if(Array.isArray(t))for(let u=0;u<t.length;u++)um(r,o,t[u],a,!1);else um(r,o,t,a,!1);vm!==void 0&&vm(r,i,e,t,o)}function nr(n,e){if(e!==null){let t=e.type;if(t&3)return Zt(e,n);if(t&4)return vd(-1,n[e.index]);if(t&8){let i=e.child;if(i!==null)return nr(n,i);{let o=n[e.index];return Kt(o)?vd(-1,o):Bt(o)}}else{if(t&128)return nr(n,e.next);if(t&32)return Xd(e,n)()||Bt(n[e.index]);{let i=Sg(n,e);if(i!==null){if(Array.isArray(i))return i[0];let o=zn(n[Ot]);return nr(o,i)}else return nr(n,e.next)}}}return null}function Sg(n,e){if(e!==null){let i=n[Ot][$t],o=e.projection;return i.projection[o]}return null}function vd(n,e){let t=Be+n+1;if(t<e.length){let i=e[t],o=i[Y].firstChild;if(o!==null)return nr(i,o)}return e[Un]}function su(n,e,t,i,o,r,s){for(;t!=null;){let a=i[Mn];if(t.type===128){t=t.next;continue}let u=i[t.index],f=t.type;if(s&&e===0&&(u&&mo(Bt(u),i),t.flags|=2),!Wd(t))if(f&8)su(n,e,t.child,i,o,r,!1),uo(e,n,a,o,u,t,r,i);else if(f&32){let g=Xd(t,i),h;for(;h=g();)uo(e,n,a,o,h,t,r,i);uo(e,n,a,o,u,t,r,i)}else f&16?mv(n,e,i,t,o,r):uo(e,n,a,o,u,t,r,i);t=s?t.projectionNext:t.next}}function ba(n,e,t,i,o,r){su(t,i,n.firstChild,e,o,r,!1)}function mv(n,e,t,i,o,r){let s=t[Ot],u=s[$t].projection[i.projection];if(Array.isArray(u))for(let f=0;f<u.length;f++){let g=u[f];uo(e,n,t[Mn],o,g,i,r,t)}else{let f=u,g=s[it];Qm(i)&&(f.flags|=128),su(n,e,f,g,o,r,!0)}}function gv(n,e,t,i,o,r,s){let a=i[Un],u=Bt(i);a!==u&&uo(e,n,t,r,a,o,s);for(let f=Be;f<i.length;f++){let g=i[f];ba(g[Y],g,n,e,r,a)}}function hv(n,e,t,i,o){if(e)o?n.addClass(t,i):n.removeClass(t,i);else{let r=i.indexOf("-")===-1?void 0:_n.DashCase;o==null?n.removeStyle(t,i,r):(typeof o=="string"&&o.endsWith("!important")&&(o=o.slice(0,-10),r|=_n.Important),n.setStyle(t,i,o,r))}}function wg(n,e,t,i,o){let r=Tt(),s=i&2;try{Qn(-1),s&&e.length>$e&&mg(n,e,$e,!1),Te(s?2:0,o,t),t(i,o)}finally{Qn(r),Te(s?3:1,o,t)}}function Eg(n,e,t){xv(n,e,t),(t.flags&64)===64&&Sv(n,e,t)}function au(n,e,t=Zt){let i=e.localNames;if(i!==null){let o=e.index+1;for(let r=0;r<i.length;r+=2){let s=i[r+1],a=s===-1?t(e,n):n[s];n[o++]=a}}}function _v(n,e,t,i){let r=i.get(ig,ng)||t===On.ShadowDom,s=n.selectRootElement(e,r);return Cv(s),s}function Cv(n){vv(n)}var vv=()=>null;function yv(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function Mg(n,e,t,i,o,r){let s=e[Y];if(lu(n,s,e,t,i)){qn(n)&&bv(e,n.index);return}n.type&3&&(t=yv(t)),Dg(n,e,t,i,o,r)}function Dg(n,e,t,i,o,r){if(n.type&3){let s=Zt(n,e);i=r!=null?r(i,n.value||"",t):i,o.setProperty(s,t,i)}else n.type&12}function bv(n,e){let t=Ht(e,n);t[X]&16||(t[X]|=64)}function xv(n,e,t){let i=t.directiveStart,o=t.directiveEnd;qn(t)&&qC(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||ia(t,e);let r=t.initialInputs;for(let s=i;s<o;s++){let a=n.data[s],u=or(e,n,s,t);if(mo(u,e),r!==null&&Tv(e,s-i,u,a,t,r),mn(a)){let f=Ht(t.index,e);f[Qe]=or(e,n,s,t)}}}function Sv(n,e,t){let i=t.directiveStart,o=t.directiveEnd,r=t.index,s=Yf();try{Qn(r);for(let a=i;a<o;a++){let u=n.data[a],f=e[a];js(a),(u.hostBindings!==null||u.hostVars!==0||u.hostAttrs!==null)&&wv(u,f)}}finally{Qn(-1),js(s)}}function wv(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function Ev(n,e){let t=n.directiveRegistry,i=null;if(t)for(let o=0;o<t.length;o++){let r=t[o];VC(e,r.selectors,!1)&&(i??=[],mn(r)?i.unshift(r):i.push(r))}return i}function Mv(n,e,t,i,o,r){let s=Zt(n,e);Dv(e[Oe],s,r,n.value,t,i,o)}function Dv(n,e,t,i,o,r,s){if(r==null)n.removeAttribute(e,o,t);else{let a=s==null?Ze(r):s(r,i||"",o);n.setAttribute(e,o,a,t)}}function Tv(n,e,t,i,o,r){let s=r[e];if(s!==null)for(let a=0;a<s.length;a+=2){let u=s[a],f=s[a+1];hd(i,t,u,f)}}function Tg(n,e,t,i,o){let r=$e+t,s=e[Y],a=o(s,e,n,i,t);e[r]=a,so(n,!0);let u=n.type===2;return u?(dg(e[Oe],a,n),(zf()===0||Rs(n))&&mo(a,e),$f()):mo(a,e),Hs()&&(!u||!Wd(n))&&ru(s,e,a,n),n}function Ig(n){let e=n;return $c()?qf():(e=e.parent,so(e,!1)),e}function Iv(n,e){let t=n[Mn];if(!t)return;let i;try{i=t.get(Pn,null)}catch{i=null}i?.(e)}function lu(n,e,t,i,o){let r=n.inputs?.[i],s=n.hostDirectiveInputs?.[i],a=!1;if(s)for(let u=0;u<s.length;u+=2){let f=s[u],g=s[u+1],h=e.data[f];hd(h,t[f],g,o),a=!0}if(r)for(let u of r){let f=t[u],g=e.data[u];hd(g,f,i,o),a=!0}return a}function Pv(n,e){let t=Ht(e,n),i=t[Y];Ov(i,t);let o=t[Yt];o!==null&&t[no]===null&&(t[no]=og(o,t[Mn])),Te(18),cu(i,t,t[Qe]),Te(19,t[Qe])}function Ov(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function cu(n,e,t){$s(e);try{let i=n.viewQuery;i!==null&&md(1,i,t);let o=n.template;o!==null&&wg(n,e,o,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[pn]?.finishViewCreation(n),n.staticContentQueries&&rg(n,e),n.staticViewQueries&&md(2,n.viewQuery,t);let r=n.components;r!==null&&Av(e,r)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[X]&=-5,Bs()}}function Av(n,e){for(let t=0;t<e.length;t++)Pv(n,e[t])}function xa(n,e,t,i){let o=J(null);try{let r=e.tView,a=n[X]&4096?4096:16,u=Zd(n,r,t,a,null,e,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null),f=n[e.index];u[Hn]=f;let g=n[pn];return g!==null&&(u[pn]=g.createEmbeddedView(r)),cu(r,u,t),u}finally{J(o)}}function rr(n,e){return!e||e.firstChild===null||Qm(n)}function sr(n,e,t,i,o=!1){for(;t!==null;){if(t.type===128){t=o?t.projectionNext:t.next;continue}let r=e[t.index];r!==null&&i.push(Bt(r)),Kt(r)&&Pg(r,i);let s=t.type;if(s&8)sr(n,e,t.child,i);else if(s&32){let a=Xd(t,e),u;for(;u=a();)i.push(u)}else if(s&16){let a=Sg(e,t);if(Array.isArray(a))i.push(...a);else{let u=zn(e[Ot]);sr(u[Y],u,a,i,!0)}}t=o?t.projectionNext:t.next}return i}function Pg(n,e){for(let t=Be;t<n.length;t++){let i=n[t],o=i[Y].firstChild;o!==null&&sr(i[Y],i,o,e)}n[Un]!==n[Yt]&&e.push(n[Un])}function Og(n){if(n[hi]!==null){for(let e of n[hi])e.impl.addSequence(e);n[hi].length=0}}var Ag=[];function Nv(n){return n[At]??kv(n)}function kv(n){let e=Ag.pop()??Object.create(Fv);return e.lView=n,e}function Rv(n){n.lView[At]!==n&&(n.lView=null,Ag.push(n))}var Fv=O(E({},ti),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{Wn(n.lView)},consumerOnSignalRead(){this.lView[At]=this}});function Vv(n){let e=n[At]??Object.create(Lv);return e.lView=n,e}var Lv=O(E({},ti),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=zn(n.lView);for(;e&&!Ng(e[Y]);)e=zn(e);e&&Nc(e)},consumerOnSignalRead(){this.lView[At]=this}});function Ng(n){return n.type!==2}function kg(n){if(n[Tn]===null)return;let e=!0;for(;e;){let t=!1;for(let i of n[Tn])i.dirty&&(t=!0,i.zone===null||Zone.current===i.zone?i.run():i.zone.run(()=>i.run()));e=t&&!!(n[X]&8192)}}var jv=100;function Rg(n,e=0){let i=n[Dn].rendererFactory,o=!1;o||i.begin?.();try{zv(n,e)}finally{o||i.end?.()}}function zv(n,e){let t=Bc();try{ao(!0),yd(n,e);let i=0;for(;Xo(n);){if(i===jv)throw new ne(103,!1);i++,yd(n,1)}}finally{ao(t)}}function $v(n,e,t,i){if(vi(e))return;let o=e[X],r=!1,s=!1;$s(e);let a=!0,u=null,f=null;r||(Ng(n)?(f=Nv(e),u=qi(f)):Jr()===null?(a=!1,f=Vv(e),u=qi(f)):e[At]&&(Wi(e[At]),e[At]=null));try{Ac(e),Hc(n.bindingStartIndex),t!==null&&wg(n,e,t,2,i);let g=(o&3)===3;if(!r)if(g){let C=n.preOrderCheckHooks;C!==null&&Qs(e,C,null)}else{let C=n.preOrderHooks;C!==null&&Ys(e,C,0,null),Jc(e,0)}if(s||Bv(e),kg(e),Fg(e,0),n.contentQueries!==null&&rg(n,e),!r)if(g){let C=n.contentCheckHooks;C!==null&&Qs(e,C)}else{let C=n.contentHooks;C!==null&&Ys(e,C,1),Jc(e,1)}Uv(n,e);let h=n.components;h!==null&&Lg(e,h,0);let b=n.viewQuery;if(b!==null&&md(2,b,i),!r)if(g){let C=n.viewCheckHooks;C!==null&&Qs(e,C)}else{let C=n.viewHooks;C!==null&&Ys(e,C,2),Jc(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[ks]){for(let C of e[ks])C();e[ks]=null}r||(Og(e),e[X]&=-73)}catch(g){throw r||Wn(e),g}finally{f!==null&&(Vo(f,u),a&&Rv(f)),Bs()}}function Fg(n,e){for(let t=Km(n);t!==null;t=Zm(t))for(let i=Be;i<t.length;i++){let o=t[i];Vg(o,e)}}function Bv(n){for(let e=Km(n);e!==null;e=Zm(e)){if(!(e[X]&2))continue;let t=e[Ci];for(let i=0;i<t.length;i++){let o=t[i];Nc(o)}}}function Hv(n,e,t){Te(18);let i=Ht(e,n);Vg(i,t),Te(19,i[Qe])}function Vg(n,e){Fs(n)&&yd(n,e)}function yd(n,e){let i=n[Y],o=n[X],r=n[At],s=!!(e===0&&o&16);if(s||=!!(o&64&&e===0),s||=!!(o&1024),s||=!!(r?.dirty&&Lo(r)),s||=!1,r&&(r.dirty=!1),n[X]&=-9217,s)$v(i,n,i.template,n[Qe]);else if(o&8192){let a=J(null);try{kg(n),Fg(n,1);let u=i.components;u!==null&&Lg(n,u,1),Og(n)}finally{J(a)}}}function Lg(n,e,t){for(let i=0;i<e.length;i++)Hv(n,e[i],t)}function Uv(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let i=0;i<t.length;i++){let o=t[i];if(o<0)Qn(~o);else{let r=o,s=t[++i],a=t[++i];Qf(s,r);let u=e[r];Te(24,u),a(2,u),Te(25,u)}}}finally{Qn(-1)}}function du(n,e){let t=Bc()?64:1088;for(n[Dn].changeDetectionScheduler?.notify(e);n;){n[X]|=t;let i=zn(n);if(ro(n)&&!i)return n;n=i}return null}function jg(n,e,t,i){return[n,!0,0,e,null,i,null,t,null,null]}function zg(n,e){let t=Be+e;if(t<n.length)return n[t]}function Sa(n,e,t,i=!0){let o=e[Y];if(qv(o,e,n,t),i){let s=vd(t,n),a=e[Oe],u=a.parentNode(n[Un]);u!==null&&ov(o,n[$t],a,e,u,s)}let r=e[no];r!==null&&r.firstChild!==null&&(r.firstChild=null)}function $g(n,e){let t=ar(n,e);return t!==void 0&&ya(t[Y],t),t}function ar(n,e){if(n.length<=Be)return;let t=Be+e,i=n[t];if(i){let o=i[Hn];o!==null&&o!==n&&ou(o,i),e>0&&(n[t-1][zt]=i[zt]);let r=Wo(n,Be+e);iv(i[Y],i);let s=r[pn];s!==null&&s.detachView(r[Y]),i[it]=null,i[zt]=null,i[X]&=-129}return i}function qv(n,e,t,i){let o=Be+i,r=t.length;i>0&&(t[o-1][zt]=e),i<r-Be?(e[zt]=t[o],vc(t,Be+i,e)):(t.push(e),e[zt]=null),e[it]=t;let s=e[Hn];s!==null&&t!==s&&Bg(s,e);let a=e[pn];a!==null&&a.insertView(n),Vs(e),e[X]|=128}function Bg(n,e){let t=n[Ci],i=e[it];if(fn(i))n[X]|=2;else{let o=i[it][Ot];e[Ot]!==o&&(n[X]|=2)}t===null?n[Ci]=[e]:t.push(e)}var Yn=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let e=this._lView,t=e[Y];return sr(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t}get context(){return this._lView[Qe]}set context(e){this._lView[Qe]=e}get destroyed(){return vi(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[it];if(Kt(e)){let t=e[Ko],i=t?t.indexOf(this):-1;i>-1&&(ar(e,i),Wo(t,i))}this._attachedToViewContainer=!1}ya(this._lView[Y],this._lView)}onDestroy(e){kc(this._lView,e)}markForCheck(){du(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[X]&=-129}reattach(){Vs(this._lView),this._lView[X]|=128}detectChanges(){this._lView[X]|=1024,Rg(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ne(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=ro(this._lView),t=this._lView[Hn];t!==null&&!e&&ou(t,this._lView),xg(this._lView[Y],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ne(902,!1);this._appRef=e;let t=ro(this._lView),i=this._lView[Hn];i!==null&&!t&&Bg(i,this._lView),Vs(this._lView)}};var go=(()=>{class n{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=Wv;constructor(t,i,o){this._declarationLView=t,this._declarationTContainer=i,this.elementRef=o}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,i){return this.createEmbeddedViewImpl(t,i)}createEmbeddedViewImpl(t,i,o){let r=xa(this._declarationLView,this._declarationTContainer,t,{embeddedViewInjector:i,dehydratedView:o});return new Yn(r)}}return n})();function Wv(){return uu(dt(),Z())}function uu(n,e){return n.type&4?new go(e,n,Co(n,e)):null}function wa(n,e,t,i,o){let r=n.data[e];if(r===null)r=Gv(n,e,t,i,o),Gf()&&(r.flags|=32);else if(r.type&64){r.type=t,r.value=i,r.attrs=o;let s=Uf();r.injectorIndex=s===null?-1:s.injectorIndex}return so(r,!0),r}function Gv(n,e,t,i,o){let r=zc(),s=$c(),a=s?r:r&&r.parent,u=n.data[e]=Yv(n,a,t,e,i,o);return Qv(n,u,r,s),u}function Qv(n,e,t,i){n.firstChild===null&&(n.firstChild=e),t!==null&&(i?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function Yv(n,e,t,i,o,r){let s=e?e.injectorIndex:-1,a=0;return Hf()&&(a|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:o,attrs:r,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var AA=new RegExp(`^(\\d+)*(${wC}|${SC})*(.*)`);function Kv(n){let e=n[Tc]??[],i=n[it][Oe],o=[];for(let r of e)r.data[tg]!==void 0?o.push(r):Zv(r,i);n[Tc]=o}function Zv(n,e){let t=0,i=n.firstChild;if(i){let o=n.data[eg];for(;t<o;){let r=i.nextSibling;cg(e,i,!1),i=r,t++}}}var Jv=()=>null,Xv=()=>null;function bd(n,e){return Jv(n,e)}function Hg(n,e,t){return Xv(n,e,t)}var Ug=class{},Ea=class{},xd=class{resolveComponentFactory(e){throw new ne(917,!1)}},Ma=class{static NULL=new xd},Mi=class{},Pi=(()=>{class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>ey()}return n})();function ey(){let n=Z(),e=dt(),t=Ht(e.index,n);return(fn(t)?t:n)[Oe]}var qg=(()=>{class n{static \u0275prov=oe({token:n,providedIn:"root",factory:()=>null})}return n})();var Zs={},Sd=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){let o=this.injector.get(e,Zs,i);return o!==Zs||t===Zs?o:this.parentInjector.get(e,t,i)}};function ca(n,e,t){let i=t?n.styles:null,o=t?n.classes:null,r=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")r=a;else if(r==1)o=Ms(o,a);else if(r==2){let u=a,f=e[++s];i=Ms(i,u+": "+f+";")}}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=o:n.classesWithoutHost=o}function Ee(n,e=0){let t=Z();if(t===null)return De(n,e);let i=dt();return qm(i,t,ct(n),e)}function ty(n,e,t,i,o){let r=i===null?null:{"":-1},s=o(n,t);if(s!==null){let a=s,u=null,f=null;for(let g of s)if(g.resolveHostDirectives!==null){[a,u,f]=g.resolveHostDirectives(s);break}oy(n,e,t,a,r,u,f)}r!==null&&i!==null&&ny(t,i,r)}function ny(n,e,t){let i=n.localNames=[];for(let o=0;o<e.length;o+=2){let r=t[e[o+1]];if(r==null)throw new ne(-301,!1);i.push(e[o],r)}}function iy(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function oy(n,e,t,i,o,r,s){let a=i.length,u=!1;for(let b=0;b<a;b++){let C=i[b];!u&&mn(C)&&(u=!0,iy(n,t,b)),dd(ia(t,e),n,C.type)}dy(t,n.data.length,a);for(let b=0;b<a;b++){let C=i[b];C.providersResolver&&C.providersResolver(C)}let f=!1,g=!1,h=fg(n,e,a,null);a>0&&(t.directiveToIndex=new Map);for(let b=0;b<a;b++){let C=i[b];if(t.mergedAttrs=fo(t.mergedAttrs,C.hostAttrs),sy(n,t,e,h,C),cy(h,C,o),s!==null&&s.has(C)){let[F,U]=s.get(C);t.directiveToIndex.set(C.type,[h,F+t.directiveStart,U+t.directiveStart])}else(r===null||!r.has(C))&&t.directiveToIndex.set(C.type,h);C.contentQueries!==null&&(t.flags|=4),(C.hostBindings!==null||C.hostAttrs!==null||C.hostVars!==0)&&(t.flags|=64);let T=C.type.prototype;!f&&(T.ngOnChanges||T.ngOnInit||T.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),f=!0),!g&&(T.ngOnChanges||T.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),g=!0),h++}ry(n,t,r)}function ry(n,e,t){for(let i=e.directiveStart;i<e.directiveEnd;i++){let o=n.data[i];if(t===null||!t.has(o))ym(0,e,o,i),ym(1,e,o,i),xm(e,i,!1);else{let r=t.get(o);bm(0,e,r,i),bm(1,e,r,i),xm(e,i,!0)}}}function ym(n,e,t,i){let o=n===0?t.inputs:t.outputs;for(let r in o)if(o.hasOwnProperty(r)){let s;n===0?s=e.inputs??={}:s=e.outputs??={},s[r]??=[],s[r].push(i),Wg(e,r)}}function bm(n,e,t,i){let o=n===0?t.inputs:t.outputs;for(let r in o)if(o.hasOwnProperty(r)){let s=o[r],a;n===0?a=e.hostDirectiveInputs??={}:a=e.hostDirectiveOutputs??={},a[s]??=[],a[s].push(i,r),Wg(e,s)}}function Wg(n,e){e==="class"?n.flags|=8:e==="style"&&(n.flags|=16)}function xm(n,e,t){let{attrs:i,inputs:o,hostDirectiveInputs:r}=n;if(i===null||!t&&o===null||t&&r===null||Yd(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let s=null,a=0;for(;a<i.length;){let u=i[a];if(u===0){a+=4;continue}else if(u===5){a+=2;continue}else if(typeof u=="number")break;if(!t&&o.hasOwnProperty(u)){let f=o[u];for(let g of f)if(g===e){s??=[],s.push(u,i[a+1]);break}}else if(t&&r.hasOwnProperty(u)){let f=r[u];for(let g=0;g<f.length;g+=2)if(f[g]===e){s??=[],s.push(f[g+1],i[a+1]);break}}a+=2}n.initialInputs??=[],n.initialInputs.push(s)}function sy(n,e,t,i,o){n.data[i]=o;let r=o.factory||(o.factory=jn(o.type,!0)),s=new wi(r,mn(o),Ee,null);n.blueprint[i]=s,t[i]=s,ay(n,e,i,fg(n,t,o.hostVars,He),o)}function ay(n,e,t,i,o){let r=o.hostBindings;if(r){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let a=~e.index;ly(s)!=a&&s.push(a),s.push(t,i,r)}}function ly(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function cy(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;mn(e)&&(t[""]=n)}}function dy(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function Gg(n,e,t,i,o,r,s,a){let u=e[Y],f=u.consts,g=gn(f,s),h=wa(u,n,t,i,g);return r&&ty(u,e,h,gn(f,a),o),h.mergedAttrs=fo(h.mergedAttrs,h.attrs),h.attrs!==null&&ca(h,h.attrs,!1),h.mergedAttrs!==null&&ca(h,h.mergedAttrs,!0),u.queries!==null&&u.queries.elementStart(u,h),h}function Qg(n,e){tC(n,e),Ic(e)&&n.queries.elementEnd(e)}function uy(n,e,t,i,o,r){let s=e.consts,a=gn(s,o),u=wa(e,n,t,i,a);if(u.mergedAttrs=fo(u.mergedAttrs,u.attrs),r!=null){let f=gn(s,r);u.localNames=[];for(let g=0;g<f.length;g+=2)u.localNames.push(f[g],-1)}return u.attrs!==null&&ca(u,u.attrs,!1),u.mergedAttrs!==null&&ca(u,u.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,u),u}function pu(n,e,t){return n[e]=t}function It(n,e,t){if(t===He)return!1;let i=n[e];return Object.is(i,t)?!1:(n[e]=t,!0)}function ho(n,e,t,i){let o=It(n,e,t);return It(n,e+1,i)||o}function Yg(n,e,t,i,o){let r=ho(n,e,t,i);return It(n,e+2,o)||r}function Kg(n,e,t,i,o,r){let s=ho(n,e,t,i);return ho(n,e+2,o,r)||s}function Js(n,e,t){return function i(o){let r=qn(n)?Ht(n.index,e):e;du(r,5);let s=e[Qe],a=Sm(e,s,t,o),u=i.__ngNextListenerFn__;for(;u;)a=Sm(e,s,u,o)&&a,u=u.__ngNextListenerFn__;return a}}function Sm(n,e,t,i){let o=J(null);try{return Te(6,e,t),t(i)!==!1}catch(r){return Iv(n,r),!1}finally{Te(7,e,t),J(o)}}function Zg(n,e,t,i,o,r,s,a){let u=Rs(n),f=!1,g=null;if(!i&&u&&(g=fy(e,t,r,n.index)),g!==null){let h=g.__ngLastListenerFn__||g;h.__ngNextListenerFn__=s,g.__ngLastListenerFn__=s,f=!0}else{let h=Zt(n,t),b=i?i(h):h;MC(t,b,r,a);let C=o.listen(b,r,a);if(!py(r)){let T=i?F=>i(Bt(F[n.index])):n.index;Jg(T,e,t,r,a,C,!1)}}return f}function py(n){return n.startsWith("animation")||n.startsWith("transition")}function fy(n,e,t,i){let o=n.cleanup;if(o!=null)for(let r=0;r<o.length-1;r+=2){let s=o[r];if(s===t&&o[r+1]===i){let a=e[io],u=o[r+2];return a&&a.length>u?a[u]:null}typeof s=="string"&&(r+=2)}return null}function Jg(n,e,t,i,o,r,s){let a=e.firstCreatePass?Fc(e):null,u=Rc(t),f=u.length;u.push(o,r),a&&a.push(i,n,f,(f+1)*(s?-1:1))}function wm(n,e,t,i,o,r){let s=e[t],a=e[Y],f=a.data[t].outputs[i],h=s[f].subscribe(r);Jg(n.index,a,e,o,r,h,!0)}var wd=Symbol("BINDING");var Ed=class extends Ma{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=fi(e);return new lr(t,this.ngModule)}};function my(n){return Object.keys(n).map(e=>{let[t,i,o]=n[e],r={propName:t,templateName:e,isSignal:(i&Ca.SignalBased)!==0};return o&&(r.transform=o),r})}function gy(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}function hy(n,e,t){let i=e instanceof Lt?e:e?.injector;return i&&n.getStandaloneInjector!==null&&(i=n.getStandaloneInjector(i)||i),i?new Sd(t,i):t}function _y(n){let e=n.get(Mi,null);if(e===null)throw new ne(407,!1);let t=n.get(qg,null),i=n.get(un,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:i,ngReflect:!1}}function Cy(n,e){let t=Xg(n);return ag(e,t,t==="svg"?Nf:t==="math"?kf:null)}function Xg(n){return(n.selectors[0][0]||"div").toLowerCase()}var lr=class extends Ea{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=my(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=gy(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=$C(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,i,o,r,s){Te(22);let a=J(null);try{let u=this.componentDef,f=vy(i,u,s,r),g=hy(u,o||this.ngModule,e),h=_y(g),b=h.rendererFactory.createRenderer(null,u),C=i?_v(b,i,u.encapsulation,g):Cy(u,b),T=s?.some(Em)||r?.some(K=>typeof K!="function"&&K.bindings.some(Em)),F=Zd(null,f,null,512|pg(u),null,null,h,b,g,null,og(C,g,!0));F[$e]=C,$s(F);let U=null;try{let K=Gg($e,F,2,"#host",()=>f.directiveRegistry,!0,0);dg(b,C,K),mo(C,F),Eg(f,F,K),sg(f,K,F),Qg(f,K),t!==void 0&&by(K,this.ngContentSelectors,t),U=Ht(K.index,F),F[Qe]=U[Qe],cu(f,F,null)}catch(K){throw U!==null&&pd(U),pd(F),K}finally{Te(23),Bs()}return new da(this.componentType,F,!!T)}finally{J(a)}}};function vy(n,e,t,i){let o=n?["ng-version","20.3.16"]:BC(e.selectors[0]),r=null,s=null,a=0;if(t)for(let g of t)a+=g[wd].requiredVars,g.create&&(g.targetIdx=0,(r??=[]).push(g)),g.update&&(g.targetIdx=0,(s??=[]).push(g));if(i)for(let g=0;g<i.length;g++){let h=i[g];if(typeof h!="function")for(let b of h.bindings){a+=b[wd].requiredVars;let C=g+1;b.create&&(b.targetIdx=C,(r??=[]).push(b)),b.update&&(b.targetIdx=C,(s??=[]).push(b))}}let u=[e];if(i)for(let g of i){let h=typeof g=="function"?g:g.type,b=xc(h);u.push(b)}return Kd(0,null,yy(r,s),1,a,u,null,null,null,[o],null)}function yy(n,e){return!n&&!e?null:t=>{if(t&1&&n)for(let i of n)i.create();if(t&2&&e)for(let i of e)i.update()}}function Em(n){let e=n[wd].kind;return e==="input"||e==="twoWay"}var da=class extends Ug{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t,i){super(),this._rootLView=t,this._hasInputBindings=i,this._tNode=Zo(t[Y],$e),this.location=Co(this._tNode,t),this.instance=Ht(this._tNode.index,t)[Qe],this.hostView=this.changeDetectorRef=new Yn(t,void 0),this.componentType=e}setInput(e,t){this._hasInputBindings;let i=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let o=this._rootLView,r=lu(i,o[Y],o,e,t);this.previousInputValues.set(e,t);let s=Ht(i.index,o);du(s,1)}get injector(){return new Si(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function by(n,e,t){let i=n.projection=[];for(let o=0;o<e.length;o++){let r=t[o];i.push(r!=null&&r.length?Array.from(r):null)}}var mr=(()=>{class n{static __NG_ELEMENT_ID__=xy}return n})();function xy(){let n=dt();return th(n,Z())}var Sy=mr,eh=class extends Sy{_lContainer;_hostTNode;_hostLView;constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return Co(this._hostTNode,this._hostLView)}get injector(){return new Si(this._hostTNode,this._hostLView)}get parentInjector(){let e=Hd(this._hostTNode,this._hostLView);if(jm(e)){let t=ta(e,this._hostLView),i=ea(e),o=t[Y].data[i+8];return new Si(o,t)}else return new Si(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=Mm(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-Be}createEmbeddedView(e,t,i){let o,r;typeof i=="number"?o=i:i!=null&&(o=i.index,r=i.injector);let s=bd(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},r,s);return this.insertImpl(a,o,rr(this._hostTNode,s)),a}createComponent(e,t,i,o,r,s,a){let u=e&&!K_(e),f;if(u)f=t;else{let U=t||{};f=U.index,i=U.injector,o=U.projectableNodes,r=U.environmentInjector||U.ngModuleRef,s=U.directives,a=U.bindings}let g=u?e:new lr(fi(e)),h=i||this.parentInjector;if(!r&&g.ngModule==null){let K=(u?h:this.parentInjector).get(Lt,null);K&&(r=K)}let b=fi(g.componentType??{}),C=bd(this._lContainer,b?.id??null),T=C?.firstChild??null,F=g.create(h,o,T,r,s,a);return this.insertImpl(F.hostView,f,rr(this._hostTNode,C)),F}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,i){let o=e._lView;if(Ff(o)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let u=o[it],f=new eh(u,u[$t],u[it]);f.detach(f.indexOf(e))}}let r=this._adjustIndex(t),s=this._lContainer;return Sa(s,o,r,i),e.attachToViewContainerRef(),vc(td(s),r,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=Mm(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),i=ar(this._lContainer,t);i&&(Wo(td(this._lContainer),t),ya(i[Y],i))}detach(e){let t=this._adjustIndex(e,-1),i=ar(this._lContainer,t);return i&&Wo(td(this._lContainer),t)!=null?new Yn(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function Mm(n){return n[Ko]}function td(n){return n[Ko]||(n[Ko]=[])}function th(n,e){let t,i=e[n.index];return Kt(i)?t=i:(t=jg(i,e,null,n),e[n.index]=t,Jd(e,t)),Ey(t,e,n,i),new eh(t,n,e)}function wy(n,e){let t=n[Oe],i=t.createComment(""),o=Zt(e,n),r=t.parentNode(o);return ra(t,r,i,t.nextSibling(o),!1),i}var Ey=Ty,My=()=>!1;function Dy(n,e,t){return My(n,e,t)}function Ty(n,e,t,i){if(n[Un])return;let o;t.type&8?o=Bt(i):o=wy(e,t),n[Un]=o}var Md=class n{queryList;matches=null;constructor(e){this.queryList=e}clone(){return new n(this.queryList)}setDirty(){this.queryList.setDirty()}},Dd=class n{queries;constructor(e=[]){this.queries=e}createEmbeddedView(e){let t=e.queries;if(t!==null){let i=e.contentQueries!==null?e.contentQueries[0]:t.length,o=[];for(let r=0;r<i;r++){let s=t.getByIndex(r),a=this.queries[s.indexInDeclarationView];o.push(a.clone())}return new n(o)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)fu(e,t).matches!==null&&this.queries[t].setDirty()}},Td=class{flags;read;predicate;constructor(e,t,i=null){this.flags=t,this.read=i,typeof e=="string"?this.predicate=Fy(e):this.predicate=e}},Id=class n{queries;constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){let o=t!==null?t.length:0,r=this.getByIndex(i).embeddedTView(e,o);r&&(r.indexInDeclarationView=i,t!==null?t.push(r):t=[r])}return t!==null?new n(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},Pd=class n{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(e,t=-1){this.metadata=e,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new n(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,i=e.parent;for(;i!==null&&i.type&8&&i.index!==t;)i=i.parent;return t===(i!==null?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){let i=this.metadata.predicate;if(Array.isArray(i))for(let o=0;o<i.length;o++){let r=i[o];this.matchTNodeWithReadOption(e,t,Iy(t,r)),this.matchTNodeWithReadOption(e,t,Ks(t,e,r,!1,!1))}else i===go?t.type&4&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Ks(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(i!==null){let o=this.metadata.read;if(o!==null)if(o===Nt||o===mr||o===go&&t.type&4)this.addMatch(t.index,-2);else{let r=Ks(t,e,o,!1,!1);r!==null&&this.addMatch(t.index,r)}else this.addMatch(t.index,i)}}addMatch(e,t){this.matches===null?this.matches=[e,t]:this.matches.push(e,t)}};function Iy(n,e){let t=n.localNames;if(t!==null){for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1]}return null}function Py(n,e){return n.type&11?Co(n,e):n.type&4?uu(n,e):null}function Oy(n,e,t,i){return t===-1?Py(e,n):t===-2?Ay(n,e,i):or(n,n[Y],t,e)}function Ay(n,e,t){if(t===Nt)return Co(e,n);if(t===go)return uu(e,n);if(t===mr)return th(e,n)}function nh(n,e,t,i){let o=e[pn].queries[i];if(o.matches===null){let r=n.data,s=t.matches,a=[];for(let u=0;s!==null&&u<s.length;u+=2){let f=s[u];if(f<0)a.push(null);else{let g=r[f];a.push(Oy(e,g,s[u+1],t.metadata.read))}}o.matches=a}return o.matches}function Od(n,e,t,i){let o=n.queries.getByIndex(t),r=o.matches;if(r!==null){let s=nh(n,e,o,t);for(let a=0;a<r.length;a+=2){let u=r[a];if(u>0)i.push(s[a/2]);else{let f=r[a+1],g=e[-u];for(let h=Be;h<g.length;h++){let b=g[h];b[Hn]===b[it]&&Od(b[Y],b,f,i)}if(g[Ci]!==null){let h=g[Ci];for(let b=0;b<h.length;b++){let C=h[b];Od(C[Y],C,f,i)}}}}}return i}function Ny(n,e){return n[pn].queries[e].queryList}function ky(n,e,t){let i=new oa((t&4)===4);return jf(n,e,i,i.destroy),(e[pn]??=new Dd).queries.push(new Md(i))-1}function Ry(n,e,t){let i=Ye();return i.firstCreatePass&&(Vy(i,new Td(n,e,t),-1),(e&2)===2&&(i.staticViewQueries=!0)),ky(i,Z(),e)}function Fy(n){return n.split(",").map(e=>e.trim())}function Vy(n,e,t){n.queries===null&&(n.queries=new Id),n.queries.track(new Pd(e,t))}function fu(n,e){return n.queries.getByIndex(e)}function Ly(n,e){let t=n[Y],i=fu(t,e);return i.crossesNgTemplate?Od(t,n,e,[]):nh(t,n,i,e)}var cr=class{};var dr=class extends cr{injector;componentFactoryResolver=new Ed(this);instance=null;constructor(e){super();let t=new ci([...e.providers,{provide:cr,useValue:this},{provide:Ma,useValue:this.componentFactoryResolver}],e.parent||Qo(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function ih(n,e,t=null){return new dr({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var jy=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let i=Sc(!1,t.type),o=i.length>0?ih([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,o)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=oe({token:n,providedIn:"environment",factory:()=>new n(De(Lt))})}return n})();function ee(n){return pr(()=>{let e=oh(n),t=O(E({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===Ud.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?o=>o.get(jy).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||On.Emulated,styles:n.styles||St,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&Ii("NgStandalone"),rh(t);let i=n.dependencies;return t.directiveDefs=Dm(i,zy),t.pipeDefs=Dm(i,Mf),t.id=Hy(t),t})}function zy(n){return fi(n)||xc(n)}function Oi(n){return pr(()=>({type:n.type,bootstrap:n.bootstrap||St,declarations:n.declarations||St,imports:n.imports||St,exports:n.exports||St,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function $y(n,e){if(n==null)return Bn;let t={};for(let i in n)if(n.hasOwnProperty(i)){let o=n[i],r,s,a,u;Array.isArray(o)?(a=o[0],r=o[1],s=o[2]??r,u=o[3]||null):(r=o,s=o,a=Ca.None,u=null),t[r]=[i,a,u],e[r]=s}return t}function By(n){if(n==null)return Bn;let e={};for(let t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function ut(n){return pr(()=>{let e=oh(n);return rh(e),e})}function gr(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function oh(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||Bn,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||St,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:$y(n.inputs,e),outputs:By(n.outputs),debugInfo:null}}function rh(n){n.features?.forEach(e=>e(n))}function Dm(n,e){return n?()=>{let t=typeof n=="function"?n():n,i=[];for(let o of t){let r=e(o);r!==null&&i.push(r)}return i}:null}function Hy(n){let e=0,t=typeof n.consts=="function"?"":n.consts,i=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let r of i.join("|"))e=Math.imul(31,e)+r.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function Uy(n){return Object.getPrototypeOf(n.prototype).constructor}function kt(n){let e=Uy(n.type),t=!0,i=[n];for(;e;){let o;if(mn(n))o=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new ne(903,!1);o=e.\u0275dir}if(o){if(t){i.push(o);let s=n;s.inputs=nd(n.inputs),s.declaredInputs=nd(n.declaredInputs),s.outputs=nd(n.outputs);let a=o.hostBindings;a&&Yy(n,a);let u=o.viewQuery,f=o.contentQueries;if(u&&Gy(n,u),f&&Qy(n,f),qy(n,o),Cf(n.outputs,o.outputs),mn(o)&&o.data.animation){let g=n.data;g.animation=(g.animation||[]).concat(o.data.animation)}}let r=o.features;if(r)for(let s=0;s<r.length;s++){let a=r[s];a&&a.ngInherit&&a(n),a===kt&&(t=!1)}}e=Object.getPrototypeOf(e)}Wy(i)}function qy(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let i=e.inputs[t];i!==void 0&&(n.inputs[t]=i,n.declaredInputs[t]=e.declaredInputs[t])}}function Wy(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){let o=n[i];o.hostVars=e+=o.hostVars,o.hostAttrs=fo(o.hostAttrs,t=fo(t,o.hostAttrs))}}function nd(n){return n===Bn?{}:n===St?[]:n}function Gy(n,e){let t=n.viewQuery;t?n.viewQuery=(i,o)=>{e(i,o),t(i,o)}:n.viewQuery=e}function Qy(n,e){let t=n.contentQueries;t?n.contentQueries=(i,o,r)=>{e(i,o,r),t(i,o,r)}:n.contentQueries=e}function Yy(n,e){let t=n.hostBindings;t?n.hostBindings=(i,o)=>{e(i,o),t(i,o)}:n.hostBindings=e}function Ky(n,e,t,i,o,r,s,a){if(t.firstCreatePass){n.mergedAttrs=fo(n.mergedAttrs,n.attrs);let g=n.tView=Kd(2,n,o,r,s,t.directiveRegistry,t.pipeRegistry,null,t.schemas,t.consts,null);t.queries!==null&&(t.queries.template(t,n),g.queries=t.queries.embeddedTView(n))}a&&(n.flags|=a),so(n,!1);let u=Zy(t,e,n,i);Hs()&&ru(t,e,u,n),mo(u,e);let f=jg(u,e,u,n);e[i+$e]=f,Jd(e,f),Dy(f,n,e)}function ua(n,e,t,i,o,r,s,a,u,f,g){let h=t+$e,b;if(e.firstCreatePass){if(b=wa(e,h,4,s||null,a||null),f!=null){let C=gn(e.consts,f);b.localNames=[];for(let T=0;T<C.length;T+=2)b.localNames.push(C[T],-1)}}else b=e.data[h];return Ky(b,n,e,t,i,o,r,u),f!=null&&au(n,b,g),b}var Zy=Jy;function Jy(n,e,t,i){return Us(!0),e[Oe].createComment("")}var mu=new le("");function vo(n){return!!n&&typeof n.then=="function"}function gu(n){return!!n&&typeof n.subscribe=="function"}var sh=new le("");var hu=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i});appInits=q(sh,{optional:!0})??[];injector=q(Qt);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let o of this.appInits){let r=Ns(this.injector,o);if(vo(r))t.push(r);else if(gu(r)){let s=new Promise((a,u)=>{r.subscribe({complete:a,error:u})});t.push(s)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(o=>{this.reject(o)}),t.length===0&&i(),this.initialized=!0}static \u0275fac=function(i){return new(i||n)};static \u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),ah=new le("");function lh(){Hl(()=>{let n="";throw new ne(600,n)})}function ch(n){return n.isBoundToModule}var Xy=10;var Ai=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=q(Pn);afterRenderManager=q(nu);zonelessEnabled=q(qs);rootEffectScheduler=q(tr);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new cn;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=q(bi);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(ri(t=>!t))}constructor(){q(Ti,{optional:!0})}whenStable(){let t;return new Promise(i=>{t=this.isStable.subscribe({next:o=>{o&&i()}})}).finally(()=>{t.unsubscribe()})}_injector=q(Lt);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,i){return this.bootstrapImpl(t,i)}bootstrapImpl(t,i,o=Qt.NULL){return this._injector.get(Je).run(()=>{Te(10);let s=t instanceof Ea;if(!this._injector.get(hu).done){let T="";throw new ne(405,T)}let u;s?u=t:u=this._injector.get(Ma).resolveComponentFactory(t),this.componentTypes.push(u.componentType);let f=ch(u)?void 0:this._injector.get(cr),g=i||u.selector,h=u.create(o,[],g,f),b=h.location.nativeElement,C=h.injector.get(mu,null);return C?.registerApplication(b),h.onDestroy(()=>{this.detachView(h.hostView),ir(this.components,h),C?.unregisterApplication(b)}),this._loadComponent(h),Te(11,h),h})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){Te(12),this.tracingSnapshot!==null?this.tracingSnapshot.run(va.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new ne(101,!1);let t=J(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,J(t),this.afterTick.next(),Te(13)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Mi,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<Xy;)Te(14),this.synchronizeOnce(),Te(15)}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let t=!1;if(this.dirtyFlags&7){let i=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:o}of this.allViews){if(!i&&!Xo(o))continue;let r=i&&!this.zonelessEnabled?0:1;Rg(o,r),t=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}t||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>Xo(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){let i=t;ir(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView);try{this.tick()}catch(o){this.internalErrorHandler(o)}this.components.push(t),this._injector.get(ah,[]).forEach(o=>o(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>ir(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new ne(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(i){return new(i||n)};static \u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function ir(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Cn(n,e,t,i){let o=Z(),r=Gn();if(It(o,r,e)){let s=Ye(),a=er();Mv(a,o,n,e,t,i)}return Cn}var LA=typeof document<"u"&&typeof document?.documentElement?.getAnimations=="function";var Ad=class{destroy(e){}updateValue(e,t){}swap(e,t){let i=Math.min(e,t),o=Math.max(e,t),r=this.detach(o);if(o-i>1){let s=this.detach(i);this.attach(i,r),this.attach(o,s)}else this.attach(i,r)}move(e,t){this.attach(t,this.detach(e))}};function id(n,e,t,i,o){return n===t&&Object.is(e,i)?1:Object.is(o(n,e),o(t,i))?-1:0}function eb(n,e,t){let i,o,r=0,s=n.length-1,a=void 0;if(Array.isArray(e)){let u=e.length-1;for(;r<=s&&r<=u;){let f=n.at(r),g=e[r],h=id(r,f,r,g,t);if(h!==0){h<0&&n.updateValue(r,g),r++;continue}let b=n.at(s),C=e[u],T=id(s,b,u,C,t);if(T!==0){T<0&&n.updateValue(s,C),s--,u--;continue}let F=t(r,f),U=t(s,b),K=t(r,g);if(Object.is(K,U)){let We=t(u,C);Object.is(We,F)?(n.swap(r,s),n.updateValue(s,C),u--,s--):n.move(s,r),n.updateValue(r,g),r++;continue}if(i??=new pa,o??=Im(n,r,s,t),Nd(n,i,r,K))n.updateValue(r,g),r++,s++;else if(o.has(K))i.set(F,n.detach(r)),s--;else{let We=n.create(r,e[r]);n.attach(r,We),r++,s++}}for(;r<=u;)Tm(n,i,t,r,e[r]),r++}else if(e!=null){let u=e[Symbol.iterator](),f=u.next();for(;!f.done&&r<=s;){let g=n.at(r),h=f.value,b=id(r,g,r,h,t);if(b!==0)b<0&&n.updateValue(r,h),r++,f=u.next();else{i??=new pa,o??=Im(n,r,s,t);let C=t(r,h);if(Nd(n,i,r,C))n.updateValue(r,h),r++,s++,f=u.next();else if(!o.has(C))n.attach(r,n.create(r,h)),r++,s++,f=u.next();else{let T=t(r,g);i.set(T,n.detach(r)),s--}}}for(;!f.done;)Tm(n,i,t,n.length,f.value),f=u.next()}for(;r<=s;)n.destroy(n.detach(s--));i?.forEach(u=>{n.destroy(u)})}function Nd(n,e,t,i){return e!==void 0&&e.has(i)?(n.attach(t,e.get(i)),e.delete(i),!0):!1}function Tm(n,e,t,i,o){if(Nd(n,e,i,t(i,o)))n.updateValue(i,o);else{let r=n.create(i,o);n.attach(i,r)}}function Im(n,e,t,i){let o=new Set;for(let r=e;r<=t;r++)o.add(i(r,n.at(r)));return o}var pa=class{kvMap=new Map;_vMap=void 0;has(e){return this.kvMap.has(e)}delete(e){if(!this.has(e))return!1;let t=this.kvMap.get(e);return this._vMap!==void 0&&this._vMap.has(t)?(this.kvMap.set(e,this._vMap.get(t)),this._vMap.delete(t)):this.kvMap.delete(e),!0}get(e){return this.kvMap.get(e)}set(e,t){if(this.kvMap.has(e)){let i=this.kvMap.get(e);this._vMap===void 0&&(this._vMap=new Map);let o=this._vMap;for(;o.has(i);)i=o.get(i);o.set(i,t)}else this.kvMap.set(e,t)}forEach(e){for(let[t,i]of this.kvMap)if(e(i,t),this._vMap!==void 0){let o=this._vMap;for(;o.has(i);)i=o.get(i),e(i,t)}}};function x(n,e,t,i,o,r,s,a){Ii("NgControlFlow");let u=Z(),f=Ye(),g=gn(f.consts,r);return ua(u,f,n,e,t,i,o,g,256,s,a),_u}function _u(n,e,t,i,o,r,s,a){Ii("NgControlFlow");let u=Z(),f=Ye(),g=gn(f.consts,r);return ua(u,f,n,e,t,i,o,g,512,s,a),_u}function S(n,e){Ii("NgControlFlow");let t=Z(),i=Gn(),o=t[i]!==He?t[i]:-1,r=o!==-1?fa(t,$e+o):void 0,s=0;if(It(t,i,n)){let a=J(null);try{if(r!==void 0&&$g(r,s),n!==-1){let u=$e+n,f=fa(t,u),g=Vd(t[Y],u),h=Hg(f,g,t),b=xa(t,g,e,{dehydratedView:h});Sa(f,b,s,rr(g,h))}}finally{J(a)}}else if(r!==void 0){let a=zg(r,s);a!==void 0&&(a[Qe]=e)}}var kd=class{lContainer;$implicit;$index;constructor(e,t,i){this.lContainer=e,this.$implicit=t,this.$index=i}get $count(){return this.lContainer.length-Be}};function Ve(n){return n}function Ut(n,e){return e}var Rd=class{hasEmptyBlock;trackByFn;liveCollection;constructor(e,t,i){this.hasEmptyBlock=e,this.trackByFn=t,this.liveCollection=i}};function z(n,e,t,i,o,r,s,a,u,f,g,h,b){Ii("NgControlFlow");let C=Z(),T=Ye(),F=u!==void 0,U=Z(),K=a?s.bind(U[Ot][Qe]):s,We=new Rd(F,K);U[$e+n]=We,ua(C,T,n+1,e,t,i,o,gn(T.consts,r),256),F&&ua(C,T,n+2,u,f,g,h,gn(T.consts,b),512)}var Fd=class extends Ad{lContainer;hostLView;templateTNode;operationsCounter=void 0;needsIndexUpdate=!1;constructor(e,t,i){super(),this.lContainer=e,this.hostLView=t,this.templateTNode=i}get length(){return this.lContainer.length-Be}at(e){return this.getLView(e)[Qe].$implicit}attach(e,t){let i=t[no];this.needsIndexUpdate||=e!==this.length,Sa(this.lContainer,t,e,rr(this.templateTNode,i)),tb(this.lContainer,e)}detach(e){return this.needsIndexUpdate||=e!==this.length-1,nb(this.lContainer,e),ib(this.lContainer,e)}create(e,t){let i=bd(this.lContainer,this.templateTNode.tView.ssrId),o=xa(this.hostLView,this.templateTNode,new kd(this.lContainer,t,e),{dehydratedView:i});return this.operationsCounter?.recordCreate(),o}destroy(e){ya(e[Y],e),this.operationsCounter?.recordDestroy()}updateValue(e,t){this.getLView(e)[Qe].$implicit=t}reset(){this.needsIndexUpdate=!1,this.operationsCounter?.reset()}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[Qe].$index=e}getLView(e){return ob(this.lContainer,e)}};function $(n){let e=J(null),t=Tt();try{let i=Z(),o=i[Y],r=i[t],s=t+1,a=fa(i,s);if(r.liveCollection===void 0){let f=Vd(o,s);r.liveCollection=new Fd(a,i,f)}else r.liveCollection.reset();let u=r.liveCollection;if(eb(u,n,r.trackByFn),u.updateIndexes(),r.hasEmptyBlock){let f=Gn(),g=u.length===0;if(It(i,f,g)){let h=t+2,b=fa(i,h);if(g){let C=Vd(o,h),T=Hg(b,C,i),F=xa(i,C,void 0,{dehydratedView:T});Sa(b,F,0,rr(C,T))}else o.firstUpdatePass&&Kv(b),$g(b,0)}}}finally{J(e)}}function fa(n,e){return n[e]}function tb(n,e){if(n.length<=Be)return;let t=Be+e,i=n[t],o=i?i[_i]:void 0;if(i&&o&&o.detachedLeaveAnimationFns&&o.detachedLeaveAnimationFns.length>0){let r=i[Mn];tv(r,o),Ei.delete(i),o.detachedLeaveAnimationFns=void 0}}function nb(n,e){if(n.length<=Be)return;let t=Be+e,i=n[t],o=i?i[_i]:void 0;o&&o.leave&&o.leave.size>0&&(o.detachedLeaveAnimationFns=[])}function ib(n,e){return ar(n,e)}function ob(n,e){return zg(n,e)}function Vd(n,e){return Zo(n,e)}function I(n,e,t){let i=Z(),o=Gn();if(It(i,o,e)){let r=Ye(),s=er();Mg(s,i,n,e,i[Oe],t)}return I}function Ld(n,e,t,i,o){lu(e,n,t,o?"class":"style",i)}function c(n,e,t,i){let o=Z(),r=o[Y],s=n+$e,a=r.firstCreatePass?Gg(s,o,2,e,Ev,Bf(),t,i):r.data[s];if(Tg(a,o,n,e,dh),Rs(a)){let u=o[Y];Eg(u,o,a),sg(u,a,o)}return i!=null&&au(o,a),c}function l(){let n=Ye(),e=dt(),t=Ig(e);return n.firstCreatePass&&Qg(n,t),Lc(t)&&jc(),Vc(),t.classesWithoutHost!=null&&iC(t)&&Ld(n,t,Z(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&oC(t)&&Ld(n,t,Z(),t.stylesWithoutHost,!1),l}function re(n,e,t,i){return c(n,e,t,i),l(),re}function L(n,e,t,i){let o=Z(),r=o[Y],s=n+$e,a=r.firstCreatePass?uy(s,r,2,e,t,i):r.data[s];return Tg(a,o,n,e,dh),i!=null&&au(o,a),L}function V(){let n=dt(),e=Ig(n);return Lc(e)&&jc(),Vc(),V}var dh=(n,e,t,i,o)=>(Us(!0),ag(e[Oe],i,tm()));function N(){return Z()}function Kn(n,e,t){let i=Z(),o=Gn();if(It(i,o,e)){let r=Ye(),s=er();Dg(s,i,n,e,i[Oe],t)}return Kn}var Ws=void 0;function rb(n){let e=Math.floor(Math.abs(n)),t=n.toString().replace(/^[^.]*\.?/,"").length;return e===1&&t===0?1:5}var sb=["en",[["a","p"],["AM","PM"]],[["AM","PM"]],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Ws,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Ws,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Ws,"{1} 'at' {0}",Ws],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",rb],od={};function Da(n){let e=ab(n),t=Pm(e);if(t)return t;let i=e.split("-")[0];if(t=Pm(i),t)return t;if(i==="en")return sb;throw new ne(701,!1)}function Pm(n){return n in od||(od[n]=di.ng&&di.ng.common&&di.ng.common.locales&&di.ng.common.locales[n]),od[n]}var Ni=(function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n})(Ni||{});function ab(n){return n.toLowerCase().replace(/_/g,"-")}var hr="en-US";var lb=hr;function uh(n){typeof n=="string"&&(lb=n.toLowerCase().replace(/_/g,"-"))}function _(n,e,t){let i=Z(),o=Ye(),r=dt();return ph(o,i,i[Oe],r,n,e,t),_}function qt(n,e,t){let i=Z(),o=Ye(),r=dt();return(r.type&3||t)&&Zg(r,o,i,t,i[Oe],n,e,Js(r,i,e)),qt}function ph(n,e,t,i,o,r,s){let a=!0,u=null;if((i.type&3||s)&&(u??=Js(i,e,r),Zg(i,n,e,s,t,o,r,u)&&(a=!1)),a){let f=i.outputs?.[o],g=i.hostDirectiveOutputs?.[o];if(g&&g.length)for(let h=0;h<g.length;h+=2){let b=g[h],C=g[h+1];u??=Js(i,e,r),wm(i,e,b,C,o,u)}if(f&&f.length)for(let h of f)u??=Js(i,e,r),wm(i,e,h,o,o,u)}}function m(n=1){return em(n)}function _r(n,e,t){Ry(n,e,t)}function Cr(n){let e=Z(),t=Ye(),i=Uc();zs(i+1);let o=fu(t,i);if(n.dirty&&Rf(e)===((o.metadata.flags&2)===2)){if(o.matches===null)n.reset([]);else{let r=Ly(e,i);n.reset(r,_C),n.notifyOnChanges()}return!0}return!1}function vr(){return Ny(Z(),Uc())}function Ta(n){let e=Wf();return Jo(e,$e+n)}function Gs(n,e){return n<<17|e<<2}function Di(n){return n>>17&32767}function cb(n){return(n&2)==2}function db(n,e){return n&131071|e<<17}function jd(n){return n|2}function _o(n){return(n&131068)>>2}function rd(n,e){return n&-131069|e<<2}function ub(n){return(n&1)===1}function zd(n){return n|1}function pb(n,e,t,i,o,r){let s=r?e.classBindings:e.styleBindings,a=Di(s),u=_o(s);n[i]=t;let f=!1,g;if(Array.isArray(t)){let h=t;g=h[1],(g===null||to(h,g)>0)&&(f=!0)}else g=t;if(o)if(u!==0){let b=Di(n[a+1]);n[i+1]=Gs(b,a),b!==0&&(n[b+1]=rd(n[b+1],i)),n[a+1]=db(n[a+1],i)}else n[i+1]=Gs(a,0),a!==0&&(n[a+1]=rd(n[a+1],i)),a=i;else n[i+1]=Gs(u,0),a===0?a=i:n[u+1]=rd(n[u+1],i),u=i;f&&(n[i+1]=jd(n[i+1])),Om(n,g,i,!0),Om(n,g,i,!1),fb(e,g,n,i,r),s=Gs(a,u),r?e.classBindings=s:e.styleBindings=s}function fb(n,e,t,i,o){let r=o?n.residualClasses:n.residualStyles;r!=null&&typeof e=="string"&&to(r,e)>=0&&(t[i+1]=zd(t[i+1]))}function Om(n,e,t,i){let o=n[t+1],r=e===null,s=i?Di(o):_o(o),a=!1;for(;s!==0&&(a===!1||r);){let u=n[s],f=n[s+1];mb(u,e)&&(a=!0,n[s+1]=i?zd(f):jd(f)),s=i?Di(f):_o(f)}a&&(n[t+1]=i?jd(o):zd(o))}function mb(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?to(n,e)>=0:!1}var en={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function gb(n){return n.substring(en.key,en.keyEnd)}function hb(n){return _b(n),fh(n,mh(n,0,en.textEnd))}function fh(n,e){let t=en.textEnd;return t===e?-1:(e=en.keyEnd=Cb(n,en.key=e,t),mh(n,e,t))}function _b(n){en.key=0,en.keyEnd=0,en.value=0,en.valueEnd=0,en.textEnd=n.length}function mh(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function Cb(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}function vn(n,e,t){return gh(n,e,t,!1),vn}function B(n,e){return gh(n,e,null,!0),B}function Wt(n){yb(Mb,vb,n,!0)}function vb(n,e){for(let t=hb(e);t>=0;t=fh(e,t))Os(n,gb(e),!0)}function gh(n,e,t,i){let o=Z(),r=Ye(),s=yi(2);if(r.firstUpdatePass&&_h(r,n,s,i),e!==He&&It(o,s,e)){let a=r.data[Tt()];Ch(r,a,o,o[Oe],n,o[s+1]=Tb(e,t),i,s)}}function yb(n,e,t,i){let o=Ye(),r=yi(2);o.firstUpdatePass&&_h(o,null,r,i);let s=Z();if(t!==He&&It(s,r,t)){let a=o.data[Tt()];if(vh(a,i)&&!hh(o,r)){let u=i?a.classesWithoutHost:a.stylesWithoutHost;u!==null&&(t=Ms(u,t||"")),Ld(o,a,s,t,i)}else Db(o,a,s,s[Oe],s[r+1],s[r+1]=Eb(n,e,t),i,r)}}function hh(n,e){return e>=n.expandoStartIndex}function _h(n,e,t,i){let o=n.data;if(o[t+1]===null){let r=o[Tt()],s=hh(n,t);vh(r,i)&&e===null&&!s&&(e=!1),e=bb(o,r,e,i),pb(o,r,e,t,s,i)}}function bb(n,e,t,i){let o=Kf(n),r=i?e.residualClasses:e.residualStyles;if(o===null)(i?e.classBindings:e.styleBindings)===0&&(t=sd(null,n,e,t,i),t=ur(t,e.attrs,i),r=null);else{let s=e.directiveStylingLast;if(s===-1||n[s]!==o)if(t=sd(o,n,e,t,i),r===null){let u=xb(n,e,i);u!==void 0&&Array.isArray(u)&&(u=sd(null,n,e,u[1],i),u=ur(u,e.attrs,i),Sb(n,e,i,u))}else r=wb(n,e,i)}return r!==void 0&&(i?e.residualClasses=r:e.residualStyles=r),t}function xb(n,e,t){let i=t?e.classBindings:e.styleBindings;if(_o(i)!==0)return n[Di(i)]}function Sb(n,e,t,i){let o=t?e.classBindings:e.styleBindings;n[Di(o)]=i}function wb(n,e,t){let i,o=e.directiveEnd;for(let r=1+e.directiveStylingLast;r<o;r++){let s=n[r].hostAttrs;i=ur(i,s,t)}return ur(i,e.attrs,t)}function sd(n,e,t,i,o){let r=null,s=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<s&&(r=e[a],i=ur(i,r.hostAttrs,o),r!==n);)a++;return n!==null&&(t.directiveStylingLast=a),i}function ur(n,e,t){let i=t?1:2,o=-1;if(e!==null)for(let r=0;r<e.length;r++){let s=e[r];typeof s=="number"?o=s:o===i&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),Os(n,s,t?!0:e[++r]))}return n===void 0?null:n}function Eb(n,e,t){if(t==null||t==="")return St;let i=[],o=Gd(t);if(Array.isArray(o))for(let r=0;r<o.length;r++)n(i,o[r],!0);else if(typeof o=="object")for(let r in o)o.hasOwnProperty(r)&&n(i,r,o[r]);else typeof o=="string"&&e(i,o);return i}function Mb(n,e,t){let i=String(e);i!==""&&!i.includes(" ")&&Os(n,i,t)}function Db(n,e,t,i,o,r,s,a){o===He&&(o=St);let u=0,f=0,g=0<o.length?o[0]:null,h=0<r.length?r[0]:null;for(;g!==null||h!==null;){let b=u<o.length?o[u+1]:void 0,C=f<r.length?r[f+1]:void 0,T=null,F;g===h?(u+=2,f+=2,b!==C&&(T=h,F=C)):h===null||g!==null&&g<h?(u+=2,T=g):(f+=2,T=h,F=C),T!==null&&Ch(n,e,t,i,T,F,s,a),g=u<o.length?o[u]:null,h=f<r.length?r[f]:null}}function Ch(n,e,t,i,o,r,s,a){if(!(e.type&3))return;let u=n.data,f=u[a+1],g=ub(f)?Am(u,e,t,o,_o(f),s):void 0;if(!ma(g)){ma(r)||cb(f)&&(r=Am(u,null,t,o,a,s));let h=Pc(Tt(),t);hv(i,s,h,o,r)}}function Am(n,e,t,i,o,r){let s=e===null,a;for(;o>0;){let u=n[o],f=Array.isArray(u),g=f?u[1]:u,h=g===null,b=t[o+1];b===He&&(b=h?St:void 0);let C=h?As(b,i):g===i?b:void 0;if(f&&!ma(C)&&(C=As(u,i)),ma(C)&&(a=C,s))return a;let T=n[o+1];o=s?Di(T):_o(T)}if(e!==null){let u=r?e.residualClasses:e.residualStyles;u!=null&&(a=As(u,i))}return a}function ma(n){return n!==void 0}function Tb(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=Ln(Gd(n)))),n}function vh(n,e){return(n.flags&(e?8:16))!==0}function d(n,e=""){let t=Z(),i=Ye(),o=n+$e,r=i.firstCreatePass?wa(i,o,1,e,null):i.data[o],s=Ib(i,t,r,e,n);t[o]=s,Hs()&&ru(i,t,s,r),so(r,!1)}var Ib=(n,e,t,i,o)=>(Us(!0),TC(e[Oe],i));function Pb(n,e){let t=!1,i=lo();for(let r=1;r<e.length;r+=2)t=It(n,i++,e[r])||t;if(Hc(i),!t)return He;let o=e[0];for(let r=1;r<e.length;r+=2)o+=Ze(e[r])+(r+1!==e.length?e[r+1]:"");return o}function yh(n,e,t,i=""){return It(n,Gn(),t)?e+Ze(t)+i:He}function Ob(n,e,t,i,o,r=""){let s=lo(),a=ho(n,s,t,o);return yi(2),a?e+Ze(t)+i+Ze(o)+r:He}function Ab(n,e,t,i,o,r,s,a=""){let u=lo(),f=Yg(n,u,t,o,s);return yi(3),f?e+Ze(t)+i+Ze(o)+r+Ze(s)+a:He}function Nb(n,e,t,i,o,r,s,a,u,f=""){let g=lo(),h=Kg(n,g,t,o,s,u);return yi(4),h?e+Ze(t)+i+Ze(o)+r+Ze(s)+a+Ze(u)+f:He}function kb(n,e,t,i,o,r,s,a,u,f,g,h,b,C=""){let T=lo(),F=Kg(n,T,t,o,s,u);return F=ho(n,T+4,g,b)||F,yi(6),F?e+Ze(t)+i+Ze(o)+r+Ze(s)+a+Ze(u)+f+Ze(g)+h+Ze(b)+C:He}function P(n){return j("",n),P}function j(n,e,t){let i=Z(),o=yh(i,n,e,t);return o!==He&&yo(i,Tt(),o),j}function ve(n,e,t,i,o){let r=Z(),s=Ob(r,n,e,t,i,o);return s!==He&&yo(r,Tt(),s),ve}function Ia(n,e,t,i,o,r,s){let a=Z(),u=Ab(a,n,e,t,i,o,r,s);return u!==He&&yo(a,Tt(),u),Ia}function Pa(n,e,t,i,o,r,s,a,u){let f=Z(),g=Nb(f,n,e,t,i,o,r,s,a,u);return g!==He&&yo(f,Tt(),g),Pa}function Oa(n,e,t,i,o,r,s,a,u,f,g,h,b){let C=Z(),T=kb(C,n,e,t,i,o,r,s,a,u,f,g,h,b);return T!==He&&yo(C,Tt(),T),Oa}function Aa(n){let e=Z(),t=Pb(e,n);return t!==He&&yo(e,Tt(),t),Aa}function yo(n,e,t){let i=Pc(e,n);IC(n[Oe],i,t)}function pt(n,e,t){Yc(e)&&(e=e());let i=Z(),o=Gn();if(It(i,o,e)){let r=Ye(),s=er();Mg(s,i,n,e,i[Oe],t)}return pt}function vt(n,e){let t=Yc(n);return t&&n.set(e),t}function ft(n,e){let t=Z(),i=Ye(),o=dt();return ph(i,t,t[Oe],o,n,e),ft}function Cu(n,e,t=""){return yh(Z(),n,e,t)}function Rb(n,e,t){let i=Ye();if(i.firstCreatePass){let o=mn(n);$d(t,i.data,i.blueprint,o,!0),$d(e,i.data,i.blueprint,o,!1)}}function $d(n,e,t,i,o){if(n=ct(n),Array.isArray(n))for(let r=0;r<n.length;r++)$d(n[r],e,t,i,o);else{let r=Ye(),s=Z(),a=dt(),u=li(n)?n:ct(n.provide),f=Ec(n),g=a.providerIndexes&1048575,h=a.directiveStart,b=a.providerIndexes>>20;if(li(n)||!n.multi){let C=new wi(f,o,Ee,null),T=ld(u,e,o?g:g+b,h);T===-1?(dd(ia(a,s),r,u),ad(r,n,e.length),e.push(u),a.directiveStart++,a.directiveEnd++,o&&(a.providerIndexes+=1048576),t.push(C),s.push(C)):(t[T]=C,s[T]=C)}else{let C=ld(u,e,g+b,h),T=ld(u,e,g,g+b),F=C>=0&&t[C],U=T>=0&&t[T];if(o&&!U||!o&&!F){dd(ia(a,s),r,u);let K=Lb(o?Vb:Fb,t.length,o,i,f,n);!o&&U&&(t[T].providerFactory=K),ad(r,n,e.length,0),e.push(u),a.directiveStart++,a.directiveEnd++,o&&(a.providerIndexes+=1048576),t.push(K),s.push(K)}else{let K=bh(t[o?T:C],f,!o&&i);ad(r,n,C>-1?C:T,K)}!o&&i&&U&&t[T].componentProviders++}}}function ad(n,e,t,i){let o=li(e),r=Pf(e);if(o||r){let u=(r?ct(e.useClass):e).prototype.ngOnDestroy;if(u){let f=n.destroyHooks||(n.destroyHooks=[]);if(!o&&e.multi){let g=f.indexOf(t);g===-1?f.push(t,[i,u]):f[g+1].push(i,u)}else f.push(t,u)}}}function bh(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function ld(n,e,t,i){for(let o=t;o<i;o++)if(e[o]===n)return o;return-1}function Fb(n,e,t,i,o){return Bd(this.multi,[])}function Vb(n,e,t,i,o){let r=this.multi,s;if(this.providerFactory){let a=this.providerFactory.componentProviders,u=or(i,i[Y],this.providerFactory.index,o);s=u.slice(0,a),Bd(r,s);for(let f=a;f<u.length;f++)s.push(u[f])}else s=[],Bd(r,s);return s}function Bd(n,e){for(let t=0;t<n.length;t++){let i=n[t];e.push(i())}return e}function Lb(n,e,t,i,o,r){let s=new wi(n,t,Ee,null);return s.multi=[],s.index=e,s.componentProviders=0,bh(s,o,i&&!t),s}function yn(n,e=[]){return t=>{t.providersResolver=(i,o)=>Rb(i,o?o(n):n,e)}}function vu(n,e){let t=n[e];return t===He?void 0:t}function jb(n,e,t,i,o,r){let s=e+t;return It(n,s,o)?pu(n,s+1,r?i.call(r,o):i(o)):vu(n,s+1)}function zb(n,e,t,i,o,r,s){let a=e+t;return ho(n,a,o,r)?pu(n,a+2,s?i.call(s,o,r):i(o,r)):vu(n,a+2)}function $b(n,e,t,i,o,r,s,a){let u=e+t;return Yg(n,u,o,r,s)?pu(n,u+3,a?i.call(a,o,r,s):i(o,r,s)):vu(n,u+3)}function Nn(n,e){let t=Ye(),i,o=n+$e;t.firstCreatePass?(i=Bb(e,t.pipeRegistry),t.data[o]=i,i.onDestroy&&(t.destroyHooks??=[]).push(o,i.onDestroy)):i=t.data[o];let r=i.factory||(i.factory=jn(i.type,!0)),s,a=xt(Ee);try{let u=na(!1),f=r();return na(u),Oc(t,Z(),o,f),f}finally{xt(a)}}function Bb(n,e){if(e)for(let t=e.length-1;t>=0;t--){let i=e[t];if(n===i.name)return i}}function yu(n,e,t){let i=n+$e,o=Z(),r=Jo(o,i);return xu(o,i)?jb(o,Ls(),e,r.transform,t,r):r.transform(t)}function bu(n,e,t,i){let o=n+$e,r=Z(),s=Jo(r,o);return xu(r,o)?zb(r,Ls(),e,s.transform,t,i,s):s.transform(t,i)}function bo(n,e,t,i,o){let r=n+$e,s=Z(),a=Jo(s,r);return xu(s,r)?$b(s,Ls(),e,a.transform,t,i,o,a):a.transform(t,i,o)}function xu(n,e){return n[Y].data[e].pure}var Hb=(()=>{class n{zone=q(Je);changeDetectionScheduler=q(un);applicationRef=q(Ai);applicationErrorHandler=q(Pn);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{try{this.applicationRef.dirtyFlags|=1,this.applicationRef._tick()}catch(t){this.applicationErrorHandler(t)}})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function xh({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new Je(O(E({},Sh()),{scheduleInRootZone:t})),[{provide:Je,useFactory:n},{provide:pi,multi:!0,useFactory:()=>{let i=q(Hb,{optional:!0});return()=>i.initialize()}},{provide:pi,multi:!0,useFactory:()=>{let i=q(Ub);return()=>{i.initialize()}}},e===!0?{provide:Kc,useValue:!0}:[],{provide:Zc,useValue:t??gg},{provide:Pn,useFactory:()=>{let i=q(Je),o=q(Lt),r;return s=>{i.runOutsideAngular(()=>{o.destroyed&&!r?setTimeout(()=>{throw s}):(r??=o.get(jt),r.handleError(s))})}}}]}function Sh(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var Ub=(()=>{class n{subscription=new bt;initialized=!1;zone=q(Je);pendingTasks=q(bi);initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Je.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Je.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var wh=(()=>{class n{applicationErrorHandler=q(Pn);appRef=q(Ai);taskService=q(bi);ngZone=q(Je);zonelessEnabled=q(qs);tracing=q(Ti,{optional:!0});disableScheduling=q(Kc,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new bt;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(sa):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(q(Zc,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof aa||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;let i=!1;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2,i=!0;break}case 12:{this.appRef.dirtyFlags|=16,i=!0;break}case 13:{this.appRef.dirtyFlags|=2,i=!0;break}case 11:{i=!0;break}case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(i))return;let o=this.useMicrotaskScheduler?mm:hg;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>o(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>o(()=>this.tick()))}shouldScheduleTick(t){return!(this.disableScheduling&&!t||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(sa+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(i){this.taskService.remove(t),this.applicationErrorHandler(i)}finally{this.cleanup()}this.useMicrotaskScheduler=!0,mm(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(i){return new(i||n)};static \u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function qb(){return typeof $localize<"u"&&$localize.locale||hr}var yr=new le("",{providedIn:"root",factory:()=>q(yr,{optional:!0,skipSelf:!0})||qb()});function kn(n){return ff(n)}function A(n,e){return is(n,e?.equal)}var Su=class{[Dt];constructor(e){this[Dt]=e}destroy(){this[Dt].destroy()}};function br(n,e){let t=e?.injector??q(Qt),i=e?.manualCleanup!==!0?t.get(In):null,o,r=t.get(co,null,{optional:!0}),s=t.get(un);return r!==null?(o=Qb(r.view,s,n),i instanceof Uo&&i._lView===r.view&&(i=null)):o=Yb(n,t.get(tr),s),o.injector=t,i!==null&&(o.onDestroyFn=i.onDestroy(()=>o.destroy())),new Su(o)}var Eh=O(E({},mf),{cleanupFns:void 0,zone:null,onDestroyFn:xi,run(){let n=ao(!1);try{gf(this)}finally{ao(n)}},cleanup(){if(!this.cleanupFns?.length)return;let n=J(null);try{for(;this.cleanupFns.length;)this.cleanupFns.pop()()}finally{this.cleanupFns=[],J(n)}}}),Wb=O(E({},Eh),{consumerMarkedDirty(){this.scheduler.schedule(this),this.notifier.notify(12)},destroy(){Wi(this),this.onDestroyFn(),this.cleanup(),this.scheduler.remove(this)}}),Gb=O(E({},Eh),{consumerMarkedDirty(){this.view[X]|=8192,Wn(this.view),this.notifier.notify(13)},destroy(){Wi(this),this.onDestroyFn(),this.cleanup(),this.view[Tn]?.delete(this)}});function Qb(n,e,t){let i=Object.create(Gb);return i.view=n,i.zone=typeof Zone<"u"?Zone.current:null,i.notifier=e,i.fn=Mh(i,t),n[Tn]??=new Set,n[Tn].add(i),i.consumerMarkedDirty(i),i}function Yb(n,e,t){let i=Object.create(Wb);return i.fn=Mh(i,n),i.scheduler=e,i.notifier=t,i.zone=typeof Zone<"u"?Zone.current:null,i.scheduler.add(i),i.notifier.notify(12),i}function Mh(n,e){return()=>{e(t=>(n.cleanupFns??=[]).push(t))}}var ax=new le("");ax.__NG_ELEMENT_ID__=n=>{let e=dt();if(e===null)throw new ne(204,!1);if(e.type&2)return e.value;if(n&8)return null;throw new ne(204,!1)};var wu=new le(""),lx=new le("");function xr(n){return!n.moduleRef}function cx(n){let e=xr(n)?n.r3Injector:n.moduleRef.injector,t=e.get(Je);return t.run(()=>{xr(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let i=e.get(Pn),o;if(t.runOutsideAngular(()=>{o=t.onError.subscribe({next:i})}),xr(n)){let r=()=>e.destroy(),s=n.platformInjector.get(wu);s.add(r),e.onDestroy(()=>{o.unsubscribe(),s.delete(r)})}else{let r=()=>n.moduleRef.destroy(),s=n.platformInjector.get(wu);s.add(r),n.moduleRef.onDestroy(()=>{ir(n.allPlatformModules,n.moduleRef),o.unsubscribe(),s.delete(r)})}return ux(i,t,()=>{let r=e.get(bi),s=r.add(),a=e.get(hu);return a.runInitializers(),a.donePromise.then(()=>{let u=e.get(yr,hr);if(uh(u||hr),!e.get(lx,!0))return xr(n)?e.get(Ai):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(xr(n)){let g=e.get(Ai);return n.rootComponent!==void 0&&g.bootstrap(n.rootComponent),g}else return dx?.(n.moduleRef,n.allPlatformModules),n.moduleRef}).finally(()=>void r.remove(s))})})}var dx;function ux(n,e,t){try{let i=t();return vo(i)?i.catch(o=>{throw e.runOutsideAngular(()=>n(o)),o}):i}catch(i){throw e.runOutsideAngular(()=>n(i)),i}}var Na=null;function px(n=[],e){return Qt.create({name:e,providers:[{provide:Go,useValue:"platform"},{provide:wu,useValue:new Set([()=>Na=null])},...n]})}function fx(n=[]){if(Na)return Na;let e=px(n);return Na=e,lh(),mx(e),e}function mx(n){let e=n.get(ha,null);Ns(n,()=>{e?.forEach(t=>t())})}var ka=(()=>{class n{static __NG_ELEMENT_ID__=gx}return n})();function gx(n){return hx(dt(),Z(),(n&16)===16)}function hx(n,e,t){if(qn(n)&&!t){let i=Ht(n.index,e);return new Yn(i,i)}else if(n.type&175){let i=e[Ot];return new Yn(i,e)}return null}function Dh(n){let{rootComponent:e,appProviders:t,platformProviders:i,platformRef:o}=n;Te(8);try{let r=o?.injector??fx(i),s=[xh({}),{provide:un,useExisting:wh},om,...t||[]],a=new dr({providers:s,parent:r,debugName:"",runEnvironmentInitializers:!1});return cx({r3Injector:a.injector,platformInjector:r,rootComponent:e})}catch(r){return Promise.reject(r)}finally{Te(9)}}function Th(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}var Ih=null;function Zn(){return Ih}function Eu(n){Ih??=n}var Sr=class{};var Tu=(function(n){return n[n.Decimal=0]="Decimal",n[n.Percent=1]="Percent",n[n.Currency=2]="Currency",n[n.Scientific=3]="Scientific",n})(Tu||{});var bn={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function xo(n,e){let t=Da(n),i=t[Ni.NumberSymbols][e];if(typeof i>"u"){if(e===bn.CurrencyDecimal)return t[Ni.NumberSymbols][bn.Decimal];if(e===bn.CurrencyGroup)return t[Ni.NumberSymbols][bn.Group]}return i}function Oh(n,e){return Da(n)[Ni.NumberFormats][e]}var _x=/^(\d+)?\.((\d+)(-(\d+))?)?$/,Ph=22,Ra=".",wr="0",Cx=";",vx=",",Mu="#";function yx(n,e,t,i,o,r,s=!1){let a="",u=!1;if(!isFinite(n))a=xo(t,bn.Infinity);else{let f=Sx(n);s&&(f=xx(f));let g=e.minInt,h=e.minFrac,b=e.maxFrac;if(r){let We=r.match(_x);if(We===null)throw new ne(2306,!1);let Et=We[1],Re=We[3],Ce=We[5];Et!=null&&(g=Du(Et)),Re!=null&&(h=Du(Re)),Ce!=null?b=Du(Ce):Re!=null&&h>b&&(b=h)}wx(f,h,b);let C=f.digits,T=f.integerLen,F=f.exponent,U=[];for(u=C.every(We=>!We);T<g;T++)C.unshift(0);for(;T<0;T++)C.unshift(0);T>0?U=C.splice(T,C.length):(U=C,C=[0]);let K=[];for(C.length>=e.lgSize&&K.unshift(C.splice(-e.lgSize,C.length).join(""));C.length>e.gSize;)K.unshift(C.splice(-e.gSize,C.length).join(""));C.length&&K.unshift(C.join("")),a=K.join(xo(t,i)),U.length&&(a+=xo(t,o)+U.join("")),F&&(a+=xo(t,bn.Exponential)+"+"+F)}return n<0&&!u?a=e.negPre+a+e.negSuf:a=e.posPre+a+e.posSuf,a}function Ah(n,e,t){let i=Oh(e,Tu.Decimal),o=bx(i,xo(e,bn.MinusSign));return yx(n,o,e,bn.Group,bn.Decimal,t)}function bx(n,e="-"){let t={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},i=n.split(Cx),o=i[0],r=i[1],s=o.indexOf(Ra)!==-1?o.split(Ra):[o.substring(0,o.lastIndexOf(wr)+1),o.substring(o.lastIndexOf(wr)+1)],a=s[0],u=s[1]||"";t.posPre=a.substring(0,a.indexOf(Mu));for(let g=0;g<u.length;g++){let h=u.charAt(g);h===wr?t.minFrac=t.maxFrac=g+1:h===Mu?t.maxFrac=g+1:t.posSuf+=h}let f=a.split(vx);if(t.gSize=f[1]?f[1].length:0,t.lgSize=f[2]||f[1]?(f[2]||f[1]).length:0,r){let g=o.length-t.posPre.length-t.posSuf.length,h=r.indexOf(Mu);t.negPre=r.substring(0,h).replace(/'/g,""),t.negSuf=r.slice(h+g).replace(/'/g,"")}else t.negPre=e+t.posPre,t.negSuf=t.posSuf;return t}function xx(n){if(n.digits[0]===0)return n;let e=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(e===0?n.digits.push(0,0):e===1&&n.digits.push(0),n.integerLen+=2),n}function Sx(n){let e=Math.abs(n)+"",t=0,i,o,r,s,a;for((o=e.indexOf(Ra))>-1&&(e=e.replace(Ra,"")),(r=e.search(/e/i))>0?(o<0&&(o=r),o+=+e.slice(r+1),e=e.substring(0,r)):o<0&&(o=e.length),r=0;e.charAt(r)===wr;r++);if(r===(a=e.length))i=[0],o=1;else{for(a--;e.charAt(a)===wr;)a--;for(o-=r,i=[],s=0;r<=a;r++,s++)i[s]=Number(e.charAt(r))}return o>Ph&&(i=i.splice(0,Ph-1),t=o-1,o=1),{digits:i,exponent:t,integerLen:o}}function wx(n,e,t){if(e>t)throw new ne(2307,!1);let i=n.digits,o=i.length-n.integerLen,r=Math.min(Math.max(e,o),t),s=r+n.integerLen,a=i[s];if(s>0){i.splice(Math.max(n.integerLen,s));for(let h=s;h<i.length;h++)i[h]=0}else{o=Math.max(0,o),n.integerLen=1,i.length=Math.max(1,s=r+1),i[0]=0;for(let h=1;h<s;h++)i[h]=0}if(a>=5)if(s-1<0){for(let h=0;h>s;h--)i.unshift(0),n.integerLen++;i.unshift(1),n.integerLen++}else i[s-1]++;for(;o<Math.max(0,r);o++)i.push(0);let u=r!==0,f=e+n.integerLen,g=i.reduceRight(function(h,b,C,T){return b=b+h,T[C]=b<10?b:b-10,u&&(T[C]===0&&C>=f?T.pop():u=!1),b>=10?1:0},0);g&&(i.unshift(g),n.integerLen++)}function Du(n){let e=parseInt(n);if(isNaN(e))throw new ne(2305,!1);return e}function Iu(n,e){return new ne(2100,!1)}var Pu=(()=>{class n{transform(t){if(t==null)return null;if(typeof t!="string")throw Iu(n,t);return t.toUpperCase()}static \u0275fac=function(i){return new(i||n)};static \u0275pipe=gr({name:"uppercase",type:n,pure:!0})}return n})();var Ou=(()=>{class n{_locale;constructor(t){this._locale=t}transform(t,i,o){if(!Ex(t))return null;o||=this._locale;try{let r=Mx(t);return Ah(r,o,i)}catch(r){throw Iu(n,r.message)}}static \u0275fac=function(i){return new(i||n)(Ee(yr,16))};static \u0275pipe=gr({name:"number",type:n,pure:!0})}return n})();function Ex(n){return!(n==null||n===""||n!==n)}function Mx(n){if(typeof n=="string"&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if(typeof n!="number")throw new ne(2309,!1);return n}var Er=(()=>{class n{transform(t,i,o){if(t==null)return null;if(!(typeof t=="string"||Array.isArray(t)))throw Iu(n,t);return t.slice(i,o)}static \u0275fac=function(i){return new(i||n)};static \u0275pipe=gr({name:"slice",type:n,pure:!1})}return n})();var te=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=Oi({type:n});static \u0275inj=$n({})}return n})();function Au(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let i=t.indexOf("="),[o,r]=i==-1?[t,""]:[t.slice(0,i),t.slice(i+1)];if(o.trim()===e)return decodeURIComponent(r)}return null}var Mr=class{};var Nh="browser";var Dr=class{_doc;constructor(e){this._doc=e}manager},Fa=(()=>{class n extends Dr{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,o,r){return t.addEventListener(i,o,r),()=>this.removeEventListener(t,i,o,r)}removeEventListener(t,i,o,r){return t.removeEventListener(i,o,r)}static \u0275fac=function(i){return new(i||n)(De(Jt))};static \u0275prov=oe({token:n,factory:n.\u0275fac})}return n})(),La=new le(""),Lu=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,i){this._zone=i,t.forEach(s=>{s.manager=this});let o=t.filter(s=>!(s instanceof Fa));this._plugins=o.slice().reverse();let r=t.find(s=>s instanceof Fa);r&&this._plugins.push(r)}addEventListener(t,i,o,r){return this._findPluginFor(i).addEventListener(t,i,o,r)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(r=>r.supports(t)),!i)throw new ne(5101,!1);return this._eventNameToPlugin.set(t,i),i}static \u0275fac=function(i){return new(i||n)(De(La),De(Je))};static \u0275prov=oe({token:n,factory:n.\u0275fac})}return n})(),ku="ng-app-id";function kh(n){for(let e of n)e.remove()}function Rh(n,e){let t=e.createElement("style");return t.textContent=n,t}function Tx(n,e,t,i){let o=n.head?.querySelectorAll(`style[${ku}="${e}"],link[${ku}="${e}"]`);if(o)for(let r of o)r.removeAttribute(ku),r instanceof HTMLLinkElement?i.set(r.href.slice(r.href.lastIndexOf("/")+1),{usage:0,elements:[r]}):r.textContent&&t.set(r.textContent,{usage:0,elements:[r]})}function Fu(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var ju=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(t,i,o,r={}){this.doc=t,this.appId=i,this.nonce=o,Tx(t,i,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,i){for(let o of t)this.addUsage(o,this.inline,Rh);i?.forEach(o=>this.addUsage(o,this.external,Fu))}removeStyles(t,i){for(let o of t)this.removeUsage(o,this.inline);i?.forEach(o=>this.removeUsage(o,this.external))}addUsage(t,i,o){let r=i.get(t);r?r.usage++:i.set(t,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,o(t,this.doc)))})}removeUsage(t,i){let o=i.get(t);o&&(o.usage--,o.usage<=0&&(kh(o.elements),i.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])kh(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[i,{elements:o}]of this.inline)o.push(this.addElement(t,Rh(i,this.doc)));for(let[i,{elements:o}]of this.external)o.push(this.addElement(t,Fu(i,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,i){return this.nonce&&i.setAttribute("nonce",this.nonce),t.appendChild(i)}static \u0275fac=function(i){return new(i||n)(De(Jt),De(ga),De(_a,8),De(fr))};static \u0275prov=oe({token:n,factory:n.\u0275fac})}return n})(),Ru={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},zu=/%COMP%/g;var Vh="%COMP%",Ix=`_nghost-${Vh}`,Px=`_ngcontent-${Vh}`,Ox=!0,Ax=new le("",{providedIn:"root",factory:()=>Ox});function Nx(n){return Px.replace(zu,n)}function kx(n){return Ix.replace(zu,n)}function Lh(n,e){return e.map(t=>t.replace(zu,n))}var $u=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,i,o,r,s,a,u=null,f=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=o,this.removeStylesOnCompDestroy=r,this.doc=s,this.ngZone=a,this.nonce=u,this.tracingService=f,this.platformIsServer=!1,this.defaultRenderer=new Tr(t,s,a,this.platformIsServer,this.tracingService)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;let o=this.getOrCreateRenderer(t,i);return o instanceof Va?o.applyToHost(t):o instanceof Ir&&o.applyStyles(),o}getOrCreateRenderer(t,i){let o=this.rendererByCompId,r=o.get(i.id);if(!r){let s=this.doc,a=this.ngZone,u=this.eventManager,f=this.sharedStylesHost,g=this.removeStylesOnCompDestroy,h=this.platformIsServer,b=this.tracingService;switch(i.encapsulation){case On.Emulated:r=new Va(u,f,i,this.appId,g,s,a,h,b);break;case On.ShadowDom:return new Vu(u,f,t,i,s,a,this.nonce,h,b);default:r=new Ir(u,f,i,g,s,a,h,b);break}o.set(i.id,r)}return r}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(i){return new(i||n)(De(Lu),De(ju),De(ga),De(Ax),De(Jt),De(Je),De(_a),De(Ti,8))};static \u0275prov=oe({token:n,factory:n.\u0275fac})}return n})(),Tr=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,i,o,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=o,this.tracingService=r}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(Ru[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(Fh(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(Fh(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){t.remove()}selectRootElement(e,t){let i=typeof e=="string"?this.doc.querySelector(e):e;if(!i)throw new ne(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,o){if(o){t=o+":"+t;let r=Ru[o];r?e.setAttributeNS(r,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){let o=Ru[i];o?e.removeAttributeNS(o,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,o){o&(_n.DashCase|_n.Important)?e.style.setProperty(t,i,o&_n.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&_n.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e!=null&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i,o){if(typeof e=="string"&&(e=Zn().getGlobalEventTarget(this.doc,e),!e))throw new ne(5102,!1);let r=this.decoratePreventDefault(i);return this.tracingService?.wrapEventListener&&(r=this.tracingService.wrapEventListener(e,t,r)),this.eventManager.addEventListener(e,t,r,o)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;e(t)===!1&&t.preventDefault()}}};function Fh(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var Vu=class extends Tr{sharedStylesHost;hostEl;shadowRoot;constructor(e,t,i,o,r,s,a,u,f){super(e,r,s,u,f),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let g=o.styles;g=Lh(o.id,g);for(let b of g){let C=document.createElement("style");a&&C.setAttribute("nonce",a),C.textContent=b,this.shadowRoot.appendChild(C)}let h=o.getExternalStyles?.();if(h)for(let b of h){let C=Fu(b,r);a&&C.setAttribute("nonce",a),this.shadowRoot.appendChild(C)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Ir=class extends Tr{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,i,o,r,s,a,u,f){super(e,r,s,a,u),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=o;let g=i.styles;this.styles=f?Lh(f,g):g,this.styleUrls=i.getExternalStyles?.(f)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&Ei.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},Va=class extends Ir{contentAttr;hostAttr;constructor(e,t,i,o,r,s,a,u,f){let g=o+"-"+i.id;super(e,t,i,r,s,a,u,f,g),this.contentAttr=Nx(g),this.hostAttr=kx(g)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}};var ja=class n extends Sr{supportsDOMEvents=!0;static makeCurrent(){Eu(new n)}onAndCancel(e,t,i,o){return e.addEventListener(t,i,o),()=>{e.removeEventListener(t,i,o)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=Rx();return t==null?null:Fx(t)}resetBaseElement(){Pr=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Au(document.cookie,e)}},Pr=null;function Rx(){return Pr=Pr||document.head.querySelector("base"),Pr?Pr.getAttribute("href"):null}function Fx(n){return new URL(n,document.baseURI).pathname}var Vx=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(i){return new(i||n)};static \u0275prov=oe({token:n,factory:n.\u0275fac})}return n})(),jh=["alt","control","meta","shift"],Lx={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},jx={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},zh=(()=>{class n extends Dr{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,i,o,r){let s=n.parseEventName(i),a=n.eventCallback(s.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Zn().onAndCancel(t,s.domEventName,a,r))}static parseEventName(t){let i=t.toLowerCase().split("."),o=i.shift();if(i.length===0||!(o==="keydown"||o==="keyup"))return null;let r=n._normalizeKey(i.pop()),s="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),s="code."),jh.forEach(f=>{let g=i.indexOf(f);g>-1&&(i.splice(g,1),s+=f+".")}),s+=r,i.length!=0||r.length===0)return null;let u={};return u.domEventName=o,u.fullKey=s,u}static matchEventFullKeyCode(t,i){let o=Lx[t.key]||t.key,r="";return i.indexOf("code.")>-1&&(o=t.code,r="code."),o==null||!o?!1:(o=o.toLowerCase(),o===" "?o="space":o==="."&&(o="dot"),jh.forEach(s=>{if(s!==o){let a=jx[s];a(t)&&(r+=s+".")}}),r+=o,r===i)}static eventCallback(t,i,o){return r=>{n.matchEventFullKeyCode(r,t)&&o.runGuarded(()=>i(r))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(i){return new(i||n)(De(Jt))};static \u0275prov=oe({token:n,factory:n.\u0275fac})}return n})();function Bu(n,e,t){let i=E({rootComponent:n,platformRef:t?.platformRef},zx(e));return Dh(i)}function zx(n){return{appProviders:[...qx,...n?.providers??[]],platformProviders:Ux}}function $x(){ja.makeCurrent()}function Bx(){return new jt}function Hx(){return qd(document),document}var Ux=[{provide:fr,useValue:Nh},{provide:ha,useValue:$x,multi:!0},{provide:Jt,useFactory:Hx}];var qx=[{provide:Go,useValue:"root"},{provide:jt,useFactory:Bx},{provide:La,useClass:Fa,multi:!0,deps:[Jt]},{provide:La,useClass:zh,multi:!0,deps:[Jt]},$u,ju,Lu,{provide:Mi,useExisting:$u},{provide:Mr,useClass:Vx},[]];var Kh=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,i){this._renderer=t,this._elementRef=i}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(i){return new(i||n)(Ee(Pi),Ee(Nt))};static \u0275dir=ut({type:n})}return n})(),Ua=(()=>{class n extends Kh{static \u0275fac=(()=>{let t;return function(o){return(t||(t=An(n)))(o||n)}})();static \u0275dir=ut({type:n,features:[kt]})}return n})(),Fr=new le("");var Wx={provide:Fr,useExisting:Pt(()=>ye),multi:!0};function Gx(){let n=Zn()?Zn().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var Qx=new le(""),ye=(()=>{class n extends Kh{_compositionMode;_composing=!1;constructor(t,i,o){super(t,i),this._compositionMode=o,this._compositionMode==null&&(this._compositionMode=!Gx())}writeValue(t){let i=t??"";this.setProperty("value",i)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(i){return new(i||n)(Ee(Pi),Ee(Nt),Ee(Qx,8))};static \u0275dir=ut({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,o){i&1&&_("input",function(s){return o._handleInput(s.target.value)})("blur",function(){return o.onTouched()})("compositionstart",function(){return o._compositionStart()})("compositionend",function(s){return o._compositionEnd(s.target.value)})},standalone:!1,features:[yn([Wx]),kt]})}return n})();function Yx(n){return n==null?null:Array.isArray(n)||typeof n=="string"?n.length:n instanceof Set?n.size:null}var qa=new le(""),Kx=new le("");function Zx(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function Jx(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function Xx(n){return e=>{let t=e.value?.length??Yx(e.value);return t!==null&&t>n?{maxlength:{requiredLength:n,actualLength:t}}:null}}function $h(n){return null}function Zh(n){return n!=null}function Jh(n){return vo(n)?Xl(n):n}function Xh(n){let e={};return n.forEach(t=>{e=t!=null?E(E({},e),t):e}),Object.keys(e).length===0?null:e}function e0(n,e){return e.map(t=>t(n))}function e1(n){return!n.validate}function t0(n){return n.map(e=>e1(e)?e:t=>e.validate(t))}function t1(n){if(!n)return null;let e=n.filter(Zh);return e.length==0?null:function(t){return Xh(e0(t,e))}}function n0(n){return n!=null?t1(t0(n)):null}function n1(n){if(!n)return null;let e=n.filter(Zh);return e.length==0?null:function(t){let i=e0(t,e).map(Jh);return ec(i).pipe(ri(Xh))}}function i0(n){return n!=null?n1(t0(n)):null}function Bh(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function i1(n){return n._rawValidators}function o1(n){return n._rawAsyncValidators}function Hu(n){return n?Array.isArray(n)?n:[n]:[]}function $a(n,e){return Array.isArray(n)?n.includes(e):n===e}function Hh(n,e){let t=Hu(e);return Hu(n).forEach(o=>{$a(t,o)||t.push(o)}),t}function Uh(n,e){return Hu(e).filter(t=>!$a(n,t))}var Ba=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=n0(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=i0(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Uu=class extends Ba{name;get formDirective(){return null}get path(){return null}},Rr=class extends Ba{_parent=null;name=null;valueAccessor=null},qu=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},r1={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},F4=O(E({},r1),{"[class.ng-submitted]":"isSubmitted"}),Me=(()=>{class n extends qu{constructor(t){super(t)}static \u0275fac=function(i){return new(i||n)(Ee(Rr,2))};static \u0275dir=ut({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,o){i&2&&B("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)},standalone:!1,features:[kt]})}return n})();var Or="VALID",za="INVALID",So="PENDING",Ar="DISABLED",ki=class{},Ha=class extends ki{value;source;constructor(e,t){super(),this.value=e,this.source=t}},Nr=class extends ki{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},kr=class extends ki{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},wo=class extends ki{status;source;constructor(e,t){super(),this.status=e,this.source=t}};var Wu=class extends ki{source;constructor(e){super(),this.source=e}};function s1(n){return(Wa(n)?n.validators:n)||null}function a1(n){return Array.isArray(n)?n0(n):n||null}function l1(n,e){return(Wa(e)?e.asyncValidators:n)||null}function c1(n){return Array.isArray(n)?i0(n):n||null}function Wa(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}var Gu=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return kn(this.statusReactive)}set status(e){kn(()=>this.statusReactive.set(e))}_status=A(()=>this.statusReactive());statusReactive=w(void 0);get valid(){return this.status===Or}get invalid(){return this.status===za}get pending(){return this.status==So}get disabled(){return this.status===Ar}get enabled(){return this.status!==Ar}errors;get pristine(){return kn(this.pristineReactive)}set pristine(e){kn(()=>this.pristineReactive.set(e))}_pristine=A(()=>this.pristineReactive());pristineReactive=w(!0);get dirty(){return!this.pristine}get touched(){return kn(this.touchedReactive)}set touched(e){kn(()=>this.touchedReactive.set(e))}_touched=A(()=>this.touchedReactive());touchedReactive=w(!1);get untouched(){return!this.touched}_events=new cn;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Hh(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Hh(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Uh(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Uh(e,this._rawAsyncValidators))}hasValidator(e){return $a(this._rawValidators,e)}hasAsyncValidator(e){return $a(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(O(E({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new kr(!0,i))}markAllAsDirty(e={}){this.markAsDirty({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsDirty(e))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let i=e.sourceControl??this;this._forEachChild(o=>{o.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:i})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,i),t&&e.emitEvent!==!1&&this._events.next(new kr(!1,i))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(O(E({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new Nr(!1,i))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let i=e.sourceControl??this;this._forEachChild(o=>{o.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,i),t&&e.emitEvent!==!1&&this._events.next(new Nr(!0,i))}markAsPending(e={}){this.status=So;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new wo(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(O(E({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Ar,this.errors=null,this._forEachChild(o=>{o.disable(O(E({},e),{onlySelf:!0}))}),this._updateValue();let i=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Ha(this.value,i)),this._events.next(new wo(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(O(E({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(o=>o(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Or,this._forEachChild(i=>{i.enable(O(E({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(O(E({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Or||this.status===So)&&this._runAsyncValidator(i,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Ha(this.value,t)),this._events.next(new wo(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(O(E({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Ar:Or}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=So,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1,shouldHaveEmitted:e!==!1};let i=Jh(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(o=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(o,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((i,o)=>i&&i._find(o),this)}getError(e,t){let i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,i){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||i)&&this._events.next(new wo(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,i)}_initObservables(){this.valueChanges=new W,this.statusChanges=new W}_calculateStatus(){return this._allControlsDisabled()?Ar:this.errors?za:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(So)?So:this._anyControlsHaveStatus(za)?za:Or}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let i=!this._anyControlsDirty(),o=this.pristine!==i;this.pristine=i,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),o&&this._events.next(new Nr(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new kr(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Wa(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=a1(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=c1(this._rawAsyncValidators)}};var o0=new le("",{providedIn:"root",factory:()=>Qu}),Qu="always";function d1(n,e){return[...e.path,n]}function u1(n,e,t=Qu){f1(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),m1(n,e),h1(n,e),g1(n,e),p1(n,e)}function qh(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function p1(n,e){if(e.valueAccessor.setDisabledState){let t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function f1(n,e){let t=i1(n);e.validator!==null?n.setValidators(Bh(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let i=o1(n);e.asyncValidator!==null?n.setAsyncValidators(Bh(i,e.asyncValidator)):typeof i=="function"&&n.setAsyncValidators([i]);let o=()=>n.updateValueAndValidity();qh(e._rawValidators,o),qh(e._rawAsyncValidators,o)}function m1(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&r0(n,e)})}function g1(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&r0(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function r0(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function h1(n,e){let t=(i,o)=>{e.valueAccessor.writeValue(i),o&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function _1(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function C1(n){return Object.getPrototypeOf(n.constructor)===Ua}function v1(n,e){if(!e)return null;Array.isArray(e);let t,i,o;return e.forEach(r=>{r.constructor===ye?t=r:C1(r)?i=r:o=r}),o||i||t||null}function Wh(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Gh(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var y1=class extends Gu{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,i){super(s1(t),l1(i,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Wa(t)&&(t.nonNullable||t.initialValueIsDefault)&&(Gh(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1,t?.emitEvent!==!1&&this._events.next(new Wu(this))}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Wh(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Wh(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Gh(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var b1={provide:Rr,useExisting:Pt(()=>xe)},Qh=Promise.resolve(),xe=(()=>{class n extends Rr{_changeDetectorRef;callSetDisabledState;control=new y1;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new W;constructor(t,i,o,r,s,a){super(),this._changeDetectorRef=s,this.callSetDisabledState=a,this._parent=t,this._setValidators(i),this._setAsyncValidators(o),this.valueAccessor=v1(this,r)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),_1(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){u1(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){Qh.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let i=t.isDisabled.currentValue,o=i!==0&&Th(i);Qh.then(()=>{o&&!this.control.disabled?this.control.disable():!o&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?d1(t,this._parent):[t]}static \u0275fac=function(i){return new(i||n)(Ee(Uu,9),Ee(qa,10),Ee(Kx,10),Ee(Fr,10),Ee(ka,8),Ee(o0,8))};static \u0275dir=ut({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[yn([b1]),kt,Fe]})}return n})();var x1={provide:Fr,useExisting:Pt(()=>tn),multi:!0},tn=(()=>{class n extends Ua{writeValue(t){let i=t??"";this.setProperty("value",i)}registerOnChange(t){this.onChange=i=>{t(i==""?null:parseFloat(i))}}static \u0275fac=(()=>{let t;return function(o){return(t||(t=An(n)))(o||n)}})();static \u0275dir=ut({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,o){i&1&&_("input",function(s){return o.onChange(s.target.value)})("blur",function(){return o.onTouched()})},standalone:!1,features:[yn([x1]),kt]})}return n})();var S1={provide:Fr,useExisting:Pt(()=>st),multi:!0};function s0(n,e){return n==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function w1(n){return n.split(":")[0]}var st=(()=>{class n extends Ua{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;appRefInjector=q(Ai).injector;destroyRef=q(In);cdr=q(ka);_queuedWrite=!1;_writeValueAfterRender(){this._queuedWrite||this.appRefInjector.destroyed||(this._queuedWrite=!0,iu({write:()=>{this.destroyRef.destroyed||(this._queuedWrite=!1,this.writeValue(this.value))}},{injector:this.appRefInjector}))}writeValue(t){this.cdr.markForCheck(),this.value=t;let i=this._getOptionId(t),o=s0(i,t);this.setProperty("value",o)}registerOnChange(t){this.onChange=i=>{this.value=this._getOptionValue(i),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),t))return i;return null}_getOptionValue(t){let i=w1(t);return this._optionMap.has(i)?this._optionMap.get(i):t}static \u0275fac=(()=>{let t;return function(o){return(t||(t=An(n)))(o||n)}})();static \u0275dir=ut({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,o){i&1&&_("change",function(s){return o.onChange(s.target.value)})("blur",function(){return o.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[yn([S1]),kt]})}return n})(),Ue=(()=>{class n{_element;_renderer;_select;id;constructor(t,i,o){this._element=t,this._renderer=i,this._select=o,this._select&&(this.id=this._select._registerOption())}set ngValue(t){this._select!=null&&(this._select._optionMap.set(this.id,t),this._setElementValue(s0(this.id,t)),this._select._writeValueAfterRender())}set value(t){this._setElementValue(t),this._select&&this._select._writeValueAfterRender()}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select._writeValueAfterRender())}static \u0275fac=function(i){return new(i||n)(Ee(Nt),Ee(Pi),Ee(st,9))};static \u0275dir=ut({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})(),E1={provide:Fr,useExisting:Pt(()=>a0),multi:!0};function Yh(n,e){return n==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function M1(n){return n.split(":")[0]}var a0=(()=>{class n extends Ua{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let i;if(Array.isArray(t)){let o=t.map(r=>this._getOptionId(r));i=(r,s)=>{r._setSelected(o.indexOf(s.toString())>-1)}}else i=(o,r)=>{o._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(t){this.onChange=i=>{let o=[],r=i.selectedOptions;if(r!==void 0){let s=r;for(let a=0;a<s.length;a++){let u=s[a],f=this._getOptionValue(u.value);o.push(f)}}else{let s=i.options;for(let a=0;a<s.length;a++){let u=s[a];if(u.selected){let f=this._getOptionValue(u.value);o.push(f)}}}this.value=o,t(o)}}_registerOption(t){let i=(this._idCounter++).toString();return this._optionMap.set(i,t),i}_getOptionId(t){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,t))return i;return null}_getOptionValue(t){let i=M1(t);return this._optionMap.has(i)?this._optionMap.get(i)._value:t}static \u0275fac=(()=>{let t;return function(o){return(t||(t=An(n)))(o||n)}})();static \u0275dir=ut({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,o){i&1&&_("change",function(s){return o.onChange(s.target)})("blur",function(){return o.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[yn([E1]),kt]})}return n})(),qe=(()=>{class n{_element;_renderer;_select;id;_value;constructor(t,i,o){this._element=t,this._renderer=i,this._select=o,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){this._select!=null&&(this._value=t,this._setElementValue(Yh(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(Yh(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(i){return new(i||n)(Ee(Nt),Ee(Pi),Ee(a0,9))};static \u0275dir=ut({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})();function D1(n){return typeof n=="number"?n:parseInt(n,10)}function l0(n){return typeof n=="number"?n:parseFloat(n)}var Yu=(()=>{class n{_validator=$h;_onChange;_enabled;ngOnChanges(t){if(this.inputName in t){let i=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):$h,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return t!=null}static \u0275fac=function(i){return new(i||n)};static \u0275dir=ut({type:n,features:[Fe]})}return n})(),T1={provide:qa,useExisting:Pt(()=>Rn),multi:!0},Rn=(()=>{class n extends Yu{max;inputName="max";normalizeInput=t=>l0(t);createValidator=t=>Jx(t);static \u0275fac=(()=>{let t;return function(o){return(t||(t=An(n)))(o||n)}})();static \u0275dir=ut({type:n,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(i,o){i&2&&Cn("max",o._enabled?o.max:null)},inputs:{max:"max"},standalone:!1,features:[yn([T1]),kt]})}return n})(),I1={provide:qa,useExisting:Pt(()=>nn),multi:!0},nn=(()=>{class n extends Yu{min;inputName="min";normalizeInput=t=>l0(t);createValidator=t=>Zx(t);static \u0275fac=(()=>{let t;return function(o){return(t||(t=An(n)))(o||n)}})();static \u0275dir=ut({type:n,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(i,o){i&2&&Cn("min",o._enabled?o.min:null)},inputs:{min:"min"},standalone:!1,features:[yn([I1]),kt]})}return n})();var P1={provide:qa,useExisting:Pt(()=>Ku),multi:!0},Ku=(()=>{class n extends Yu{maxlength;inputName="maxlength";normalizeInput=t=>D1(t);createValidator=t=>Xx(t);static \u0275fac=(()=>{let t;return function(o){return(t||(t=An(n)))(o||n)}})();static \u0275dir=ut({type:n,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(i,o){i&2&&Cn("maxlength",o._enabled?o.maxlength:null)},inputs:{maxlength:"maxlength"},standalone:!1,features:[yn([P1]),kt]})}return n})();var O1=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=Oi({type:n});static \u0275inj=$n({})}return n})();var ce=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:o0,useValue:t.callSetDisabledState??Qu}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=Oi({type:n});static \u0275inj=$n({imports:[O1]})}return n})();function de(n,e){for(let t of n.modifiers)if(Ga(e,t.samples))return t.value;return n.value}function Ga(n,e){let t=e.split(",");for(let i of t){let o=i.trim();if(o.includes("-")){let[r,s]=o.split("-").map(Number);if(n>=r&&n<=s)return!0}else if(n===Number(o))return!0}return!1}function c0(n){let e=n.toLowerCase().trim();return e==="source name"?"source_name":e.startsWith("characteristics[")?"characteristics":e.startsWith("comment[")?"comment":e.startsWith("factor value[")||e.startsWith("factorvalue[")?"factor_value":"special"}var A1=[{name:"source name",type:"source_name",description:"Unique sample identifier",category:"Core Sample Metadata",isRequired:!0},{name:"characteristics[organism]",type:"characteristics",description:"Organism of the sample",category:"Characteristics",isRequired:!0,ontologies:["ncbitaxon"],examples:["Homo sapiens","Mus musculus"]},{name:"characteristics[disease]",type:"characteristics",description:"Disease under study",category:"Characteristics",isRequired:!0,ontologies:["efo","mondo","doid"],examples:["normal","breast cancer"]},{name:"characteristics[organism part]",type:"characteristics",description:"Part of organism anatomy",category:"Characteristics",isRequired:!0,ontologies:["uberon","bto"],examples:["liver","brain","blood"]},{name:"characteristics[cell type]",type:"characteristics",description:"Cell type",category:"Characteristics",ontologies:["cl","bto"],examples:["T cell","hepatocyte"]},{name:"characteristics[age]",type:"characteristics",description:"Age of the individual",category:"Characteristics",pattern:"^(\\d+Y)?(\\d+M)?(\\d+D)?(-\\d+Y(\\d+M)?(\\d+D)?)?$|^not available$|^not applicable$",examples:["30Y","30Y6M","25Y-35Y"]},{name:"characteristics[sex]",type:"characteristics",description:"Biological sex",category:"Characteristics",ontologies:["pato"],examples:["male","female"]},{name:"characteristics[ancestry category]",type:"characteristics",description:"Ancestry or ethnicity",category:"Characteristics",ontologies:["hancestro"]},{name:"characteristics[cell line]",type:"characteristics",description:"Cell line name",category:"Characteristics",ontologies:["clo","bto"],examples:["HeLa","HEK293"]},{name:"characteristics[enrichment process]",type:"characteristics",description:"Enrichment process applied",category:"Characteristics"},{name:"characteristics[pooled sample]",type:"characteristics",description:"Pooled sample indicator",category:"Characteristics",examples:["not pooled","pooled","SN=sample1,sample2"]},{name:"characteristics[spiked compound]",type:"characteristics",description:"Spiked compound details",category:"Characteristics",examples:["SP=iRT;CT=peptide;QY=1fmol"]},{name:"characteristics[synthetic peptide]",type:"characteristics",description:"Synthetic peptide indicator",category:"Characteristics",examples:["synthetic","not synthetic"]},{name:"characteristics[individual]",type:"characteristics",description:"Patient/individual identifier",category:"Characteristics"},{name:"characteristics[biological replicate]",type:"characteristics",description:"Biological replicate number",category:"Characteristics"},{name:"assay name",type:"special",description:"MS run identifier",category:"Assay Information",isRequired:!0},{name:"technology type",type:"special",description:"Technology used for data generation",category:"Assay Information",isRequired:!0,examples:["proteomic profiling by mass spectrometry"]},{name:"comment[fraction identifier]",type:"comment",description:"Fraction number",category:"Comments",examples:["1","2","3"]},{name:"comment[label]",type:"comment",description:"Label applied to sample",category:"Comments",isRequired:!0,ontologies:["ms","pride"],examples:["label free sample","TMT126","iTRAQ4plex-114"]},{name:"comment[data file]",type:"comment",description:"Raw data file name",category:"Comments",isRequired:!0,examples:["sample1.raw","sample1.mzML"]},{name:"comment[instrument]",type:"comment",description:"Mass spectrometer model",category:"Comments",isRequired:!0,ontologies:["ms"],examples:["Orbitrap Fusion Lumos","Q Exactive HF"]},{name:"comment[technical replicate]",type:"comment",description:"Technical replicate number",category:"Comments",examples:["1","2"]},{name:"comment[modification parameters]",type:"comment",description:"Protein modifications",category:"Modifications & Enzymes",isRequired:!0,ontologies:["unimod"],examples:["NT=Oxidation;MT=Variable;TA=M;AC=UNIMOD:35","NT=Carbamidomethyl;TA=C;MT=fixed;AC=UNIMOD:4"]},{name:"comment[cleavage agent details]",type:"comment",description:"Digestion enzyme information",category:"Modifications & Enzymes",isRequired:!0,ontologies:["ms"],examples:["NT=Trypsin;AC=MS:1001251","NT=Trypsin/P;AC=MS:1001313"]},{name:"comment[fragment mass tolerance]",type:"comment",description:"Fragment ion mass tolerance",category:"Mass Tolerances",pattern:"^\\d+(\\.\\d+)?\\s*(ppm|Da)$|^not available$|^not applicable$",examples:["20 ppm","0.02 Da"]},{name:"comment[precursor mass tolerance]",type:"comment",description:"Precursor ion mass tolerance",category:"Mass Tolerances",pattern:"^\\d+(\\.\\d+)?\\s*(ppm|Da)$|^not available$|^not applicable$",examples:["10 ppm","20 ppm"]},{name:"comment[collision energy]",type:"comment",description:"Collision energy used",category:"Technical Parameters",pattern:"^\\d+(\\.\\d+)?%? (NCE|eV)(;\\d+(\\.\\d+)?%? (NCE|eV))*$|^not available$",examples:["30 NCE","30% NCE","27 eV","25 NCE;27 NCE;30 NCE"]},{name:"comment[dissociation method]",type:"comment",description:"Fragmentation method",category:"Technical Parameters",ontologies:["ms","pride"],examples:["HCD","CID","ETD","EThcD"]},{name:"comment[proteomics data acquisition method]",type:"comment",description:"DDA, DIA, etc.",category:"Technical Parameters",ontologies:["ms"],examples:["Data-dependent acquisition","Data-independent acquisition"]},{name:"comment[scan window lower limit]",type:"comment",description:"Lower m/z limit of DIA scan window",category:"Technical Parameters",pattern:"^\\d+(\\.\\d+)?$",examples:["400","350.5"]},{name:"comment[scan window upper limit]",type:"comment",description:"Upper m/z limit of DIA scan window",category:"Technical Parameters",pattern:"^\\d+(\\.\\d+)?$",examples:["1200","1000.5"]},{name:"comment[isolation window width]",type:"comment",description:"Width of the isolation window in m/z units",category:"Technical Parameters",pattern:"^\\d+(\\.\\d+)?$",examples:["25","8","4"]},{name:"comment[MS2 mass analyzer]",type:"comment",description:"Mass analyzer used for MS2 acquisition",category:"Technical Parameters",ontologies:["ms"],examples:["orbitrap","ion trap","TOF"]},{name:"comment[depletion]",type:"comment",description:"Depletion method applied",category:"Sample Preparation"},{name:"comment[reduction reagent]",type:"comment",description:"Reduction reagent used",category:"Sample Preparation",examples:["DTT","TCEP"]},{name:"comment[alkylation reagent]",type:"comment",description:"Alkylation reagent used",category:"Sample Preparation",examples:["IAA","IAM","Chloroacetamide"]},{name:"comment[fractionation method]",type:"comment",description:"Fractionation method",category:"Sample Preparation",ontologies:["pride"],examples:["High-pH reversed-phase chromatography","SCX"]},{name:"comment[file uri]",type:"comment",description:"Public URI of the file",category:"File & Project Information",examples:["ftp://ftp.pride.ebi.ac.uk/pride/..."]},{name:"comment[proteomexchange accession number]",type:"comment",description:"ProteomeXchange accession",category:"File & Project Information",pattern:"^PXD\\d{6}$",examples:["PXD000001"]}];function Eo(n){return A1.find(e=>e.name.toLowerCase()===n.toLowerCase())}function d0(n){return Eo(n)?.isRequired===!0}function u0(n){return Eo(n)?.ontologies||[]}var f0=$0(p0());function Qa(n=1){return{columns:[],sampleCount:n,pools:[],metadata:{loadedAt:new Date,modifiedAt:new Date}}}function Vr(n){let e=[];for(let t=1;t<=n.sampleCount;t++){let i=[];for(let o of n.columns){let r=o.value;for(let s of o.modifiers)if(N1(t,s.samples)){r=s.value;break}i.push(r)}e.push(i)}return e}function N1(n,e){let t=e.split(",");for(let i of t){let o=i.trim();if(o.includes("-")){let[r,s]=o.split("-").map(Number);if(n>=r&&n<=s)return!0}else if(n===Number(o))return!0}return!1}function Mo(n){if(n.length===0)return"";let e=[...n].sort((r,s)=>r-s),t=[],i=e[0],o=e[0];for(let r=1;r<=e.length;r++)r<e.length&&e[r]===o+1?o=e[r]:(i===o?t.push(String(i)):o-i===1?(t.push(String(i)),t.push(String(o))):t.push(`${i}-${o}`),r<e.length&&(i=e[r],o=e[r]));return t.join(",")}function Ya(n){if(!n||n.trim()==="")return[];let e=[],t=n.split(",");for(let i of t){let o=i.trim();if(o.includes("-")){let[r,s]=o.split("-"),a=parseInt(r,10),u=parseInt(s,10);if(!isNaN(a)&&!isNaN(u))for(let f=a;f<=u;f++)e.push(f)}else{let r=parseInt(o,10);isNaN(r)||e.push(r)}}return[...new Set(e)].sort((i,o)=>i-o)}var k1={detectPools:!0,trimValues:!0,normalizeColumnNames:!0,delimiter:"	"},Lr=class{parseFromContent(e,t={}){let i=E(E({},k1),t),o=performance.now(),r=[];try{let s=f0.default.parse(e,{delimiter:i.delimiter,header:!1,skipEmptyLines:!0,transformHeader:void 0});if(s.errors.length>0){let b=s.errors.filter(C=>C.type==="Quotes"||C.type==="FieldMismatch");if(b.length>0)return{success:!1,error:`Parse error: ${b[0].message}`,warnings:r,stats:{rowCount:0,columnCount:0,poolCount:0,parseTimeMs:0}};for(let C of s.errors)r.push(`Row ${C.row}: ${C.message}`)}let a=s.data;if(a.length===0)return{success:!1,error:"Empty file",warnings:r,stats:{rowCount:0,columnCount:0,poolCount:0,parseTimeMs:0}};let u=a[0],f=a.slice(1),g=this.buildTable(u,f,i,r),h=performance.now()-o;return{success:!0,table:g,warnings:r,stats:{rowCount:g.sampleCount,columnCount:g.columns.length,poolCount:g.pools.length,parseTimeMs:h}}}catch(s){return{success:!1,error:`Parse error: ${s instanceof Error?s.message:String(s)}`,warnings:r,stats:{rowCount:0,columnCount:0,poolCount:0,parseTimeMs:0}}}}parseFromUrl(i){return k(this,arguments,function*(e,t={}){try{let o=yield fetch(e);if(!o.ok)return{success:!1,error:`Failed to fetch: ${o.status} ${o.statusText}`,warnings:[],stats:{rowCount:0,columnCount:0,poolCount:0,parseTimeMs:0}};let r=yield o.text(),s=this.parseFromContent(r,t);return s.success&&s.table&&(s.table.metadata=O(E({},s.table.metadata),{sourceUrl:e})),s}catch(o){return{success:!1,error:`Fetch error: ${o instanceof Error?o.message:String(o)}`,warnings:[],stats:{rowCount:0,columnCount:0,poolCount:0,parseTimeMs:0}}}})}parseFromFile(i){return k(this,arguments,function*(e,t={}){return new Promise(o=>{let r=new FileReader;r.onload=s=>{let a=s.target?.result,u=this.parseFromContent(a,t);u.success&&u.table&&(u.table.metadata=O(E({},u.table.metadata),{filename:e.name})),o(u)},r.onerror=()=>{o({success:!1,error:`File read error: ${r.error?.message||"Unknown error"}`,warnings:[],stats:{rowCount:0,columnCount:0,poolCount:0,parseTimeMs:0}})},r.readAsText(e)})})}buildTable(e,t,i,o){let r=Qa(t.length),s=new Map;return e.forEach((a,u)=>{let f=i.normalizeColumnNames?a.toLowerCase().trim():a.trim(),g=(s.get(f)||0)+1;s.set(f,g),g>1&&o.push(`Duplicate column name: "${f}" (occurrence ${g})`);let h=this.createColumn(f,u,t,i);r.columns.push(h)}),i.detectPools&&(r.pools=this.detectPools(r.columns,t,o)),r.metadata=O(E({},r.metadata),{loadedAt:new Date,modifiedAt:new Date}),r}createColumn(e,t,i,o){let r=new Map,s=!1,a=!1;i.forEach((C,T)=>{let F=C[t]||"";o.trimValues&&(F=F.trim());let U=F.toLowerCase();if(U==="not applicable"&&(s=!0),U==="not available"&&(a=!0),F==="")return;let K=T+1;r.has(F)||r.set(F,[]),r.get(F).push(K)});let u="",f=0;for(let[C,T]of r)T.length>f&&(f=T.length,u=C);let g=[];for(let[C,T]of r)C!==u&&g.push({samples:Mo(T),value:C});let h=c0(e),b=Eo(e);return{name:e,type:h,value:u,modifiers:g,columnPosition:t,isRequired:d0(e),ontologyType:b?.ontologies?.[0],ontologyOptions:u0(e),notApplicable:s,notAvailable:a}}detectPools(e,t,i){let o=[],r=e.findIndex(f=>f.name.includes("pooled sample"));if(r===-1)return o;let s=e.findIndex(f=>f.name==="source name"),a=[],u=[];t.forEach((f,g)=>{let h=f[r]?.trim()||"";h.startsWith("SN=")?a.push({rowIndex:g,row:f,value:h}):h.toLowerCase()==="pooled"&&u.push(g+1)});for(let f of a){let g=f.value.substring(3).split(",").map(T=>T.trim()).filter(T=>T),h=s!==-1?f.row[s]?.trim()||`Pool ${o.length+1}`:`Pool ${o.length+1}`,b=[],C=[];s!==-1&&t.forEach((T,F)=>{let U=T[s]?.trim()||"";if(g.includes(U)){let K=T[r]?.trim().toLowerCase()||"";K==="not pooled"||K===""||K==="independent"?C.push(F+1):K.startsWith("sn=")||b.push(F+1)}}),o.push({poolName:h,pooledOnlySamples:b,pooledAndIndependentSamples:C,isReference:!0,sdrfValue:f.value})}if(a.length===0&&u.length>0){let f=[];if(s!==-1)for(let h of u){let C=t[h-1][s]?.trim()||"";C&&f.push(C)}let g=f.length>0?`SN=${f.join(",")}`:"";o.push({poolName:"Pool 1",pooledOnlySamples:u,pooledAndIndependentSamples:[],isReference:!1,sdrfValue:g})}return o}},J4=new Lr;function m0(){return{isValid:!0,errors:[],warnings:[],info:[],summary:{errorCount:0,warningCount:0,infoCount:0,columnsValidated:0,samplesValidated:0,ontologyValidated:!1},timestamp:new Date}}function Jn(n,e,t){return E({type:"error",code:n,message:e},t)}function yt(n,e,t){return E({type:"warning",code:n,message:e},t)}var R1={baseUrl:"https://www.ebi.ac.uk/ols4/api",defaultRows:10,cacheTtlMs:300*1e3,timeoutMs:1e4,enableCache:!0},Ri=class{config;cache=new Map;constructor(e={}){this.config=E(E({},R1),e)}search(e){return k(this,null,function*(){let t=e.query?.trim()||"";if(t.length<2)return{suggestions:[],totalCount:0,hasMore:!1,query:t,ontologies:e.ontology||[]};let i=this.getCacheKey(e);if(this.config.enableCache){let o=this.getFromCache(i);if(o)return{suggestions:o,totalCount:o.length,hasMore:o.length>=(e.rows||this.config.defaultRows),query:t,ontologies:e.ontology||[]}}try{let o=this.buildSearchUrl(e),r=yield this.fetchWithTimeout(o);if(!r.ok)throw new Error(`OLS API error: ${r.status} ${r.statusText}`);let s=yield r.json(),a=this.mapOlsResponse(s,e);return this.config.enableCache&&this.addToCache(i,a),{suggestions:a,totalCount:s.response?.numFound||a.length,hasMore:(s.response?.numFound||0)>a.length,query:t,ontologies:e.ontology||[]}}catch(o){return console.error("OLS search error:",o),{suggestions:[],totalCount:0,hasMore:!1,query:t,ontologies:e.ontology||[]}}})}searchOrganism(e,t){return k(this,null,function*(){return(yield this.search({query:e,ontology:["ncbitaxon"],rows:t||15})).suggestions})}searchDisease(e,t){return k(this,null,function*(){return(yield this.search({query:e,ontology:["efo","mondo","doid"],rows:t||15})).suggestions})}searchCellType(e,t){return k(this,null,function*(){return(yield this.search({query:e,ontology:["cl","bto"],rows:t||15})).suggestions})}searchTissue(e,t){return k(this,null,function*(){return(yield this.search({query:e,ontology:["uberon","bto"],rows:t||15})).suggestions})}searchInstrument(e,t){return k(this,null,function*(){return(yield this.search({query:e,ontology:["ms"],rows:t||15})).suggestions})}searchPride(e,t){return k(this,null,function*(){return(yield this.search({query:e,ontology:["pride"],rows:t||15})).suggestions})}validateTerm(e,t){return k(this,null,function*(){return!e||e.trim()===""?!1:(yield this.search({query:e,ontology:t,exact:!0,rows:1})).suggestions.length>0})}getTermByIri(e){return k(this,null,function*(){try{let t=encodeURIComponent(encodeURIComponent(e)),i=`${this.config.baseUrl}/terms/${t}`,o=yield this.fetchWithTimeout(i);if(!o.ok)return null;let r=yield o.json();return{id:r.obo_id||r.short_form||"",label:r.label||"",iri:r.iri||e,ontologyPrefix:r.ontology_prefix||"",description:r.description?.[0]||"",synonyms:r.synonyms||[]}}catch{return null}})}clearCache(){this.cache.clear()}getCacheStats(){let e=0;for(let t of this.cache.values())e+=JSON.stringify(t.value).length;return{size:e,entries:this.cache.size}}buildSearchUrl(e){let t=new URLSearchParams;if(t.set("q",e.query),t.set("rows",String(e.rows||this.config.defaultRows)),e.ontology&&e.ontology.length>0)for(let i of e.ontology)t.append("ontology",i.toLowerCase());return e.exact&&t.set("exact","true"),e.type&&t.set("type",e.type),t.set("fieldList","id,iri,short_form,obo_id,label,description,ontology_prefix,synonym"),t.set("queryFields","label,synonym,short_form,obo_id"),t.set("highlight","true"),`${this.config.baseUrl}/select?${t.toString()}`}mapOlsResponse(e,t){return(e.response?.docs||[]).map(o=>({id:o.obo_id||o.short_form||o.id||"",label:o.label||"",iri:o.iri||"",ontologyPrefix:o.ontology_prefix||"",description:o.description?.[0]||"",synonyms:o.synonym||[],isExactMatch:t.exact||o.label?.toLowerCase()===t.query.toLowerCase()}))}getCacheKey(e){return JSON.stringify({query:e.query.toLowerCase(),ontology:e.ontology?.sort()||[],exact:e.exact||!1,rows:e.rows||this.config.defaultRows,type:e.type})}getFromCache(e){let t=this.cache.get(e);return t?Date.now()-t.timestamp>this.config.cacheTtlMs?(this.cache.delete(e),null):t.value:null}addToCache(e,t){if(this.cache.set(e,{value:t,timestamp:Date.now()}),this.cache.size>1e3){let i=this.cache.keys().next().value;i&&this.cache.delete(i)}}fetchWithTimeout(e){return k(this,null,function*(){let t=new AbortController,i=setTimeout(()=>t.abort(),this.config.timeoutMs);try{return yield fetch(e,{signal:t.signal,headers:{Accept:"application/json"}})}finally{clearTimeout(i)}})}},Do=new Ri;var To={collisionEnergy:/^\d+(\.\d+)?%? (NCE|eV)(;\d+(\.\d+)?%? (NCE|eV))*$|^not available$/,age:/^(\d+Y)?(\d+M)?(\d+D)?(-(\d+Y)?(\d+M)?(\d+D)?)?$|^not available$|^not applicable$/,massTolerance:/^\d+(\.\d+)?\s*(ppm|Da)$|^not available$|^not applicable$/,scanWindowLimit:/^\d+(\.\d+)?$|^not available$|^not applicable$/,pxdAccession:/^PXD\d{6}$/},g0=["source name","characteristics[organism]","characteristics[disease]","characteristics[organism part]","assay name","technology type","comment[label]","comment[data file]","comment[instrument]","comment[modification parameters]","comment[cleavage agent details]"],F1={"characteristics[organism]":["ncbitaxon"],"characteristics[disease]":["efo","mondo","doid"],"characteristics[cell type]":["cl","bto"],"characteristics[organism part]":["uberon","bto"],"characteristics[cell line]":["clo","bto"],"comment[instrument]":["ms"],"comment[dissociation method]":["ms","pride"],"comment[fractionation method]":["pride"]},jr=class{olsService;constructor(e){this.olsService=e||new Ri}validate(i){return k(this,arguments,function*(e,t={}){let o=m0();o.options=t;let r=[],s=[],a=this.validateRequiredColumns(e);r.push(...a);for(let b of e.columns){if(t.skipColumns?.includes(b.name))continue;let C=this.validateColumnFormat(b,e.sampleCount);r.push(...C.filter(T=>T.type==="error")),s.push(...C.filter(T=>T.type==="warning"))}if(t.validateOntology!==!1){let b=yield this.validateOntologyTerms(e,t);s.push(...b)}let u=this.validatePools(e);r.push(...u.filter(b=>b.type==="error")),s.push(...u.filter(b=>b.type==="warning"));let f=this.validateStructure(e);r.push(...f.filter(b=>b.type==="error")),s.push(...f.filter(b=>b.type==="warning"));let g=this.validateWhitespace(e);s.push(...g);let h=this.validateFactorCharacteristicRelations(e);return s.push(...h.filter(b=>b.type==="warning")),r.push(...h.filter(b=>b.type==="error")),o.errors=r,o.warnings=s,o.isValid=r.length===0,o.timestamp=new Date,o.summary={errorCount:r.length,warningCount:s.length,infoCount:0,columnsValidated:e.columns.length,samplesValidated:e.sampleCount,ontologyValidated:t.validateOntology!==!1},t.strictMode&&s.length>0&&(o.isValid=!1),o})}validateRequiredColumns(e){let t=[],i=new Set(e.columns.map(o=>o.name.toLowerCase()));for(let o of g0)i.has(o.toLowerCase())||t.push(Jn("MISSING_REQUIRED_COLUMN",`Required column '${o}' is missing`,{column:o}));return t}validateColumnFormat(e,t){let i=[],o=e.name.toLowerCase(),r=this.getUniqueValuesToValidate(e);if(o.includes("collision energy"))for(let s of r)s&&!To.collisionEnergy.test(s)&&i.push(Jn("INVALID_COLLISION_ENERGY",`Invalid collision energy format: '${s}'. Expected: {value} {unit} (e.g., '30 NCE', '25% NCE;27% NCE')`,{column:e.name,value:s}));else if(o==="characteristics[age]")for(let s of r)s&&!To.age.test(s)&&i.push(yt("INVALID_AGE_FORMAT",`Non-standard age format: '${s}'. Expected: XY[XM][XD] (e.g., '30Y', '30Y6M', '25Y-35Y')`,{column:e.name,value:s}));else if(o.includes("mass tolerance")||o.includes("precursor mass tolerance")||o.includes("fragment mass tolerance"))for(let s of r)s&&!To.massTolerance.test(s)&&i.push(Jn("INVALID_MASS_TOLERANCE",`Invalid mass tolerance format: '${s}'. Expected: {value} {unit} (e.g., '10 ppm', '0.02 Da')`,{column:e.name,value:s}));else if(o.includes("scan window lower limit")||o.includes("scan window upper limit")||o.includes("isolation window width"))for(let s of r)s&&!To.scanWindowLimit.test(s)&&i.push(yt("INVALID_PATTERN",`Invalid numeric format: '${s}'. Expected: numeric value`,{column:e.name,value:s}));else if(o==="comment[modification parameters]"){for(let s of r)if(s&&s!=="not available"){let a=this.validateModificationFormat(s,e.name);i.push(...a)}}else if(o==="comment[cleavage agent details]"){for(let s of r)if(s&&s!=="not available"){let a=this.validateCleavageFormat(s,e.name);i.push(...a)}}else if(o==="comment[proteomexchange accession number]")for(let s of r)s&&!To.pxdAccession.test(s)&&i.push(yt("INVALID_PATTERN",`Invalid ProteomeXchange accession: '${s}'. Expected format: PXD000000`,{column:e.name,value:s}));return e.isRequired&&!e.value&&e.modifiers.length===0&&i.push(Jn("EMPTY_REQUIRED_VALUE",`Required column '${e.name}' has no values`,{column:e.name})),i}validateModificationFormat(e,t){let i=[],o=e.split(";"),r=[];for(let s of o){let a=s.split("=");a.length>=2&&r.push(a[0].trim())}return r.includes("NT")||i.push(yt("INVALID_MODIFICATION_FORMAT",`Modification missing NT (Name of Term): '${e}'`,{column:t,value:e,suggestion:"Add NT=<modification name>"})),r.includes("TA")||i.push(yt("INVALID_MODIFICATION_FORMAT",`Modification missing TA (Target Amino acid): '${e}'`,{column:t,value:e,suggestion:"Add TA=<amino acid>"})),i}validateCleavageFormat(e,t){let i=[],o=e.split(";"),r=[];for(let s of o){let a=s.split("=");a.length>=2&&r.push(a[0].trim())}return r.includes("NT")||i.push(yt("INVALID_CLEAVAGE_FORMAT",`Cleavage agent missing NT (Name of Term): '${e}'`,{column:t,value:e,suggestion:"Add NT=<enzyme name>"})),i}validateOntologyTerms(e,t){return k(this,null,function*(){let i=[],o=new Set;for(let r of e.columns){let s=F1[r.name.toLowerCase()];if(!s)continue;let a=this.getUniqueValuesToValidate(r);for(let u of a){if(!u)continue;let f=u.toLowerCase();if(f==="not applicable"||f==="not available")continue;let g=`${r.name}:${u}`;if(!o.has(g)){o.add(g);try{(yield this.olsService.validateTerm(u,s))||i.push(yt("ONTOLOGY_TERM_NOT_FOUND",`Term '${u}' not found in ${s.join("/")} ontologies`,{column:r.name,value:u}))}catch{}}}}return i})}validatePools(e){let t=[];for(let i of e.pools){let o=[...i.pooledOnlySamples,...i.pooledAndIndependentSamples];for(let r of o)(r<1||r>e.sampleCount)&&t.push(Jn("POOL_SAMPLE_NOT_FOUND",`Pool '${i.poolName}' references non-existent sample ${r}`,{value:i.poolName}));o.length===0&&t.push(yt("INVALID_POOL_REFERENCE",`Pool '${i.poolName}' has no samples`,{value:i.poolName}))}return t}validateStructure(e){let t=[],i=new Map;for(let o of e.columns){let r=o.name.toLowerCase(),s=(i.get(r)||0)+1;i.set(r,s),s>1&&!r.includes("modification parameters")&&t.push(yt("DUPLICATE_COLUMN_NAME",`Duplicate column name: '${o.name}' (occurrence ${s})`,{column:o.name}))}return e.columns.length===0&&t.push(Jn("UNKNOWN_ERROR","Table has no columns",{})),e.sampleCount===0&&t.push(Jn("UNKNOWN_ERROR","Table has no samples",{})),t}validateFactorCharacteristicRelations(e){let t=[],i=e.columns.filter(r=>r.name.toLowerCase().startsWith("factor value[")),o=new Map;for(let r of e.columns){let s=r.name.toLowerCase().match(/^characteristics\[(.+)\]$/);s&&o.set(s[1].toLowerCase(),r)}for(let r of i){let s=r.name.toLowerCase().match(/^factor value\[(.+)\]$/);if(!s)continue;let a=s[1].toLowerCase(),u=o.get(a);if(!u){t.push(yt("FACTOR_MISSING_CHARACTERISTIC",`Factor value column '${r.name}' has no corresponding 'characteristics[${a}]' column`,{column:r.name}));continue}let f=this.getAllValuesForColumn(r,e.sampleCount),g=this.getAllValuesForColumn(u,e.sampleCount),h=new Set(g.filter(C=>C&&C.toLowerCase()!=="not available"&&C.toLowerCase()!=="not applicable").map(C=>C.toLowerCase().trim())),b=new Set;for(let C=0;C<f.length;C++){let T=f[C];if(!T||T.toLowerCase()==="not available"||T.toLowerCase()==="not applicable")continue;let F=T.toLowerCase().trim();!h.has(F)&&!b.has(F)&&(b.add(F),t.push(yt("FACTOR_CHARACTERISTIC_MISMATCH",`Factor value '${T}' in '${r.name}' not found in '${u.name}'`,{column:r.name,value:T,row:C+1,suggestion:`Ensure '${T}' is present in 'characteristics[${a}]'`})))}}return t}getAllValuesForColumn(e,t){let i=[];if(e.value&&e.modifiers.length===0){for(let o=0;o<t;o++)i.push(e.value);return i}for(let o=1;o<=t;o++){let r=de(e,o);i.push(r)}return i}validateWhitespace(e){let t=[];for(let i=0;i<e.columns.length;i++){let o=e.columns[i];if(o.value){let r=o.value.trim();o.value!==r&&(r===""?t.push(yt("EMPTY_VALUE_WITH_WHITESPACE",`Column '${o.name}' has value with only whitespace`,{column:o.name,columnIndex:i,value:o.value})):t.push(yt("LEADING_TRAILING_WHITESPACE",`Column '${o.name}' has leading/trailing whitespace in value '${o.value}'`,{column:o.name,columnIndex:i,value:o.value,suggestion:`Trim to '${r}'`})))}for(let r of o.modifiers)if(r.value){let s=r.value.trim();if(r.value!==s){let a=r.samples;s===""?t.push(yt("EMPTY_VALUE_WITH_WHITESPACE",`Column '${o.name}' has value with only whitespace for samples ${a}`,{column:o.name,columnIndex:i,value:r.value,row:parseInt(a.split("-")[0])||1})):t.push(yt("LEADING_TRAILING_WHITESPACE",`Column '${o.name}' has leading/trailing whitespace in '${r.value}' for samples ${a}`,{column:o.name,columnIndex:i,value:r.value,row:parseInt(a.split("-")[0])||1,suggestion:`Trim to '${s}'`}))}}}return t}getUniqueValuesToValidate(e){let t=new Set;e.value&&t.add(e.value);for(let i of e.modifiers)i.value&&t.add(i.value);return Array.from(t)}validatePattern(e,t){return t.test(e)}getValidationPatterns(){return E({},To)}getRequiredColumns(){return[...g0]}},p5=new jr;var h0={includePools:!0,lineEnding:"unix",includeBom:!1},zr=class{exportToTsv(e,t={}){let i=E(E({},h0),t),o=[],r=i.lineEnding==="windows"?`\r
`:`
`,s=e.columns.map(f=>f.name);o.push(s.join("	"));let a=Vr(e);for(let f of a)o.push(f.join("	"));if(i.includePools&&e.pools.length>0){for(let f of e.pools)if(f.sdrfValue){let g=this.createPoolRow(e,f);o.push(g.join("	"))}}let u=o.join(r);return i.includeBom&&(u="\uFEFF"+u),u}exportToTsvBlob(e,t={}){let i=this.exportToTsv(e,t);return new Blob([i],{type:"text/tab-separated-values;charset=utf-8"})}downloadTsv(e,t="sdrf.tsv",i={}){let o=this.exportToTsvBlob(e,i);this.downloadBlob(o,t)}exportToExcel(i){return k(this,arguments,function*(e,t={}){let o=yield this.loadXlsx(),r=E(E({},h0),t),s=o.utils.book_new(),a=e.columns.map(T=>T.name),u=Vr(e),f=[a,...u],g=o.utils.aoa_to_sheet(f);o.utils.book_append_sheet(s,g,"main");let h=[["id","column","name","type","hidden"],...e.columns.map((T,F)=>[F,F,T.name,T.type,T.hidden||!1])],b=o.utils.aoa_to_sheet(h);if(o.utils.book_append_sheet(s,b,"id_metadata_column_map"),r.includePools&&e.pools.length>0){let T=[["pool_name","pooled_only_samples","pooled_and_independent_samples","is_reference"],...e.pools.map(U=>[U.poolName,JSON.stringify(U.pooledOnlySamples),JSON.stringify(U.pooledAndIndependentSamples),U.isReference])],F=o.utils.aoa_to_sheet(T);o.utils.book_append_sheet(s,F,"pool_object_map")}let C=o.write(s,{bookType:"xlsx",type:"array"});return new Blob([C],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})})}downloadExcel(o){return k(this,arguments,function*(e,t="sdrf.xlsx",i={}){let r=yield this.exportToExcel(e,i);this.downloadBlob(r,t)})}createPoolRow(e,t){let i=[];for(let o of e.columns){let r=o.name.toLowerCase();if(r==="source name")i.push(t.poolName);else if(r.includes("pooled sample"))i.push(t.sdrfValue);else{let s=t.metadata?.find(a=>a.name.toLowerCase()===r);i.push(s?.value||"")}}return i}downloadBlob(e,t){let i=URL.createObjectURL(e),o=document.createElement("a");o.href=i,o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}loadXlsx(){return k(this,null,function*(){return yield import("./chunk-P2CTJKDX.js")})}},Io=new zr;function Xu(n,e,t){if(t===n.value){n.modifiers=n.modifiers.map(o=>{let s=Ya(o.samples).filter(a=>a!==e);return s.length===0?null:O(E({},o),{samples:Mo(s)})}).filter(o=>o!==null);return}let i=n.modifiers.find(o=>o.value===t);if(i){let o=Ya(i.samples);o.includes(e)||(o.push(e),i.samples=Mo(o))}else n.modifiers.push({samples:String(e),value:t});for(let o of n.modifiers)if(o.value!==t){let s=Ya(o.samples).filter(a=>a!==e);if(s.length===0){let a=n.modifiers.indexOf(o);n.modifiers.splice(a,1)}else o.samples=Mo(s)}}var V1={age:/^characteristics\[age\]$/i,modification:/^comment\[modification parameters\]$/i,cleavage:/^comment\[cleavage agent details\]$/i,spiked_compound:/^characteristics\[spiked compound\]$/i,pooled_sample:/^characteristics\[pooled sample\]$/i,synthetic_peptide:/^characteristics\[synthetic peptide\]$/i},_0=["NT","AC","CF","MT","PP","TA","MM","TS"],C0=["NT","AC","CS"],v0=["SP","CT","QY","PS","AC","CN","CV","CS","CF"],L1=["not pooled","pooled"],y0=["synthetic","not synthetic"],on=class{detectSpecialSyntax(e,t){let i=e.toLowerCase(),o=t?.toLowerCase()||"";for(let[r,s]of Object.entries(V1))if(s.test(i)||s.test(o))return r;return null}parseValue(e,t){if(!t||t.trim()==="")return null;try{switch(e){case"age":return this.parseAgeFormat(t);case"modification":return this.parseKeyValuePairs(t,_0);case"cleavage":return this.parseKeyValuePairs(t,C0);case"spiked_compound":return this.parseKeyValuePairs(t,v0);case"pooled_sample":return this.parsePooledSample(t);case"synthetic_peptide":return{value:t.toLowerCase().trim()};default:throw new Error(`Unknown syntax type: ${e}`)}}catch(i){return console.error(`Error parsing ${e} value:`,i),null}}formatValue(e,t){if(!t)return"";try{switch(e){case"age":return this.formatAgeFormat(t);case"modification":case"cleavage":case"spiked_compound":return this.formatKeyValuePairs(t);case"pooled_sample":return this.formatPooledSample(t);case"synthetic_peptide":return t.value||"";default:throw new Error(`Unknown syntax type: ${e}`)}}catch(i){return console.error(`Error formatting ${e} value:`,i),""}}validateValue(e,t){let i={isValid:!0,errors:[],warnings:[]};if(!t)return i.isValid=!1,i.errors.push("Value is required"),i;try{switch(e){case"age":return this.validateAgeFormat(t);case"modification":return this.validateModificationParameters(t);case"cleavage":return this.validateCleavageAgentDetails(t);case"spiked_compound":return this.validateSpikedCompound(t);case"pooled_sample":return this.validatePooledSample(t);case"synthetic_peptide":return this.validateSyntheticPeptide(t);default:i.isValid=!1,i.errors.push(`Unknown syntax type: ${e}`)}}catch(o){i.isValid=!1,i.errors.push(`Validation error: ${o}`)}return i}parseAgeFormat(e){let t=e.trim();if(t.includes("-")&&!t.startsWith("-")){let i=t.split("-");if(i.length===2)return{isRange:!0,rangeStart:this.parseSingleAge(i[0].trim()),rangeEnd:this.parseSingleAge(i[1].trim())}}return this.parseSingleAge(t)}parseSingleAge(e){let t={},i=e.match(/(\d+)Y/i),o=e.match(/(\d+)M/i),r=e.match(/(\d+)D/i);return i&&(t.years=parseInt(i[1],10)),o&&(t.months=parseInt(o[1],10)),r&&(t.days=parseInt(r[1],10)),t}formatAgeFormat(e){return e.isRange&&e.rangeStart&&e.rangeEnd?`${this.formatSingleAge(e.rangeStart)}-${this.formatSingleAge(e.rangeEnd)}`:this.formatSingleAge(e)}formatSingleAge(e){let t="";return e.years!==void 0&&e.years>0&&(t+=`${e.years}Y`),e.months!==void 0&&e.months>0&&(t+=`${e.months}M`),e.days!==void 0&&e.days>0&&(t+=`${e.days}D`),t}validateAgeFormat(e){let t={isValid:!0,errors:[],warnings:[]};if(e.isRange){if(!e.rangeStart||!e.rangeEnd)return t.isValid=!1,t.errors.push("Range format requires both start and end values"),t;let i=this.validateSingleAge(e.rangeStart),o=this.validateSingleAge(e.rangeEnd);i.isValid||(t.isValid=!1,t.errors.push(...i.errors.map(r=>`Range start: ${r}`))),o.isValid||(t.isValid=!1,t.errors.push(...o.errors.map(r=>`Range end: ${r}`)))}else{let i=this.validateSingleAge(e);i.isValid||(t.isValid=!1,t.errors.push(...i.errors))}return t}validateSingleAge(e){let t={isValid:!0,errors:[]};return e.years===void 0&&e.months===void 0&&e.days===void 0&&(t.isValid=!1,t.errors.push("At least one age component (years, months, or days) is required")),e.years!==void 0&&(e.years<0||e.years>200)&&(t.isValid=!1,t.errors.push("Years must be between 0 and 200")),e.months!==void 0&&(e.months<0||e.months>11)&&(t.isValid=!1,t.errors.push("Months must be between 0 and 11")),e.days!==void 0&&(e.days<0||e.days>31)&&(t.isValid=!1,t.errors.push("Days must be between 0 and 31")),t}parseKeyValuePairs(e,t){let i={},o=e.split(";").map(r=>r.trim()).filter(r=>r);for(let r of o){let[s,...a]=r.split("="),u=s?.trim(),f=a.join("=").trim();u&&t.includes(u)&&(i[u]=f)}return i}formatKeyValuePairs(e){let t=[];for(let[i,o]of Object.entries(e))o!=null&&o!==""&&t.push(`${i}=${o}`);return t.join(";")}validateModificationParameters(e){let t={isValid:!0,errors:[],warnings:[]};return Object.values(e).some(o=>o!==void 0&&o!=="")||(t.isValid=!1,t.errors.push("At least one modification parameter is required")),e.NT||t.warnings?.push("NT (Name of Term) is recommended"),e.TA||t.warnings?.push("TA (Target Amino acid) is recommended"),e.PP&&!/^\d+$/.test(e.PP)&&(["Anywhere","Protein N-term","Protein C-term","Any N-term","Any C-term"].some(r=>r.toLowerCase()===e.PP?.toLowerCase())||t.warnings?.push("PP (position) should be a number or standard position term")),e.MM&&!/^-?\d+(\.\d+)?$/.test(e.MM)&&(t.errors.push("MM (monoisotopic mass) must be a valid number"),t.isValid=!1),t}validateCleavageAgentDetails(e){let t={isValid:!0,errors:[],warnings:[]};return Object.values(e).some(o=>o!==void 0&&o!=="")||(t.isValid=!1,t.errors.push("At least one cleavage agent detail is required")),e.NT||t.warnings?.push("NT (Name of Term) is recommended"),t}validateSpikedCompound(e){let t={isValid:!0,errors:[],warnings:[]};return Object.values(e).some(o=>o!==void 0&&o!=="")||(t.isValid=!1,t.errors.push("At least one spiked compound parameter is required")),e.QY&&!/^\d+(\.\d+)?\s*(mg|g|kg|g|ng|pg|M|mM|M|nM|pM|fmol|pmol|nmol)?$/i.test(e.QY)&&t.warnings?.push("QY (quantity) format may not be standard - consider using standard units"),t}parsePooledSample(e){let t=e.trim(),i=t.toLowerCase();if(i==="not pooled"||i==="pooled")return{value:i};if(t.startsWith("SN=")){let o=t.substring(3).split(",").map(r=>r.trim()).filter(r=>r);return{value:t,sourceNames:o}}return{value:t}}formatPooledSample(e){return e.sourceNames&&e.sourceNames.length>0?`SN=${e.sourceNames.join(",")}`:e.value}validatePooledSample(e){let t={isValid:!0,errors:[],warnings:[]},i=e.value.toLowerCase();return i!=="not pooled"&&i!=="pooled"&&!e.value.startsWith("SN=")&&t.warnings?.push('Pooled sample should be "not pooled", "pooled", or use SN= format'),e.value.startsWith("SN=")&&(!e.sourceNames||e.sourceNames.length===0)&&(t.isValid=!1,t.errors.push("SN= format requires at least one source name")),t}validateSyntheticPeptide(e){let t={isValid:!0,errors:[],warnings:[]};return y0.includes(e.value.toLowerCase())||t.warnings?.push('Synthetic peptide should be "synthetic" or "not synthetic"'),t}getPooledSampleValues(){return[...L1]}getSyntheticPeptideValues(){return[...y0]}getModificationKeys(){return[..._0]}getCleavageKeys(){return[...C0]}getSpikedCompoundKeys(){return[...v0]}},M5=new on;function j1(n,e){if(n&1){let t=N();c(0,"div",3)(1,"div",8)(2,"label"),d(3,"From:"),l(),c(4,"div",9)(5,"input",10),_("ngModelChange",function(o){v(t);let r=m();return y(r.updateStartYears(o))}),l(),c(6,"span"),d(7,"Y"),l(),c(8,"input",11),_("ngModelChange",function(o){v(t);let r=m();return y(r.updateStartMonths(o))}),l(),c(9,"span"),d(10,"M"),l(),c(11,"input",12),_("ngModelChange",function(o){v(t);let r=m();return y(r.updateStartDays(o))}),l(),c(12,"span"),d(13,"D"),l()()(),c(14,"div",8)(15,"label"),d(16,"To:"),l(),c(17,"div",9)(18,"input",10),_("ngModelChange",function(o){v(t);let r=m();return y(r.updateEndYears(o))}),l(),c(19,"span"),d(20,"Y"),l(),c(21,"input",11),_("ngModelChange",function(o){v(t);let r=m();return y(r.updateEndMonths(o))}),l(),c(22,"span"),d(23,"M"),l(),c(24,"input",12),_("ngModelChange",function(o){v(t);let r=m();return y(r.updateEndDays(o))}),l(),c(25,"span"),d(26,"D"),l()()()()}if(n&2){let t=m();p(5),I("ngModel",t.startYears()),p(3),I("ngModel",t.startMonths()),p(3),I("ngModel",t.startDays()),p(7),I("ngModel",t.endYears()),p(3),I("ngModel",t.endMonths()),p(3),I("ngModel",t.endDays())}}function z1(n,e){if(n&1){let t=N();c(0,"div",4)(1,"div",9)(2,"input",13),_("ngModelChange",function(o){v(t);let r=m();return y(r.updateYears(o))}),l(),c(3,"span"),d(4,"Y"),l(),c(5,"input",14),_("ngModelChange",function(o){v(t);let r=m();return y(r.updateMonths(o))}),l(),c(6,"span"),d(7,"M"),l(),c(8,"input",15),_("ngModelChange",function(o){v(t);let r=m();return y(r.updateDays(o))}),l(),c(9,"span"),d(10,"D"),l()()()}if(n&2){let t=m();p(2),I("ngModel",t.years()),p(3),I("ngModel",t.months()),p(3),I("ngModel",t.days())}}function $1(n,e){if(n&1&&(c(0,"span",16),d(1),l()),n&2){let t=e.$implicit;p(),P(t)}}function B1(n,e){if(n&1&&(c(0,"div",7),z(1,$1,2,1,"span",16,Ve),l()),n&2){let t=m();p(),$(t.validationErrors())}}var Ka=class n{value="";valueChange=new W;syntaxService=new on;years=w(null);months=w(null);days=w(null);isRange=w(!1);startYears=w(null);startMonths=w(null);startDays=w(null);endYears=w(null);endMonths=w(null);endDays=w(null);validationErrors=w([]);formattedValue=A(()=>{if(this.isRange()){let e=this.formatSingleAge(this.startYears(),this.startMonths(),this.startDays()),t=this.formatSingleAge(this.endYears(),this.endMonths(),this.endDays());return e&&t?`${e}-${t}`:""}else return this.formatSingleAge(this.years(),this.months(),this.days())});ngOnInit(){this.parseValue()}ngOnChanges(e){e.value&&!e.value.firstChange&&this.parseValue()}parseValue(){if(!this.value){this.resetFields();return}let e=this.syntaxService.parseValue("age",this.value);if(!e){this.resetFields();return}e.isRange&&e.rangeStart&&e.rangeEnd?(this.isRange.set(!0),this.startYears.set(e.rangeStart.years??null),this.startMonths.set(e.rangeStart.months??null),this.startDays.set(e.rangeStart.days??null),this.endYears.set(e.rangeEnd.years??null),this.endMonths.set(e.rangeEnd.months??null),this.endDays.set(e.rangeEnd.days??null)):(this.isRange.set(!1),this.years.set(e.years??null),this.months.set(e.months??null),this.days.set(e.days??null))}resetFields(){this.years.set(null),this.months.set(null),this.days.set(null),this.startYears.set(null),this.startMonths.set(null),this.startDays.set(null),this.endYears.set(null),this.endMonths.set(null),this.endDays.set(null)}toggleRange(){this.isRange.set(!this.isRange()),this.emitValue()}updateYears(e){this.years.set(e),this.emitValue()}updateMonths(e){this.months.set(e),this.emitValue()}updateDays(e){this.days.set(e),this.emitValue()}updateStartYears(e){this.startYears.set(e),this.emitValue()}updateStartMonths(e){this.startMonths.set(e),this.emitValue()}updateStartDays(e){this.startDays.set(e),this.emitValue()}updateEndYears(e){this.endYears.set(e),this.emitValue()}updateEndMonths(e){this.endMonths.set(e),this.emitValue()}updateEndDays(e){this.endDays.set(e),this.emitValue()}formatSingleAge(e,t,i){let o="";return e!==null&&e>0&&(o+=`${e}Y`),t!==null&&t>0&&(o+=`${t}M`),i!==null&&i>0&&(o+=`${i}D`),o}emitValue(){let e=this.formattedValue();this.validate(e),this.valueChange.emit(e)}validate(e){if(!e){this.validationErrors.set([]);return}let t=this.syntaxService.parseValue("age",e);if(t){let i=this.syntaxService.validateValue("age",t);this.validationErrors.set(i.errors)}else this.validationErrors.set(["Invalid age format"])}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ee({type:n,selectors:[["sdrf-age-input"]],inputs:{value:"value"},outputs:{valueChange:"valueChange"},features:[Fe],decls:13,vars:4,consts:[[1,"age-input-container"],[1,"age-mode-toggle"],["type","checkbox",3,"change","checked"],[1,"age-range"],[1,"age-single"],[1,"age-preview"],[1,"label"],[1,"validation-errors"],[1,"age-group"],[1,"age-fields"],["type","number","min","0","max","200","placeholder","Y",1,"age-field",3,"ngModelChange","ngModel"],["type","number","min","0","max","11","placeholder","M",1,"age-field",3,"ngModelChange","ngModel"],["type","number","min","0","max","31","placeholder","D",1,"age-field",3,"ngModelChange","ngModel"],["type","number","min","0","max","200","placeholder","Years",1,"age-field",3,"ngModelChange","ngModel"],["type","number","min","0","max","11","placeholder","Months",1,"age-field",3,"ngModelChange","ngModel"],["type","number","min","0","max","31","placeholder","Days",1,"age-field",3,"ngModelChange","ngModel"],[1,"error"]],template:function(t,i){t&1&&(c(0,"div",0)(1,"div",1)(2,"label")(3,"input",2),_("change",function(){return i.toggleRange()}),l(),d(4," Age Range "),l()(),x(5,j1,27,6,"div",3)(6,z1,11,3,"div",4),c(7,"div",5)(8,"span",6),d(9,"Output:"),l(),c(10,"code"),d(11),l()(),x(12,B1,3,0,"div",7),l()),t&2&&(p(3),I("checked",i.isRange()),p(2),S(i.isRange()?5:6),p(6),P(i.formattedValue()||"(empty)"),p(),S(i.validationErrors().length>0?12:-1))},dependencies:[te,ce,ye,tn,Me,nn,Rn,xe],styles:[".age-input-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;padding:12px;border:1px solid #ddd;border-radius:4px;background:#fafafa}.age-mode-toggle[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-size:13px;cursor:pointer}.age-range[_ngcontent-%COMP%], .age-single[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.age-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.age-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{min-width:40px;font-size:13px;font-weight:500}.age-fields[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}.age-field[_ngcontent-%COMP%]{width:60px;padding:6px 8px;border:1px solid #ccc;border-radius:4px;font-size:13px;text-align:center}.age-field[_ngcontent-%COMP%]:focus{outline:none;border-color:#2196f3;box-shadow:0 0 0 2px #2196f333}.age-fields[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;color:#666;min-width:12px}.age-preview[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px;background:#fff;border:1px solid #e0e0e0;border-radius:4px}.age-preview[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:12px;color:#666}.age-preview[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{font-family:monospace;font-size:13px;color:#333}.validation-errors[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.validation-errors[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{font-size:12px;color:#d32f2f}"]})};var H1=[{accession:"UNIMOD:4",name:"Carbamidomethyl",deltaMonoMass:57.021464,deltaComposition:"H3C2NO",sites:["C"],positions:["Anywhere"],specifications:[{site:"C",position:"Anywhere",classification:"Chemical derivatization",hidden:!1}]},{accession:"UNIMOD:35",name:"Oxidation",deltaMonoMass:15.994915,deltaComposition:"O",sites:["M","W","H","C","P","F","Y"],positions:["Anywhere"],specifications:[{site:"M",position:"Anywhere",classification:"Post-translational",hidden:!1},{site:"W",position:"Anywhere",classification:"Post-translational",hidden:!1},{site:"H",position:"Anywhere",classification:"Post-translational",hidden:!0}]},{accession:"UNIMOD:1",name:"Acetyl",deltaMonoMass:42.010565,deltaComposition:"H2C2O",sites:["K","N-term"],positions:["Protein N-term","Any N-term","Anywhere"],specifications:[{site:"K",position:"Anywhere",classification:"Post-translational",hidden:!1},{site:"N-term",position:"Protein N-term",classification:"Post-translational",hidden:!1}]},{accession:"UNIMOD:21",name:"Phospho",deltaMonoMass:79.966331,deltaComposition:"HO3P",sites:["S","T","Y","H","D"],positions:["Anywhere"],specifications:[{site:"S",position:"Anywhere",classification:"Post-translational",hidden:!1},{site:"T",position:"Anywhere",classification:"Post-translational",hidden:!1},{site:"Y",position:"Anywhere",classification:"Post-translational",hidden:!1}]},{accession:"UNIMOD:7",name:"Deamidated",deltaMonoMass:.984016,deltaComposition:"H-1NO",sites:["N","Q"],positions:["Anywhere"],specifications:[{site:"N",position:"Anywhere",classification:"Post-translational",hidden:!1},{site:"Q",position:"Anywhere",classification:"Post-translational",hidden:!1}]},{accession:"UNIMOD:121",name:"GlyGly",deltaMonoMass:114.042927,deltaComposition:"H6C4N2O2",sites:["K"],positions:["Anywhere"],specifications:[{site:"K",position:"Anywhere",classification:"Post-translational",hidden:!1}]},{accession:"UNIMOD:36",name:"Dimethyl",deltaMonoMass:28.0313,deltaComposition:"H4C2",sites:["K","N-term","R"],positions:["Anywhere","Any N-term"],specifications:[{site:"K",position:"Anywhere",classification:"Chemical derivatization",hidden:!1},{site:"N-term",position:"Any N-term",classification:"Chemical derivatization",hidden:!1}]},{accession:"UNIMOD:34",name:"Methyl",deltaMonoMass:14.01565,deltaComposition:"H2C",sites:["K","R","E","D","C","H","S"],positions:["Anywhere"],specifications:[{site:"K",position:"Anywhere",classification:"Post-translational",hidden:!1},{site:"R",position:"Anywhere",classification:"Post-translational",hidden:!1}]},{accession:"UNIMOD:5",name:"Carbamyl",deltaMonoMass:43.005814,deltaComposition:"HCNO",sites:["K","N-term","R","C","M"],positions:["Anywhere","Any N-term"],specifications:[{site:"K",position:"Anywhere",classification:"Artefact",hidden:!1},{site:"N-term",position:"Any N-term",classification:"Artefact",hidden:!1}]},{accession:"UNIMOD:737",name:"TMT6plex",deltaMonoMass:229.162932,deltaComposition:"H20C12N2O2",sites:["K","N-term"],positions:["Anywhere","Any N-term"],specifications:[{site:"K",position:"Anywhere",classification:"Chemical derivatization",hidden:!1},{site:"N-term",position:"Any N-term",classification:"Chemical derivatization",hidden:!1}]},{accession:"UNIMOD:2016",name:"TMTpro",deltaMonoMass:304.207146,deltaComposition:"H25C15N3O3",sites:["K","N-term"],positions:["Anywhere","Any N-term"],specifications:[{site:"K",position:"Anywhere",classification:"Chemical derivatization",hidden:!1},{site:"N-term",position:"Any N-term",classification:"Chemical derivatization",hidden:!1}]},{accession:"UNIMOD:214",name:"iTRAQ4plex",deltaMonoMass:144.102063,deltaComposition:"H12C4C*3N2O",sites:["K","N-term","Y"],positions:["Anywhere","Any N-term"],specifications:[{site:"K",position:"Anywhere",classification:"Chemical derivatization",hidden:!1},{site:"N-term",position:"Any N-term",classification:"Chemical derivatization",hidden:!1}]},{accession:"UNIMOD:730",name:"Label:13C(6)15N(2)",deltaMonoMass:8.014199,deltaComposition:"C*6N*2C-6N-2",sites:["K"],positions:["Anywhere"],specifications:[{site:"K",position:"Anywhere",classification:"Isotopic label",hidden:!1}]},{accession:"UNIMOD:259",name:"Label:13C(6)15N(4)",deltaMonoMass:10.008269,deltaComposition:"C*6N*4C-6N-4",sites:["R"],positions:["Anywhere"],specifications:[{site:"R",position:"Anywhere",classification:"Isotopic label",hidden:!1}]},{accession:"UNIMOD:188",name:"Label:13C(6)",deltaMonoMass:6.020129,deltaComposition:"C*6C-6",sites:["K","R","L","I"],positions:["Anywhere"],specifications:[{site:"K",position:"Anywhere",classification:"Isotopic label",hidden:!1},{site:"R",position:"Anywhere",classification:"Isotopic label",hidden:!1}]},{accession:"UNIMOD:267",name:"Pyro-carbamidomethyl",deltaMonoMass:39.994915,deltaComposition:"C2H2NO-H2O",sites:["C"],positions:["N-term"],specifications:[{site:"C",position:"Any N-term",classification:"Post-translational",hidden:!1}]},{accession:"UNIMOD:27",name:"Gln->pyro-Glu",deltaMonoMass:-17.026549,deltaComposition:"H-3N-1",sites:["Q"],positions:["N-term"],specifications:[{site:"Q",position:"Any N-term",classification:"Post-translational",hidden:!1}]},{accession:"UNIMOD:28",name:"Glu->pyro-Glu",deltaMonoMass:-18.010565,deltaComposition:"H-2O-1",sites:["E"],positions:["N-term"],specifications:[{site:"E",position:"Any N-term",classification:"Post-translational",hidden:!1}]}],$r=class{modifications=new Map;modificationsByName=new Map;loaded=!1;loadPromise=null;loadDatabase(){return k(this,null,function*(){if(!this.loaded)return this.loadPromise?this.loadPromise:(this.loadPromise=this.doLoad(),this.loadPromise)})}doLoad(){return k(this,null,function*(){for(let e of H1)this.modifications.set(e.accession,e),this.modificationsByName.set(e.name.toLowerCase(),e);this.loaded=!0})}searchModifications(e,t=10){return k(this,null,function*(){if(yield this.loadDatabase(),!e||e.trim()==="")return[];let i=e.toLowerCase().trim(),o=[],r=new Set;for(let s of this.modifications.values())if(!r.has(s.accession)&&((s.name.toLowerCase()===i||s.accession.toLowerCase()===i)&&(o.push(s),r.add(s.accession)),o.length>=t))break;if(o.length<t){for(let s of this.modifications.values())if(!r.has(s.accession)&&((s.name.toLowerCase().startsWith(i)||s.accession.toLowerCase().startsWith(i))&&(o.push(s),r.add(s.accession)),o.length>=t))break}if(o.length<t){for(let s of this.modifications.values())if(!r.has(s.accession)&&((s.name.toLowerCase().includes(i)||s.accession.toLowerCase().includes(i))&&(o.push(s),r.add(s.accession)),o.length>=t))break}return o})}getByAccession(e){return k(this,null,function*(){yield this.loadDatabase();let t=e.toUpperCase();return t.startsWith("UNIMOD:")||(t=`UNIMOD:${t}`),this.modifications.get(t)})}getByName(e){return k(this,null,function*(){return yield this.loadDatabase(),this.modificationsByName.get(e.toLowerCase())})}getModificationsForSite(e,t=50){return k(this,null,function*(){yield this.loadDatabase();let i=e.toUpperCase(),o=[];for(let r of this.modifications.values())if(r.sites.includes(i)&&(o.push(r),o.length>=t))break;return o})}getAllModifications(){return k(this,null,function*(){return yield this.loadDatabase(),Array.from(this.modifications.values())})}getCount(){return k(this,null,function*(){return yield this.loadDatabase(),this.modifications.size})}formatForSdrf(e,t,i="Variable"){return[`NT=${e.name}`,`TA=${t}`,`MT=${i}`,`AC=${e.accession}`].join(";")}isValidAccession(e){return k(this,null,function*(){return(yield this.getByAccession(e))!==void 0})}},z5=new $r;var U1=(n,e)=>e.accession;function q1(n,e){if(n&1){let t=N();c(0,"div",24),_("click",function(){let o=v(t).$implicit,r=m(2);return y(r.selectSuggestion(o))}),c(1,"span",25),d(2),l(),c(3,"span",26),d(4),l(),c(5,"span",27),d(6),l()()}if(n&2){let t=e.$implicit;p(2),P(t.name),p(2),P(t.accession),p(2),j("\u0394",t.deltaMonoMass.toFixed(4))}}function W1(n,e){if(n&1&&(c(0,"div",4),z(1,q1,7,3,"div",23,U1),l()),n&2){let t=m();p(),$(t.suggestions())}}function G1(n,e){if(n&1&&(c(0,"div",6),d(1),l()),n&2){let t=m();p(),j(" Valid sites: ",t.selectedMod().sites.join(", ")," ")}}function Q1(n,e){if(n&1&&(c(0,"span",28),d(1),l()),n&2){let t=e.$implicit;p(),P(t)}}function Y1(n,e){if(n&1&&(c(0,"div",22),z(1,Q1,2,1,"span",28,Ve),l()),n&2){let t=m();p(),$(t.validationErrors())}}var Za=class n{value="";valueChange=new W;syntaxService=new on;unimodService=new $r;nt=w("");ta=w("");mt=w("");ac=w("");pp=w("");cf=w("");mm=w("");suggestions=w([]);selectedMod=w(null);validationErrors=w([]);formattedValue=A(()=>{let e={};return this.nt()&&(e.NT=this.nt()),this.ta()&&(e.TA=this.ta()),this.mt()&&(e.MT=this.mt()),this.ac()&&(e.AC=this.ac()),this.pp()&&(e.PP=this.pp()),this.cf()&&(e.CF=this.cf()),this.mm()&&(e.MM=this.mm()),this.syntaxService.formatValue("modification",e)});ngOnInit(){this.parseValue()}ngOnChanges(e){e.value&&!e.value.firstChange&&this.parseValue()}parseValue(){if(!this.value){this.resetFields();return}let e=this.syntaxService.parseValue("modification",this.value);e?(this.nt.set(e.NT||""),this.ta.set(e.TA||""),this.mt.set(e.MT||""),this.ac.set(e.AC||""),this.pp.set(e.PP||""),this.cf.set(e.CF||""),this.mm.set(e.MM||""),e.AC&&this.unimodService.getByAccession(e.AC).then(t=>{this.selectedMod.set(t||null)})):this.resetFields()}resetFields(){this.nt.set(""),this.ta.set(""),this.mt.set(""),this.ac.set(""),this.pp.set(""),this.cf.set(""),this.mm.set(""),this.selectedMod.set(null)}updateNt(e){this.nt.set(e),this.emitValue()}updateTa(e){this.ta.set(e.toUpperCase()),this.emitValue()}updateMt(e){this.mt.set(e),this.emitValue()}updateAc(e){this.ac.set(e),this.emitValue()}updatePp(e){this.pp.set(e),this.emitValue()}updateCf(e){this.cf.set(e),this.emitValue()}updateMm(e){this.mm.set(e),this.emitValue()}onNtInput(e){return k(this,null,function*(){let i=e.target.value.trim();if(i.length<2){this.suggestions.set([]);return}let o=yield this.unimodService.searchModifications(i,8);this.suggestions.set(o)})}selectSuggestion(e){this.nt.set(e.name),this.ac.set(e.accession),this.cf.set(e.deltaComposition),this.mm.set(e.deltaMonoMass.toString()),this.selectedMod.set(e),this.suggestions.set([]),e.sites.length===1&&this.ta.set(e.sites[0]),e.positions.length===1&&this.pp.set(e.positions[0]),this.emitValue()}emitValue(){let e=this.formattedValue();this.validate(e),this.valueChange.emit(e)}validate(e){if(!e){this.validationErrors.set([]);return}let t=this.syntaxService.parseValue("modification",e);if(t){let i=this.syntaxService.validateValue("modification",t);this.validationErrors.set([...i.errors,...i.warnings||[]])}else this.validationErrors.set(["Invalid modification format"])}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ee({type:n,selectors:[["sdrf-modification-input"]],inputs:{value:"value"},outputs:{valueChange:"valueChange"},features:[Fe],decls:58,vars:11,consts:[[1,"modification-input-container"],[1,"field-group"],[1,"autocomplete-wrapper"],["type","text","placeholder","e.g., Oxidation, Carbamidomethyl",1,"field-input",3,"ngModelChange","input","ngModel"],[1,"suggestions-dropdown"],["type","text","placeholder","e.g., M, K, C","maxlength","10",1,"field-input",3,"ngModelChange","ngModel"],[1,"hint"],[1,"field-input",3,"ngModelChange","ngModel"],["value",""],["value","Fixed"],["value","Variable"],["value","Annotated"],["type","text","placeholder","e.g., UNIMOD:35",1,"field-input",3,"ngModelChange","ngModel"],["value","Anywhere"],["value","Protein N-term"],["value","Protein C-term"],["value","Any N-term"],["value","Any C-term"],["type","text","placeholder","e.g., O, H3C2NO",1,"field-input",3,"ngModelChange","ngModel"],["type","text","placeholder","e.g., 15.994915",1,"field-input",3,"ngModelChange","ngModel"],[1,"output-preview"],[1,"label"],[1,"validation-errors"],[1,"suggestion-item"],[1,"suggestion-item",3,"click"],[1,"suggestion-name"],[1,"suggestion-accession"],[1,"suggestion-mass"],[1,"error"]],template:function(t,i){t&1&&(c(0,"div",0)(1,"div",1)(2,"label"),d(3,"Name of Term (NT)*"),l(),c(4,"div",2)(5,"input",3),_("ngModelChange",function(r){return i.updateNt(r)})("input",function(r){return i.onNtInput(r)}),l(),x(6,W1,3,0,"div",4),l()(),c(7,"div",1)(8,"label"),d(9,"Target Amino Acid (TA)*"),l(),c(10,"input",5),_("ngModelChange",function(r){return i.updateTa(r)}),l(),x(11,G1,2,1,"div",6),l(),c(12,"div",1)(13,"label"),d(14,"Modification Type (MT)"),l(),c(15,"select",7),_("ngModelChange",function(r){return i.updateMt(r)}),c(16,"option",8),d(17,"-- Select --"),l(),c(18,"option",9),d(19,"Fixed"),l(),c(20,"option",10),d(21,"Variable"),l(),c(22,"option",11),d(23,"Annotated"),l()()(),c(24,"div",1)(25,"label"),d(26,"Accession (AC)"),l(),c(27,"input",12),_("ngModelChange",function(r){return i.updateAc(r)}),l()(),c(28,"div",1)(29,"label"),d(30,"Position (PP)"),l(),c(31,"select",7),_("ngModelChange",function(r){return i.updatePp(r)}),c(32,"option",8),d(33,"-- Select --"),l(),c(34,"option",13),d(35,"Anywhere"),l(),c(36,"option",14),d(37,"Protein N-term"),l(),c(38,"option",15),d(39,"Protein C-term"),l(),c(40,"option",16),d(41,"Any N-term"),l(),c(42,"option",17),d(43,"Any C-term"),l()()(),c(44,"div",1)(45,"label"),d(46,"Chemical Formula (CF)"),l(),c(47,"input",18),_("ngModelChange",function(r){return i.updateCf(r)}),l()(),c(48,"div",1)(49,"label"),d(50,"Monoisotopic Mass (MM)"),l(),c(51,"input",19),_("ngModelChange",function(r){return i.updateMm(r)}),l()(),c(52,"div",20)(53,"span",21),d(54,"Output:"),l(),c(55,"code"),d(56),l()(),x(57,Y1,3,0,"div",22),l()),t&2&&(p(5),I("ngModel",i.nt()),p(),S(i.suggestions().length>0?6:-1),p(4),I("ngModel",i.ta()),p(),S(i.selectedMod()&&i.selectedMod().sites.length>0?11:-1),p(4),I("ngModel",i.mt()),p(12),I("ngModel",i.ac()),p(4),I("ngModel",i.pp()),p(16),I("ngModel",i.cf()),p(4),I("ngModel",i.mm()),p(5),P(i.formattedValue()||"(empty)"),p(),S(i.validationErrors().length>0?57:-1))},dependencies:[te,ce,Ue,qe,ye,st,Me,Ku,xe],styles:[".modification-input-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;padding:12px;border:1px solid #ddd;border-radius:4px;background:#fafafa}.field-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.field-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px;font-weight:500;color:#333}.field-input[_ngcontent-%COMP%]{padding:8px;border:1px solid #ccc;border-radius:4px;font-size:13px}.field-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#2196f3;box-shadow:0 0 0 2px #2196f333}select.field-input[_ngcontent-%COMP%]{background:#fff}.autocomplete-wrapper[_ngcontent-%COMP%]{position:relative}.suggestions-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;right:0;max-height:200px;overflow-y:auto;background:#fff;border:1px solid #ddd;border-top:none;border-radius:0 0 4px 4px;box-shadow:0 4px 6px #0000001a;z-index:100}.suggestion-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 12px;cursor:pointer;border-bottom:1px solid #eee}.suggestion-item[_ngcontent-%COMP%]:hover{background:#f5f5f5}.suggestion-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.suggestion-name[_ngcontent-%COMP%]{font-weight:500;flex:1}.suggestion-accession[_ngcontent-%COMP%]{font-size:11px;color:#666;font-family:monospace}.suggestion-mass[_ngcontent-%COMP%]{font-size:11px;color:#999}.hint[_ngcontent-%COMP%]{font-size:11px;color:#666;margin-top:2px}.output-preview[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:8px;padding:8px;background:#fff;border:1px solid #e0e0e0;border-radius:4px;margin-top:8px}.output-preview[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:12px;color:#666;flex-shrink:0}.output-preview[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{font-family:monospace;font-size:12px;color:#333;word-break:break-all}.validation-errors[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.validation-errors[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{font-size:12px;color:#d32f2f}"]})};var K1=(n,e)=>e.accession;function Z1(n,e){if(n&1&&(c(0,"option",4),d(1),l()),n&2){let t=e.$implicit;I("value",t.accession),p(),P(t.name)}}function J1(n,e){if(n&1&&(c(0,"span",12),d(1),l()),n&2){let t=e.$implicit;p(),P(t)}}function X1(n,e){if(n&1&&(c(0,"div",11),z(1,J1,2,1,"span",12,Ve),l()),n&2){let t=m();p(),$(t.validationErrors())}}var eS=[{name:"Trypsin",accession:"MS:1001251",site:"[KR]|{P}"},{name:"Trypsin/P",accession:"MS:1001313",site:"[KR]"},{name:"Lys-C",accession:"MS:1001309",site:"K|"},{name:"Lys-N",accession:"MS:1001310",site:"|K"},{name:"Arg-C",accession:"MS:1001303",site:"R|{P}"},{name:"Asp-N",accession:"MS:1001304",site:"|D"},{name:"Chymotrypsin",accession:"MS:1001306",site:"[FYWL]|{P}"},{name:"Glu-C",accession:"MS:1001917",site:"[DE]|{P}"},{name:"PepsinA",accession:"MS:1001311",site:"[FL]|"},{name:"CNBr",accession:"MS:1001307",site:"M|"},{name:"no cleavage",accession:"MS:1001955",site:""},{name:"unspecific cleavage",accession:"MS:1001956",site:""}],Ja=class n{value="";valueChange=new W;syntaxService=new on;commonAgents=eS;nt=w("");ac=w("");cs=w("");validationErrors=w([]);formattedValue=A(()=>{let e={};return this.nt()&&(e.NT=this.nt()),this.ac()&&(e.AC=this.ac()),this.cs()&&(e.CS=this.cs()),this.syntaxService.formatValue("cleavage",e)});ngOnInit(){this.parseValue()}ngOnChanges(e){e.value&&!e.value.firstChange&&this.parseValue()}parseValue(){if(!this.value){this.resetFields();return}let e=this.syntaxService.parseValue("cleavage",this.value);e?(this.nt.set(e.NT||""),this.ac.set(e.AC||""),this.cs.set(e.CS||"")):this.resetFields()}resetFields(){this.nt.set(""),this.ac.set(""),this.cs.set("")}selectPreset(e){let t=e.target,i=t.value;if(!i)return;let o=this.commonAgents.find(r=>r.accession===i);o&&(this.nt.set(o.name),this.ac.set(o.accession),this.cs.set(o.site),this.emitValue()),t.value=""}updateNt(e){this.nt.set(e),this.emitValue()}updateAc(e){this.ac.set(e),this.emitValue()}updateCs(e){this.cs.set(e),this.emitValue()}emitValue(){let e=this.formattedValue();this.validate(e),this.valueChange.emit(e)}validate(e){if(!e){this.validationErrors.set([]);return}let t=this.syntaxService.parseValue("cleavage",e);if(t){let i=this.syntaxService.validateValue("cleavage",t);this.validationErrors.set([...i.errors,...i.warnings||[]])}else this.validationErrors.set(["Invalid cleavage agent format"])}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ee({type:n,selectors:[["sdrf-cleavage-input"]],inputs:{value:"value"},outputs:{valueChange:"valueChange"},features:[Fe],decls:29,vars:5,consts:[[1,"cleavage-input-container"],[1,"field-group"],[1,"field-input",3,"change"],["value",""],[3,"value"],["type","text","placeholder","e.g., Trypsin",1,"field-input",3,"ngModelChange","ngModel"],["type","text","placeholder","e.g., MS:1001251",1,"field-input",3,"ngModelChange","ngModel"],["type","text","placeholder","e.g., [KR]|{P}",1,"field-input",3,"ngModelChange","ngModel"],[1,"hint"],[1,"output-preview"],[1,"label"],[1,"validation-errors"],[1,"error"]],template:function(t,i){t&1&&(c(0,"div",0)(1,"div",1)(2,"label"),d(3,"Quick Select"),l(),c(4,"select",2),_("change",function(r){return i.selectPreset(r)}),c(5,"option",3),d(6,"-- Select common enzyme --"),l(),z(7,Z1,2,2,"option",4,K1),l()(),c(9,"div",1)(10,"label"),d(11,"Name of Term (NT)*"),l(),c(12,"input",5),_("ngModelChange",function(r){return i.updateNt(r)}),l()(),c(13,"div",1)(14,"label"),d(15,"Accession (AC)"),l(),c(16,"input",6),_("ngModelChange",function(r){return i.updateAc(r)}),l()(),c(17,"div",1)(18,"label"),d(19,"Cleavage Site Regex (CS)"),l(),c(20,"input",7),_("ngModelChange",function(r){return i.updateCs(r)}),l(),c(21,"div",8),d(22," Format: [allowed]|{not allowed} \u2014 e.g., [KR]|{P} means cleave after K or R, not followed by P "),l()(),c(23,"div",9)(24,"span",10),d(25,"Output:"),l(),c(26,"code"),d(27),l()(),x(28,X1,3,0,"div",11),l()),t&2&&(p(7),$(i.commonAgents),p(5),I("ngModel",i.nt()),p(4),I("ngModel",i.ac()),p(4),I("ngModel",i.cs()),p(7),P(i.formattedValue()||"(empty)"),p(),S(i.validationErrors().length>0?28:-1))},dependencies:[te,ce,Ue,qe,ye,Me,xe],styles:[".cleavage-input-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;padding:12px;border:1px solid #ddd;border-radius:4px;background:#fafafa}.field-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.field-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px;font-weight:500;color:#333}.field-input[_ngcontent-%COMP%]{padding:8px;border:1px solid #ccc;border-radius:4px;font-size:13px}.field-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#2196f3;box-shadow:0 0 0 2px #2196f333}select.field-input[_ngcontent-%COMP%]{background:#fff}.hint[_ngcontent-%COMP%]{font-size:11px;color:#666;margin-top:2px}.output-preview[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:8px;padding:8px;background:#fff;border:1px solid #e0e0e0;border-radius:4px;margin-top:8px}.output-preview[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:12px;color:#666;flex-shrink:0}.output-preview[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{font-family:monospace;font-size:12px;color:#333;word-break:break-all}.validation-errors[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.validation-errors[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{font-size:12px;color:#d32f2f}"]})};var tS=(n,e)=>e.iri;function nS(n,e){n&1&&re(0,"span",3)}function iS(n,e){if(n&1){let t=N();c(0,"button",10),_("click",function(){v(t);let o=m(2);return y(o.searchAllOntologies.set(!0))}),d(1," Expand search "),l()}}function oS(n,e){if(n&1){let t=N();c(0,"div",4)(1,"label",7)(2,"input",8),_("change",function(){v(t);let o=m();return y(o.toggleOntologyFilter())}),l(),c(3,"span"),d(4),l()(),x(5,iS,2,0,"button",9),l()}if(n&2){let t=m();p(2),I("checked",!t.searchAllOntologies()),p(2),j("Search in: ",t.getOntologyLabel()),p(),S(t.searchAllOntologies()?-1:5)}}function rS(n,e){if(n&1&&(c(0,"div",16),d(1),Nn(2,"slice"),l()),n&2){let t=m().$implicit;p(),ve(" ",bo(2,2,t.description,0,100),"",t.description.length>100?"...":""," ")}}function sS(n,e){if(n&1){let t=N();c(0,"div",12),_("mousedown",function(){let o=v(t).$implicit,r=m(2);return y(r.selectSuggestion(o))}),c(1,"div",13)(2,"span",14),d(3),l(),c(4,"span",15),d(5),l()(),x(6,rS,3,6,"div",16),l()}if(n&2){let t=e.$implicit,i=e.$index,o=m(2);B("selected",o.selectedIndex()===i),p(3),P(t.label),p(2),P(t.id),p(),S(t.description?6:-1)}}function aS(n,e){if(n&1&&(c(0,"div",5),z(1,sS,7,5,"div",11,tS),l()),n&2){let t=m();p(),$(t.suggestions())}}function lS(n,e){n&1&&(c(0,"div",5)(1,"div",17),d(2,"No results found"),l()())}function cS(n,e){if(n&1){let t=N();c(0,"div",6)(1,"span",18),d(2),l(),c(3,"span",19),d(4),l(),c(5,"button",20),_("click",function(){v(t);let o=m();return y(o.clearSelection())}),d(6,"\xD7"),l()()}if(n&2){let t=m();p(2),P(t.selectedTerm().label),p(2),j("(",t.selectedTerm().id,")")}}var dS={organism:{ontologies:["ncbitaxon"],searchMethod:"searchOrganism"},disease:{ontologies:["efo","mondo","doid"],searchMethod:"searchDisease"},"cell type":{ontologies:["cl","bto"],searchMethod:"searchCellType"},"cell line":{ontologies:["clo","efo","bto"]},tissue:{ontologies:["uberon","bto"],searchMethod:"searchTissue"},organ:{ontologies:["uberon"]},"developmental stage":{ontologies:["uberon","efo"]},sex:{ontologies:["pato"]},"ancestry category":{ontologies:["hancestro"]},instrument:{ontologies:["ms"],searchMethod:"searchInstrument"},"enrichment process":{ontologies:["sep","obi"]},label:{ontologies:["ms","pride"]},"fraction identifier":{ontologies:["ms"]},"technical replicate":{ontologies:[]},"data file":{ontologies:[]}},Po=class n{constructor(e){this.elementRef=e}value="";columnName="";ontologies=[];placeholder="Type to search...";allowFreeText=!0;valueChange=new W;termSelected=new W;olsService=new Ri;searchTimeout;inputValue=w("");suggestions=w([]);selectedTerm=w(null);showDropdown=w(!1);loading=w(!1);selectedIndex=w(-1);searchAllOntologies=w(!1);ngOnInit(){this.inputValue.set(this.value)}ngOnChanges(e){e.value&&!e.value.firstChange&&this.inputValue.set(this.value)}onDocumentClick(e){this.elementRef.nativeElement.contains(e.target)||this.showDropdown.set(!1)}onKeyDown(e){if(!this.showDropdown())return;let t=this.suggestions();switch(e.key){case"ArrowDown":e.preventDefault(),this.selectedIndex.set(Math.min(this.selectedIndex()+1,t.length-1));break;case"ArrowUp":e.preventDefault(),this.selectedIndex.set(Math.max(this.selectedIndex()-1,-1));break;case"Enter":e.preventDefault(),this.selectedIndex()>=0&&t[this.selectedIndex()]?this.selectSuggestion(t[this.selectedIndex()]):this.allowFreeText&&this.emitValue();break;case"Escape":this.showDropdown.set(!1);break}}onInputChange(e){this.inputValue.set(e),this.selectedTerm.set(null),this.selectedIndex.set(-1),clearTimeout(this.searchTimeout),e.length>=2?(this.loading.set(!0),this.searchTimeout=setTimeout(()=>{this.search(e)},300)):(this.suggestions.set([]),this.loading.set(!1)),this.allowFreeText&&this.valueChange.emit(e)}onFocus(){(this.suggestions().length>0||this.inputValue().length>=2)&&this.showDropdown.set(!0)}onBlur(){setTimeout(()=>{this.allowFreeText&&this.emitValue()},200)}selectSuggestion(e){this.inputValue.set(e.label),this.selectedTerm.set(e),this.showDropdown.set(!1),this.suggestions.set([]),this.valueChange.emit(e.label),this.termSelected.emit(e)}clearSelection(){this.inputValue.set(""),this.selectedTerm.set(null),this.valueChange.emit(""),this.termSelected.emit(null)}search(e){return k(this,null,function*(){let t=this.getOntologyConfig();try{let i;if(this.searchAllOntologies())i=(yield this.olsService.search({query:e,rows:15})).suggestions;else if(t.searchMethod){let o=t.searchMethod;i=yield this.olsService[o](e,10)}else t.ontologies.length>0?i=(yield this.olsService.search({query:e,ontology:t.ontologies,rows:10})).suggestions:i=(yield this.olsService.search({query:e,rows:10})).suggestions;this.suggestions.set(i),this.showDropdown.set(!0)}catch(i){console.error("Ontology search error:",i),this.suggestions.set([])}finally{this.loading.set(!1)}})}getOntologyConfig(){if(this.ontologies.length>0)return{ontologies:this.ontologies};let e=this.columnName.toLowerCase().match(/\[(.*?)\]/),t=e?e[1]:this.columnName.toLowerCase();return dS[t]||{ontologies:[]}}emitValue(){this.valueChange.emit(this.inputValue())}getRecommendedOntologies(){return this.getOntologyConfig().ontologies}getOntologyLabel(){if(this.searchAllOntologies())return"All ontologies";let e=this.getRecommendedOntologies();return e.length===0?"All ontologies":e.map(i=>i.toUpperCase()).join(", ")}toggleOntologyFilter(){this.searchAllOntologies.update(e=>!e),this.inputValue().length>=2&&this.search(this.inputValue())}static \u0275fac=function(t){return new(t||n)(Ee(Nt))};static \u0275cmp=ee({type:n,selectors:[["sdrf-ontology-input"]],hostBindings:function(t,i){t&1&&_("click",function(r){return i.onDocumentClick(r)},Qd)("keydown",function(r){return i.onKeyDown(r)})},inputs:{value:"value",columnName:"columnName",ontologies:"ontologies",placeholder:"placeholder",allowFreeText:"allowFreeText"},outputs:{valueChange:"valueChange",termSelected:"termSelected"},features:[Fe],decls:8,vars:7,consts:[[1,"ontology-input-container"],[1,"input-wrapper"],["type","text",1,"field-input",3,"ngModelChange","focus","blur","ngModel","placeholder"],[1,"loading-indicator"],[1,"ontology-filter"],[1,"suggestions-dropdown"],[1,"selected-term"],[1,"filter-label"],["type","checkbox",3,"change","checked"],["title","Search in all ontologies",1,"expand-search-btn"],["title","Search in all ontologies",1,"expand-search-btn",3,"click"],[1,"suggestion-item",3,"selected"],[1,"suggestion-item",3,"mousedown"],[1,"suggestion-main"],[1,"suggestion-label"],[1,"suggestion-id"],[1,"suggestion-description"],[1,"no-results"],[1,"term-label"],[1,"term-id"],[1,"clear-btn",3,"click"]],template:function(t,i){t&1&&(c(0,"div",0)(1,"div",1)(2,"input",2),_("ngModelChange",function(r){return i.onInputChange(r)})("focus",function(){return i.onFocus()})("blur",function(){return i.onBlur()}),l(),x(3,nS,1,0,"span",3),l(),x(4,oS,6,3,"div",4),x(5,aS,3,0,"div",5),x(6,lS,3,0,"div",5),x(7,cS,7,2,"div",6),l()),t&2&&(p(2),I("ngModel",i.inputValue())("placeholder",i.placeholder),p(),S(i.loading()?3:-1),p(),S(i.getRecommendedOntologies().length>0?4:-1),p(),S(i.showDropdown()&&i.suggestions().length>0?5:-1),p(),S(i.showDropdown()&&!i.loading()&&i.suggestions().length===0&&i.inputValue().length>=2?6:-1),p(),S(i.selectedTerm()?7:-1))},dependencies:[te,ce,ye,Me,xe,Er],styles:[".ontology-input-container[_ngcontent-%COMP%]{position:relative;width:100%}.input-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.field-input[_ngcontent-%COMP%]{width:100%;padding:8px;border:1px solid #ccc;border-radius:4px;font-size:13px}.field-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#2196f3;box-shadow:0 0 0 2px #2196f333}.loading-indicator[_ngcontent-%COMP%]{position:absolute;right:8px;width:16px;height:16px;border:2px solid #ddd;border-top-color:#2196f3;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.suggestions-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;right:0;max-height:250px;overflow-y:auto;background:#fff;border:1px solid #ddd;border-top:none;border-radius:0 0 4px 4px;box-shadow:0 4px 8px #00000026;z-index:100}.suggestion-item[_ngcontent-%COMP%]{padding:8px 12px;cursor:pointer;border-bottom:1px solid #eee}.suggestion-item[_ngcontent-%COMP%]:hover, .suggestion-item.selected[_ngcontent-%COMP%]{background:#f0f7ff}.suggestion-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.suggestion-main[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.suggestion-label[_ngcontent-%COMP%]{font-weight:500;flex:1}.suggestion-id[_ngcontent-%COMP%]{font-size:11px;color:#666;font-family:monospace;background:#f0f0f0;padding:2px 4px;border-radius:2px}.suggestion-description[_ngcontent-%COMP%]{font-size:11px;color:#666;margin-top:4px;line-height:1.3}.no-results[_ngcontent-%COMP%]{padding:12px;text-align:center;color:#666;font-size:13px}.selected-term[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;margin-top:6px;padding:6px 8px;background:#e3f2fd;border-radius:4px;font-size:12px}.term-label[_ngcontent-%COMP%]{font-weight:500}.term-id[_ngcontent-%COMP%]{color:#666;font-family:monospace}.clear-btn[_ngcontent-%COMP%]{margin-left:auto;background:none;border:none;font-size:16px;cursor:pointer;color:#666;padding:0 4px}.clear-btn[_ngcontent-%COMP%]:hover{color:#d32f2f}.ontology-filter[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:8px;padding:4px 8px;font-size:11px;color:#666;background:#f8f9fa;border:1px solid #e0e0e0;border-top:none;border-radius:0 0 4px 4px}.filter-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;cursor:pointer;margin:0;-webkit-user-select:none;user-select:none}.filter-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{margin:0;cursor:pointer}.expand-search-btn[_ngcontent-%COMP%]{padding:2px 8px;font-size:10px;background:#fff;border:1px solid #ccc;border-radius:3px;cursor:pointer;color:#666;transition:all .2s}.expand-search-btn[_ngcontent-%COMP%]:hover{background:#2196f3;color:#fff;border-color:#2196f3}"]})};var uS=["textInput"];function pS(n,e){if(n&1){let t=N();c(0,"button",20),_("click",function(){v(t);let o=m();return y(o.toggleExpand())}),d(1),l()}if(n&2){let t=m();p(),j(" ",t.isExpanded()?"Collapse":"Expand"," ")}}function fS(n,e){if(n&1){let t=N();c(0,"sdrf-age-input",21),_("valueChange",function(o){v(t);let r=m();return y(r.onValueChange(o))}),l()}if(n&2){let t=m();I("value",t.value)}}function mS(n,e){if(n&1){let t=N();c(0,"sdrf-modification-input",21),_("valueChange",function(o){v(t);let r=m();return y(r.onValueChange(o))}),l()}if(n&2){let t=m();I("value",t.value)}}function gS(n,e){if(n&1){let t=N();c(0,"sdrf-cleavage-input",21),_("valueChange",function(o){v(t);let r=m();return y(r.onValueChange(o))}),l()}if(n&2){let t=m();I("value",t.value)}}function hS(n,e){if(n&1){let t=N();c(0,"sdrf-ontology-input",22),_("valueChange",function(o){v(t);let r=m();return y(r.onValueChange(o))}),l()}if(n&2){let t=m();I("value",t.value)("columnName",(t.column==null?null:t.column.name)||"")("placeholder","Search "+t.getColumnTypeLabel()+"...")}}function _S(n,e){if(n&1&&(c(0,"option",6),d(1),l()),n&2){let t=e.$implicit;I("value",t),p(),P(t)}}function CS(n,e){if(n&1){let t=N();c(0,"select",23),_("ngModelChange",function(o){v(t);let r=m();return y(r.onValueChange(o))}),c(1,"option",24),d(2,"-- Select --"),l(),z(3,_S,2,2,"option",6,Ut),l()}if(n&2){let t=m();I("ngModel",t.value),p(3),$(t.selectOptions())}}function vS(n,e){if(n&1){let t=N();c(0,"textarea",27,0),_("ngModelChange",function(o){v(t);let r=m(2);return y(r.onValueChange(o))})("keydown.escape",function(){v(t);let o=m(2);return y(o.onCancel())}),l()}if(n&2){let t=m(2);I("ngModel",t.value)}}function yS(n,e){if(n&1){let t=N();c(0,"input",28,0),_("ngModelChange",function(o){v(t);let r=m(2);return y(r.onValueChange(o))})("keydown.enter",function(){v(t);let o=m(2);return y(o.onSave())})("keydown.escape",function(){v(t);let o=m(2);return y(o.onCancel())}),l()}if(n&2){let t=m(2);I("ngModel",t.value)}}function bS(n,e){if(n&1&&x(0,vS,2,1,"textarea",25)(1,yS,2,1,"input",26),n&2){let t=m();S(t.isExpanded()?0:1)}}function xS(n,e){if(n&1){let t=N();c(0,"button",29),_("click",function(){v(t);let o=m();return y(o.onClear())}),d(1,"Clear"),l()}}var b0={"pooled sample":["not pooled","pooled"],"synthetic peptide":["synthetic","not synthetic"],labeling:["label free sample","SILAC","TMT","iTRAQ"]},SS=["organism","disease","cell type","cell line","tissue","organ","developmental stage","sex","ancestry category","instrument","enrichment process","label"],Xa=class n{value="";column;rowIndex=1;save=new W;cancel=new W;textInput;syntaxService=new on;isExpanded=w(!1);currentValue=w("");editorMode=A(()=>{if(!this.column)return"text";let e=this.syntaxService.detectSpecialSyntax(this.column.name,this.column.type);if(e)return this.syntaxTypeToEditorMode(e);let t=this.getColumnTypeFromName(this.column.name);return b0[t]?"select":SS.includes(t)||this.column.ontologyType?"ontology":"text"});selectOptions=A(()=>{if(!this.column)return[];let e=this.getColumnTypeFromName(this.column.name);return b0[e]||[]});ngOnInit(){this.currentValue.set(this.value)}ngOnChanges(e){e.value&&!e.value.firstChange&&this.currentValue.set(this.value)}ngAfterViewInit(){setTimeout(()=>{this.textInput?.nativeElement?.focus(),this.textInput?.nativeElement instanceof HTMLInputElement&&this.textInput.nativeElement.select()},50)}getModeLabel(){switch(this.editorMode()){case"age":return"Age";case"modification":return"Modification";case"cleavage":return"Cleavage";case"ontology":return"Ontology";case"select":return"Select";default:return"Text"}}getColumnTypeLabel(){return this.column?this.getColumnTypeFromName(this.column.name):"term"}canExpand(){return this.editorMode()==="text"}canClear(){return this.value!==""}toggleExpand(){this.isExpanded.set(!this.isExpanded())}onValueChange(e){this.currentValue.set(e),this.value=e}onSave(){this.save.emit(this.currentValue())}onCancel(){this.cancel.emit()}onClear(){this.currentValue.set(""),this.value=""}setSpecialValue(e){this.currentValue.set(e),this.value=e}syntaxTypeToEditorMode(e){switch(e){case"age":return"age";case"modification":return"modification";case"cleavage":return"cleavage";case"pooled_sample":case"synthetic_peptide":return"select";default:return"text"}}getColumnTypeFromName(e){let t=e.toLowerCase().match(/\[(.*?)\]/);return t?t[1]:e.toLowerCase()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ee({type:n,selectors:[["sdrf-cell-editor"]],viewQuery:function(t,i){if(t&1&&_r(uS,5),t&2){let o;Cr(o=vr())&&(i.textInput=o.first)}},inputs:{value:"value",column:"column",rowIndex:"rowIndex"},outputs:{save:"save",cancel:"cancel"},features:[Fe],decls:30,vars:16,consts:[["textInput",""],[1,"cell-editor-container"],[1,"editor-header"],[1,"mode-badge"],[1,"expand-btn"],[1,"editor-content"],[3,"value"],[3,"value","columnName","placeholder"],[1,"select-input",3,"ngModel"],[1,"editor-actions"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-secondary",3,"click"],[1,"btn","btn-link"],[1,"reserved-options"],[1,"reserved-label"],[1,"reserved-btns"],["title","Value is not available - data was not collected or cannot be determined",1,"reserved-btn","not-available",3,"click"],["title","Value is not applicable - does not apply to this sample type",1,"reserved-btn","not-applicable",3,"click"],["title","Value is anonymized - hidden for privacy/ethical reasons",1,"reserved-btn","anonymized",3,"click"],["title","Value is pooled - sample is a pool of multiple sources",1,"reserved-btn","pooled",3,"click"],[1,"expand-btn",3,"click"],[3,"valueChange","value"],[3,"valueChange","value","columnName","placeholder"],[1,"select-input",3,"ngModelChange","ngModel"],["value",""],["rows","4",1,"text-input","textarea",3,"ngModel"],["type","text",1,"text-input",3,"ngModel"],["rows","4",1,"text-input","textarea",3,"ngModelChange","keydown.escape","ngModel"],["type","text",1,"text-input",3,"ngModelChange","keydown.enter","keydown.escape","ngModel"],[1,"btn","btn-link",3,"click"]],template:function(t,i){if(t&1&&(c(0,"div",1)(1,"div",2)(2,"span",3),d(3),l(),x(4,pS,2,1,"button",4),l(),c(5,"div",5),x(6,fS,1,1,"sdrf-age-input",6)(7,mS,1,1,"sdrf-modification-input",6)(8,gS,1,1,"sdrf-cleavage-input",6)(9,hS,1,3,"sdrf-ontology-input",7)(10,CS,5,1,"select",8)(11,bS,2,1),l(),c(12,"div",9)(13,"button",10),_("click",function(){return i.onSave()}),d(14,"Save"),l(),c(15,"button",11),_("click",function(){return i.onCancel()}),d(16,"Cancel"),l(),x(17,xS,2,0,"button",12),l(),c(18,"div",13)(19,"span",14),d(20,"Reserved values:"),l(),c(21,"div",15)(22,"button",16),_("click",function(){return i.setSpecialValue("not available")}),d(23," not available "),l(),c(24,"button",17),_("click",function(){return i.setSpecialValue("not applicable")}),d(25," not applicable "),l(),c(26,"button",18),_("click",function(){return i.setSpecialValue("anonymized")}),d(27," anonymized "),l(),c(28,"button",19),_("click",function(){return i.setSpecialValue("pooled")}),d(29," pooled "),l()()()()),t&2){let o;B("expanded",i.isExpanded()),p(2),Wt(i.editorMode()),p(),j(" ",i.getModeLabel()," "),p(),S(i.canExpand()?4:-1),p(2),S((o=i.editorMode())==="age"?6:o==="modification"?7:o==="cleavage"?8:o==="ontology"?9:o==="select"?10:11),p(11),S(i.canClear()?17:-1),p(5),B("active",i.value.toLowerCase()==="not available"),p(2),B("active",i.value.toLowerCase()==="not applicable"),p(2),B("active",i.value.toLowerCase()==="anonymized"),p(2),B("active",i.value.toLowerCase()==="pooled")}},dependencies:[te,ce,Ue,qe,ye,st,Me,xe,Ka,Za,Ja,Po],styles:[".cell-editor-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;padding:12px;background:#fff;border:1px solid #ddd;border-radius:6px;box-shadow:0 4px 12px #00000026;min-width:280px;max-width:400px}.cell-editor-container.expanded[_ngcontent-%COMP%]{min-width:350px;max-width:500px}.editor-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding-bottom:8px;border-bottom:1px solid #eee}.mode-badge[_ngcontent-%COMP%]{font-size:11px;font-weight:500;padding:2px 8px;border-radius:12px;background:#e0e0e0;color:#333}.mode-badge.age[_ngcontent-%COMP%]{background:#e3f2fd;color:#1565c0}.mode-badge.modification[_ngcontent-%COMP%]{background:#f3e5f5;color:#7b1fa2}.mode-badge.cleavage[_ngcontent-%COMP%]{background:#fff3e0;color:#ef6c00}.mode-badge.ontology[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.mode-badge.select[_ngcontent-%COMP%]{background:#fce4ec;color:#c2185b}.expand-btn[_ngcontent-%COMP%]{font-size:11px;padding:2px 8px;background:none;border:1px solid #ccc;border-radius:4px;cursor:pointer;color:#666}.expand-btn[_ngcontent-%COMP%]:hover{background:#f5f5f5}.editor-content[_ngcontent-%COMP%]{min-height:40px}.text-input[_ngcontent-%COMP%]{width:100%;padding:8px;border:1px solid #ccc;border-radius:4px;font-size:13px;font-family:inherit}.text-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#2196f3;box-shadow:0 0 0 2px #2196f333}.text-input.textarea[_ngcontent-%COMP%]{resize:vertical;min-height:80px}.select-input[_ngcontent-%COMP%]{width:100%;padding:8px;border:1px solid #ccc;border-radius:4px;font-size:13px;background:#fff}.select-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#2196f3;box-shadow:0 0 0 2px #2196f333}.editor-actions[_ngcontent-%COMP%]{display:flex;gap:8px;padding-top:8px;border-top:1px solid #eee}.btn[_ngcontent-%COMP%]{padding:6px 12px;border-radius:4px;font-size:12px;cursor:pointer;border:none}.btn-primary[_ngcontent-%COMP%]{background:#2196f3;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background:#1976d2}.btn-secondary[_ngcontent-%COMP%]{background:#e0e0e0;color:#333}.btn-secondary[_ngcontent-%COMP%]:hover{background:#d0d0d0}.btn-link[_ngcontent-%COMP%]{background:none;color:#666;padding:6px 8px}.btn-link[_ngcontent-%COMP%]:hover{color:#d32f2f;text-decoration:underline}.reserved-options[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px;padding-top:10px;border-top:1px dashed #ddd;margin-top:4px}.reserved-label[_ngcontent-%COMP%]{font-size:10px;text-transform:uppercase;letter-spacing:.5px;color:#888}.reserved-btns[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:6px}.reserved-btn[_ngcontent-%COMP%]{padding:4px 8px;font-size:11px;font-style:italic;background:#f8f8f8;border:1px solid #e0e0e0;border-radius:4px;cursor:pointer;color:#888;transition:all .15s ease}.reserved-btn[_ngcontent-%COMP%]:hover{background:#f0f0f0;border-color:#ccc}.reserved-btn.not-available[_ngcontent-%COMP%], .reserved-btn.not-applicable[_ngcontent-%COMP%]{color:#888}.reserved-btn.not-available[_ngcontent-%COMP%]:hover, .reserved-btn.not-applicable[_ngcontent-%COMP%]:hover{background:#9e9e9e26}.reserved-btn.not-available.active[_ngcontent-%COMP%], .reserved-btn.not-applicable.active[_ngcontent-%COMP%]{background:#9e9e9e33;border-color:#9e9e9e;color:#666}.reserved-btn.anonymized[_ngcontent-%COMP%]{color:#9c27b0}.reserved-btn.anonymized[_ngcontent-%COMP%]:hover{background:#9c27b01a}.reserved-btn.anonymized.active[_ngcontent-%COMP%]{background:#9c27b026;border-color:#9c27b0;color:#7b1fa2}.reserved-btn.pooled[_ngcontent-%COMP%]{color:#1976d2}.reserved-btn.pooled[_ngcontent-%COMP%]:hover{background:#2196f31a}.reserved-btn.pooled.active[_ngcontent-%COMP%]{background:#2196f326;border-color:#2196f3;color:#1565c0}"]})};var wS=(n,e)=>e.columnPosition,ES=(n,e)=>e.value;function MS(n,e){if(n&1&&(c(0,"option",5),d(1),l()),n&2){let t=e.$implicit,i=e.$index;I("value",i),p(),P(t.name)}}function DS(n,e){n&1&&(c(0,"span",9),re(1,"span",14),d(2," Processing... "),l())}function TS(n,e){if(n&1){let t=N();c(0,"div",23)(1,"input",24),ft("ngModelChange",function(o){v(t);let r=m(3);return vt(r.editNewValue,o)||(r.editNewValue=o),y(o)}),_("keydown.enter",function(){v(t);let o=m().$implicit,r=m(2);return y(r.applyEdit(o))})("keydown.escape",function(){v(t);let o=m(3);return y(o.cancelEdit())}),l(),c(2,"button",25),_("click",function(){v(t);let o=m().$implicit,r=m(2);return y(r.applyEdit(o))}),d(3," Apply "),l(),c(4,"button",26),_("click",function(){v(t);let o=m(3);return y(o.cancelEdit())}),d(5," Cancel "),l()()}if(n&2){let t=m(3);p(),pt("ngModel",t.editNewValue)}}function IS(n,e){if(n&1){let t=N();c(0,"button",27),_("click",function(o){v(t);let r=m().$implicit;return m(2).selectValue(r),y(o.stopPropagation())}),d(1," \u2611 "),l(),c(2,"button",28),_("click",function(o){v(t);let r=m().$implicit;return m(2).startEdit(r),y(o.stopPropagation())}),d(3," \u270E "),l()}}function PS(n,e){if(n&1){let t=N();c(0,"div",15)(1,"div",16),_("click",function(){let o=v(t).$implicit,r=m(2);return y(r.onValueClick(o))}),c(2,"div",17),re(3,"div",18),l(),c(4,"span",19),d(5),l(),c(6,"span",20),d(7),c(8,"span",21),d(9),Nn(10,"number"),l()()(),c(11,"div",22),x(12,TS,6,1,"div",23)(13,IS,4,0),l()()}if(n&2){let t=e.$implicit,i=m(2);B("selected",i.isValueSelected(t.value))("editing",i.editingValue()===t.value),p(3),vn("width",t.percentage,"%"),p(),I("title",t.value||"(empty)"),p(),j(" ",t.value||"(empty)"," "),p(2),j(" ",t.count," "),p(2),j("(",bu(10,11,t.percentage,"1.1-1"),"%)"),p(3),S(i.editingValue()===t.value?12:13)}}function OS(n,e){if(n&1){let t=N();c(0,"div",6)(1,"div",7)(2,"span",8)(3,"strong"),d(4),l(),d(5," unique values "),l(),c(6,"span",8)(7,"strong"),d(8),l(),d(9," total samples "),l(),x(10,DS,3,0,"span",9),l(),c(11,"div",10),z(12,PS,14,14,"div",11,ES),l(),c(14,"div",12)(15,"button",13),_("click",function(){v(t);let o=m();return y(o.selectEmpty())}),d(16," Select Empty "),l(),c(17,"button",13),_("click",function(){v(t);let o=m();return y(o.selectAll())}),d(18," Select All "),l()()()}if(n&2){let t=m();p(4),P(t.uniqueValues().length),p(4),P((t.table==null?null:t.table.sampleCount)||0),p(2),S(t.isComputing()?10:-1),p(),B("computing",t.isComputing()),p(),$(t.uniqueValues())}}var el=class n{table=null;selectedSamples=new Set;close=new W;selectByValue=new W;bulkEdit=new W;selectSamples=new W;selectedColumnIndex=w(0);editingValue=w(null);editNewValue="";isComputing=w(!1);cachedValues=w([]);selectedColumn=A(()=>this.table&&this.table.columns[this.selectedColumnIndex()]||null);uniqueValues=A(()=>this.cachedValues());constructor(){br(()=>{let e=this.selectedColumn(),t=this.table;if(!e||!t){this.cachedValues.set([]);return}this.isComputing.set(!0),setTimeout(()=>{let i=this.computeUniqueValues(e,t);this.cachedValues.set(i),this.isComputing.set(!1)},0)})}computeUniqueValues(e,t){let i=new Map;for(let r=1;r<=t.sampleCount;r++){let s=de(e,r);i.has(s)||i.set(s,[]),i.get(s).push(r)}let o=[];for(let[r,s]of i)o.push({value:r,count:s.length,percentage:s.length/t.sampleCount*100,sampleIndices:s});return o.sort((r,s)=>s.count-r.count),o}onColumnChange(e){this.selectedColumnIndex.set(Number(e)),this.cancelEdit()}isValueSelected(e){let t=this.uniqueValues().find(i=>i.value===e);return t?t.sampleIndices.every(i=>this.selectedSamples.has(i)):!1}onValueClick(e){this.selectValue(e)}selectValue(e){this.selectByValue.emit({columnIndex:this.selectedColumnIndex(),value:e.value,sampleIndices:e.sampleIndices})}startEdit(e){this.editingValue.set(e.value),this.editNewValue=e.value}cancelEdit(){this.editingValue.set(null),this.editNewValue=""}applyEdit(e){this.editNewValue!==e.value&&this.bulkEdit.emit({columnIndex:this.selectedColumnIndex(),oldValue:e.value,newValue:this.editNewValue,sampleIndices:e.sampleIndices}),this.cancelEdit()}selectEmpty(){let e=this.uniqueValues().find(t=>t.value==="");e&&this.selectSamples.emit(e.sampleIndices)}selectAll(){if(!this.table)return;let e=Array.from({length:this.table.sampleCount},(t,i)=>i+1);this.selectSamples.emit(e)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ee({type:n,selectors:[["sdrf-column-stats"]],inputs:{table:"table",selectedSamples:"selectedSamples"},outputs:{close:"close",selectByValue:"selectByValue",bulkEdit:"bulkEdit",selectSamples:"selectSamples"},decls:13,vars:2,consts:[[1,"column-stats-panel"],[1,"panel-header"],[1,"close-btn",3,"click"],[1,"column-selector"],[3,"ngModelChange","ngModel"],[3,"value"],[1,"stats-content"],[1,"stats-summary"],[1,"summary-item"],[1,"computing-indicator"],[1,"value-list"],[1,"value-item",3,"selected","editing"],[1,"quick-actions"],[1,"btn","btn-sm",3,"click"],[1,"spinner"],[1,"value-item"],[1,"value-main",3,"click"],[1,"value-bar"],[1,"value-bar-fill"],[1,"value-text",3,"title"],[1,"value-count"],[1,"value-percentage"],[1,"value-actions"],[1,"edit-inline"],["type","text","placeholder","New value...",1,"edit-input",3,"ngModelChange","keydown.enter","keydown.escape","ngModel"],[1,"btn-sm","btn-primary",3,"click"],[1,"btn-sm",3,"click"],["title","Select all samples with this value",1,"btn-icon",3,"click"],["title","Edit all samples with this value",1,"btn-icon",3,"click"]],template:function(t,i){t&1&&(c(0,"div",0)(1,"div",1)(2,"h3"),d(3,"Column Statistics"),l(),c(4,"button",2),_("click",function(){return i.close.emit()}),d(5,"\xD7"),l()(),c(6,"div",3)(7,"label"),d(8,"Select Column:"),l(),c(9,"select",4),_("ngModelChange",function(r){return i.onColumnChange(r)}),z(10,MS,2,2,"option",5,wS),l()(),x(12,OS,19,5,"div",6),l()),t&2&&(p(9),I("ngModel",i.selectedColumnIndex()),p(),$(i.table==null?null:i.table.columns),p(2),S(i.selectedColumn()?12:-1))},dependencies:[te,ce,Ue,qe,ye,st,Me,xe,Ou],styles:[".column-stats-panel[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;background:#f8f9fa;border-left:1px solid #ddd;width:320px;font-size:13px}.panel-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;background:#fff;border-bottom:1px solid #ddd}.panel-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:14px;font-weight:600}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:20px;cursor:pointer;color:#666;padding:0 4px}.close-btn[_ngcontent-%COMP%]:hover{color:#333}.column-selector[_ngcontent-%COMP%]{padding:12px 16px;background:#fff;border-bottom:1px solid #eee}.column-selector[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:6px;font-weight:500;color:#555}.column-selector[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:8px;border:1px solid #ccc;border-radius:4px;font-size:13px;background:#fff}.stats-content[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;overflow:hidden}.stats-summary[_ngcontent-%COMP%]{display:flex;gap:16px;padding:12px 16px;background:#fff;border-bottom:1px solid #eee}.summary-item[_ngcontent-%COMP%]{font-size:12px;color:#666}.summary-item[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#333}.value-list[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:8px 0}.value-item[_ngcontent-%COMP%]{padding:8px 16px;border-bottom:1px solid #eee;transition:background .15s}.value-item[_ngcontent-%COMP%]:hover{background:#fff}.value-item.selected[_ngcontent-%COMP%]{background:#e3f2fd}.value-item.editing[_ngcontent-%COMP%]{background:#fff3e0}.value-main[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer}.value-bar[_ngcontent-%COMP%]{width:40px;height:6px;background:#e0e0e0;border-radius:3px;overflow:hidden;flex-shrink:0}.value-bar-fill[_ngcontent-%COMP%]{height:100%;background:#2196f3;border-radius:3px;transition:width .3s}.value-text[_ngcontent-%COMP%]{flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;min-width:0}.value-count[_ngcontent-%COMP%]{font-weight:500;color:#333;flex-shrink:0}.value-percentage[_ngcontent-%COMP%]{font-weight:400;color:#999;font-size:11px}.value-actions[_ngcontent-%COMP%]{display:flex;gap:4px;margin-top:6px}.btn-icon[_ngcontent-%COMP%]{background:none;border:1px solid #ddd;border-radius:4px;padding:4px 8px;cursor:pointer;font-size:12px}.btn-icon[_ngcontent-%COMP%]:hover{background:#f0f0f0;border-color:#ccc}.edit-inline[_ngcontent-%COMP%]{display:flex;gap:4px;flex:1}.edit-input[_ngcontent-%COMP%]{flex:1;padding:4px 8px;border:1px solid #2196f3;border-radius:4px;font-size:12px}.btn-sm[_ngcontent-%COMP%]{padding:4px 8px;font-size:11px;border:1px solid #ccc;border-radius:4px;background:#fff;cursor:pointer}.btn-sm[_ngcontent-%COMP%]:hover{background:#f5f5f5}.btn-sm.btn-primary[_ngcontent-%COMP%]{background:#2196f3;color:#fff;border-color:#2196f3}.btn-sm.btn-primary[_ngcontent-%COMP%]:hover{background:#1976d2}.quick-actions[_ngcontent-%COMP%]{display:flex;gap:8px;padding:12px 16px;background:#fff;border-top:1px solid #ddd}.quick-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{flex:1}.computing-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-size:11px;color:#1976d2;margin-left:auto}.spinner[_ngcontent-%COMP%]{width:14px;height:14px;border:2px solid #e3f2fd;border-top-color:#1976d2;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.value-list.computing[_ngcontent-%COMP%]{opacity:.6;pointer-events:none}"]})};var AS=(n,e)=>e.columnPosition;function NS(n,e){if(n&1&&(c(0,"option",8),d(1),l()),n&2){let t=e.$implicit,i=e.$index;I("value",i),p(),P(t.name)}}function kS(n,e){if(n&1){let t=N();c(0,"input",12),ft("ngModelChange",function(o){v(t);let r=m();return vt(r.newValue,o)||(r.newValue=o),y(o)}),_("keydown.enter",function(){v(t);let o=m();return y(o.applyBulkEdit())}),l(),c(1,"button",13),_("click",function(){v(t);let o=m();return y(o.applyBulkEdit())}),d(2," Apply to Selected "),l()}if(n&2){let t=m();pt("ngModel",t.newValue),p(),I("disabled",!t.newValue)}}function RS(n,e){if(n&1){let t=N();c(0,"div",11)(1,"div",14)(2,"p"),d(3),l(),c(4,"div",15)(5,"button",16),_("click",function(){v(t);let o=m();return y(o.confirmAction())}),d(6," Confirm "),l(),c(7,"button",17),_("click",function(){v(t);let o=m();return y(o.cancelConfirm())}),d(8," Cancel "),l()()()()}if(n&2){let t=m();p(3),P(t.confirmMessage())}}var tl=class n{table=null;selectedCount=0;selectedSamples=new Set;preselectedColumn=null;clearSelection=new W;bulkEdit=new W;copyFromFirst=new W;selectedColumnIndex=-1;newValue="";ngOnChanges(e){e.preselectedColumn&&this.preselectedColumn!==null&&(this.selectedColumnIndex=this.preselectedColumn)}showConfirm=w(!1);confirmMessage=w("");pendingAction=null;applyBulkEdit(){if(this.selectedColumnIndex<0||!this.newValue)return;let e=Array.from(this.selectedSamples);this.confirmMessage.set(`Apply "${this.newValue}" to ${e.length} samples in column "${this.table?.columns[this.selectedColumnIndex]?.name}"?`),this.pendingAction=()=>{this.bulkEdit.emit({columnIndex:this.selectedColumnIndex,newValue:this.newValue,sampleIndices:e}),this.newValue=""},this.showConfirm.set(!0)}copyFirstValue(){this.selectedColumnIndex<0||(this.confirmMessage.set(`Copy value from first selected sample to all ${this.selectedSamples.size} selected samples?`),this.pendingAction=()=>{this.copyFromFirst.emit(this.selectedColumnIndex)},this.showConfirm.set(!0))}clearValues(){if(this.selectedColumnIndex<0)return;let e=Array.from(this.selectedSamples);this.confirmMessage.set(`Clear values for ${e.length} samples in column "${this.table?.columns[this.selectedColumnIndex]?.name}"?`),this.pendingAction=()=>{this.bulkEdit.emit({columnIndex:this.selectedColumnIndex,newValue:"",sampleIndices:e})},this.showConfirm.set(!0)}confirmAction(){this.pendingAction&&this.pendingAction(),this.cancelConfirm()}cancelConfirm(){this.showConfirm.set(!1),this.pendingAction=null}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ee({type:n,selectors:[["sdrf-bulk-toolbar"]],inputs:{table:"table",selectedCount:"selectedCount",selectedSamples:"selectedSamples",preselectedColumn:"preselectedColumn"},outputs:{clearSelection:"clearSelection",bulkEdit:"bulkEdit",copyFromFirst:"copyFromFirst"},features:[Fe],decls:22,vars:6,consts:[[1,"bulk-toolbar"],[1,"toolbar-info"],[1,"selection-count"],[1,"btn-link",3,"click"],[1,"toolbar-actions"],[1,"action-group"],[1,"column-select",3,"ngModelChange","ngModel"],["value","-1"],[3,"value"],[1,"btn","btn-secondary",3,"click"],[1,"btn","btn-danger",3,"click"],[1,"confirm-overlay"],["type","text","placeholder","Enter new value...",1,"value-input",3,"ngModelChange","keydown.enter","ngModel"],[1,"btn","btn-primary",3,"click","disabled"],[1,"confirm-dialog"],[1,"confirm-actions"],[1,"btn","btn-primary",3,"click"],[1,"btn",3,"click"]],template:function(t,i){t&1&&(c(0,"div",0)(1,"div",1)(2,"span",2)(3,"strong"),d(4),l(),d(5," samples selected "),l(),c(6,"button",3),_("click",function(){return i.clearSelection.emit()}),d(7," Clear selection "),l()(),c(8,"div",4)(9,"div",5)(10,"select",6),ft("ngModelChange",function(r){return vt(i.selectedColumnIndex,r)||(i.selectedColumnIndex=r),r}),c(11,"option",7),d(12,"Select column..."),l(),z(13,NS,2,2,"option",8,AS),l(),x(15,kS,3,2),l(),c(16,"div",5)(17,"button",9),_("click",function(){return i.copyFirstValue()}),d(18," Copy from First "),l(),c(19,"button",10),_("click",function(){return i.clearValues()}),d(20," Clear Values "),l()()(),x(21,RS,9,1,"div",11),l()),t&2&&(B("visible",i.selectedCount>0),p(4),P(i.selectedCount),p(6),pt("ngModel",i.selectedColumnIndex),p(3),$(i.table==null?null:i.table.columns),p(2),S(i.selectedColumnIndex>=0?15:-1),p(6),S(i.showConfirm()?21:-1))},dependencies:[te,ce,Ue,qe,ye,st,Me,xe],styles:[".bulk-toolbar[_ngcontent-%COMP%]{display:none;background:#1a237e;color:#fff;padding:12px 16px;gap:16px;align-items:center;flex-wrap:wrap;position:relative}.bulk-toolbar.visible[_ngcontent-%COMP%]{display:flex}.toolbar-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.selection-count[_ngcontent-%COMP%]{font-size:14px}.selection-count[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:18px}.btn-link[_ngcontent-%COMP%]{background:none;border:none;color:#fffc;cursor:pointer;font-size:12px;text-decoration:underline}.btn-link[_ngcontent-%COMP%]:hover{color:#fff}.toolbar-actions[_ngcontent-%COMP%]{display:flex;gap:16px;flex:1;flex-wrap:wrap}.action-group[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.column-select[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid rgba(255,255,255,.3);border-radius:4px;background:#ffffff1a;color:#fff;font-size:13px;min-width:180px}.column-select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{background:#1a237e;color:#fff}.value-input[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid rgba(255,255,255,.3);border-radius:4px;background:#fffffff2;font-size:13px;min-width:200px}.value-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#fff}.btn[_ngcontent-%COMP%]{padding:8px 16px;border:none;border-radius:4px;font-size:13px;cursor:pointer;transition:all .2s}.btn-primary[_ngcontent-%COMP%]{background:#4caf50;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#43a047}.btn-primary[_ngcontent-%COMP%]:disabled{background:#fff3;cursor:not-allowed}.btn-secondary[_ngcontent-%COMP%]{background:#fff3;color:#fff;border:1px solid rgba(255,255,255,.3)}.btn-secondary[_ngcontent-%COMP%]:hover{background:#ffffff4d}.btn-danger[_ngcontent-%COMP%]{background:#f44336;color:#fff}.btn-danger[_ngcontent-%COMP%]:hover{background:#e53935}.confirm-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:10}.confirm-dialog[_ngcontent-%COMP%]{background:#fff;color:#333;padding:20px;border-radius:8px;box-shadow:0 4px 20px #0000004d;max-width:400px}.confirm-dialog[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 16px}.confirm-actions[_ngcontent-%COMP%]{display:flex;gap:8px;justify-content:flex-end}.confirm-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{color:#333;background:#e0e0e0}.confirm-actions[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{background:#2196f3;color:#fff}"]})};var FS=(n,e)=>e.columnPosition;function VS(n,e){if(n&1&&(c(0,"option",4),d(1),l()),n&2){let t=e.$implicit,i=e.$index;I("value",i),p(),P(t.name)}}function LS(n,e){if(n&1){let t=N();c(0,"div",18),_("mousedown",function(){let o=v(t).$implicit,r=m(3);return y(r.selectSuggestion(o))}),d(1),l()}if(n&2){let t=e.$implicit;p(),j(" ",t," ")}}function jS(n,e){if(n&1&&(c(0,"div",16),z(1,LS,2,1,"div",17,Ut),l()),n&2){let t=m(2);p(),$(t.valueSuggestions().slice(0,10))}}function zS(n,e){if(n&1){let t=N();c(0,"div",12)(1,"input",15),ft("ngModelChange",function(o){v(t);let r=m();return vt(r.newFilterValue,o)||(r.newFilterValue=o),y(o)}),_("focus",function(){v(t);let o=m();return y(o.showSuggestions=!0)})("blur",function(){v(t);let o=m();return y(o.onInputBlur())})("keydown.enter",function(){v(t);let o=m();return y(o.addFilter())}),l(),x(2,jS,3,0,"div",16),l()}if(n&2){let t=m();p(),pt("ngModel",t.newFilterValue),p(),S(t.showSuggestions&&t.valueSuggestions().length>0?2:-1)}}function $S(n,e){if(n&1&&(c(0,"span",24),d(1),l()),n&2){let t=m().$implicit;p(),j('"',t.value,'"')}}function BS(n,e){if(n&1){let t=N();c(0,"span",19)(1,"span",22),d(2),l(),c(3,"span",23),d(4),l(),x(5,$S,2,1,"span",24),c(6,"button",25),_("click",function(){let o=v(t).$index,r=m(2);return y(r.removeFilter(o))}),d(7,"\xD7"),l()()}if(n&2){let t=e.$implicit,i=m(2);p(2),P(t.columnName),p(2),P(i.getOperatorLabel(t.operator)),p(),S(t.value?5:-1)}}function HS(n,e){n&1&&(re(0,"span",26),d(1," Filtering... "))}function US(n,e){if(n&1&&d(0),n&2){let t=m(2);ve(" ",t.filterResult().matchingIndices.length," of ",t.filterResult().totalCount," samples ")}}function qS(n,e){if(n&1){let t=N();c(0,"div",14),z(1,BS,8,3,"span",19,Ve),c(3,"button",20),_("click",function(){v(t);let o=m();return y(o.clearFilters())}),d(4,"Clear all"),l(),c(5,"span",21),x(6,HS,2,0)(7,US,1,2),l()()}if(n&2){let t=m();p(),$(t.filters()),p(5),S(t.isFiltering()?6:7)}}var nl=class n{table=null;filterChange=new W;newFilterColumn=-1;newFilterOperator="equals";newFilterValue="";showSuggestions=!1;filters=w([]);isFiltering=w(!1);cachedFilterResult=w({matchingIndices:[],totalCount:0});filterResult=A(()=>this.cachedFilterResult());constructor(){br(()=>{let e=this.filters(),t=this.table;if(!t){this.cachedFilterResult.set({matchingIndices:[],totalCount:0});return}if(e.length===0){let i=Array.from({length:t.sampleCount},(o,r)=>r+1);this.cachedFilterResult.set({matchingIndices:i,totalCount:t.sampleCount});return}this.isFiltering.set(!0),setTimeout(()=>{let i=this.computeFilterResult(e,t);this.cachedFilterResult.set(i),this.isFiltering.set(!1)},0)})}computeFilterResult(e,t){let i=[];for(let o=1;o<=t.sampleCount;o++)this.rowMatchesAllFilters(o,e)&&i.push(o);return{matchingIndices:i,totalCount:t.sampleCount}}valueSuggestions=A(()=>{if(!this.table||this.newFilterColumn<0)return[];let e=this.table.columns[this.newFilterColumn];if(!e)return[];let t=new Set;for(let i=1;i<=this.table.sampleCount;i++){let o=de(e,i);o&&o.toLowerCase().includes(this.newFilterValue.toLowerCase())&&t.add(o)}return Array.from(t).sort()});canAddFilter(){return this.newFilterColumn<0?!1:this.newFilterOperator==="is_empty"||this.newFilterOperator==="is_not_empty"?!0:this.newFilterValue.trim().length>0}addFilter(){if(!this.canAddFilter()||!this.table)return;let e=this.table.columns[this.newFilterColumn],t={columnIndex:this.newFilterColumn,columnName:e.name,operator:this.newFilterOperator,value:this.newFilterValue.trim()};this.filters.set([...this.filters(),t]),this.emitFilterChange(),this.newFilterValue=""}removeFilter(e){let t=this.filters();this.filters.set([...t.slice(0,e),...t.slice(e+1)]),this.emitFilterChange()}clearFilters(){this.filters.set([]),this.emitFilterChange()}selectSuggestion(e){this.newFilterValue=e,this.showSuggestions=!1}onInputBlur(){setTimeout(()=>{this.showSuggestions=!1},200)}getOperatorLabel(e){switch(e){case"equals":return"=";case"contains":return"contains";case"starts_with":return"starts with";case"ends_with":return"ends with";case"is_empty":return"is empty";case"is_not_empty":return"is not empty"}}rowMatchesAllFilters(e,t){if(!this.table)return!1;for(let i of t){let o=this.table.columns[i.columnIndex];if(!o)continue;let r=de(o,e);if(!this.matchesFilter(r,i))return!1}return!0}matchesFilter(e,t){let i=e.toLowerCase(),o=t.value.toLowerCase();switch(t.operator){case"equals":return i===o;case"contains":return i.includes(o);case"starts_with":return i.startsWith(o);case"ends_with":return i.endsWith(o);case"is_empty":return e.trim()==="";case"is_not_empty":return e.trim()!==""}}emitFilterChange(){this.filterChange.emit(this.filterResult())}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ee({type:n,selectors:[["sdrf-filter-bar"]],inputs:{table:"table"},outputs:{filterChange:"filterChange"},decls:24,vars:7,consts:[[1,"filter-bar"],[1,"filter-controls"],[1,"filter-select",3,"ngModelChange","ngModel"],["value","-1"],[3,"value"],[1,"filter-select","operator",3,"ngModelChange","ngModel"],["value","equals"],["value","contains"],["value","starts_with"],["value","ends_with"],["value","is_empty"],["value","is_not_empty"],[1,"value-input-wrapper"],[1,"btn","btn-primary",3,"click","disabled"],[1,"active-filters"],["type","text","placeholder","Value...",1,"filter-input",3,"ngModelChange","focus","blur","keydown.enter","ngModel"],[1,"suggestions"],[1,"suggestion-item"],[1,"suggestion-item",3,"mousedown"],[1,"filter-chip"],[1,"btn-link",3,"click"],[1,"filter-result"],[1,"filter-column"],[1,"filter-operator"],[1,"filter-value"],[1,"remove-btn",3,"click"],[1,"filter-spinner"]],template:function(t,i){t&1&&(c(0,"div",0)(1,"div",1)(2,"select",2),ft("ngModelChange",function(r){return vt(i.newFilterColumn,r)||(i.newFilterColumn=r),r}),c(3,"option",3),d(4,"Select column..."),l(),z(5,VS,2,2,"option",4,FS),l(),c(7,"select",5),ft("ngModelChange",function(r){return vt(i.newFilterOperator,r)||(i.newFilterOperator=r),r}),c(8,"option",6),d(9,"equals"),l(),c(10,"option",7),d(11,"contains"),l(),c(12,"option",8),d(13,"starts with"),l(),c(14,"option",9),d(15,"ends with"),l(),c(16,"option",10),d(17,"is empty"),l(),c(18,"option",11),d(19,"is not empty"),l()(),x(20,zS,3,2,"div",12),c(21,"button",13),_("click",function(){return i.addFilter()}),d(22," Add Filter "),l()(),x(23,qS,8,1,"div",14),l()),t&2&&(B("has-filters",i.filters().length>0),p(2),pt("ngModel",i.newFilterColumn),p(3),$(i.table==null?null:i.table.columns),p(2),pt("ngModel",i.newFilterOperator),p(13),S(i.newFilterOperator!=="is_empty"&&i.newFilterOperator!=="is_not_empty"?20:-1),p(),I("disabled",!i.canAddFilter()),p(2),S(i.filters().length>0?23:-1))},dependencies:[te,ce,Ue,qe,ye,st,Me,xe],styles:[".filter-bar[_ngcontent-%COMP%]{padding:8px 16px;background:#f8f9fa;border-bottom:1px solid #ddd}.filter-bar.has-filters[_ngcontent-%COMP%]{background:#e3f2fd}.filter-controls[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center;flex-wrap:wrap}.filter-select[_ngcontent-%COMP%]{padding:6px 10px;border:1px solid #ccc;border-radius:4px;font-size:13px;background:#fff}.filter-select.operator[_ngcontent-%COMP%]{min-width:120px}.value-input-wrapper[_ngcontent-%COMP%]{position:relative;flex:1;min-width:150px;max-width:250px}.filter-input[_ngcontent-%COMP%]{width:100%;padding:6px 10px;border:1px solid #ccc;border-radius:4px;font-size:13px}.filter-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#2196f3}.suggestions[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;right:0;background:#fff;border:1px solid #ddd;border-top:none;border-radius:0 0 4px 4px;max-height:200px;overflow-y:auto;z-index:100;box-shadow:0 4px 6px #0000001a}.suggestion-item[_ngcontent-%COMP%]{padding:8px 10px;cursor:pointer;font-size:13px}.suggestion-item[_ngcontent-%COMP%]:hover{background:#f5f5f5}.btn[_ngcontent-%COMP%]{padding:6px 12px;border:none;border-radius:4px;font-size:13px;cursor:pointer}.btn-primary[_ngcontent-%COMP%]{background:#2196f3;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#1976d2}.btn-primary[_ngcontent-%COMP%]:disabled{background:#ccc;cursor:not-allowed}.btn-link[_ngcontent-%COMP%]{background:none;border:none;color:#1976d2;cursor:pointer;font-size:12px;text-decoration:underline}.active-filters[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center;margin-top:8px;flex-wrap:wrap}.filter-chip[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;padding:4px 8px;background:#fff;border:1px solid #2196f3;border-radius:16px;font-size:12px}.filter-column[_ngcontent-%COMP%]{font-weight:500;color:#1976d2}.filter-operator[_ngcontent-%COMP%]{color:#666}.filter-value[_ngcontent-%COMP%]{color:#333}.remove-btn[_ngcontent-%COMP%]{background:none;border:none;color:#999;cursor:pointer;padding:0 2px;font-size:14px;line-height:1}.remove-btn[_ngcontent-%COMP%]:hover{color:#d32f2f}.filter-result[_ngcontent-%COMP%]{margin-left:auto;font-size:12px;color:#666;font-weight:500;display:flex;align-items:center;gap:6px}.filter-spinner[_ngcontent-%COMP%]{width:12px;height:12px;border:2px solid #e3f2fd;border-top-color:#1976d2;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}"]})};var il=class extends Ap{name="openai";supportsStreaming=!0;constructor(e={}){super(e)}getProviderType(){return"openai"}complete(e){return k(this,null,function*(){this.validateConfiguration();let t=`${this.config.baseUrl}/chat/completions`,i={model:this.config.model,messages:this.convertMessages(e),max_tokens:this.config.maxTokens,temperature:this.config.temperature,stream:!1},o=yield this.fetchWithTimeout(t,{method:"POST",headers:this.getHeaders(),body:JSON.stringify(i)});if(!o.ok){let s=yield o.text();throw this.createErrorFromResponse(o.status,s)}let r=yield o.json();return this.convertResponse(r)})}stream(e){return Sn(this,null,function*(){this.validateConfiguration();let t=`${this.config.baseUrl}/chat/completions`,i={model:this.config.model,messages:this.convertMessages(e),max_tokens:this.config.maxTokens,temperature:this.config.temperature,stream:!0},o=yield new nt(this.fetchStream(t,{method:"POST",headers:this.getHeaders(),body:JSON.stringify(i)}));try{for(var r=wn(this.parseSSEStream(o)),s,a,u;s=!(a=yield new nt(r.next())).done;s=!1){let f=a.value;try{let h=JSON.parse(f).choices[0];h&&(yield{content:h.delta.content||"",done:h.finish_reason!==null,finishReason:h.finish_reason||void 0})}catch(g){console.warn("Failed to parse OpenAI stream chunk:",f,g)}}}catch{u=[a]}finally{try{s&&(a=r.return)&&(yield new nt(a.call(r)))}finally{if(u)throw u[0]}}})}getHeaders(){return O(E({},this.getCommonHeaders()),{Authorization:`Bearer ${this.config.apiKey}`})}convertMessages(e){return e.map(t=>({role:t.role,content:t.content}))}convertResponse(e){let t=e.choices[0],i=e.usage?{promptTokens:e.usage.prompt_tokens,completionTokens:e.usage.completion_tokens,totalTokens:e.usage.total_tokens}:void 0;return{content:t?.message?.content||"",finishReason:this.mapFinishReason(t?.finish_reason),usage:i,raw:e}}mapFinishReason(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content_filter";default:return}}};var WS=["not available","not applicable","anonymized","pooled"],GS={maxSampleRows:10,maxUniqueValues:20,includeSampleData:!0,maxContextLength:8e3},Fi=class{config;constructor(e={}){this.config=E(E({},GS),e)}buildContext(e,t=["all"],i){let o=this.buildColumnContexts(e,i),r=this.identifyIssues(e,o,t),s=this.config.includeSampleData?this.buildSampleData(e,r):void 0,a=t.includes("all")?["fill_missing","validate_ontology","check_consistency"]:t;return{metadata:{sampleCount:e.sampleCount,columnCount:e.columns.length,columnNames:e.columns.map(u=>u.name)},columns:o,issues:r,sampleData:s,focusAreas:a}}contextToString(e){let t=[];t.push("## Table Overview"),t.push(`- Samples: ${e.metadata.sampleCount}`),t.push(`- Columns: ${e.metadata.columnCount}`),t.push(""),t.push("## Analysis Focus"),t.push(e.focusAreas.map(r=>`- ${this.formatFocusArea(r)}`).join(`
`)),t.push(""),t.push("## Columns with Issues");let i=e.columns.filter(r=>r.notAvailableCount>0||r.emptyCount>0||e.issues.some(s=>s.columnIndex===r.index));for(let r of i){if(t.push(`### ${r.name}`),t.push(`- Type: ${r.type}`),t.push(`- Required: ${r.isRequired?"Yes":"No"}`),r.ontologies&&r.ontologies.length>0&&t.push(`- Ontologies: ${r.ontologies.join(", ")}`),r.examples&&r.examples.length>0&&t.push(`- Examples: ${r.examples.slice(0,5).join(", ")}`),r.notAvailableCount>0&&t.push(`- "not available" values: ${r.notAvailableCount}`),r.emptyCount>0&&t.push(`- Empty values: ${r.emptyCount}`),r.uniqueValues.length>0){let s=r.uniqueValues.slice(0,10);t.push(`- Current values: ${s.join(", ")}${r.uniqueValues.length>10?"...":""}`)}t.push("")}if(e.issues.length>0){t.push("## Identified Issues");for(let r of e.issues.slice(0,20))t.push(`- [${r.type}] ${r.column}: ${r.details||""} (${r.sampleIndices.length} samples)`);e.issues.length>20&&t.push(`... and ${e.issues.length-20} more issues`),t.push("")}if(e.sampleData&&e.sampleData.length>0){t.push("## Sample Data (affected rows)"),t.push("```"),t.push(e.metadata.columnNames.join("	"));for(let r of e.sampleData)t.push(r.join("	"));t.push("```")}let o=t.join(`
`);return this.config.maxContextLength&&o.length>this.config.maxContextLength&&(o=o.substring(0,this.config.maxContextLength)+`
... (truncated)`),o}buildColumnContexts(e,t){return e.columns.map((i,o)=>{let r=t?.columns.find(h=>h.name.toLowerCase()===i.name.toLowerCase()),{uniqueValues:s,notAvailableCount:a,emptyCount:u}=this.analyzeColumnValues(i,e.sampleCount),f=r?.validators?.find(h=>h.validator_name==="ontology"),g=r?.validators?.find(h=>h.validator_name==="pattern");return{name:i.name,index:o,type:this.detectColumnType(i.name),isRequired:r?.requirement==="required"||i.isRequired||!1,ontologies:f?.params?.ontologies,pattern:g?.params?.pattern,examples:f?.params?.examples||g?.params?.examples,allowNotAvailable:r?.allow_not_available??!0,allowNotApplicable:r?.allow_not_applicable??!0,uniqueValues:s.slice(0,this.config.maxUniqueValues),notAvailableCount:a,emptyCount:u}})}analyzeColumnValues(e,t){let i=new Set,o=0,r=0;for(let s=1;s<=t;s++){let a=de(e,s),u=a.toLowerCase().trim();!a||a.trim()===""?r++:u==="not available"?o++:WS.includes(u)||i.add(a)}return{uniqueValues:Array.from(i).sort(),notAvailableCount:o,emptyCount:r}}identifyIssues(e,t,i){let o=[],r=i.includes("all")||i.includes("fill_missing"),s=i.includes("all")||i.includes("validate_ontology"),a=i.includes("all")||i.includes("check_consistency");for(let u of t){let f=e.columns[u.index];if(r){let g=[];for(let h=1;h<=e.sampleCount;h++){let b=de(f,h),C=b.toLowerCase().trim();(!b||b.trim()===""||C==="not available")&&g.push(h)}g.length>0&&g.length<e.sampleCount&&o.push({type:"missing_value",column:u.name,columnIndex:u.index,sampleIndices:g,currentValue:"not available",details:`${g.length} samples have missing or "not available" values`})}if(s&&u.ontologies&&u.ontologies.length>0){let g=u.uniqueValues.filter(h=>!h.includes(":")&&!h.match(/\[\w+:\d+\]/));if(g.length>0){let h=[];for(let b=1;b<=e.sampleCount;b++){let C=de(f,b);g.includes(C)&&h.push(b)}h.length>0&&o.push({type:"invalid_ontology",column:u.name,columnIndex:u.index,sampleIndices:h.slice(0,100),details:`Values may need ontology validation: ${g.slice(0,5).join(", ")}`})}}if(a&&u.uniqueValues.length>1){let g=this.findSimilarValues(u.uniqueValues);for(let h of g)if(h.length>1){let b=[];for(let C=1;C<=e.sampleCount;C++){let T=de(f,C);h.includes(T)&&b.push(C)}o.push({type:"inconsistency",column:u.name,columnIndex:u.index,sampleIndices:b,details:`Similar values found: ${h.join(", ")}`})}}}return o}findSimilarValues(e){let t=[],i=new Set;for(let o of e){if(i.has(o))continue;let r=e.filter(s=>s===o||i.has(s)?!1:this.areSimilar(o,s));if(r.length>0){t.push([o,...r]),i.add(o);for(let s of r)i.add(s)}}return t}areSimilar(e,t){let i=e.toLowerCase().trim(),o=t.toLowerCase().trim();if(i===o||i.includes(o)||o.includes(i))return!0;if(i.length<20&&o.length<20){let r=this.levenshteinDistance(i,o),s=Math.max(i.length,o.length);return r/s<.3}return!1}levenshteinDistance(e,t){let i=[];for(let o=0;o<=t.length;o++)i[o]=[o];for(let o=0;o<=e.length;o++)i[0][o]=o;for(let o=1;o<=t.length;o++)for(let r=1;r<=e.length;r++)t.charAt(o-1)===e.charAt(r-1)?i[o][r]=i[o-1][r-1]:i[o][r]=Math.min(i[o-1][r-1]+1,i[o][r-1]+1,i[o-1][r]+1);return i[t.length][e.length]}buildSampleData(e,t){let i=new Set;for(let s of t)for(let a of s.sampleIndices.slice(0,5))i.add(a);let o=Array.from(i).slice(0,this.config.maxSampleRows),r=[];for(let s of o){let a=[];for(let u of e.columns)a.push(de(u,s));r.push(a)}return r}detectColumnType(e){let t=e.toLowerCase();return t==="source name"||t==="assay name"?"identifier":t.startsWith("characteristics[")?"characteristic":t.startsWith("factor value[")?"factor":t.startsWith("comment[")?"comment":t==="technology type"?"controlled_vocabulary":"general"}formatFocusArea(e){return{fill_missing:'Fill missing and "not available" values',validate_ontology:"Validate and suggest ontology terms",check_consistency:"Check data consistency",all:"Comprehensive analysis"}[e]}},Mj=new Fi;var ol=`You are an expert in proteomics data annotation, specifically the SDRF (Sample and Data Relationship Format) specification used in the PRIDE database and proteomics community.

## SDRF Format Rules

### Required Columns (ALL experiments):
- source name: Unique sample identifier
- characteristics[organism]: NCBI Taxonomy lowercase (e.g., "homo sapiens", "mus musculus")
- characteristics[organism part]: UBERON term lowercase (e.g., "liver", "blood plasma")
- characteristics[biological replicate]: Integer starting from 1 per condition
- assay name: Unique MS run identifier
- comment[instrument]: MS ontology term (e.g., "Q Exactive HF")
- comment[data file]: Raw file name
- comment[label]: Label type (e.g., "label free sample", "TMT126")
- technology type: Usually "proteomic profiling by mass spectrometry"

### Reserved Words (MUST use instead of empty cells):
- "not available": Value unknown or not recorded
- "not applicable": Concept doesn't apply (e.g., age for synthetic sample)
- "anonymized": Value redacted for privacy
- "pooled": Sample is mixture of multiple sources

### Ontology Requirements:
- characteristics[organism]: NCBI Taxonomy
- characteristics[organism part]: UBERON (for mammals), BTO
- characteristics[cell type]: Cell Ontology (CL)
- characteristics[disease]: MONDO (preferred), EFO, or DOID
- characteristics[cell line]: Free text (e.g., "HeLa", "HEK293")
- comment[instrument]: PSI-MS ontology

### Common Mistakes to AVOID:
- \u274C "control" for healthy samples \u2192 \u2705 Use "normal"
- \u274C "characteristics[tissue]" \u2192 \u2705 Use "characteristics[organism part]"
- \u274C Empty cells \u2192 \u2705 Use reserved words
- \u274C "Characteristics[...]" \u2192 \u2705 Use "characteristics[...]" (lowercase)
- \u274C "blood" \u2192 \u2705 Use "blood plasma" or specific component
- \u274C "NA", "N/A", "Unknown" \u2192 \u2705 Use "not available"
- \u274C Uppercase values \u2192 \u2705 Use lowercase (e.g., "homo sapiens" not "Homo Sapiens")

### Age Format (for human samples):
- Exact: 25Y, 6M, 30D (years, months, days)
- Range: 40Y-50Y
- Greater/Less: >18Y, <65Y

### Disease Column Rules:
- Use "normal" for healthy samples (NOT "control" or "healthy")
- Use MONDO terms for diseases (e.g., "breast carcinoma", "diabetes mellitus")

## Output Format

You MUST respond with a valid JSON object containing recommendations:

\`\`\`json
{
  "recommendations": [
    {
      "type": "fill_value" | "correct_value" | "ontology_suggestion" | "consistency_fix",
      "column": "column name",
      "columnIndex": 0,
      "sampleIndices": [1, 2, 3],
      "currentValue": "current value or empty",
      "suggestedValue": "suggested value",
      "confidence": "high" | "medium" | "low",
      "reasoning": "Brief explanation"
    }
  ],
  "summary": "Brief overall summary"
}
\`\`\`

## Important Guidelines

1. Only suggest changes you are confident about
2. For ontology terms, use the common label in lowercase
3. Be conservative - don't guess at values you can't reasonably infer
4. For consistency fixes, prefer the most common or most standard form
5. Always replace "control" with "normal" for disease columns
6. Standardize null values to "not available" or "not applicable"`,ep=`

## Human Sample Requirements

REQUIRED columns for human data:
1. characteristics[disease] - Use MONDO terms. For healthy: "normal" (NEVER "control")
2. characteristics[age] - Format: 25Y, 6M, 30D, or ranges like 40Y-50Y, or ">18Y"
3. characteristics[sex] - "male" or "female" (lowercase)

RECOMMENDED columns:
- characteristics[individual] - Pseudonymized patient ID (e.g., "patient_001")
- characteristics[ancestry category] - "African", "European", "East Asian", "South Asian", "American"

For CLINICAL studies also consider:
- characteristics[tumor stage] - TNM format: "T1N0M0", "pT2pN1M0"
- characteristics[treatment] - Therapy type from NCIT
- characteristics[compound] - Drug name if applicable
- characteristics[dose] - Format: "100 nanomolar", "10 micromolar"`,tp=`

## Cell Line Requirements

REQUIRED:
- characteristics[cell line] - Cell line name (e.g., "HeLa", "HEK293", "MCF-7")

For organism part: Use tissue of origin (e.g., "cervix" for HeLa) or "not applicable"
For disease: Use disease the cell line models or "normal" for non-disease lines
For sex: Use "female" for HeLa, "male" for HEK293, etc. based on cell line origin`,np=`

## Vertebrate (Non-Human) Sample Requirements

REQUIRED:
- characteristics[disease] - MONDO term or "normal" for healthy animals

RECOMMENDED:
- characteristics[strain/breed] - e.g., "C57BL/6", "Sprague-Dawley", "BALB/c"
- characteristics[developmental stage] - e.g., "adult", "embryonic day 14", "8 weeks"
- characteristics[sex] - "male", "female", or "hermaphrodite"

Common organisms:
- Mouse: "mus musculus"
- Rat: "rattus norvegicus"
- Zebrafish: "danio rerio"`;function x0(n){return n.length===0?"":`

## Quality Issues Found in This File:
${n.map(e=>`- ${e.column}: ${e.reason}`).join(`
`)}

Please address these issues in your recommendations.`}function QS(n){if(n.length===0)return"";let e=n.filter(o=>o.level==="error"),t=n.filter(o=>o.level==="warning"),i=[];if(i.push(`
## SDRF-Pipelines Validator Results (PRIORITY - Address These First):`),i.push(`Found ${e.length} errors and ${t.length} warnings.
`),e.length>0){i.push("### Errors (Must Fix):");for(let o of e.slice(0,10)){let r=o.row!==void 0&&o.row>=0?`Row ${o.row+1}`:"General",s=o.column?` in "${o.column}"`:"",a=o.value?` (current value: "${o.value}")`:"",u=o.suggestion?` \u2192 Suggested fix: ${o.suggestion}`:"";i.push(`- ${r}${s}${a}: ${o.message}${u}`)}e.length>10&&i.push(`  ... and ${e.length-10} more errors`)}if(t.length>0){i.push(`
### Warnings (Should Review):`);for(let o of t.slice(0,5)){let r=o.row!==void 0&&o.row>=0?`Row ${o.row+1}`:"General",s=o.column?` in "${o.column}"`:"";i.push(`- ${r}${s}: ${o.message}`)}t.length>5&&i.push(`  ... and ${t.length-5} more warnings`)}return i.push(`
Generate recommendations to address these validator findings.`),i.join(`
`)}var Br=class{contextBuilder;constructor(e){this.contextBuilder=e||new Fi}buildAnalysisMessages(e,t,i,o){let r=[],s=this.detectSampleTypes(e),a=ol;s.includes("human")&&(a+=ep),s.includes("cell-line")&&(a+=tp),s.includes("vertebrate")&&(a+=np),o&&o.length>0&&(a+=QS(o)),i&&i.length>0&&(a+=x0(i)),r.push({role:"system",content:a});let u=this.buildUserPrompt(e,t);return r.push({role:"user",content:u}),r}detectSampleTypes(e){let t=[],i=e.columns.find(r=>r.name.toLowerCase()==="characteristics[organism]"),o=e.columns.find(r=>r.name.toLowerCase()==="characteristics[cell line]");if(i){let r=i.uniqueValues.map(a=>a.toLowerCase());r.some(a=>a.includes("homo sapiens")||a.includes("human"))&&t.push("human");let s=["mus musculus","mouse","rattus norvegicus","rat","danio rerio","zebrafish","sus scrofa","pig","bos taurus","cow","cattle","gallus gallus","chicken","ovis aries","sheep","canis","dog","felis catus","cat"];r.some(a=>s.some(u=>a.includes(u)))&&t.push("vertebrate")}return o&&o.uniqueValues.length>0&&o.uniqueValues.some(s=>s&&s.toLowerCase()!=="not available"&&s.toLowerCase()!=="not applicable")&&t.push("cell-line"),t.length===0&&t.push("other"),t}convertQualityToPromptIssues(e){return e.filter(t=>t.action==="review"||t.action==="remove").map(t=>({column:t.name,reason:t.reason+(t.suggestedFix?` (Fix: ${t.suggestedFix})`:"")}))}buildUserPrompt(e,t){let i=[];i.push("Please analyze the following SDRF data and provide recommendations for improvement."),i.push(""),i.push("**Analysis Focus:**");for(let o of e.focusAreas)i.push(`- ${this.formatFocusArea(o)}`);return i.push(""),i.push("**SDRF Data:**"),i.push(""),i.push(this.contextBuilder.contextToString(e)),t&&(i.push(""),i.push("**Additional Instructions:**"),i.push(t)),i.push(""),i.push("Remember to respond with a valid JSON object containing your recommendations."),i.join(`
`)}buildColumnFocusedPrompt(e,t){let i=e.columns.find(a=>a.name.toLowerCase()===t.toLowerCase());if(!i)throw new Error(`Column "${t}" not found in context`);let o=[];o.push({role:"system",content:ol});let r=[];r.push(`Please analyze the "${t}" column and provide recommendations.`),r.push(""),r.push("**Column Details:**"),r.push(`- Name: ${i.name}`),r.push(`- Type: ${i.type}`),r.push(`- Required: ${i.isRequired?"Yes":"No"}`),i.ontologies&&i.ontologies.length>0&&r.push(`- Expected Ontologies: ${i.ontologies.join(", ")}`),i.examples&&i.examples.length>0&&r.push(`- Valid Examples: ${i.examples.join(", ")}`),r.push(""),r.push("**Current Values:**"),r.push(`- Unique values: ${i.uniqueValues.join(", ")||"None"}`),r.push(`- "not available" count: ${i.notAvailableCount}`),r.push(`- Empty count: ${i.emptyCount}`);let s=e.issues.filter(a=>a.column.toLowerCase()===t.toLowerCase());if(s.length>0){r.push(""),r.push("**Identified Issues:**");for(let a of s)r.push(`- ${a.type}: ${a.details} (${a.sampleIndices.length} samples)`)}return r.push(""),r.push("Respond with JSON recommendations for this column only."),o.push({role:"user",content:r.join(`
`)}),o}buildOntologyValidationPrompt(e,t,i){let o=[];o.push({role:"system",content:`You are an expert in biomedical ontologies. Your task is to validate and suggest correct ontology terms.

For each value provided, determine:
1. If it's a valid term from the specified ontologies
2. If not, suggest the correct term

Respond with JSON:
\`\`\`json
{
  "validations": [
    {
      "originalValue": "input value",
      "isValid": true/false,
      "suggestedValue": "correct term if invalid",
      "confidence": "high" | "medium" | "low",
      "reasoning": "brief explanation"
    }
  ]
}
\`\`\``});let r=`Validate these values for the "${e}" column.

Expected ontologies: ${i.join(", ")}

Values to validate:
${t.map((s,a)=>`${a+1}. "${s}"`).join(`
`)}`;return o.push({role:"user",content:r}),o}buildValueInferencePrompt(e,t,i,o){let r=[];r.push({role:"system",content:`You are an expert in proteomics data annotation. Your task is to infer missing values based on:
1. Other values in the same column
2. Values in related columns for the same samples
3. Common patterns in proteomics experiments

Be conservative - only suggest values you are reasonably confident about.

Respond with JSON:
\`\`\`json
{
  "inferences": [
    {
      "sampleIndex": 1,
      "suggestedValue": "inferred value",
      "confidence": "high" | "medium" | "low",
      "reasoning": "why this value was inferred"
    }
  ],
  "cannotInfer": [2, 3]  // sample indices where inference is not possible
}
\`\`\``});let s=[];s.push(`Infer missing values for the "${e}" column.`),s.push(""),s.push("**Known values in this column:**");for(let a of t.slice(0,20))s.push(`- Sample ${a.sampleIndex}: "${a.value}"`);if(t.length>20&&s.push(`... and ${t.length-20} more`),s.push(""),s.push(`**Samples missing values:** ${i.slice(0,50).join(", ")}`),i.length>50&&s.push(`... and ${i.length-50} more`),o&&o.length>0){s.push(""),s.push("**Related column values for missing samples:**");for(let a of o){s.push(`
${a.name}:`);for(let u of i.slice(0,10)){let f=a.values.get(u);f&&s.push(`- Sample ${u}: "${f}"`)}}}return r.push({role:"user",content:s.join(`
`)}),r}getSystemPrompt(e,t){let i=ol;return e&&(e.includes("human")&&(i+=ep),e.includes("cell-line")&&(i+=tp),e.includes("vertebrate")&&(i+=np)),t&&t.length>0&&(i+=x0(t)),i}getBaseSystemPrompt(){return ol}getTemplatePrompt(e){switch(e){case"human":return ep;case"cell-line":return tp;case"vertebrate":return np;default:return""}}formatFocusArea(e){return{fill_missing:'Fill missing and "not available" values',validate_ontology:"Validate and suggest ontology terms",check_consistency:"Check data consistency",all:"Comprehensive analysis"}[e]}},Pj=new Br;var ip="sdrf_llm_settings",S0="sdrf_llm_key",op=class{settings;cryptoKey=null;useSessionStorage;constructor(e={}){this.useSessionStorage=e.useSessionStorage||!1,this.settings=this.loadSettings()}getSettings(){return E({},this.settings)}getActiveProvider(){return this.settings.activeProvider}setActiveProvider(e){this.settings.activeProvider=e,this.saveSettings()}getProviderConfig(e){let t=this.settings.providers[e];if(t)return O(E(E({},Hi[e]),t),{provider:e})}getActiveProviderConfig(){return this.getProviderConfig(this.settings.activeProvider)}isAnyProviderConfigured(){let e=this.settings.activeProvider;if(e==="ollama")return!0;let t=this.getProviderConfig(e);return!!(t?.apiKey&&t.apiKey.length>0)}setProviderConfig(e,t){return k(this,null,function*(){let i=this.settings.providers[e]||E({provider:e},Hi[e]);this.settings.providers[e]=O(E(E({},i),t),{provider:e}),yield this.saveSettings()})}setApiKey(e,t){return k(this,null,function*(){let i=this.settings.providers[e]||E({provider:e},Hi[e]);if(this.settings.storageConsent&&this.settings.storageMode==="persistent"){let o=yield this.encryptApiKey(t);i._encryptedKey=o,i.apiKey=t}else i.apiKey=t;this.settings.providers[e]=i,yield this.saveSettings()})}getApiKey(e){return k(this,null,function*(){let t=this.settings.providers[e];if(!t)return;if(t.apiKey)return t.apiKey;let i=t._encryptedKey;if(i)try{return yield this.decryptApiKey(i)}catch(o){console.warn("Failed to decrypt API key:",o);return}})}clearApiKey(e){return k(this,null,function*(){let t=this.settings.providers[e];t&&(delete t.apiKey,delete t._encryptedKey,yield this.saveSettings())})}isProviderConfigured(e){return Op(this.getProviderConfig(e))}isActiveProviderConfigured(){return this.isProviderConfigured(this.settings.activeProvider)}hasStorageConsent(){return this.settings.storageConsent}setStorageConsent(e,t="session"){return k(this,null,function*(){if(this.settings.storageConsent=e,this.settings.storageMode=t,!e)for(let i of Object.keys(this.settings.providers))delete this.settings.providers[i]?._encryptedKey;yield this.saveSettings()})}clearAll(){this.settings=E({},Ur),this.getStorage().removeItem(ip)}exportSettings(){let e={activeProvider:this.settings.activeProvider,providers:{}};for(let[i,o]of Object.entries(this.settings.providers))if(o){let t=o,{apiKey:r}=t,s=Tp(t,["apiKey"]);delete s._encryptedKey,e.providers[i]=s}return e}importSettings(e){return k(this,null,function*(){if(e.activeProvider&&(this.settings.activeProvider=e.activeProvider),e.providers){for(let[t,i]of Object.entries(e.providers))if(i){let o=yield this.getApiKey(t);this.settings.providers[t]=O(E({},i),{apiKey:o})}}yield this.saveSettings()})}getStorage(){return this.useSessionStorage?sessionStorage:localStorage}loadSettings(){try{let e=this.getStorage().getItem(ip);if(e){let t=JSON.parse(e);return E(E({},Ur),t)}}catch(e){console.warn("Failed to load LLM settings:",e)}return E({},Ur)}saveSettings(){return k(this,null,function*(){try{let e=O(E({},this.settings),{lastUsed:Date.now()});if(e.providers){e.providers=E({},e.providers);for(let t of Object.keys(e.providers))if(e.providers[t]){let i=E({},e.providers[t]);!this.settings.storageConsent||this.settings.storageMode==="session"?(delete i.apiKey,delete i._encryptedKey):delete i.apiKey,e.providers[t]=i}}this.getStorage().setItem(ip,JSON.stringify(e))}catch(e){console.error("Failed to save LLM settings:",e)}})}getEncryptionKey(){return k(this,null,function*(){if(this.cryptoKey)return this.cryptoKey;try{let e=yield this.loadKeyFromIndexedDB();if(e)return this.cryptoKey=e,e}catch(e){console.warn("Failed to load encryption key:",e)}return this.cryptoKey=yield crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"]),yield this.saveKeyToIndexedDB(this.cryptoKey),this.cryptoKey})}encryptApiKey(e){return k(this,null,function*(){let t=yield this.getEncryptionKey(),i=crypto.getRandomValues(new Uint8Array(12)),o=new TextEncoder,r=yield crypto.subtle.encrypt({name:"AES-GCM",iv:i},t,o.encode(e)),s=new Uint8Array(i.length+r.byteLength);return s.set(i),s.set(new Uint8Array(r),i.length),btoa(String.fromCharCode(...s))})}decryptApiKey(e){return k(this,null,function*(){let t=yield this.getEncryptionKey(),i=new Uint8Array(atob(e).split("").map(a=>a.charCodeAt(0))),o=i.slice(0,12),r=i.slice(12),s=yield crypto.subtle.decrypt({name:"AES-GCM",iv:o},t,r);return new TextDecoder().decode(s)})}loadKeyFromIndexedDB(){return new Promise(e=>{try{let t=indexedDB.open("sdrf_llm_keys",1);t.onerror=()=>e(null),t.onupgradeneeded=i=>{let o=i.target.result;o.objectStoreNames.contains("keys")||o.createObjectStore("keys")},t.onsuccess=i=>{let o=i.target.result,a=o.transaction("keys","readonly").objectStore("keys").get(S0);a.onerror=()=>{o.close(),e(null)},a.onsuccess=()=>{o.close(),e(a.result||null)}}}catch{e(null)}})}saveKeyToIndexedDB(e){return new Promise((t,i)=>{try{let o=indexedDB.open("sdrf_llm_keys",1);o.onerror=()=>i(new Error("Failed to open IndexedDB")),o.onupgradeneeded=r=>{let s=r.target.result;s.objectStoreNames.contains("keys")||s.createObjectStore("keys")},o.onsuccess=r=>{let s=r.target.result,a=s.transaction("keys","readwrite");a.objectStore("keys").put(e,S0),a.oncomplete=()=>{s.close(),t()},a.onerror=()=>{s.close(),i(new Error("Failed to save key"))}}}catch(o){i(o)}})}},Oo=new op;var Xn=["not available","not applicable","anonymized","pooled"],Vi=["na","n/a","n.a.","none","null","unknown","-","--","missing",""],YS=["source name","characteristics[organism]","characteristics[organism part]","characteristics[biological replicate]","assay name","technology type","comment[data file]","comment[instrument]","comment[label]","comment[fraction identifier]"],KS=["characteristics[disease]","characteristics[age]","characteristics[sex]"],ZS=["comment[sdrf template]","comment[sdrf-template]","technology type","comment[instrument]","comment[label]","comment[modification parameters]","comment[cleavage agent details]","comment[precursor mass tolerance]","comment[fragment mass tolerance]","characteristics[organism]"],ei=class{analyzeTable(e){let t=this.detectIfHuman(e),i=this.getRequiredColumns(t),o=[];for(let a=0;a<e.columns.length;a++){let u=e.columns[a],f=this.analyzeColumn(u,e,i);o.push(f)}let r=o.filter(a=>a.action==="remove"),s=o.filter(a=>a.action==="review");return{columns:o,removeRecommendations:r,reviewRecommendations:s,summary:{totalColumns:o.length,redundantColumns:o.filter(a=>a.isRedundant).length,effectivelyEmptyColumns:o.filter(a=>a.isEffectivelyEmpty).length,columnsWithIssues:o.filter(a=>a.hasInconsistentCase||a.hasInconsistentNulls||a.hasWrongReservedWords||a.hasWrongColumnNameCase).length}}}analyzeColumn(e,t,i){let o=this.getValueCountsFromColumn(e,t.sampleCount),s=new Set(o.keys()).size,a=this.calculateEntropyFromCounts(o,t.sampleCount),u=0,f=0,g=0;for(let[M,D]of o){let R=(M||"").toLowerCase().trim();R===""||M===void 0||M===null?u+=D:R==="not available"?f+=D:R==="not applicable"&&(g+=D)}let h=Array.from(o.keys()),b=s===1,C=this.isEffectivelyEmptyFromValues(h),T=this.hasInconsistentCaseFromValues(h),F=this.hasInconsistentNullsFromValues(h),U=this.hasWrongReservedWordsFromValues(h,e.name),K=this.hasWrongColumnNameCase(e.name),We=i.some(M=>M.toLowerCase()===e.name.toLowerCase()),{action:Et,reason:Re,suggestedFix:Ce}=this.determineAction({column:e,values:h,isRedundant:b,isEffectivelyEmpty:C,hasInconsistentCase:T,hasInconsistentNulls:F,hasWrongReservedWords:U,hasWrongColumnNameCase:K,isRequired:We,uniqueValues:s,entropy:a});return{name:e.name,columnIndex:e.columnPosition,totalRows:t.sampleCount,uniqueValues:s,entropy:a,emptyCount:u,notAvailableCount:f,notApplicableCount:g,isRedundant:b,isEffectivelyEmpty:C,hasInconsistentCase:T,hasInconsistentNulls:F,hasWrongReservedWords:U,hasWrongColumnNameCase:K,action:Et,reason:Re,suggestedFix:Ce,isRequired:We}}getValueCountsFromColumn(e,t){let i=new Map,o=0;for(let s of e.modifiers){let a=this.countSamplesInRange(s.samples);o+=a,i.set(s.value,(i.get(s.value)||0)+a)}let r=t-o;return r>0&&i.set(e.value,(i.get(e.value)||0)+r),i}countSamplesInRange(e){let t=0,i=e.split(",");for(let o of i){let r=o.trim();if(r.includes("-")){let[s,a]=r.split("-").map(Number);!isNaN(s)&&!isNaN(a)&&(t+=a-s+1)}else{let s=Number(r);isNaN(s)||(t+=1)}}return t}calculateEntropyFromCounts(e,t){if(t===0)return 0;let i=0;for(let o of e.values()){let r=o/t;r>0&&(i-=r*Math.log2(r))}return i}isEffectivelyEmptyFromValues(e){return e.every(t=>{let i=(t||"").toLowerCase().trim();return i===""||Xn.includes(i)||Vi.includes(i)})}hasInconsistentCaseFromValues(e){let t=e.filter(o=>{let r=(o||"").toLowerCase().trim();return r!==""&&!Xn.includes(r)});if(t.length===0)return!1;let i=new Map;for(let o of t){let r=(o||"").toLowerCase().trim();i.has(r)||i.set(r,new Set),i.get(r).add(o)}for(let o of i.values())if(o.size>1)return!0;return!1}hasInconsistentNullsFromValues(e){let t=new Set;for(let r of e){let s=(r||"").toLowerCase().trim();(Xn.includes(s)||Vi.includes(s))&&t.add(s)}let i=Array.from(t).some(r=>Xn.includes(r)),o=Array.from(t).some(r=>Vi.includes(r));return i&&o||t.size>1}hasWrongReservedWordsFromValues(e,t){let i=t.toLowerCase().includes("disease");for(let o of e){let r=(o||"").toLowerCase().trim();if(i&&r==="control"||Vi.includes(r))return!0}return!1}calculateEntropy(e){let t=e.length;if(t===0)return 0;let i=new Map;for(let r of e){let s=r.toLowerCase().trim();i.set(s,(i.get(s)||0)+1)}let o=0;for(let r of i.values()){let s=r/t;s>0&&(o-=s*Math.log2(s))}return o}isEffectivelyEmpty(e){return e.every(t=>{let i=t.toLowerCase().trim();return i===""||Xn.includes(i)||Vi.includes(i)})}hasInconsistentCase(e){let t=e.filter(o=>{let r=o.toLowerCase().trim();return r!==""&&!Xn.includes(r)});if(t.length===0)return!1;let i=new Map;for(let o of t){let r=o.toLowerCase().trim();i.has(r)||i.set(r,new Set),i.get(r).add(o)}for(let o of i.values())if(o.size>1)return!0;return!1}hasInconsistentNulls(e){let t=new Set;for(let r of e){let s=r.toLowerCase().trim();(Xn.includes(s)||Vi.includes(s))&&t.add(s)}let i=[...t].some(r=>Xn.includes(r)),o=[...t].some(r=>Vi.includes(r));return i&&o||t.size>1}hasWrongReservedWords(e,t){return t.toLowerCase().includes("disease")?e.some(o=>{let r=o.toLowerCase().trim();return r==="control"||r==="healthy"}):!1}hasWrongColumnNameCase(e){return!!(e.startsWith("Characteristics[")||e.startsWith("Comment[")||e.startsWith("Factor Value[")||e.startsWith("Source Name")||e.startsWith("Assay Name"))}determineAction(e){let{column:t,values:i,isRedundant:o,isEffectivelyEmpty:r,hasInconsistentCase:s,hasInconsistentNulls:a,hasWrongReservedWords:u,hasWrongColumnNameCase:f,isRequired:g,uniqueValues:h,entropy:b}=e;if(r&&!g)return{action:"remove",reason:'Column is 100% empty or "not available" - adds no information'};if(o&&!g){let C=i[0];return this.isExpectedUniformColumn(t.name)?{action:"keep",reason:`All rows have same value (expected for this column type): "${C}"`}:{action:"review",reason:`All ${i.length} rows have identical value: "${C}"`}}return r&&g?{action:"review",reason:"Required column is 100% empty - needs actual values"}:u?{action:"review",reason:'Contains "control" or "healthy" - should use "normal" for healthy samples',suggestedFix:'Replace "control" and "healthy" with "normal"'}:a?{action:"review",reason:'Inconsistent null representations (e.g., "NA", "N/A", "not available")',suggestedFix:'Standardize to "not available" or "not applicable"'}:s?{action:"review",reason:'Inconsistent capitalization (e.g., "Male" vs "male")',suggestedFix:"Standardize to lowercase"}:f?{action:"review",reason:'Column name should be lowercase (e.g., "characteristics[...]" not "Characteristics[...]")',suggestedFix:"Rename column to lowercase"}:b<.3&&h<=2&&!g?{action:"review",reason:`Very low information content (${h} unique values)`}:{action:"keep",reason:"Column appears to have valid, varied data"}}isExpectedUniformColumn(e){let t=e.toLowerCase().trim();return!!(ZS.some(i=>i.toLowerCase()===t)||t.includes("template")||t.includes("version")||t.includes("protocol")||t.startsWith("comment[")||t.startsWith("factor value[")||t.includes("technology")||t.includes("assay")||t.includes("material type"))}detectIfHuman(e){let t=e.columns.find(i=>i.name.toLowerCase()==="characteristics[organism]");if(!t)return!1;for(let i=1;i<=e.sampleCount;i++){let o=de(t,i).toLowerCase();if(o.includes("homo sapiens")||o.includes("human"))return!0}return!1}getRequiredColumns(e){let t=[...YS];return e&&t.push(...KS),t}getAllValuesForColumn(e,t){let i=[];for(let o=1;o<=t.sampleCount;o++)i.push(de(e,o));return i}};function rp(){return`asg_${Date.now()}_${Math.random().toString(36).substring(2,9)}`}function sp(n){return{fill_value:"fill_value",correct_value:"correct_value",ontology_suggestion:"ontology_mapping",ontology_mapping:"ontology_mapping",consistency_fix:"consistency_fix",add_column:"add_column",remove_column:"remove_redundant",remove_redundant:"remove_redundant",relationship_fix:"relationship_fix"}[n]||"fill_value"}function w0(n){let e={total:n.length,byStatus:{pending:0,applied:0,dismissed:0,stale:0},byType:{},byConfidence:{high:0,medium:0,low:0},bySource:{},olsValidated:0,olsMatched:0,stale:0};for(let t of n)e.byStatus[t.status]++,e.byType[t.type]=(e.byType[t.type]||0)+1,e.byConfidence[t.confidence]++,e.bySource[t.source]=(e.bySource[t.source]||0)+1,t.validation.olsValidated&&(e.olsValidated++,t.validation.olsMatch&&e.olsMatched++),t.validation.isStale&&e.stale++;return e}function JS(n){return{fill_value:"Fill Value",correct_value:"Correct Value",ontology_mapping:"Ontology Mapping",consistency_fix:"Consistency Fix",add_column:"Add Column",remove_redundant:"Remove Redundant",relationship_fix:"Relationship Fix"}[n]||n}function E0(n){return{fill_value:"edit_note",correct_value:"auto_fix_high",ontology_mapping:"account_tree",consistency_fix:"format_color_text",add_column:"add_circle",remove_redundant:"delete",relationship_fix:"link"}[n]||"lightbulb"}function M0(n){return{high:"confidence-high",medium:"confidence-medium",low:"confidence-low"}[n]||"confidence-medium"}function D0(n,e){if(e==="ontology_mapping")return!0;let t=["organism","disease","cell type","cell_type","tissue","organ","cell line","cell_line","instrument","modification","ancestry","sex","developmental stage"],i=n.toLowerCase();return t.some(o=>i.includes(o))}function ap(n){let e=n.toLowerCase(),t=[{pattern:"organism",ontologies:["ncbitaxon"]},{pattern:"disease",ontologies:["efo","mondo","doid"]},{pattern:/cell.?type/,ontologies:["cl","bto"]},{pattern:/cell.?line/,ontologies:["clo","efo"]},{pattern:"tissue",ontologies:["uberon","bto"]},{pattern:"organ",ontologies:["uberon"]},{pattern:"instrument",ontologies:["ms"]},{pattern:"modification",ontologies:["unimod","ms"]},{pattern:"ancestry",ontologies:["hancestro"]},{pattern:"sex",ontologies:["pato"]},{pattern:"developmental",ontologies:["efo"]}];for(let{pattern:i,ontologies:o}of t)if(typeof i=="string"){if(e.includes(i))return o}else if(i.test(e))return o;return["efo"]}function lp(n,e){let t=n.affectedSamples?.length||0,i=e>0?Math.round(t/e*100):0,o=n.type?JS(n.type).toLowerCase():"change";return t===0?`Will ${o} column "${n.column}"`:t===e?`Will ${o} all ${t} samples in column "${n.column}"`:`Will ${o} ${t} samples (${i}%) in column "${n.column}"`}var cp=class n{_currentHash=w("");_previousHash=w("");_lastSnapshot=w(null);currentHash=this._currentHash.asReadonly();previousHash=this._previousHash.asReadonly();lastSnapshot=this._lastSnapshot.asReadonly();hasChanged=A(()=>this._currentHash()!==this._previousHash()&&this._previousHash()!=="");computeTableHash(e){let t=[];t.push(`cols:${e.columns.length}`),t.push(`rows:${e.sampleCount}`);let i=e.columns.map(r=>r.name).join(",");t.push(`names:${this.simpleHash(i)}`);let o=this.getValueSample(e);return t.push(`vals:${this.simpleHash(o)}`),t.join("|")}updateState(e){let t=this.computeTableHash(e);return this._previousHash.set(this._currentHash()),this._currentHash.set(t),this._lastSnapshot.set({hash:t,timestamp:new Date,columnCount:e.columns.length,sampleCount:e.sampleCount,columnNames:e.columns.map(i=>i.name)}),t}isHashCurrent(e){return e===this._currentHash()}detectChanges(e,t){let i={hasChanged:!1},o=new Set(e.columns.map(C=>C.name.toLowerCase())),r=new Set(t.columns.map(C=>C.name.toLowerCase())),s=t.columns.filter(C=>!o.has(C.name.toLowerCase())).map(C=>C.name),a=e.columns.filter(C=>!r.has(C.name.toLowerCase())).map(C=>C.name),u=t.sampleCount-e.sampleCount,f=s.length>0||a.length>0||u!==0,g=this.computeTableHash(e),h=this.computeTableHash(t),b=g!==h;return(f||b)&&(i.hasChanged=!0,f&&b?i.changeType="both":f?i.changeType="structure":i.changeType="values",s.length>0&&(i.addedColumns=s),a.length>0&&(i.removedColumns=a),u!==0&&(i.sampleCountDelta=u)),i}reset(){this._currentHash.set(""),this._previousHash.set(""),this._lastSnapshot.set(null)}createDetailedSnapshot(e){return{hash:this.computeTableHash(e),timestamp:new Date,columnCount:e.columns.length,sampleCount:e.sampleCount,columnNames:e.columns.map(i=>i.name),valueSnapshot:this.getValueMatrix(e,5,5)}}getValueSample(e){if(e.columns.length===0||e.sampleCount===0)return"";let t=[],i=Math.min(5,e.sampleCount),o=Math.min(10,e.columns.length),r=this.getSampleIndices(e.sampleCount,i);for(let s of r){let a=[];for(let u=0;u<o;u++){let f=e.columns[u],g=de(f,s);a.push(g)}t.push(a.join("|"))}return t.join(`
`)}getSampleIndices(e,t){if(e<=t)return Array.from({length:e},(r,s)=>s+1);let i=[1],o=Math.floor((e-2)/(t-2));for(let r=1;r<t-1;r++)i.push(1+r*o);return i.push(e),i}getValueMatrix(e,t,i){let o=[],r=Math.min(t,e.sampleCount),s=Math.min(i,e.columns.length);for(let a=1;a<=r;a++){let u=[];for(let f=0;f<s;f++){let g=e.columns[f],h=de(g,a);u.push(h)}o.push(u)}return o}simpleHash(e){let t=5381;for(let i=0;i<e.length;i++)t=(t<<5)+t^e.charCodeAt(i);return(t>>>0).toString(36)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})},rl=new cp;var XS={validateOls:!0,maxAlternatives:5,olsTimeoutMs:5e3,skipLowConfidenceValidation:!1},dp=class n{config;olsService;tableStateService;constructor(){this.config=E({},XS),this.olsService=Do,this.tableStateService=rl}setConfig(e){this.config=E(E({},this.config),e)}enrichSuggestion(e,t,i="analysis"){return k(this,null,function*(){let o=this.tableStateService.computeTableHash(t),r=sp(e.type),s=this.resolveColumnIndex(e,t),a=this.resolveAffectedSamples(e,t,s),u=this.getCurrentValues(t,s,a),f={id:rp(),timestamp:new Date,source:i,type:r,column:e.column,columnIndex:s,affectedSamples:a,currentValues:u,suggestedValue:e.suggestedValue,ontologyId:e.ontologyId,ontologyLabel:e.ontologyLabel,validation:{olsValidated:!1,tableStateHash:o,isStale:!1},reasoning:e.reasoning||"No explanation provided",confidence:this.normalizeConfidence(e.confidence),impactDescription:"",availableActions:[],status:"pending"};return f.impactDescription=lp(f,t.sampleCount),this.config.validateOls&&this.shouldValidateWithOls(f)&&(f.validation=yield this.validateWithOls(f)),f.availableActions=this.computeActions(f),f})}enrichSuggestionsStreaming(e,t,i="analysis"){return Sn(this,null,function*(){let o=e.length,r=[],s=0,a=0;for(let u=0;u<e.length;u++){let f=e[u];yield{type:"progress",message:`Enriching suggestion ${u+1}/${o}: ${f.column}`,current:u+1,total:o};try{let g=yield new nt(this.enrichSuggestion(f,t,i));r.push(g),g.validation.olsValidated&&s++}catch(g){console.error(`Failed to enrich suggestion for ${f.column}:`,g),a++;let h=this.createFallbackSuggestion(f,t,i);r.push(h)}}yield{type:"complete",suggestions:r,enrichedCount:r.length,validatedCount:s,failedCount:a}})}enrichRecommendations(e,t){return k(this,null,function*(){let i=[];for(let o of e){let r={type:o.type,column:o.column,columnIndex:o.columnIndex,sampleIndices:o.sampleIndices,currentValue:o.currentValue,suggestedValue:o.suggestedValue,confidence:o.confidence,reasoning:o.reasoning,ontologyId:o.ontologyId,ontologyLabel:o.ontologyLabel},s=yield this.enrichSuggestion(r,t,"analysis");i.push(s)}return i})}validateWithOls(e){return k(this,null,function*(){let t={olsValidated:!1,tableStateHash:e.validation.tableStateHash,isStale:e.validation.isStale};try{let i=ap(e.column),o=e.suggestedValue,r=yield this.olsService.search({query:o,ontology:i,rows:this.config.maxAlternatives+1});if(t.olsValidated=!0,t.validatedAt=new Date,r.suggestions.length>0){let s=r.suggestions.find(a=>this.isExactMatch(a,o));s?(t.olsMatch=s,t.olsAlternatives=r.suggestions.filter(a=>a.id!==s.id).slice(0,this.config.maxAlternatives)):t.olsAlternatives=r.suggestions.slice(0,this.config.maxAlternatives)}}catch(i){console.error("OLS validation failed:",i),t.validationError=i instanceof Error?i.message:"Unknown error"}return t})}findAlternatives(e,t=5){return k(this,null,function*(){let i=ap(e.column);return(yield this.olsService.search({query:e.suggestedValue,ontology:i,rows:t})).suggestions})}computeActions(e){let t=[],i=e.validation.isStale,o=e.validation.olsMatch!==void 0,r=(e.validation.olsAlternatives?.length||0)>0;if(o?t.push({type:"apply_ols",label:"Apply (OLS Verified)",icon:"verified",enabled:!i,tooltip:`Apply ${e.validation.olsMatch.label} (${e.validation.olsMatch.id})`,priority:1,isPrimary:!0}):t.push({type:"apply",label:"Apply",icon:"check",enabled:!i,tooltip:r?"Apply (term not found in OLS)":"Apply this suggestion",priority:1,isPrimary:!0}),r){let s=e.validation.olsAlternatives.length;t.push({type:"alternatives",label:`${s} Alternative${s>1?"s":""}`,icon:"list",enabled:!0,tooltip:"Show OLS alternatives",priority:2})}return t.push({type:"preview",label:"Preview",icon:"visibility",enabled:!i,tooltip:`Preview changes to ${e.affectedSamples.length} sample(s)`,priority:3}),t.push({type:"chat",label:"Explain",icon:"chat",enabled:!0,tooltip:"Ask AI to explain this suggestion",priority:4}),t.push({type:"dismiss",label:"Dismiss",icon:"close",enabled:!0,tooltip:"Dismiss this suggestion",priority:5}),t.sort((s,a)=>s.priority-a.priority)}buildExplanationPrompt(e){let t=["The user wants to understand this AI suggestion:","",`**Suggestion Type**: ${e.type}`,`**Column**: "${e.column}"`,`**Current Value**: "${this.getFirstCurrentValue(e)}"`,`**Suggested Value**: "${e.suggestedValue}"`,`**Affected Samples**: ${e.affectedSamples.length}`,`**Confidence**: ${e.confidence}`,`**Original Reasoning**: ${e.reasoning}`];if(e.validation.olsMatch)t.push(""),t.push("**OLS Match Found**:"),t.push(`- Label: ${e.validation.olsMatch.label}`),t.push(`- ID: ${e.validation.olsMatch.id}`),e.validation.olsMatch.description&&t.push(`- Description: ${e.validation.olsMatch.description}`);else if(e.validation.olsAlternatives?.length){t.push(""),t.push("**Note**: The suggested term was not found in OLS. Alternatives:");for(let i of e.validation.olsAlternatives.slice(0,3))t.push(`- ${i.label} (${i.id})`)}return t.push(""),t.push("Please explain:"),t.push("1. Why this change is recommended"),t.push("2. What the suggested value means in the context of proteomics/SDRF"),t.push("3. Whether you recommend applying it"),t.push("4. Any alternatives the user should consider"),t.join(`
`)}shouldValidateWithOls(e){return e.type==="add_column"||e.type==="remove_redundant"||this.config.skipLowConfidenceValidation&&e.confidence==="low"?!1:D0(e.column,e.type)}resolveColumnIndex(e,t){let i=t.columns.findIndex(o=>o.name.toLowerCase()===e.column.toLowerCase());return i>=0?(typeof e.columnIndex=="number"&&e.columnIndex!==i&&console.warn(`Column index mismatch: LLM said ${e.columnIndex} for "${e.column}", but found at index ${i}. Using name-based lookup.`),i):typeof e.columnIndex=="number"&&e.columnIndex>=0&&e.columnIndex<t.columns.length?(console.warn(`Column "${e.column}" not found by name, using LLM-provided index ${e.columnIndex}`),e.columnIndex):-1}resolveAffectedSamples(e,t,i){if(e.sampleIndices&&e.sampleIndices.length>0)return e.sampleIndices.filter(o=>o>=1&&o<=t.sampleCount);if(e.currentValue&&i>=0){let o=t.columns[i],r=[];for(let s=1;s<=t.sampleCount;s++)de(o,s).toLowerCase()===e.currentValue.toLowerCase()&&r.push(s);if(r.length>0)return r}return Array.from({length:t.sampleCount},(o,r)=>r+1)}getCurrentValues(e,t,i){let o=new Map;if(t<0||t>=e.columns.length)return o;let r=e.columns[t];for(let s of i){let a=de(r,s);o.set(s,a)}return o}normalizeConfidence(e){if(!e)return"medium";let t=e.toLowerCase();return t==="high"?"high":t==="low"?"low":"medium"}isExactMatch(e,t){let i=t.toLowerCase().trim();return!!(e.label.toLowerCase().trim()===i||e.id.toLowerCase()===i||e.synonyms?.some(r=>r.toLowerCase().trim()===i))}getFirstCurrentValue(e){let i=e.currentValues.values().next();return i.done?"N/A":i.value}createFallbackSuggestion(e,t,i){let o=this.tableStateService.computeTableHash(t),r=sp(e.type),s=this.resolveColumnIndex(e,t),a=this.resolveAffectedSamples(e,t,s),u=this.getCurrentValues(t,s,a),f={id:rp(),timestamp:new Date,source:i,type:r,column:e.column,columnIndex:s,affectedSamples:a,currentValues:u,suggestedValue:e.suggestedValue,ontologyId:e.ontologyId,ontologyLabel:e.ontologyLabel,validation:{olsValidated:!1,tableStateHash:o,isStale:!1,validationError:"Validation skipped due to error"},reasoning:e.reasoning||"No explanation provided",confidence:this.normalizeConfidence(e.confidence),impactDescription:lp({type:r,column:e.column,affectedSamples:a},t.sampleCount),availableActions:[],status:"pending"};return f.availableActions=this.computeActions(f),f}static \u0275fac=function(t){return new(t||n)};static \u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})},sl=new dp;var up=class n{_suggestions=w([]);_tableStateHash=w("");_filter=w({excludeStale:!0,status:["pending"]});_sort=w({field:"confidence",direction:"desc"});suggestions=this._suggestions.asReadonly();tableStateHash=this._tableStateHash.asReadonly();filter=this._filter.asReadonly();sort=this._sort.asReadonly();filteredSuggestions=A(()=>{let e=this._suggestions(),t=this._filter(),i=this._sort();if(t.status&&t.status.length>0&&(e=e.filter(o=>t.status.includes(o.status))),t.source&&t.source.length>0&&(e=e.filter(o=>t.source.includes(o.source))),t.type&&t.type.length>0&&(e=e.filter(o=>t.type.includes(o.type))),t.confidence&&t.confidence.length>0&&(e=e.filter(o=>t.confidence.includes(o.confidence))),t.column){let o=t.column.toLowerCase();e=e.filter(r=>r.column.toLowerCase().includes(o))}return t.olsValidatedOnly&&(e=e.filter(o=>o.validation.olsValidated&&o.validation.olsMatch)),t.excludeStale&&(e=e.filter(o=>!o.validation.isStale)),e=[...e].sort((o,r)=>{let s=0;switch(i.field){case"timestamp":s=o.timestamp.getTime()-r.timestamp.getTime();break;case"confidence":let a={high:3,medium:2,low:1};s=a[o.confidence]-a[r.confidence];break;case"column":s=o.column.localeCompare(r.column);break;case"type":s=o.type.localeCompare(r.type);break;case"affectedSamples":s=o.affectedSamples.length-r.affectedSamples.length;break}return i.direction==="desc"?-s:s}),e});pendingSuggestions=A(()=>this._suggestions().filter(e=>e.status==="pending"&&!e.validation.isStale));appliedSuggestions=A(()=>this._suggestions().filter(e=>e.status==="applied"));dismissedSuggestions=A(()=>this._suggestions().filter(e=>e.status==="dismissed"));staleSuggestions=A(()=>this._suggestions().filter(e=>e.validation.isStale));suggestionsByColumn=A(()=>{let e=new Map;for(let t of this._suggestions()){let i=e.get(t.column)||[];i.push(t),e.set(t.column,i)}return e});suggestionsByType=A(()=>{let e=new Map;for(let t of this._suggestions()){let i=e.get(t.type)||[];i.push(t),e.set(t.type,i)}return e});summary=A(()=>w0(this._suggestions()));hasPendingSuggestions=A(()=>this.pendingSuggestions().length>0);highConfidenceSuggestions=A(()=>this._suggestions().filter(e=>e.status==="pending"&&e.confidence==="high"&&!e.validation.isStale));olsValidatedSuggestions=A(()=>this._suggestions().filter(e=>e.status==="pending"&&e.validation.olsValidated&&e.validation.olsMatch&&!e.validation.isStale));addSuggestions(e,t,i=!0){this._suggestions.update(o=>{let r=o;return i&&(r=r.filter(s=>s.source!==t)),[...r,...e]})}getSuggestionById(e){return this._suggestions().find(t=>t.id===e)}getSuggestionsForCell(e,t){return this._suggestions().filter(i=>i.column.toLowerCase()===e.toLowerCase()&&i.affectedSamples.includes(t)&&i.status==="pending"&&!i.validation.isStale)}getSuggestionsForColumn(e){return this._suggestions().filter(t=>t.column.toLowerCase()===e.toLowerCase()&&t.status==="pending"&&!t.validation.isStale)}markAsApplied(e){this._suggestions.update(t=>t.map(i=>i.id===e?O(E({},i),{status:"applied"}):i))}markAsDismissed(e){this._suggestions.update(t=>t.map(i=>i.id===e?O(E({},i),{status:"dismissed"}):i))}markManyAsApplied(e){let t=new Set(e);this._suggestions.update(i=>i.map(o=>t.has(o.id)?O(E({},o),{status:"applied"}):o))}markManyAsDismissed(e){let t=new Set(e);this._suggestions.update(i=>i.map(o=>t.has(o.id)?O(E({},o),{status:"dismissed"}):o))}updateTableState(e){let t=this._tableStateHash();e!==t&&(this._tableStateHash.set(e),this._suggestions.update(i=>i.map(o=>o.validation.tableStateHash!==e&&o.status==="pending"?O(E({},o),{validation:O(E({},o.validation),{isStale:!0})}):o)))}invalidateStale(e){this._suggestions.update(t=>t.map(i=>i.validation.tableStateHash!==e?O(E({},i),{validation:O(E({},i.validation),{isStale:!0})}):i))}clearStale(){this._suggestions.update(e=>e.filter(t=>!t.validation.isStale))}clearAll(){this._suggestions.set([])}clearBySource(e){this._suggestions.update(t=>t.filter(i=>i.source!==e))}setFilter(e){this._filter.update(t=>E(E({},t),e))}resetFilter(){this._filter.set({excludeStale:!0,status:["pending"]})}setSort(e){this._sort.update(t=>E(E({},t),e))}linkToChatMessage(e,t){this._suggestions.update(i=>i.map(o=>o.id===e?O(E({},o),{linkedChatMessageId:t}):o))}updateSuggestionValue(e,t,i,o){this._suggestions.update(r=>r.map(s=>s.id===e?O(E({},s),{suggestedValue:t,ontologyId:i,ontologyLabel:o}):s))}restoreDismissed(e){this._suggestions.update(t=>t.map(i=>i.id===e&&i.status==="dismissed"?O(E({},i),{status:"pending"}):i))}getColumnsWithSuggestions(){let e=new Set;for(let t of this.pendingSuggestions())e.add(t.column);return Array.from(e).sort()}getSuggestionCountByColumn(){let e=new Map;for(let t of this.pendingSuggestions())e.set(t.column,(e.get(t.column)||0)+1);return e}static \u0275fac=function(t){return new(t||n)};static \u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})},al=new up;var ew={cacheTtlMs:300*1e3,enableCache:!0,maxRecommendations:50},pp=class{config;providers=new Map;cache=new Map;contextBuilder;promptService;settingsService;qualityService;enrichmentService;suggestionState;tableState;constructor(e={},t){this.config=E(E({},ew),e),this.contextBuilder=new Fi,this.promptService=new Br(this.contextBuilder),this.settingsService=t||Oo,this.qualityService=new ei,this.enrichmentService=sl,this.suggestionState=al,this.tableState=rl}analyze(r){return k(this,arguments,function*(e,t=["all"],i,o=!0){let s=yield this.getActiveProvider(),a=this.settingsService.getActiveProviderConfig();if(!a)throw new Fn("No LLM provider configured","NOT_CONFIGURED");let u=this.getCacheKey(e,t);if(this.config.enableCache){let U=this.getFromCache(u,e);if(U)return U}let f,g=[];o&&(f=this.qualityService.analyzeTable(e),g=this.promptService.convertQualityToPromptIssues(f.columns));let h=this.contextBuilder.buildContext(e,t,i);if(h.issues.length===0&&g.length===0){let U=Ip(a.provider,a.model);return O(E({},U),{qualityAnalysis:f})}let b=this.promptService.buildAnalysisMessages(h,void 0,g),C=yield s.complete(b),T=this.parseRecommendations(C.content,e),F={recommendations:T.slice(0,this.config.maxRecommendations),summary:Wr(T),rawResponse:C.content,timestamp:new Date,provider:a.provider,model:a.model,qualityAnalysis:f};return this.config.enableCache&&this.addToCache(u,F,e),F})}analyzeQuality(e){return this.qualityService.analyzeTable(e)}getQualityService(){return this.qualityService}analyzeStreaming(r){return Sn(this,arguments,function*(e,t=["all"],i,o=!0){let s=yield new nt(this.getActiveProvider()),a=this.settingsService.getActiveProviderConfig();if(!a)throw new Fn("No LLM provider configured","NOT_CONFIGURED");if(!s.supportsStreaming){let Re=yield new nt(this.analyze(e,t,i,o));return yield Re.rawResponse||"",Re}let u,f=[];o&&(u=this.qualityService.analyzeTable(e),f=this.promptService.convertQualityToPromptIssues(u.columns));let g=this.contextBuilder.buildContext(e,t,i),h=this.promptService.buildAnalysisMessages(g,void 0,f),b="";try{for(var U=wn(s.stream(h)),K,We,Et;K=!(We=yield new nt(U.next())).done;K=!1){let Re=We.value;b+=Re.content,yield Re.content}}catch{Et=[We]}finally{try{K&&(We=U.return)&&(yield new nt(We.call(U)))}finally{if(Et)throw Et[0]}}let C=this.parseRecommendations(b,e),T={recommendations:C.slice(0,this.config.maxRecommendations),summary:Wr(C),rawResponse:b,timestamp:new Date,provider:a.provider,model:a.model,qualityAnalysis:u},F=this.getCacheKey(e,t);return this.config.enableCache&&this.addToCache(F,T,e),T})}analyzeColumn(e,t,i){return k(this,null,function*(){let o=yield this.getActiveProvider(),r=this.settingsService.getActiveProviderConfig();if(!r)throw new Fn("No LLM provider configured","NOT_CONFIGURED");let s=this.contextBuilder.buildContext(e,["all"],i),a=this.promptService.buildColumnFocusedPrompt(s,t),u=yield o.complete(a),f=this.parseRecommendations(u.content,e);return{recommendations:f,summary:Wr(f),rawResponse:u.content,timestamp:new Date,provider:r.provider,model:r.model}})}analyzeActionable(o){return k(this,arguments,function*(e,t=["all"],i){let r=yield this.getActiveProvider(),s=this.settingsService.getActiveProviderConfig();if(!s)throw new Fn("No LLM provider configured","NOT_CONFIGURED");this.tableState.updateState(e);let a=this.qualityService.analyzeTable(e),u=this.promptService.convertQualityToPromptIssues(a.columns),f=this.contextBuilder.buildContext(e,t,i),g=this.promptService.buildAnalysisMessages(f,void 0,u),h=yield r.complete(g),b=this.parseRawSuggestions(h.content,e),C=yield this.enrichmentService.enrichRecommendations(this.convertToSdrfRecommendations(b,e),e);this.suggestionState.addSuggestions(C,"analysis",!0);let T=C.filter(U=>U.validation.olsValidated).length,F=C.filter(U=>U.validation.olsMatch!==void 0).length;return{suggestions:C,qualityAnalysis:a,rawResponse:h.content,timestamp:new Date,provider:s.provider,model:s.model,olsValidatedCount:T,olsMatchedCount:F}})}analyzeActionableStreaming(r){return Sn(this,arguments,function*(e,t=["all"],i,o){let s=yield new nt(this.getActiveProvider()),a=this.settingsService.getActiveProviderConfig();if(!a)throw new Fn("No LLM provider configured","NOT_CONFIGURED");this.tableState.updateState(e);let u=this.qualityService.analyzeTable(e),f=this.promptService.convertQualityToPromptIssues(u.columns),g=this.contextBuilder.buildContext(e,t,i),h=this.promptService.buildAnalysisMessages(g,void 0,f,o),b="";if(s.supportsStreaming)try{for(var K=wn(s.stream(h)),We,Et,Re;We=!(Et=yield new nt(K.next())).done;We=!1){let H=Et.value;b+=H.content,yield{type:"streaming",content:H.content}}}catch{Re=[Et]}finally{try{We&&(Et=K.return)&&(yield new nt(Et.call(K)))}finally{if(Re)throw Re[0]}}else b=(yield new nt(s.complete(h))).content,yield{type:"streaming",content:b};yield{type:"parsing",message:"Parsing recommendations..."};let C=this.parseRawSuggestions(b,e),T=[];try{for(var Ce=wn(this.enrichmentService.enrichSuggestionsStreaming(C,e,"analysis")),M,D,R;M=!(D=yield new nt(Ce.next())).done;M=!1){let H=D.value;H.type==="progress"?yield H:T.push(...H.suggestions)}}catch{R=[D]}finally{try{M&&(D=Ce.return)&&(yield new nt(D.call(Ce)))}finally{if(R)throw R[0]}}this.suggestionState.addSuggestions(T,"analysis",!0);let F=T.filter(H=>H.validation.olsValidated).length,U=T.filter(H=>H.validation.olsMatch!==void 0).length;return{suggestions:T,qualityAnalysis:u,rawResponse:b,timestamp:new Date,provider:a.provider,model:a.model,olsValidatedCount:F,olsMatchedCount:U}})}getEnrichmentService(){return this.enrichmentService}getSuggestionState(){return this.suggestionState}getTableState(){return this.tableState}abort(){for(let e of this.providers.values())e.abort()}clearCache(){this.cache.clear()}getActiveProvider(){return k(this,null,function*(){let e=this.settingsService.getActiveProvider(),t=this.settingsService.getActiveProviderConfig();if(!t)throw new Fn(`Provider ${e} is not configured`,"NOT_CONFIGURED",e);let i=this.providers.get(e);return i?i.setConfig(t):(i=yield this.createProvider(e,t),this.providers.set(e,i)),i})}testConnection(){return k(this,null,function*(){try{let e=yield this.getActiveProvider(),t=[{role:"user",content:'Say "OK" if you can read this.'}],i=yield e.complete(t);return i.content&&i.content.length>0?{success:!0}:{success:!1,error:"Empty response from provider"}}catch(e){return{success:!1,error:e instanceof Error?e.message:String(e)}}})}createProvider(e,t){return k(this,null,function*(){let i=yield this.settingsService.getApiKey(e),o=O(E({},t),{apiKey:i});switch(e){case"openai":return new il(o);case"anthropic":let{AnthropicProvider:r}=yield import("./chunk-I27B4FU4.js");return new r(o);case"gemini":let{GeminiProvider:s}=yield import("./chunk-NU6WRDTI.js");return new s(o);case"ollama":let{OllamaProvider:a}=yield import("./chunk-CT4BTJ6G.js");return new a(o);default:throw new Fn(`Unknown provider type: ${e}`,"PROVIDER_ERROR",e)}})}parseRecommendations(e,t){try{let i=null,o=e.match(/```(?:json)?\s*([\s\S]*?)\s*```/);if(o)try{i=JSON.parse(o[1].trim())}catch{}if(!i)try{i=JSON.parse(e.trim())}catch{}if(!i){let a=e.match(/\{[\s\S]*?"recommendations"\s*:\s*\[[\s\S]*?\][\s\S]*?\}/);if(a)try{i=JSON.parse(a[0])}catch{}}if(!i){let a=e.match(/\[[\s\S]*?\{[\s\S]*?"column"[\s\S]*?\}[\s\S]*?\]/);if(a)try{i=JSON.parse(a[0])}catch{}}if(!i)try{let a=e.replace(/^[^{[]*/,"");a=a.replace(/[^}\]]*$/,""),a=a.replace(/,\s*([\]}])/g,"$1"),i=JSON.parse(a)}catch{return console.warn("Failed to parse recommendations JSON after all strategies"),[]}let r;if(Array.isArray(i))r=i;else if(i&&Array.isArray(i.recommendations))r=i.recommendations;else return console.warn("Could not find recommendations array in response"),[];let s=[];for(let a of r){let u=this.validateAndConvertRecommendation(a,t);u&&s.push(u)}return console.log(`Parsed ${s.length} recommendations from LLM response`),s}catch(i){return console.error("Failed to parse recommendations:",i),[]}}validateAndConvertRecommendation(e,t){if(!e.column||!e.suggestedValue)return null;let i=e.columnIndex;if(typeof i!="number"&&(i=t.columns.findIndex(f=>f.name.toLowerCase()===e.column.toLowerCase())),i<0||i>=t.columns.length)return null;let o=e.sampleIndices||[];if(Array.isArray(o)||(o=[o]),o=o.filter(f=>typeof f=="number"&&f>=1&&f<=t.sampleCount),o.length===0)return null;let s=["fill_value","correct_value","ontology_suggestion","consistency_fix","add_column"].includes(e.type)?e.type:"fill_value",u=["high","medium","low"].includes(e.confidence)?e.confidence:"medium";return{id:Vl(),type:s,column:e.column,columnIndex:i,sampleIndices:o,currentValue:e.currentValue||void 0,suggestedValue:String(e.suggestedValue),confidence:u,reasoning:e.reasoning||"No explanation provided",applied:!1,ontologyId:e.ontologyId,ontologyLabel:e.ontologyLabel}}getCacheKey(e,t){return JSON.stringify({sampleCount:e.sampleCount,columnCount:e.columns.length,focusAreas:t.sort()})}getTableHash(e){let t=[];for(let i=0;i<Math.min(5,e.columns.length);i++){let o=e.columns[i];t.push(`${o.name}:${o.value}`)}return t.join("|")}getFromCache(e,t){let i=this.cache.get(e);return i?Date.now()-i.timestamp>this.config.cacheTtlMs?(this.cache.delete(e),null):i.tableHash!==this.getTableHash(t)?(this.cache.delete(e),null):i.result:null}addToCache(e,t,i){if(this.cache.set(e,{result:t,timestamp:Date.now(),tableHash:this.getTableHash(i)}),this.cache.size>20){let o=this.cache.keys().next().value;o&&this.cache.delete(o)}}parseRawSuggestions(e,t){try{let i=null,o=e.match(/```(?:json)?\s*([\s\S]*?)\s*```/);if(o)try{i=JSON.parse(o[1].trim())}catch{}if(!i)try{i=JSON.parse(e.trim())}catch{}if(!i){let a=e.match(/\{[\s\S]*?"recommendations"\s*:\s*\[[\s\S]*?\][\s\S]*?\}/);if(a)try{i=JSON.parse(a[0])}catch{}}if(!i){let a=e.match(/\[[\s\S]*?\{[\s\S]*?"column"[\s\S]*?\}[\s\S]*?\]/);if(a)try{i=JSON.parse(a[0])}catch{}}if(!i)try{let a=e.replace(/^[^{[]*/,"");a=a.replace(/[^}\]]*$/,""),a=a.replace(/,\s*([\]}])/g,"$1"),i=JSON.parse(a)}catch{return console.warn("Failed to parse suggestions JSON after all strategies"),[]}let r;if(Array.isArray(i))r=i;else if(i&&Array.isArray(i.recommendations))r=i.recommendations;else return console.warn("Could not find recommendations array in response"),[];let s=[];for(let a of r)a.column&&a.suggestedValue&&s.push({type:a.type||"fill_value",column:a.column,columnIndex:a.columnIndex,sampleIndices:a.sampleIndices,currentValue:a.currentValue,suggestedValue:String(a.suggestedValue),confidence:a.confidence,reasoning:a.reasoning,ontologyId:a.ontologyId,ontologyLabel:a.ontologyLabel});return console.log(`Parsed ${s.length} raw suggestions from LLM response`),s}catch(i){return console.error("Failed to parse raw suggestions:",i),[]}}convertToSdrfRecommendations(e,t){let i=[];for(let o of e){let r=o.columnIndex;if(typeof r!="number"&&(r=t.columns.findIndex(h=>h.name.toLowerCase()===o.column.toLowerCase())),r<0||r>=t.columns.length){if(o.type!=="add_column")continue;r=t.columns.length}let s=o.sampleIndices||[];Array.isArray(s)||(s=[s]),s=s.filter(h=>typeof h=="number"&&h>=1&&h<=t.sampleCount),s.length===0&&(s=Array.from({length:t.sampleCount},(h,b)=>b+1));let u=["fill_value","correct_value","ontology_suggestion","consistency_fix","add_column"].includes(o.type)?o.type:"fill_value",g=["high","medium","low"].includes(o.confidence)?o.confidence:"medium";i.push({id:Vl(),type:u,column:o.column,columnIndex:r,sampleIndices:s,currentValue:o.currentValue,suggestedValue:o.suggestedValue,confidence:g,reasoning:o.reasoning||"No explanation provided",applied:!1,ontologyId:o.ontologyId,ontologyLabel:o.ontologyLabel})}return i}},ll=new pp;var fp=new Set(["na","n/a","n.a.","none","null","unknown","-","--","missing",""]),cl="not available",tw=["characteristics[organism]","characteristics[organism part]","characteristics[cell type]","characteristics[disease]","characteristics[sex]","characteristics[ancestry category]"],mp=class{qualityService;constructor(e){this.qualityService=e||new ei}detectAvailableFixes(e,t){let i=[],o=t||this.qualityService.analyzeTable(e),r=this.detectNullStandardization(e);r&&i.push(r);let s=this.detectReservedWordFixes(e);s&&i.push(s);let a=this.detectColumnNameCaseFixes(e);a&&i.push(a);let u=this.detectLowercaseValueFixes(e);i.push(...u);let f=this.detectRemovableColumns(e,o);return i.push(...f),i}applyFix(e,t){try{switch(t.type){case"standardize_nulls":return this.applyNullStandardization(e,t);case"fix_reserved_words":return this.applyReservedWordFix(e,t);case"lowercase_column_names":return this.applyColumnNameLowercase(e,t);case"lowercase_values":return this.applyValueLowercase(e,t);case"remove_column":return this.applyColumnRemoval(e,t);default:return{table:e,result:{success:!1,changesCount:0,error:`Unknown fix type: ${t.type}`}}}}catch(i){return{table:e,result:{success:!1,changesCount:0,error:i instanceof Error?i.message:String(i)}}}}applyFixes(e,t){let i=e,o=[];for(let r of t){let{table:s,result:a}=this.applyFix(i,r);i=s,o.push(a)}return{table:i,results:o}}getRemovalSuggestions(e,t){let i=t||this.qualityService.analyzeTable(e),o=[];for(let r of i.columns)r.action==="remove"&&!r.isRequired?o.push({column:r.name,columnIndex:r.columnIndex,reason:r.reason,impact:"none",isRequired:!1,quality:r}):r.isEffectivelyEmpty&&r.isRequired?o.push({column:r.name,columnIndex:r.columnIndex,reason:r.reason+" (Required column - needs actual values)",impact:"high",isRequired:!0,quality:r}):r.isRedundant&&!r.isRequired&&o.push({column:r.name,columnIndex:r.columnIndex,reason:r.reason,impact:"low",isRequired:!1,quality:r});return o}detectNullStandardization(e){let t=[];for(let i of e.columns)for(let o=1;o<=e.sampleCount;o++){let r=de(i,o),s=r.toLowerCase().trim();fp.has(s)&&s!==""&&t.push({column:i.name,sampleIndex:o,value:r})}return t.length===0?null:{id:"standardize_nulls",type:"standardize_nulls",column:"*",description:`Standardize ${t.length} null values to "${cl}"`,affectedCount:t.length,affectedSamples:[...new Set(t.map(i=>i.sampleIndex))],isSafe:!0,preview:t.slice(0,5).map(i=>({before:i.value||"(empty)",after:cl,sampleIndex:i.sampleIndex}))}}detectReservedWordFixes(e){let t=e.columns.find(r=>r.name.toLowerCase()==="characteristics[disease]");if(!t)return null;let i=[],o=[];for(let r=1;r<=e.sampleCount;r++){let s=de(t,r),a=s.toLowerCase().trim();(a==="control"||a==="healthy")&&(i.push(r),o.length<5&&o.push({before:s,after:"normal",sampleIndex:r}))}return i.length===0?null:{id:"fix_reserved_words_disease",type:"fix_reserved_words",column:"characteristics[disease]",description:`Replace "control"/"healthy" with "normal" in ${i.length} samples`,affectedCount:i.length,affectedSamples:i,isSafe:!0,preview:o}}detectColumnNameCaseFixes(e){let t=[];for(let i of e.columns)(i.name.startsWith("Characteristics[")||i.name.startsWith("Comment[")||i.name.startsWith("Factor Value[")||i.name.startsWith("Source Name")||i.name.startsWith("Assay Name"))&&t.push(i.name);return t.length===0?null:{id:"lowercase_column_names",type:"lowercase_column_names",column:"*",description:`Lowercase ${t.length} column names`,affectedCount:t.length,isSafe:!0,preview:t.slice(0,5).map(i=>({before:i,after:this.lowercaseColumnName(i)}))}}detectLowercaseValueFixes(e){let t=[];for(let i of tw){let o=e.columns.find(a=>a.name.toLowerCase()===i.toLowerCase());if(!o)continue;let r=[],s=[];for(let a=1;a<=e.sampleCount;a++){let u=de(o,a);u&&u!==u.toLowerCase()&&!this.isNullValue(u)&&(r.push(a),s.length<3&&s.push({before:u,after:u.toLowerCase(),sampleIndex:a}))}r.length>0&&t.push({id:`lowercase_values_${o.name.replace(/[^a-z]/gi,"_")}`,type:"lowercase_values",column:o.name,description:`Lowercase ${r.length} values in ${o.name}`,affectedCount:r.length,affectedSamples:r,isSafe:!0,preview:s})}return t}detectRemovableColumns(e,t){let i=[];for(let o of t.columns)o.action==="remove"&&!o.isRequired&&i.push({id:`remove_column_${o.columnIndex}`,type:"remove_column",column:o.name,description:`Remove column "${o.name}" - ${o.reason}`,affectedCount:1,isSafe:!1,preview:[{before:o.name,after:"(removed)"}]});return i}applyNullStandardization(e,t){let i=[],o=e.columns.map(r=>{let s=this.cloneColumn(r);for(let a=1;a<=e.sampleCount;a++){let u=de(s,a),f=u.toLowerCase().trim();fp.has(f)&&(this.setValueForSample(s,a,cl,e),i.push({column:r.name,sampleIndex:a,before:u||"(empty)",after:cl}))}return s});return{table:O(E({},e),{columns:o}),result:{success:!0,changesCount:i.length,changes:i}}}applyReservedWordFix(e,t){let i=[],o=e.columns.map(r=>{if(r.name.toLowerCase()!==t.column.toLowerCase())return r;let s=this.cloneColumn(r);for(let a=1;a<=e.sampleCount;a++){let u=de(s,a),f=u.toLowerCase().trim();(f==="control"||f==="healthy")&&(this.setValueForSample(s,a,"normal",e),i.push({column:r.name,sampleIndex:a,before:u,after:"normal"}))}return s});return{table:O(E({},e),{columns:o}),result:{success:!0,changesCount:i.length,changes:i}}}applyColumnNameLowercase(e,t){let i=[],o=e.columns.map(r=>{let s=this.lowercaseColumnName(r.name);return s!==r.name?(i.push({column:r.name,before:r.name,after:s}),O(E({},r),{name:s})):r});return{table:O(E({},e),{columns:o}),result:{success:!0,changesCount:i.length,changes:i}}}applyValueLowercase(e,t){let i=[],o=e.columns.map(r=>{if(r.name.toLowerCase()!==t.column.toLowerCase())return r;let s=this.cloneColumn(r);for(let a=1;a<=e.sampleCount;a++){let u=de(s,a);u&&u!==u.toLowerCase()&&!this.isNullValue(u)&&(this.setValueForSample(s,a,u.toLowerCase(),e),i.push({column:r.name,sampleIndex:a,before:u,after:u.toLowerCase()}))}return s});return{table:O(E({},e),{columns:o}),result:{success:!0,changesCount:i.length,changes:i}}}applyColumnRemoval(e,t){let i=e.columns.findIndex(r=>r.name.toLowerCase()===t.column.toLowerCase());if(i<0)return{table:e,result:{success:!1,changesCount:0,error:`Column "${t.column}" not found`}};let o=e.columns.filter((r,s)=>s!==i).map((r,s)=>O(E({},r),{columnPosition:s}));return{table:O(E({},e),{columns:o}),result:{success:!0,changesCount:1,changes:[{column:t.column,before:t.column,after:"(removed)"}]}}}lowercaseColumnName(e){return e.replace(/^Characteristics\[/i,"characteristics[").replace(/^Comment\[/i,"comment[").replace(/^Factor Value\[/i,"factor value[").replace(/^Source Name$/i,"source name").replace(/^Assay Name$/i,"assay name")}isNullValue(e){let t=e.toLowerCase().trim();return t==="not available"||t==="not applicable"||t==="anonymized"||t==="pooled"||fp.has(t)}cloneColumn(e){return{name:e.name,type:e.type,value:e.value,modifiers:e.modifiers.map(t=>E({},t)),columnPosition:e.columnPosition,ontologyType:e.ontologyType,ontologyOptions:e.ontologyOptions?[...e.ontologyOptions]:void 0,isRequired:e.isRequired,notApplicable:e.notApplicable,notAvailable:e.notAvailable,hidden:e.hidden,readonly:e.readonly}}setValueForSample(e,t,i,o){if(i===e.value){e.modifiers=e.modifiers.map(s=>Ga(t,s.samples)?O(E({},s),{samples:this.removeSampleFromRange(s.samples,t)}):s).filter(s=>s.samples.length>0);return}e.modifiers=e.modifiers.map(s=>s.value===i?s:Ga(t,s.samples)?O(E({},s),{samples:this.removeSampleFromRange(s.samples,t)}):s).filter(s=>s.samples.length>0);let r=e.modifiers.find(s=>s.value===i);r?r.samples=this.addSampleToRange(r.samples,t):e.modifiers.push({samples:String(t),value:i})}addSampleToRange(e,t){let i=this.expandRange(e);return i.includes(t)||(i.push(t),i.sort((o,r)=>o-r)),this.compactRange(i)}removeSampleFromRange(e,t){let o=this.expandRange(e).filter(r=>r!==t);return this.compactRange(o)}expandRange(e){let t=[],i=e.split(",");for(let o of i){let r=o.trim();if(r)if(r.includes("-")){let[s,a]=r.split("-").map(Number);for(let u=s;u<=a;u++)t.push(u)}else t.push(Number(r))}return t}compactRange(e){if(e.length===0)return"";if(e.length===1)return String(e[0]);let t=[...new Set(e)].sort((s,a)=>s-a),i=[],o=t[0],r=t[0];for(let s=1;s<t.length;s++)t[s]===r+1||(i.push(o===r?String(o):`${o}-${r}`),o=t[s]),r=t[s];return i.push(o===r?String(o):`${o}-${r}`),i.join(",")}},T0=new mp;var gp=class{index=null;loadPromise=null;loaded=!1;loadIndex(){return k(this,null,function*(){if(!this.loaded)return this.loadPromise?this.loadPromise:(this.loadPromise=this.doLoadIndex(),this.loadPromise)})}doLoadIndex(){return k(this,null,function*(){try{let e=yield this.loadCompressedIndex();if(e){this.index=e,this.loaded=!0,console.log(`SDRF examples loaded (compressed): ${this.index?.metadata?.totalRows} rows from ${this.index?.metadata?.filesProcessed} files`);return}let t=yield fetch("assets/sdrf-examples-index.json");if(!t.ok)throw new Error(`Failed to load index: ${t.status}`);this.index=yield t.json(),this.loaded=!0,console.log(`SDRF examples loaded: ${this.index?.metadata?.totalRows} rows from ${this.index?.metadata?.filesProcessed} files`)}catch(e){console.warn("Could not load SDRF examples index:",e),this.index={columns:{},metadata:{generatedAt:new Date().toISOString(),filesProcessed:0,totalRows:0,columnsIndexed:0,maxValuesPerColumn:0,minCountThreshold:0}},this.loaded=!0}})}loadCompressedIndex(){return k(this,null,function*(){if(typeof DecompressionStream>"u")return console.log("DecompressionStream not supported, falling back to uncompressed"),null;try{let e=yield fetch("assets/sdrf-examples-index.json.gz");if(!e.ok||!e.body)return null;let i=e.body.pipeThrough(new DecompressionStream("gzip")).getReader(),o=[];for(;;){let{done:f,value:g}=yield i.read();if(f)break;o.push(g)}let r=o.reduce((f,g)=>f+g.length,0),s=new Uint8Array(r),a=0;for(let f of o)s.set(f,a),a+=f.length;let u=new TextDecoder().decode(s);return JSON.parse(u)}catch(e){return console.warn("Failed to load compressed index, falling back to uncompressed:",e),null}})}isLoaded(){return this.loaded}getMetadata(){return this.index?.metadata||null}getExamplesForColumn(e,t,i=20){if(!this.index)return[];let o=e.toLowerCase().trim(),r=this.index.columns[o];if(!r)return[];let s=t?.toLowerCase().trim(),a;if(s){if(a=r[s],!a){let u=Object.keys(r).find(f=>f.includes(s)||s.includes(f));u&&(a=r[u])}a||(o==="characteristics[organism]"?a=r.all:a=this.aggregateAllOrganisms(r))}else o==="characteristics[organism]"?a=r.all:a=this.aggregateAllOrganisms(r);return a?Object.entries(a).map(([u,f])=>({value:u,count:f})).sort((u,f)=>f.count-u.count).slice(0,i):[]}aggregateAllOrganisms(e){let t={};for(let i of Object.values(e))for(let[o,r]of Object.entries(i))t[o]=(t[o]||0)+r;return t}getContextForColumn(e,t,i=10){let o=this.getExamplesForColumn(e,t,i);if(o.length===0)return"";let r=o.map(a=>{let u=a.count>=1e3?`${(a.count/1e3).toFixed(1)}k`:`${a.count}`;return`- "${a.value}" (${u} occurrences)`}),s=t?` for ${t}`:"";return`Common values in ${e}${s}:
${r.join(`
`)}`}getContextForColumns(e,t,i=5){let o=[];for(let r of e){let s=this.getContextForColumn(r,t,i);s&&o.push(s)}return o.length===0?"":`## Reference Examples from Annotated Datasets

`+o.join(`

`)}getExampleValuesList(e,t,i=5){return this.getExamplesForColumn(e,t,i).map(o=>o.value)}isCommonValue(e,t,i){let o=this.getExamplesForColumn(e,i,50),r=t.toLowerCase().trim();return o.some(s=>s.value===r)}suggestSimilarValues(e,t,i,o=5){let r=this.getExamplesForColumn(e,i,50),s=t.toLowerCase().trim();return r.map(u=>O(E({},u),{score:this.similarityScore(s,u.value)})).filter(u=>u.score>.3).sort((u,f)=>f.score-u.score).slice(0,o)}similarityScore(e,t){if(e===t)return 1;if(e.includes(t)||t.includes(e))return .8;let i=new Set(e.split("")),o=new Set(t.split("")),r=0;for(let a of i)o.has(a)&&r++;let s=Math.max(i.size,o.size);return s>0?r/s:0}getAvailableOrganisms(){if(!this.index)return[];let e=new Set;for(let t of Object.values(this.index.columns))for(let i of Object.keys(t))i!=="all"&&e.add(i);return Array.from(e).sort()}getIndexedColumns(){return this.index?Object.keys(this.index.columns):[]}},I0=new gp;var dl=class n{worker=null;pendingRequests=new Map;isInitialized=!1;constructor(){this.initWorker()}ngOnDestroy(){this.terminate()}initWorker(){if(typeof Worker>"u"){console.warn("Web Workers are not supported in this browser");return}try{this.worker=new Worker(new URL("worker-ZKROABW5.js",import.meta.url),{type:"module"}),this.worker.onmessage=e=>{this.handleWorkerMessage(e.data)},this.worker.onerror=e=>{console.error("AI Worker error:",e);for(let[t,i]of this.pendingRequests)i.onError(`Worker error: ${e.message}`),this.pendingRequests.delete(t)},this.isInitialized=!0}catch(e){console.error("Failed to initialize AI Worker:",e)}}handleWorkerMessage(e){if(e.id==="init")return;let t=this.pendingRequests.get(e.id);if(t)switch(e.type){case"chunk":e.content&&t.onChunk(e.content);break;case"complete":t.onComplete(e.content||""),this.pendingRequests.delete(e.id);break;case"error":t.onError(e.error||"Unknown error"),this.pendingRequests.delete(e.id);break;case"aborted":t.onError("Request was aborted"),this.pendingRequests.delete(e.id);break}}isAvailable(){return this.isInitialized&&this.worker!==null}stream(e,t,i,o){return new Promise((r,s)=>{if(!this.isAvailable()){s(new Error("AI Worker is not available"));return}let a=crypto.randomUUID();this.pendingRequests.set(a,{onChunk:o,onComplete:r,onError:s});let u={id:a,type:"stream",provider:e,config:t,messages:i};this.worker.postMessage(u)})}complete(e,t,i){return new Promise((o,r)=>{if(!this.isAvailable()){r(new Error("AI Worker is not available"));return}let s=crypto.randomUUID();this.pendingRequests.set(s,{onChunk:()=>{},onComplete:u=>{o({content:u,finishReason:"stop"})},onError:r});let a={id:s,type:"complete",provider:e,config:t,messages:i};this.worker.postMessage(a)})}streamGenerator(e,t,i){return Sn(this,null,function*(){if(!this.isAvailable())throw new Error("AI Worker is not available");let o=crypto.randomUUID(),r=[],s=null,a=null,u=!1,f="";this.pendingRequests.set(o,{onChunk:h=>{r.push(h),s&&(s(r.shift()),s=null)},onComplete:h=>{u=!0,f=h,s&&(s(null),s=null)},onError:h=>{u=!0,a&&(a(new Error(h)),a=null)}});let g={id:o,type:"stream",provider:e,config:t,messages:i};this.worker.postMessage(g);try{for(;!u||r.length>0;)if(r.length>0)yield r.shift();else if(!u){let h=yield new nt(new Promise((b,C)=>{s=b,a=C}));h!==null&&(yield h)}return f}finally{this.pendingRequests.delete(o)}})}abort(e){if(!this.worker)return;let t={id:e,type:"abort",provider:"openai",config:{},messages:[]};this.worker.postMessage(t),this.pendingRequests.delete(e)}abortAll(){for(let e of this.pendingRequests.keys())this.abort(e)}terminate(){this.worker&&(this.worker.terminate(),this.worker=null,this.isInitialized=!1,this.pendingRequests.clear())}restart(){this.terminate(),this.initWorker()}static \u0275fac=function(t){return new(t||n)};static \u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})};var ul="https://www.ebi.ac.uk/pride/services/sdrf-validator",hp=class{isAvailable=w(null);lastError=w(null);apiVersion=w(null);checkHealth(){return k(this,null,function*(){try{let e=yield fetch(`${ul}/health`,{method:"GET",headers:{Accept:"application/json"}});if(!e.ok)return this.isAvailable.set(!1),!1;let t=yield e.json();return this.isAvailable.set(t.status==="healthy"),this.apiVersion.set(t.sdrf_pipelines_version),t.status==="healthy"}catch(e){return console.warn("SDRF API health check failed:",e),this.isAvailable.set(!1),this.lastError.set(e instanceof Error?e.message:String(e)),!1}})}getTemplates(){return k(this,null,function*(){try{let e=yield fetch(`${ul}/templates`,{method:"GET",headers:{Accept:"application/json"}});if(!e.ok)throw new Error(`Failed to get templates: ${e.status}`);return(yield e.json()).templates.map(i=>i.name)}catch(e){return console.warn("Failed to get templates from API:",e),["default","human","vertebrates","nonvertebrates","plants","cell_lines"]}})}validate(o){return k(this,arguments,function*(e,t=["ms-proteomics"],i={}){let{skipOntology:r=!0,useOlsCacheOnly:s=!0}=i;try{let a=new URLSearchParams;a.append("content",e),t.forEach(b=>a.append("template",b)),a.append("skip_ontology",String(r)),a.append("use_ols_cache_only",String(s));let u=yield fetch(`${ul}/validate/text?${a.toString()}`,{method:"POST",headers:{Accept:"application/json"}});if(!u.ok){let b=yield u.text();throw new Error(`Validation API error: ${u.status} - ${b}`)}let f=yield u.json(),g=this.convertApiErrors(f.errors,"error"),h=this.convertApiErrors(f.warnings,"warning");return[...g,...h]}catch(a){let u=a instanceof Error?a.message:String(a);throw this.lastError.set(u),new Error(`SDRF API validation failed: ${u}`)}})}validateFile(o){return k(this,arguments,function*(e,t=["ms-proteomics"],i={}){let{skipOntology:r=!0,useOlsCacheOnly:s=!0}=i;try{let a=new URLSearchParams;t.forEach(C=>a.append("template",C)),a.append("skip_ontology",String(r)),a.append("use_ols_cache_only",String(s));let u=new FormData;u.append("file",e);let f=yield fetch(`${ul}/validate?${a.toString()}`,{method:"POST",headers:{Accept:"application/json"},body:u});if(!f.ok){let C=yield f.text();throw new Error(`Validation API error: ${f.status} - ${C}`)}let g=yield f.json(),h=this.convertApiErrors(g.errors,"error"),b=this.convertApiErrors(g.warnings,"warning");return[...h,...b]}catch(a){let u=a instanceof Error?a.message:String(a);throw this.lastError.set(u),new Error(`SDRF API validation failed: ${u}`)}})}convertApiErrors(e,t){return e.map(i=>({message:i.message,row:i.row??-1,column:i.column??null,value:i.value??null,level:t,suggestion:this.generateSuggestion(i)}))}generateSuggestion(e){let t=e.error_type?.toLowerCase()||"",i=e.message?.toLowerCase()||"";return t.includes("missing")||i.includes("missing")?e.column?`Add a value for the "${e.column}" column`:"Add the missing required value":t.includes("ontology")||i.includes("ontology")?"Use a valid ontology term from the appropriate ontology (e.g., EFO, NCBI Taxonomy)":t.includes("format")||i.includes("format")?"Check the value format and ensure it matches the expected pattern":t.includes("duplicate")||i.includes("duplicate")?"Remove or rename duplicate entries":i.includes("not allowed")||i.includes("invalid")?"Check the allowed values for this column":null}},P0=new hp;var _p=class n{worker=null;messageId=0;pendingRequests=new Map;apiValidator=P0;state=w("not-loaded");loadProgress=w("");availableTemplates=w([]);lastError=w(null);usingApiFallback=w(!1);apiAvailable=w(null);isReady=A(()=>this.state()==="ready"||this.usingApiFallback());isLoading=A(()=>this.state()==="loading");initialize(){return k(this,null,function*(){if(this.state()!=="ready"){if(this.state()==="loading")return new Promise((e,t)=>{let i=setInterval(()=>{this.state()==="ready"?(clearInterval(i),e()):this.state()==="error"&&(clearInterval(i),t(new Error(this.lastError()||"Initialization failed")))},100)});this.state.set("loading"),this.loadProgress.set("Creating worker..."),this.lastError.set(null);try{this.worker=new Worker(new URL("worker-UE2AYD7R.js",import.meta.url),{type:"module"}),this.worker.onmessage=e=>this.handleWorkerMessage(e),this.worker.onerror=e=>this.handleWorkerError(e),yield new Promise((e,t)=>{let i=setTimeout(()=>{t(new Error("Pyodide initialization timed out (60s)"))},6e4),o=r=>{let{type:s,payload:a}=r.data;s==="progress"?this.loadProgress.set(a):s==="ready"?(clearTimeout(i),this.worker?.removeEventListener("message",o),e()):s==="error"&&(clearTimeout(i),this.worker?.removeEventListener("message",o),t(new Error(a)))};this.worker?.addEventListener("message",o),this.worker?.postMessage({type:"init"})}),this.state.set("ready"),this.loadProgress.set("Ready"),yield this.loadTemplates()}catch(e){let t=e instanceof Error?e.message:String(e);console.warn("Pyodide initialization failed:",t),console.log("Attempting to use SDRF Validator API as fallback..."),this.loadProgress.set("Pyodide failed, checking API...");try{let i=yield this.apiValidator.checkHealth();if(this.apiAvailable.set(i),i){console.log("SDRF Validator API is available, using as fallback"),this.usingApiFallback.set(!0),this.state.set("not-loaded"),this.loadProgress.set("Using SDRF Validator API (Pyodide unavailable)"),this.lastError.set(`Pyodide failed: ${t}. Using API fallback.`);let o=yield this.apiValidator.getTemplates();this.availableTemplates.set(o);return}}catch(i){console.warn("API fallback also failed:",i)}throw this.state.set("error"),this.lastError.set(t),this.loadProgress.set(`Error: ${t}`),e}}})}loadTemplates(){return k(this,null,function*(){if(this.usingApiFallback())try{let e=yield this.apiValidator.getTemplates();this.availableTemplates.set(e);return}catch(e){console.warn("Failed to load templates from API:",e)}try{let e=yield this.sendMessage("get-templates",{});this.availableTemplates.set(e)}catch(e){console.warn("Failed to load templates from Pyodide:",e);try{let t=yield this.apiValidator.getTemplates();this.availableTemplates.set(t);return}catch(t){console.warn("Failed to load templates from API:",t)}}})}validate(o,r){return k(this,arguments,function*(e,t,i={}){if(this.usingApiFallback())return console.log("Using API fallback for validation"),this.apiValidator.validate(e,t,{skipOntology:i.skipOntology??!0});if(!this.isReady())return console.log("Pyodide not ready, attempting API fallback"),this.validateWithApiFallback(e,t,i);try{return yield this.sendMessage("validate",{sdrf:e,templates:t,skipOntology:i.skipOntology??!0})}catch(s){return console.warn("Pyodide validation failed, falling back to API:",s),this.validateWithApiFallback(e,t,i)}})}validateWithApiFallback(o,r){return k(this,arguments,function*(e,t,i={}){try{let s=yield this.apiValidator.checkHealth();if(this.apiAvailable.set(s),!s)throw new Error("SDRF Validator API is not available");console.log("Using SDRF Validator API for validation"),this.loadProgress.set("Using SDRF Validator API...");let a=yield this.apiValidator.validate(e,t,{skipOntology:i.skipOntology??!0});return this.loadProgress.set("Validation complete (via API)"),a}catch(s){let a=s instanceof Error?s.message:String(s);throw this.lastError.set(`Validation failed: ${a}`),new Error(`Both Pyodide and API validation failed: ${a}`)}})}getTemplateDetails(e){return k(this,null,function*(){if(!this.isReady())throw new Error("Pyodide not initialized. Call initialize() first.");return this.sendMessage("get-template-details",{template:e})})}detectTemplates(e){let t=["ms-proteomics"],i=e.toLowerCase();return i.includes("homo sapiens")?t.push("human"):i.includes("mus musculus")||i.includes("rattus")||i.includes("danio rerio")?t.push("vertebrates"):i.includes("drosophila")||i.includes("caenorhabditis")?t.push("nonvertebrates"):(i.includes("arabidopsis")||i.includes("zea mays"))&&t.push("plants"),(i.includes("characteristics[cell line]")||i.includes("cvcl_"))&&t.push("cell_lines"),t}sendMessage(e,t){return new Promise((i,o)=>{if(!this.worker){o(new Error("Worker not initialized"));return}let r=++this.messageId;this.pendingRequests.set(r,{resolve:i,reject:o}),this.worker.postMessage({type:e,payload:t,id:r}),setTimeout(()=>{this.pendingRequests.has(r)&&(this.pendingRequests.delete(r),o(new Error("Request timed out")))},3e5)})}handleWorkerMessage(e){let{type:t,payload:i,id:o}=e.data;if(o!==void 0&&this.pendingRequests.has(o)){let{resolve:r,reject:s}=this.pendingRequests.get(o);this.pendingRequests.delete(o),t==="error"?s(new Error(i)):r(i);return}switch(t){case"progress":this.loadProgress.set(i);break;case"templates":this.availableTemplates.set(i);break;case"error":console.error("Pyodide worker error:",i),this.lastError.set(i);break}}handleWorkerError(e){console.error("Pyodide worker error:",e),this.lastError.set(e.message||"Unknown worker error"),this.state.set("error")}dispose(){this.worker&&(this.worker.terminate(),this.worker=null),this.state.set("not-loaded"),this.pendingRequests.clear()}static \u0275fac=function(t){return new(t||n)};static \u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})},pl=new _p;function O0(n){return`${n.label} (${n.id})`}var nw=(n,e)=>e.type,iw=(n,e)=>e.id;function ow(n,e){n&1&&(L(0,"span",22)(1,"span",24),d(2,"verified"),V(),d(3," OLS "),V())}function rw(n,e){if(n&1&&(L(0,"span",23)(1,"span",24),d(2,"warning"),V(),d(3),V()),n&2){let t=m(2);p(3),j(" ",t.alternativesCount()," ")}}function sw(n,e){if(n&1&&x(0,ow,4,0,"span",22)(1,rw,4,1,"span",23),n&2){let t=m();S(t.suggestion.validation.olsMatch?0:t.hasAlternatives()?1:-1)}}function aw(n,e){n&1&&(L(0,"span",5)(1,"span",24),d(2,"update"),V(),d(3," Stale "),V())}function lw(n,e){if(n&1&&(L(0,"p",29),d(1),V()),n&2){let t=m(3);p(),P(t.suggestion.validation.olsMatch.description)}}function cw(n,e){if(n&1&&(L(0,"div",26)(1,"span",27),d(2,"OLS Match:"),V(),L(3,"span",28),d(4),V(),x(5,lw,2,1,"p",29),V()),n&2){let t=m(2);p(4),P(t.formatTerm(t.suggestion.validation.olsMatch)),p(),S(t.suggestion.validation.olsMatch.description?5:-1)}}function dw(n,e){if(n&1&&(L(0,"div",17)(1,"p",25),d(2),V(),x(3,cw,6,2,"div",26),V()),n&2){let t=m();p(2),P(t.suggestion.reasoning),p(),S(t.suggestion.validation.olsMatch?3:-1)}}function uw(n,e){if(n&1){let t=N();L(0,"li",33),qt("click",function(){let o=v(t).$implicit,r=m(2);return y(r.selectAlternative(o))}),L(1,"span",34),d(2),V(),L(3,"code",35),d(4),V()()}if(n&2){let t=e.$implicit;Kn("title",t.description||""),p(2),P(t.label),p(2),P(t.id)}}function pw(n,e){if(n&1&&(L(0,"div",18)(1,"div",30)(2,"span",24),d(3,"info"),V(),L(4,"span"),d(5,"Suggested term not found in OLS. Consider these alternatives:"),V()(),L(6,"ul",31),z(7,uw,5,3,"li",32,iw),V()()),n&2){let t=m();p(7),$(t.suggestion.validation.olsAlternatives)}}function fw(n,e){if(n&1){let t=N();L(0,"button",36),qt("click",function(o){let r=v(t).$implicit,s=m();return y(s.handleAction(r,o))}),L(1,"span",24),d(2),V(),L(3,"span",37),d(4),V()()}if(n&2){let t=e.$implicit;Wt(t.type),B("primary",t.isPrimary),Kn("disabled",!t.enabled)("title",t.tooltip||t.label),p(2),P(t.icon),p(2),P(t.label)}}function mw(n,e){if(n&1){let t=N();L(0,"button",38),qt("click",function(o){v(t);let r=m();return y(r.toggleAlternatives(o))}),L(1,"span",24),d(2,"list"),V(),L(3,"span",37),d(4),V()()}if(n&2){let t=m();p(4),j("",t.alternativesCount()," Alternatives")}}var fl=class n{suggestion;actionTriggered=new W;alternativeSelected=new W;isExpanded=w(!1);showAlternativesState=w(!1);typeIcon=A(()=>E0(this.suggestion.type));confidenceClass=A(()=>M0(this.suggestion.confidence));hasAlternatives=A(()=>(this.suggestion.validation.olsAlternatives?.length||0)>0);alternativesCount=A(()=>this.suggestion.validation.olsAlternatives?.length||0);showAlternatives=A(()=>this.showAlternativesState()||!this.suggestion.validation.olsMatch);visibleActions=A(()=>this.suggestion.availableActions.filter(e=>e.type!=="alternatives"));currentValuePreview(){let t=this.suggestion.currentValues.values().next();return t.done?"N/A":t.value}formatTerm(e){return O0(e)}toggleExpand(){this.isExpanded.update(e=>!e)}toggleAlternatives(e){e.stopPropagation(),this.showAlternativesState.update(t=>!t)}handleAction(e,t){t.stopPropagation(),this.actionTriggered.emit({suggestion:this.suggestion,action:e})}selectAlternative(e){this.alternativeSelected.emit({suggestion:this.suggestion,alternative:e})}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ee({type:n,selectors:[["app-suggestion-card"]],inputs:{suggestion:"suggestion"},outputs:{actionTriggered:"actionTriggered",alternativeSelected:"alternativeSelected"},decls:36,vars:41,consts:[[1,"suggestion-card"],[1,"card-header",3,"click"],[1,"header-left"],[1,"type-icon","material-icons"],[1,"confidence-badge"],["title","Table has changed since this suggestion was created",1,"stale-badge"],[1,"header-right"],["title","Affected samples",1,"affected-count"],[1,"expand-icon","material-icons"],[1,"card-content"],[1,"change-preview"],[1,"column-name",3,"title"],[1,"value-change"],[1,"old-value",3,"title"],[1,"arrow","material-icons"],[1,"new-value",3,"title"],[1,"impact"],[1,"reasoning-section"],[1,"ols-alternatives"],[1,"card-actions"],["type","button",1,"action-btn",3,"primary","class","disabled","title"],["type","button","title","Show OLS alternatives",1,"action-btn","alternatives"],["title","OLS verified",1,"ols-badge","verified"],["title","Term not found in OLS",1,"ols-badge","warning"],[1,"material-icons"],[1,"reasoning"],[1,"ols-match"],[1,"label"],[1,"term"],[1,"description"],[1,"alternatives-header"],[1,"alternatives-list"],[1,"alternative-item",3,"title"],[1,"alternative-item",3,"click","title"],[1,"alt-label"],[1,"alt-id"],["type","button",1,"action-btn",3,"click","disabled","title"],[1,"action-label"],["type","button","title","Show OLS alternatives",1,"action-btn","alternatives",3,"click"]],template:function(t,i){t&1&&(L(0,"div",0)(1,"div",1),qt("click",function(){return i.toggleExpand()}),L(2,"div",2)(3,"span",3),d(4),V(),L(5,"span",4),d(6),Nn(7,"uppercase"),V(),x(8,sw,2,1),x(9,aw,4,0,"span",5),V(),L(10,"div",6)(11,"span",7),d(12),V(),L(13,"span",8),d(14),V()()(),L(15,"div",9)(16,"div",10)(17,"span",11),d(18),V(),L(19,"div",12)(20,"span",13),d(21),Nn(22,"slice"),V(),L(23,"span",14),d(24,"arrow_forward"),V(),L(25,"span",15),d(26),Nn(27,"slice"),V()()(),L(28,"p",16),d(29),V(),x(30,dw,4,2,"div",17),x(31,pw,9,0,"div",18),V(),L(32,"div",19),z(33,fw,5,8,"button",20,nw),x(35,mw,5,1,"button",21),V()()),t&2&&(B("stale",i.suggestion.validation.isStale)("applied",i.suggestion.status==="applied")("dismissed",i.suggestion.status==="dismissed")("expanded",i.isExpanded()),p(4),P(i.typeIcon()),p(),Wt(i.confidenceClass()),p(),j(" ",yu(7,31,i.suggestion.confidence)," "),p(2),S(i.suggestion.validation.olsValidated?8:-1),p(),S(i.suggestion.validation.isStale?9:-1),p(3),ve(" ",i.suggestion.affectedSamples.length," sample",i.suggestion.affectedSamples.length!==1?"s":""," "),p(2),j(" ",i.isExpanded()?"expand_less":"expand_more"," "),p(3),Kn("title",i.suggestion.column),p(),j(" ",i.suggestion.column," "),p(2),Kn("title",i.currentValuePreview()),p(),ve(" ",bo(22,33,i.currentValuePreview(),0,30),"",i.currentValuePreview().length>30?"...":""," "),p(4),B("ols-matched",i.suggestion.validation.olsMatch),Kn("title",i.suggestion.suggestedValue),p(),ve(" ",bo(27,37,i.suggestion.suggestedValue,0,30),"",i.suggestion.suggestedValue.length>30?"...":""," "),p(3),P(i.suggestion.impactDescription),p(),S(i.isExpanded()?30:-1),p(),S(i.showAlternatives()&&i.hasAlternatives()?31:-1),p(2),$(i.visibleActions()),p(2),S(i.hasAlternatives()&&!i.showAlternatives()?35:-1))},dependencies:[te,Pu,Er],styles:[".suggestion-card[_ngcontent-%COMP%]{background:var(--card-bg, #fff);border:1px solid var(--border-color, #e0e0e0);border-radius:8px;margin-bottom:8px;overflow:hidden;transition:all .2s ease}.suggestion-card[_ngcontent-%COMP%]:hover{box-shadow:0 2px 8px #00000014}.suggestion-card.stale[_ngcontent-%COMP%]{opacity:.7;border-color:var(--warning-color, #ff9800)}.suggestion-card.applied[_ngcontent-%COMP%]{background:var(--success-bg, #e8f5e9);border-color:var(--success-color, #4caf50)}.suggestion-card.dismissed[_ngcontent-%COMP%]{opacity:.5;background:var(--muted-bg, #f5f5f5)}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:8px 12px;cursor:pointer;background:var(--header-bg, #fafafa);border-bottom:1px solid var(--border-color, #e0e0e0)}.header-left[_ngcontent-%COMP%], .header-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.type-icon[_ngcontent-%COMP%]{font-size:18px;color:var(--text-secondary, #666)}.confidence-badge[_ngcontent-%COMP%]{padding:2px 8px;border-radius:4px;font-size:10px;font-weight:600;text-transform:uppercase}.confidence-high[_ngcontent-%COMP%]{background:var(--success-bg, #e8f5e9);color:var(--success-color, #2e7d32)}.confidence-medium[_ngcontent-%COMP%]{background:var(--warning-bg, #fff3e0);color:var(--warning-color, #ef6c00)}.confidence-low[_ngcontent-%COMP%]{background:var(--muted-bg, #f5f5f5);color:var(--text-secondary, #666)}.ols-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:2px;padding:2px 6px;border-radius:4px;font-size:10px;font-weight:500}.ols-badge[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:12px}.ols-badge.verified[_ngcontent-%COMP%]{background:var(--info-bg, #e3f2fd);color:var(--info-color, #1565c0)}.ols-badge.warning[_ngcontent-%COMP%]{background:var(--warning-bg, #fff3e0);color:var(--warning-color, #ef6c00)}.stale-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:2px;padding:2px 6px;border-radius:4px;font-size:10px;font-weight:500;background:var(--error-bg, #ffebee);color:var(--error-color, #c62828)}.stale-badge[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:12px}.affected-count[_ngcontent-%COMP%]{font-size:12px;color:var(--text-secondary, #666)}.expand-icon[_ngcontent-%COMP%]{font-size:20px;color:var(--text-secondary, #666)}.card-content[_ngcontent-%COMP%]{padding:12px}.change-preview[_ngcontent-%COMP%]{margin-bottom:8px}.column-name[_ngcontent-%COMP%]{display:block;font-weight:600;font-size:13px;color:var(--text-primary, #333);margin-bottom:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.value-change[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:12px}.old-value[_ngcontent-%COMP%]{color:var(--error-color, #c62828);text-decoration:line-through;background:var(--error-bg, #ffebee);padding:2px 6px;border-radius:4px}.arrow[_ngcontent-%COMP%]{font-size:14px;color:var(--text-secondary, #666)}.new-value[_ngcontent-%COMP%]{color:var(--success-color, #2e7d32);background:var(--success-bg, #e8f5e9);padding:2px 6px;border-radius:4px}.new-value.ols-matched[_ngcontent-%COMP%]{border:1px solid var(--info-color, #1565c0)}.impact[_ngcontent-%COMP%]{font-size:12px;color:var(--text-secondary, #666);margin:0 0 8px}.reasoning-section[_ngcontent-%COMP%]{margin-top:12px;padding-top:12px;border-top:1px solid var(--border-color, #e0e0e0)}.reasoning[_ngcontent-%COMP%]{font-size:12px;color:var(--text-secondary, #666);margin:0 0 8px;font-style:italic}.ols-match[_ngcontent-%COMP%]{background:var(--info-bg, #e3f2fd);padding:8px;border-radius:4px;font-size:12px}.ols-match[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:600;color:var(--info-color, #1565c0)}.ols-match[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]{margin-left:4px}.ols-match[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{margin:4px 0 0;font-size:11px;color:var(--text-secondary, #666)}.ols-alternatives[_ngcontent-%COMP%]{margin-top:12px;padding:8px;background:var(--warning-bg, #fff3e0);border-radius:4px}.alternatives-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;font-size:12px;color:var(--warning-color, #ef6c00);margin-bottom:8px}.alternatives-header[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:16px}.alternatives-list[_ngcontent-%COMP%]{list-style:none;margin:0;padding:0}.alternative-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:6px 8px;margin-bottom:4px;background:#fff;border-radius:4px;cursor:pointer;transition:background .15s ease}.alternative-item[_ngcontent-%COMP%]:hover{background:var(--hover-bg, #f5f5f5)}.alternative-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}.alt-label[_ngcontent-%COMP%]{font-size:12px;color:var(--text-primary, #333)}.alt-id[_ngcontent-%COMP%]{font-size:10px;color:var(--text-secondary, #666);background:var(--muted-bg, #f5f5f5);padding:2px 4px;border-radius:2px}.card-actions[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px;padding:8px 12px;background:var(--header-bg, #fafafa);border-top:1px solid var(--border-color, #e0e0e0)}.action-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;padding:6px 10px;border:1px solid var(--border-color, #e0e0e0);border-radius:4px;background:#fff;font-size:12px;cursor:pointer;transition:all .15s ease}.action-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--hover-bg, #f5f5f5)}.action-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.action-btn[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:16px}.action-btn.primary[_ngcontent-%COMP%]{background:var(--primary-color, #1976d2);border-color:var(--primary-color, #1976d2);color:#fff}.action-btn.primary[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--primary-dark, #1565c0)}.action-btn.apply_ols[_ngcontent-%COMP%]{background:var(--info-color, #1565c0);border-color:var(--info-color, #1565c0);color:#fff}.action-btn.dismiss[_ngcontent-%COMP%]{color:var(--error-color, #c62828)}.action-btn.chat[_ngcontent-%COMP%]{color:var(--info-color, #1565c0)}.action-label[_ngcontent-%COMP%]{white-space:nowrap}@media (max-width: 600px){.action-label[_ngcontent-%COMP%]{display:none}.action-btn[_ngcontent-%COMP%]{padding:8px}}"],changeDetection:0})};var Cp=(n,e)=>e.id,A0=(n,e)=>e.columnIndex;function gw(n,e){if(n&1&&(c(0,"span",4),d(1),l()),n&2){let t=m();p(),P(t.getActiveProviderName())}}function hw(n,e){n&1&&(c(0,"div",8),re(1,"div",10),c(2,"p"),d(3,"Initializing AI Assistant..."),l()())}function _w(n,e){if(n&1){let t=N();c(0,"div",9)(1,"p"),d(2,"Configure an AI provider to get started."),l(),c(3,"button",11),_("click",function(){v(t);let o=m();return y(o.openSettings.emit())}),d(4," Configure Provider "),l()()}}function Cw(n,e){if(n&1&&(c(0,"span",14),d(1),l()),n&2){let t=m(2);p(),P(t.qualityIssueCount())}}function vw(n,e){if(n&1&&(c(0,"span",15),d(1),l()),n&2){let t=m(2);p(),P(t.result().recommendations.length)}}function yw(n,e){n&1&&(re(0,"span",25),d(1," Analyzing... "))}function bw(n,e){n&1&&d(0," Analyze Quality ")}function xw(n,e){n&1&&(c(0,"p",22),d(1,"No table loaded"),l())}function Sw(n,e){if(n&1&&(c(0,"div",23),d(1),l()),n&2){let t=m(3);p(),j(" ",t.error()," ")}}function ww(n,e){n&1&&d(0," \u{1F504} ")}function Ew(n,e){n&1&&d(0," \u2713 ")}function Mw(n,e){n&1&&d(0," Aa ")}function Dw(n,e){n&1&&d(0," Aa ")}function Tw(n,e){n&1&&d(0," \u{1F5D1}\uFE0F ")}function Iw(n,e){if(n&1&&(c(0,"span",49)(1,"span",51),d(2),l(),c(3,"span",52),d(4,"\u2192"),l(),c(5,"span",53),d(6),l()()),n&2){let t=e.$implicit;p(2),P(t.before),p(4),P(t.after)}}function Pw(n,e){if(n&1&&(c(0,"span",50),d(1),l()),n&2){let t=m(2).$implicit;p(),j("+",t.preview.length-2," more")}}function Ow(n,e){if(n&1&&(c(0,"div",44),z(1,Iw,7,2,"span",49,Ve),x(3,Pw,2,1,"span",50),l()),n&2){let t=m().$implicit;p(),$(t.preview.slice(0,2)),p(2),S(t.preview.length>2?3:-1)}}function Aw(n,e){n&1&&(c(0,"span",46),d(1,"Safe"),l())}function Nw(n,e){n&1&&(c(0,"span",47),d(1,"Review"),l())}function kw(n,e){if(n&1){let t=N();c(0,"div",40)(1,"div",41),x(2,ww,1,0)(3,Ew,1,0)(4,Mw,1,0)(5,Dw,1,0)(6,Tw,1,0),l(),c(7,"div",42)(8,"div",43),d(9),l(),x(10,Ow,4,1,"div",44),c(11,"div",45),d(12),x(13,Aw,2,0,"span",46)(14,Nw,2,0,"span",47),l()(),c(15,"button",48),_("click",function(o){let r=v(t).$implicit,s=m(5);return s.logClick(r),s.applyFixAction(r),y(o.stopPropagation())}),d(16),l()()}if(n&2){let t,i=e.$implicit,o=m(5);B("fix-safe",i.isSafe),p(2),S((t=i.type)==="standardize_nulls"?2:t==="fix_reserved_words"?3:t==="lowercase_values"?4:t==="lowercase_column_names"?5:t==="remove_column"?6:-1),p(7),P(i.description),p(),S(i.preview&&i.preview.length>0?10:-1),p(2),Ia(" ",i.affectedCount," ",i.type==="remove_column"?"column":"cell","",i.affectedCount>1?"s":""," "),p(),S(i.isSafe?13:14),p(2),I("disabled",o.isApplyingFix()),p(),j(" ",o.isApplyingFix()?"Applying...":"Apply"," ")}}function Rw(n,e){if(n&1){let t=N();c(0,"div",33)(1,"div",36)(2,"h4"),d(3,"Auto-Fixes Available"),l(),c(4,"button",37),_("click",function(){v(t);let o=m(4);return y(o.applyAllSafeFixes())}),d(5),l()(),c(6,"div",38),z(7,kw,17,11,"div",39,Cp),l()()}if(n&2){let t=m(4);p(4),I("disabled",t.safeFixes().length===0),p(),j(" Apply Safe (",t.safeFixes().length,") "),p(2),$(t.availableFixes())}}function Fw(n,e){if(n&1&&(c(0,"div",61),d(1),l()),n&2){let t=m().$implicit;p(),j("\u{1F4A1} ",t.suggestedFix)}}function Vw(n,e){if(n&1&&(c(0,"div",56)(1,"div",57)(2,"span",58),d(3),l(),c(4,"span",59),d(5),l()(),c(6,"div",60),d(7),l(),x(8,Fw,2,1,"div",61),c(9,"div",62)(10,"span"),d(11),l(),c(12,"span"),d(13),l(),c(14,"span"),d(15),l()()()),n&2){let t=e.$implicit;Wt("action-"+t.action),p(3),P(t.name),p(),Wt("badge-"+t.action),p(),j(" ",t.action," "),p(2),P(t.reason),p(),S(t.suggestedFix?8:-1),p(3),j("",t.uniqueValues," unique"),p(2),j("",t.emptyCount," empty"),p(2),j("",t.notAvailableCount," N/A")}}function Lw(n,e){if(n&1&&(c(0,"div",34)(1,"div",36)(2,"h4"),d(3,"Column Issues"),l()(),c(4,"div",54),z(5,Vw,16,11,"div",55,A0),l()()),n&2){let t=m(4);p(5),$(t.columnsWithIssues())}}function jw(n,e){if(n&1&&(c(0,"div",64),d(1),l()),n&2){let t=e.$implicit;p(),P(t.name)}}function zw(n,e){if(n&1&&(c(0,"details",35)(1,"summary"),d(2),l(),c(3,"div",63),z(4,jw,2,1,"div",64,A0),l()()),n&2){let t=m(4);p(2),j(" \u2705 ",t.goodColumns().length," columns OK "),p(2),$(t.goodColumns())}}function $w(n,e){if(n&1&&(c(0,"div",26)(1,"div",27)(2,"div",28)(3,"span",29),d(4),l(),c(5,"span",30),d(6,"Columns"),l()(),c(7,"div",31)(8,"span",29),d(9),l(),c(10,"span",30),d(11,"Empty"),l()(),c(12,"div",32)(13,"span",29),d(14),l(),c(15,"span",30),d(16,"Issues"),l()()()(),x(17,Rw,9,2,"div",33),x(18,Lw,7,0,"div",34),x(19,zw,6,1,"details",35)),n&2){let t=m(3);p(4),P(t.qualityResult().summary.totalColumns),p(3),B("hidden",t.qualityResult().summary.effectivelyEmptyColumns===0),p(2),P(t.qualityResult().summary.effectivelyEmptyColumns),p(3),B("hidden",t.qualityResult().summary.columnsWithIssues===0),p(2),P(t.qualityResult().summary.columnsWithIssues),p(3),S(t.availableFixes().length>0?17:-1),p(),S(t.columnsWithIssues().length>0?18:-1),p(),S(t.goodColumns().length>0?19:-1)}}function Bw(n,e){if(n&1&&(c(0,"div",65)(1,"p")(2,"strong"),d(3,"Large table detected"),l()(),c(4,"p"),d(5),l(),c(6,"p"),d(7,'Click "Analyze Quality" to run the analysis manually.'),l()()),n&2){let t=m(4);p(5),j("This table has ",t.table==null?null:t.table.sampleCount," samples. Quality analysis was not run automatically to avoid slowing down your browser.")}}function Hw(n,e){n&1&&(c(0,"p"),d(1,'Click "Analyze Quality" to detect issues in your SDRF columns.'),l(),c(2,"ul",66)(3,"li"),d(4,"Columns with 100% identical values"),l(),c(5,"li"),d(6,'Columns with 100% "not available"'),l(),c(7,"li"),d(8,"Inconsistent case or null representations"),l(),c(9,"li"),d(10,"Wrong reserved words (control \u2192 normal)"),l()())}function Uw(n,e){if(n&1&&(c(0,"div",24),x(1,Bw,8,1,"div",65)(2,Hw,11,0),l()),n&2){let t=m(3);p(),S(t.isLargeTable()?1:2)}}function qw(n,e){if(n&1){let t=N();c(0,"div",17)(1,"div",20)(2,"button",21),_("click",function(){v(t);let o=m(2);return y(o.analyzeQuality())}),x(3,yw,2,0)(4,bw,1,0),l(),x(5,xw,2,0,"p",22),l(),x(6,Sw,2,1,"div",23),x(7,$w,20,10)(8,Uw,3,1,"div",24),l()}if(n&2){let t=m(2);p(2),I("disabled",t.qualityAnalyzing()||!t.table),p(),S(t.qualityAnalyzing()?3:4),p(2),S(t.table?-1:5),p(),S(t.error()&&t.activeTab()==="quality"?6:-1),p(),S(t.qualityResult()?7:8)}}function Ww(n,e){if(n&1&&d(0),n&2){let t=m(4);j(" ",t.enrichmentProgress()," ")}}function Gw(n,e){n&1&&d(0," Analyzing... ")}function Qw(n,e){if(n&1&&(re(0,"span",25),x(1,Ww,1,1)(2,Gw,1,0)),n&2){let t=m(3);p(),S(t.enrichmentProgress()?1:2)}}function Yw(n,e){n&1&&d(0," Analyze SDRF ")}function Kw(n,e){if(n&1){let t=N();c(0,"div",74),d(1),c(2,"button",80),_("click",function(){v(t);let o=m(3);return y(o.clearError())}),d(3,"\xD7"),l()()}if(n&2){let t=m(3);p(),j(" ",t.error()," ")}}function Zw(n,e){if(n&1&&d(0),n&2){let t=m(4);ve(" , ",t.pyodideWarningCount()," warning",t.pyodideWarningCount()!==1?"s":""," ")}}function Jw(n,e){if(n&1&&(c(0,"span"),d(1),l()),n&2){let t=m(2).$implicit;p(),P(t.column)}}function Xw(n,e){if(n&1&&(c(0,"span"),d(1),l()),n&2){let t=m(2).$implicit;p(),j("Row ",t.row+1)}}function eE(n,e){if(n&1&&(c(0,"span",94),d(1),l()),n&2){let t=m(2).$implicit;p(),j('Value: "',t.value,'"')}}function tE(n,e){if(n&1&&(c(0,"div",91),x(1,Jw,2,1,"span"),x(2,Xw,2,1,"span"),x(3,eE,2,1,"span",94),l()),n&2){let t=m().$implicit;p(),S(t.column?1:-1),p(),S(t.row>=0?2:-1),p(),S(t.value?3:-1)}}function nE(n,e){if(n&1&&(c(0,"div",92),d(1),l()),n&2){let t=m().$implicit;p(),j("\u{1F4A1} ",t.suggestion)}}function iE(n,e){if(n&1){let t=N();c(0,"button",95),_("click",function(){v(t);let o=m().$implicit,r=m(4);return y(r.jumpToValidationError(o))}),d(1," Jump "),l()}}function oE(n,e){if(n&1&&(c(0,"div",87)(1,"div",88),d(2),l(),c(3,"div",89)(4,"div",90),d(5),l(),x(6,tE,4,3,"div",91),x(7,nE,2,1,"div",92),l(),x(8,iE,2,0,"button",93),l()),n&2){let t=e.$implicit;B("error-level-warning",t.level==="warning"),p(),B("level-error",t.level==="error")("level-warning",t.level==="warning"),p(),j(" ",t.level==="error"?"\u274C":"\u26A0\uFE0F"," "),p(3),P(t.message),p(),S(t.column||t.row>=0?6:-1),p(),S(t.suggestion?7:-1),p(),S(t.column&&t.row>=0?8:-1)}}function rE(n,e){if(n&1&&(c(0,"div",86),d(1),l()),n&2){let t=m(4);p(),ve(" ... and ",t.pyodideErrors().length-10," more error",t.pyodideErrors().length-10!==1?"s":""," ")}}function sE(n,e){if(n&1&&(c(0,"div",75)(1,"div",81)(2,"h3",82),d(3," \u{1F50D} Validation Errors "),c(4,"span",83),d(5),x(6,Zw,1,2),l()()(),c(7,"div",84),z(8,oE,9,11,"div",85,Ve),x(10,rE,2,2,"div",86),l()()),n&2){let t=m(3);p(5),ve(" ",t.pyodideErrorCount()," error",t.pyodideErrorCount()!==1?"s":""," "),p(),S(t.pyodideWarningCount()>0?6:-1),p(2),$(t.pyodideErrors().slice(0,10)),p(2),S(t.pyodideErrors().length>10?10:-1)}}function aE(n,e){n&1&&(re(0,"span",97),d(1," Processing... "))}function lE(n,e){n&1&&d(0," Raw Output ")}function cE(n,e){if(n&1&&(c(0,"details",76)(1,"summary"),x(2,aE,2,0)(3,lE,1,0),l(),c(4,"pre",96),d(5),l()()),n&2){let t=m(3);I("open",t.analyzing()),p(2),S(t.analyzing()?2:3),p(3),P(t.streamContent())}}function dE(n,e){n&1&&(c(0,"div",77)(1,"h3",82),d(2,"\u2728 AI Recommendations"),l(),c(3,"p",98),d(4,"Suggestions based on validation results and AI knowledge"),l()())}function uE(n,e){if(n&1){let t=N();c(0,"button",107),_("click",function(){v(t);let o=m(4);return y(o.applyOlsValidatedActionable())}),d(1),l()}if(n&2){let t=m(4);p(),j(" Apply OLS Verified (",t.olsMatchedCount(),") ")}}function pE(n,e){if(n&1){let t=N();c(0,"app-suggestion-card",108),_("actionTriggered",function(o){v(t);let r=m(4);return y(r.handleSuggestionAction(o))})("alternativeSelected",function(o){v(t);let r=m(4);return y(r.handleAlternativeSelected(o))}),l()}if(n&2){let t=e.$implicit;I("suggestion",t)}}function fE(n,e){if(n&1){let t=N();c(0,"div",78)(1,"div",99)(2,"span",100)(3,"span",101),d(4,"verified"),l(),d(5),l(),c(6,"span",100)(7,"span",101),d(8,"search"),l(),d(9),l(),c(10,"span",100)(11,"span",101),d(12,"lightbulb"),l(),d(13),l()(),c(14,"div",102),x(15,uE,2,1,"button",103),c(16,"button",104),_("click",function(){v(t);let o=m(3);return y(o.applyHighConfidenceActionable())}),d(17," Apply High Confidence "),l()(),c(18,"div",105),z(19,pE,1,1,"app-suggestion-card",106,Cp),l()()}if(n&2){let t=m(3);p(5),j(" ",t.olsMatchedCount()," OLS verified "),p(4),j(" ",t.olsValidatedCount()," validated "),p(4),j(" ",t.actionableSuggestionCount()," suggestions "),p(2),S(t.olsMatchedCount()>0?15:-1),p(4),$(t.pendingActionableSuggestions())}}function mE(n,e){if(n&1){let t=N();c(0,"div",102)(1,"button",104),_("click",function(){v(t);let o=m(4);return y(o.applyHighConfidence())}),d(2),l(),c(3,"button",104),_("click",function(){v(t);let o=m(4);return y(o.applyAll())}),d(4),l()()}if(n&2){let t=m(4);p(2),j(" Apply High Confidence (",t.highConfidenceCount(),") "),p(2),j(" Apply All (",t.unappliedCount(),") ")}}function gE(n,e){n&1&&d(0," No issues found. Your SDRF looks good! ")}function hE(n,e){n&1&&d(0," No recommendations match current filter. ")}function _E(n,e){if(n&1&&(c(0,"div",119),x(1,gE,1,0)(2,hE,1,0),l()),n&2){let t=m(4);p(),S(t.result().recommendations.length===0?1:2)}}function CE(n,e){if(n&1&&(c(0,"span",135),d(1),l(),c(2,"span",136),d(3,"\u2192"),l()),n&2){let t=m().$implicit;p(),P(t.currentValue)}}function vE(n,e){n&1&&(c(0,"span",134),d(1,"Applied"),l())}function yE(n,e){if(n&1){let t=N();c(0,"button",137),_("click",function(){v(t);let o=m().$implicit,r=m(5);return y(r.onApplyClick(o))}),d(1," Accept "),l(),c(2,"button",138),_("click",function(){v(t);let o=m().$implicit,r=m(5);return y(r.onPreviewClick(o))}),d(3," Preview "),l(),c(4,"button",139),_("click",function(){v(t);let o=m().$implicit,r=m(5);return y(r.dismissRecommendation(o))}),d(5," Dismiss "),l()}}function bE(n,e){if(n&1&&(c(0,"div",121),re(1,"div",122),c(2,"div",123)(3,"div",124)(4,"span",125),d(5),l(),c(6,"span",126),d(7),l(),c(8,"span",127),d(9),l()(),c(10,"div",128),x(11,CE,4,1),c(12,"span",129),d(13),l()(),c(14,"div",130),d(15),c(16,"span",131),d(17),l()(),c(18,"div",132),d(19),l(),c(20,"div",133),x(21,vE,2,0,"span",134)(22,yE,6,0),l()()()),n&2){let t=e.$implicit,i=m(5);B("applied",t.applied),p(),Wt("conf-"+t.confidence),p(3),Wt("type-"+t.type),p(),j(" ",i.formatType(t.type)," "),p(2),P(t.column),p(),Wt("conf-"+t.confidence),p(),j(" ",t.confidence," "),p(2),S(t.currentValue&&t.currentValue!==t.suggestedValue?11:-1),p(2),P(t.suggestedValue),p(2),ve(" ",t.sampleIndices.length," sample",t.sampleIndices.length>1?"s":""," "),p(2),j("(",i.formatSamples(t.sampleIndices),")"),p(2),P(t.reasoning),p(2),S(t.applied?21:22)}}function xE(n,e){if(n&1&&z(0,bE,23,18,"div",120,Cp),n&2){let t=m(4);$(t.sortedRecommendations())}}function SE(n,e){if(n&1){let t=N();c(0,"div",78)(1,"div",109)(2,"span",110),d(3),l(),c(4,"select",111),_("change",function(o){v(t);let r=m(3);return y(r.onSortChange(o))}),c(5,"option",112),d(6,"Sort: Confidence"),l(),c(7,"option",113),d(8,"Sort: Column"),l(),c(9,"option",114),d(10,"Sort: Type"),l(),c(11,"option",115),d(12,"Sort: # Samples"),l()()(),c(13,"div",116)(14,"button",117),_("click",function(){v(t);let o=m(3);return y(o.filterType.set("all"))}),d(15,"All"),l(),c(16,"button",117),_("click",function(){v(t);let o=m(3);return y(o.filterType.set("fill_value"))}),d(17,"Fill"),l(),c(18,"button",117),_("click",function(){v(t);let o=m(3);return y(o.filterType.set("ontology_suggestion"))}),d(19,"Ontology"),l(),c(20,"button",117),_("click",function(){v(t);let o=m(3);return y(o.filterType.set("consistency_fix"))}),d(21,"Consistency"),l()(),x(22,mE,5,2,"div",102),c(23,"div",118),x(24,_E,3,1,"div",119)(25,xE,2,0),l()()}if(n&2){let t=m(3);p(3),ve(" ",t.filteredRecommendations().length," suggestion",t.filteredRecommendations().length!==1?"s":""," "),p(),I("value",t.sortBy()),p(10),B("active",t.filterType()==="all"),p(2),B("active",t.filterType()==="fill_value"),p(2),B("active",t.filterType()==="ontology_suggestion"),p(2),B("active",t.filterType()==="consistency_fix"),p(2),S(t.unappliedCount()>0?22:-1),p(2),S(t.filteredRecommendations().length===0?24:25)}}function wE(n,e){n&1&&(c(0,"p",140),d(1,"Suggestions will be validated against OLS for accurate ontology terms."),l())}function EE(n,e){if(n&1&&(c(0,"div",79)(1,"p"),d(2,'Click "Analyze SDRF" to get AI-powered suggestions.'),l(),x(3,wE,2,0,"p",140),l()),n&2){let t=m(3);p(3),S(t.useActionableSuggestions()?3:-1)}}function ME(n,e){if(n&1){let t=N();c(0,"div",18)(1,"div",67)(2,"div",68)(3,"label",69)(4,"input",70),_("change",function(){v(t);let o=m(2);return y(o.toggleFocus("fill_missing"))}),l(),d(5," Fill missing "),l(),c(6,"label",69)(7,"input",70),_("change",function(){v(t);let o=m(2);return y(o.toggleFocus("validate_ontology"))}),l(),d(8," Ontology "),l(),c(9,"label",69)(10,"input",70),_("change",function(){v(t);let o=m(2);return y(o.toggleFocus("check_consistency"))}),l(),d(11," Consistency "),l()(),c(12,"label",71)(13,"input",70),_("change",function(){v(t);let o=m(2);return y(o.useActionableSuggestions.set(!o.useActionableSuggestions()))}),l(),c(14,"span",72),d(15," Validate with OLS "),c(16,"span",73),d(17,"?"),l()()(),c(18,"button",21),_("click",function(){v(t);let o=m(2);return y(o.useActionableSuggestions()?o.analyzeActionable():o.analyze())}),x(19,Qw,3,1)(20,Yw,1,0),l()(),x(21,Kw,4,1,"div",74),x(22,sE,11,4,"div",75),x(23,cE,6,3,"details",76),x(24,dE,5,0,"div",77),x(25,fE,21,4,"div",78),x(26,SE,26,13,"div",78),x(27,EE,4,1,"div",79),l()}if(n&2){let t=m(2);p(4),I("checked",t.focusFillMissing()),p(3),I("checked",t.focusValidateOntology()),p(3),I("checked",t.focusCheckConsistency()),p(3),I("checked",t.useActionableSuggestions()),p(5),I("disabled",(t.useActionableSuggestions()?t.actionableAnalyzing():t.analyzing())||!t.table),p(),S((t.useActionableSuggestions()?t.actionableAnalyzing():t.analyzing())?19:20),p(2),S(t.error()?21:-1),p(),S(t.pyodideErrors().length>0&&t.pyodideHasValidated()?22:-1),p(),S(t.streamContent()?23:-1),p(),S(t.useActionableSuggestions()&&t.pendingActionableSuggestions().length>0||!t.useActionableSuggestions()&&t.result()?24:-1),p(),S(t.useActionableSuggestions()&&t.pendingActionableSuggestions().length>0&&!t.actionableAnalyzing()?25:-1),p(),S(!t.useActionableSuggestions()&&t.result()&&!t.analyzing()?26:-1),p(),S((t.useActionableSuggestions()?t.pendingActionableSuggestions().length===0:!t.result())&&!(t.useActionableSuggestions()?t.actionableAnalyzing():t.analyzing())?27:-1)}}function DE(n,e){if(n&1&&(c(0,"pre",149),d(1),l()),n&2){let t=m(3);p(),P(t.result().rawResponse)}}function TE(n,e){if(n&1){let t=N();c(0,"div",19)(1,"div",141)(2,"h4"),d(3,"Context Options"),l(),c(4,"label",142)(5,"input",70),_("change",function(){v(t);let o=m(2);return y(o.includeSampleData.set(!o.includeSampleData()))}),l(),d(6," Include sample data in context "),l(),c(7,"label",142)(8,"span"),d(9,"Max samples in context:"),l(),c(10,"input",143),_("input",function(o){v(t);let r=m(2);return y(r.onMaxSamplesChange(o))}),l()(),c(11,"label",142)(12,"span"),d(13,"Max unique values per column:"),l(),c(14,"input",144),_("input",function(o){v(t);let r=m(2);return y(r.onMaxUniqueChange(o))}),l()()(),c(15,"div",141)(16,"h4"),d(17,"Custom Instructions"),l(),c(18,"p",145),d(19,"Add additional instructions for the AI. These will be appended to the analysis prompt."),l(),c(20,"textarea",146),_("input",function(o){v(t);let r=m(2);return y(r.onCustomInstructionsChange(o))}),l()(),c(21,"div",141)(22,"h4"),d(23,"System Prompt Preview"),l(),c(24,"p",145),d(25,"The base system prompt used for SDRF analysis. Read-only."),l(),c(26,"details",147)(27,"summary"),d(28,"View system prompt"),l(),c(29,"pre",148),d(30),l()()(),c(31,"div",141)(32,"h4"),d(33,"Debug"),l(),c(34,"label",142)(35,"input",70),_("change",function(){v(t);let o=m(2);return y(o.showRawOutput.set(!o.showRawOutput()))}),l(),d(36," Show raw LLM output "),l(),x(37,DE,2,1,"pre",149),l()()}if(n&2){let t,i=m(2);p(5),I("checked",i.includeSampleData()),p(5),I("value",i.maxSampleRows()),p(4),I("value",i.maxUniqueValues()),p(6),I("value",i.customInstructions()),p(10),P(i.systemPromptPreview()),p(5),I("checked",i.showRawOutput()),p(2),S((t=i.result())!=null&&t.rawResponse&&i.showRawOutput()?37:-1)}}function IE(n,e){if(n&1){let t=N();c(0,"div",12)(1,"button",13),_("click",function(){v(t);let o=m();return y(o.activeTab.set("quality"))}),d(2," Quality "),x(3,Cw,2,1,"span",14),l(),c(4,"button",13),_("click",function(){v(t);let o=m();return y(o.activeTab.set("recommendations"))}),d(5," AI Suggest "),x(6,vw,2,1,"span",15),l(),c(7,"button",13),_("click",function(){v(t);let o=m();return y(o.activeTab.set("advanced"))}),d(8," Advanced "),l()(),c(9,"div",16),x(10,qw,9,5,"div",17),x(11,ME,28,13,"div",18),x(12,TE,38,7,"div",19),l()}if(n&2){let t=m();p(),B("active",t.activeTab()==="quality"),p(2),S(t.qualityIssueCount()>0?3:-1),p(),B("active",t.activeTab()==="recommendations"),p(2),S(t.result()&&t.result().recommendations.length>0?6:-1),p(),B("active",t.activeTab()==="advanced"),p(3),S(t.activeTab()==="quality"?10:-1),p(),S(t.activeTab()==="recommendations"?11:-1),p(),S(t.activeTab()==="advanced"?12:-1)}}var ml=class n{table=null;isInitializing=w(!0);hasInitialized=!1;close=new W;openSettings=new W;applyRecommendation=new W;batchApply=new W;previewRecommendation=new W;applyFix=new W;activeTab=w("quality");analyzing=w(!1);error=w(null);result=w(null);streamContent=w("");focusFillMissing=w(!0);focusValidateOntology=w(!0);focusCheckConsistency=w(!0);sortBy=w("confidence");filterType=w("all");includeSampleData=w(!0);maxSampleRows=w(10);maxUniqueValues=w(20);customInstructions=w("");showRawOutput=w(!1);examplesLoaded=w(!1);qualityResult=w(null);qualityAnalyzing=w(!1);availableFixes=w([]);pyodideValidating=w(!1);pyodideErrors=w([]);pyodideHasValidated=w(!1);selectedTemplates=w(["ms-proteomics"]);dismissedIds=new Set;recommendationService;settingsService;qualityService;cleaningService;examplesService;pyodideService;aiWorker;enrichmentService;suggestionState;actionableResult=w(null);actionableAnalyzing=w(!1);enrichmentProgress=w("");useActionableSuggestions=w(!0);constructor(){this.recommendationService=ll,this.settingsService=Oo,this.cleaningService=T0,this.examplesService=I0,this.pyodideService=pl,this.enrichmentService=sl,this.suggestionState=al,this.qualityService=null,this.aiWorker=null}ngAfterViewInit(){requestAnimationFrame(()=>{setTimeout(()=>{this.initializePanel()},0)})}initializePanel(){return k(this,null,function*(){try{this.qualityService=new ei,this.aiWorker=new dl,this.loadExamplesIndex(),this.hasInitialized=!0,this.isInitializing.set(!1),this.table&&this.table.sampleCount<=this.AUTO_ANALYZE_THRESHOLD&&setTimeout(()=>{this.analyzeQuality()},100)}catch(e){console.error("Error initializing AI panel:",e),this.isInitializing.set(!1)}})}loadExamplesIndex(){return k(this,null,function*(){try{yield this.examplesService.loadIndex(),this.examplesLoaded.set(!0)}catch(e){console.warn("Could not load SDRF examples index:",e)}})}qualityIssueCount=A(()=>{let e=this.qualityResult();return e?e.summary.columnsWithIssues+e.summary.effectivelyEmptyColumns:0});columnsWithIssues=A(()=>{let e=this.qualityResult();return e?e.columns.filter(t=>t.action!=="keep"):[]});goodColumns=A(()=>{let e=this.qualityResult();return e?e.columns.filter(t=>t.action==="keep"):[]});safeFixes=A(()=>this.availableFixes().filter(e=>e.isSafe));pyodideState=A(()=>this.pyodideService.state());pyodideIsReady=A(()=>this.pyodideService.isReady());pyodideIsLoading=A(()=>this.pyodideService.isLoading());pyodideLoadProgress=A(()=>this.pyodideService.loadProgress());pyodideAvailableTemplates=A(()=>this.pyodideService.availableTemplates());pyodideErrorCount=A(()=>this.pyodideErrors().filter(e=>e.level==="error").length);usingApiFallback=A(()=>this.pyodideService.usingApiFallback());apiAvailable=A(()=>this.pyodideService.apiAvailable());pyodideWarningCount=A(()=>this.pyodideErrors().filter(e=>e.level==="warning").length);pyodideLastError=A(()=>this.pyodideService.lastError());filteredRecommendations=A(()=>{let e=this.result();if(!e)return[];let t=e.recommendations.filter(o=>!this.dismissedIds.has(o.id));t=t.filter(o=>{let r=(o.currentValue||"").trim().toLowerCase(),s=(o.suggestedValue||"").trim().toLowerCase();return r!==s});let i=this.filterType();return i!=="all"&&(t=t.filter(o=>o.type===i)),t});sortedRecommendations=A(()=>{let e=[...this.filteredRecommendations()],t=this.sortBy();return e.sort((i,o)=>{switch(t){case"confidence":let r={high:0,medium:1,low:2};return r[i.confidence]-r[o.confidence];case"column":return i.column.localeCompare(o.column);case"type":return i.type.localeCompare(o.type);case"samples":return o.sampleIndices.length-i.sampleIndices.length;default:return 0}}),e});unappliedCount=A(()=>this.filteredRecommendations().filter(e=>!e.applied).length);highConfidenceCount=A(()=>this.filteredRecommendations().filter(e=>!e.applied&&e.confidence==="high").length);pendingActionableSuggestions=A(()=>this.suggestionState.pendingSuggestions().filter(t=>{let i=(t.suggestedValue||"").trim().toLowerCase();if(t.currentValues.size===0)return!0;for(let[o,r]of t.currentValues)if((r||"").trim().toLowerCase()!==i)return!0;return!1}));actionableSuggestionCount=A(()=>this.pendingActionableSuggestions().length);olsValidatedCount=A(()=>this.actionableResult()?.olsValidatedCount||0);olsMatchedCount=A(()=>this.actionableResult()?.olsMatchedCount||0);systemPromptPreview=A(()=>`You are an expert in proteomics data annotation, specifically the SDRF format...

Key concepts:
- Reserved values: "not available", "not applicable", "anonymized", "pooled"
- Column types: source name, characteristics[...], factor value[...], comment[...]
- Ontology requirements per column type

Output: JSON with recommendations array containing type, column, suggestedValue, confidence, reasoning...`);AUTO_ANALYZE_THRESHOLD=1e3;ngOnChanges(e){if(e.table){if(!this.hasInitialized)return;if(this.isApplyingFix()){console.log("ngOnChanges: Skipping reset because fix is being applied");return}console.log("ngOnChanges: Table changed, resetting state"),this.result.set(null),this.error.set(null),this.streamContent.set(""),this.dismissedIds.clear(),this.qualityResult.set(null),this.availableFixes.set([]),this.table&&this.table.sampleCount<=this.AUTO_ANALYZE_THRESHOLD&&setTimeout(()=>{this.analyzeQuality()},100)}}isLargeTable(){return this.table?this.table.sampleCount>this.AUTO_ANALYZE_THRESHOLD:!1}isConfigured(){return this.settingsService.isActiveProviderConfigured()}getActiveProviderName(){return qr(this.settingsService.getActiveProvider())}toggleFocus(e){switch(e){case"fill_missing":this.focusFillMissing.set(!this.focusFillMissing());break;case"validate_ontology":this.focusValidateOntology.set(!this.focusValidateOntology());break;case"check_consistency":this.focusCheckConsistency.set(!this.focusCheckConsistency());break}}analyze(){return k(this,null,function*(){if(!this.table||this.analyzing())return;this.analyzing.set(!0),this.error.set(null),this.streamContent.set(""),this.result.set(null),this.dismissedIds.clear();let e=[];this.focusFillMissing()&&e.push("fill_missing"),this.focusValidateOntology()&&e.push("validate_ontology"),this.focusCheckConsistency()&&e.push("check_consistency");try{let s=null;try{for(var t=wn(this.recommendationService.analyzeStreaming(this.table,e)),i,o,r;i=!(o=yield t.next()).done;i=!1){let a=o.value;typeof a=="string"?this.streamContent.update(u=>u+a):s=a}}catch{r=[o]}finally{try{i&&(o=t.return)&&(yield o.call(t))}finally{if(r)throw r[0]}}s&&this.result.set(s)}catch(s){this.error.set(s instanceof Error?s.message:"Analysis failed")}finally{this.analyzing.set(!1)}})}clearError(){this.error.set(null)}analyzeActionable(){return k(this,null,function*(){if(!this.table||this.actionableAnalyzing())return;this.actionableAnalyzing.set(!0),this.error.set(null),this.streamContent.set(""),this.enrichmentProgress.set(""),this.actionableResult.set(null);let e=[];this.focusFillMissing()&&e.push("fill_missing"),this.focusValidateOntology()&&e.push("validate_ontology"),this.focusCheckConsistency()&&e.push("check_consistency");let t=this.pyodideErrors().map(a=>({message:a.message,level:a.level,row:a.row,column:a.column??void 0,value:a.value??void 0,suggestion:a.suggestion??void 0}));try{try{for(var i=wn(this.recommendationService.analyzeActionableStreaming(this.table,e,void 0,t.length>0?t:void 0)),o,r,s;o=!(r=yield i.next()).done;o=!1){let f=r.value;f.type==="streaming"?this.streamContent.update(g=>g+f.content):f.type==="progress"&&this.enrichmentProgress.set(f.message)}}catch{s=[r]}finally{try{o&&(r=i.return)&&(yield r.call(i))}finally{if(s)throw s[0]}}let a=this.suggestionState.pendingSuggestions();!this.actionableResult()&&a.length>0&&this.actionableResult.set({suggestions:a,timestamp:new Date,provider:this.settingsService.getActiveProvider(),model:this.settingsService.getProviderConfig(this.settingsService.getActiveProvider())?.model||"",olsValidatedCount:a.filter(f=>f.validation.olsValidated).length,olsMatchedCount:a.filter(f=>f.validation.olsMatch).length})}catch(a){this.error.set(a instanceof Error?a.message:"Analysis failed")}finally{this.actionableAnalyzing.set(!1),this.enrichmentProgress.set("")}})}handleSuggestionAction(e){let{suggestion:t,action:i}=e;switch(i.type){case"apply":case"apply_ols":this.applyActionableSuggestion(t);break;case"preview":this.previewActionableSuggestion(t);break;case"dismiss":this.dismissActionableSuggestion(t);break;case"alternatives":break}}applyActionableSuggestion(e){let t={id:e.id,type:e.type,column:e.column,columnIndex:e.columnIndex,sampleIndices:e.affectedSamples,currentValue:this.getFirstValue(e.currentValues),suggestedValue:e.validation.olsMatch?e.validation.olsMatch.label:e.suggestedValue,confidence:e.confidence,reasoning:e.reasoning,applied:!0,ontologyId:e.validation.olsMatch?.id||e.ontologyId,ontologyLabel:e.validation.olsMatch?.label||e.ontologyLabel};this.suggestionState.markAsApplied(e.id),this.applyRecommendation.emit({recommendation:t})}previewActionableSuggestion(e){let t={id:e.id,type:e.type,column:e.column,columnIndex:e.columnIndex,sampleIndices:e.affectedSamples,currentValue:this.getFirstValue(e.currentValues),suggestedValue:e.suggestedValue,confidence:e.confidence,reasoning:e.reasoning,applied:!1};this.previewRecommendation.emit(t)}dismissActionableSuggestion(e){this.suggestionState.markAsDismissed(e.id)}handleAlternativeSelected(e){let{suggestion:t,alternative:i}=e;this.suggestionState.updateSuggestionValue(t.id,i.label,i.id,i.label)}applyHighConfidenceActionable(){let e=this.suggestionState.highConfidenceSuggestions();for(let t of e)this.applyActionableSuggestion(t)}applyOlsValidatedActionable(){let e=this.suggestionState.olsValidatedSuggestions();for(let t of e)this.applyActionableSuggestion(t)}getFirstValue(e){let i=e.values().next();return i.done?"":i.value}onSortChange(e){this.sortBy.set(e.target.value)}formatType(e){return{fill_value:"Fill",correct_value:"Fix",ontology_suggestion:"Ontology",consistency_fix:"Consistency",add_column:"Add Column"}[e]}formatSamples(e){return e.length<=3?e.join(", "):`${e.slice(0,3).join(", ")}...+${e.length-3}`}onApplyClick(e){e.applied=!0,this.applyRecommendation.emit({recommendation:e}),this.result.update(t=>t?E({},t):null)}onPreviewClick(e){this.previewRecommendation.emit(e)}dismissRecommendation(e){this.dismissedIds.add(e.id),this.result.update(t=>t?E({},t):null)}applyHighConfidence(){let e=this.filteredRecommendations().filter(t=>!t.applied&&t.confidence==="high");for(let t of e)t.applied=!0;this.batchApply.emit({recommendations:e}),this.result.update(t=>t?E({},t):null)}applyAll(){let e=this.filteredRecommendations().filter(t=>!t.applied);for(let t of e)t.applied=!0;this.batchApply.emit({recommendations:e}),this.result.update(t=>t?E({},t):null)}analyzeQuality(){if(!this.table){console.warn("analyzeQuality: No table available");return}if(this.qualityAnalyzing()){console.warn("analyzeQuality: Already analyzing");return}this.qualityAnalyzing.set(!0),this.error.set(null),setTimeout(()=>{try{let e=this.qualityService.analyzeTable(this.table);this.qualityResult.set(e);let t=this.cleaningService.detectAvailableFixes(this.table,e);this.availableFixes.set(t)}catch(e){console.error("Quality analysis failed:",e),this.error.set(`Quality analysis failed: ${e instanceof Error?e.message:"Unknown error"}`)}finally{this.qualityAnalyzing.set(!1)}},10)}isApplyingFix=w(!1);fixesInProgress=new Set;lastFixApplyTime=0;logClick(e){console.log(">>> BUTTON CLICKED <<<",e.id,e.type)}applyFixAction(e){console.log("=== applyFixAction CALLED ===",e.id,e.description);let t=Date.now(),i=t-this.lastFixApplyTime;if(console.log("Time since last fix:",i,"ms, isApplyingFix:",this.isApplyingFix(),"fixesInProgress:",[...this.fixesInProgress]),i<500){console.warn("applyFixAction: Debounced (too soon after last fix)",i,"ms");return}if(!this.table){console.warn("applyFixAction: No table available");return}if(this.fixesInProgress.has(e.id)){console.warn("applyFixAction: Fix already in progress:",e.id);return}if(this.isApplyingFix()){console.warn("applyFixAction: Another fix is already being applied");return}this.lastFixApplyTime=t,this.isApplyingFix.set(!0),this.fixesInProgress.add(e.id),console.log("Applying fix:",e.id,e.description);try{let{table:o,result:r}=this.cleaningService.applyFix(this.table,e);console.log("Fix result:",r),r.success?(this.availableFixes.update(s=>s.filter(a=>a.id!==e.id)),this.applyFix.emit({table:o,fix:e,result:r}),console.log("Fix applied successfully, changes:",r.changesCount),setTimeout(()=>{this.isApplyingFix.set(!1),this.fixesInProgress.delete(e.id),this.table&&this.analyzeQuality()},200)):(console.warn("Fix was not successful:",r),this.error.set(`Fix failed: ${e.description}`),this.isApplyingFix.set(!1),this.fixesInProgress.delete(e.id))}catch(o){console.error("Error applying fix:",o),this.error.set(`Error applying fix: ${o instanceof Error?o.message:"Unknown error"}`),this.isApplyingFix.set(!1),this.fixesInProgress.delete(e.id)}}applyAllSafeFixes(){let e=Date.now();if(e-this.lastFixApplyTime<500){console.warn("applyAllSafeFixes: Debounced (too soon after last fix)");return}if(!this.table)return;if(this.isApplyingFix()){console.warn("applyAllSafeFixes: Another fix is already being applied");return}let t=this.safeFixes();if(t.length!==0){this.lastFixApplyTime=e,this.isApplyingFix.set(!0),console.log("Applying all safe fixes:",t.length);try{let{table:i,results:o}=this.cleaningService.applyFixes(this.table,t),r=o.filter(s=>s.success).length;console.log("Safe fixes applied:",r,"of",t.length),r>0?(this.availableFixes.update(s=>s.filter(a=>!t.some(u=>u.id===a.id))),this.applyFix.emit({table:i,fix:t[0],result:{success:!0,changesCount:o.reduce((s,a)=>s+a.changesCount,0)}}),setTimeout(()=>{this.isApplyingFix.set(!1),this.table&&this.analyzeQuality()},200)):this.isApplyingFix.set(!1)}catch(i){console.error("Error applying safe fixes:",i),this.error.set(`Error applying fixes: ${i instanceof Error?i.message:"Unknown error"}`),this.isApplyingFix.set(!1)}}}initPyodide(){return k(this,null,function*(){try{yield this.pyodideService.initialize();let e=this.pyodideAvailableTemplates();if(e.length===0)return;if(this.table){let t=Io.exportToTsv(this.table),o=this.pyodideService.detectTemplates(t).filter(s=>e.includes(s)),r=e.includes("ms-proteomics")?"ms-proteomics":e[0];this.selectedTemplates.set(o.length>0?o:[r])}else{let t=this.selectedTemplates().filter(o=>e.includes(o)),i=e.includes("ms-proteomics")?"ms-proteomics":e[0];this.selectedTemplates.set(t.length>0?t:[i])}}catch(e){console.error("Failed to initialize Pyodide:",e)}})}runPyodideValidation(){return k(this,null,function*(){if(!(!this.table||this.pyodideValidating())){this.pyodideIsReady()||(yield this.initPyodide()),this.pyodideValidating.set(!0),this.pyodideErrors.set([]);try{let e=Io.exportToTsv(this.table),t=this.table.columns.find(s=>s.name.includes("sdrf template"));if(t){console.log(`[RecPanel Validate] Template column state: value="${t.value}", modifiers=${JSON.stringify(t.modifiers)}`);let s=e.split(`
`).slice(0,3);console.log("[RecPanel Validate] First 3 TSV lines:",s)}let i=this.pyodideAvailableTemplates(),o=this.selectedTemplates().filter(s=>i.includes(s));o.length===0&&i.length>0&&(o=[i.includes("ms-proteomics")?"ms-proteomics":i[0]],this.selectedTemplates.set(o));let r=yield this.pyodideService.validate(e,o,{skipOntology:!0});this.pyodideErrors.set(r),r.length>0&&this.settingsService.isAnyProviderConfigured()&&setTimeout(()=>{this.analyzeActionable()},100)}catch(e){console.error("Pyodide validation failed:",e),this.pyodideErrors.set([{message:`Validation failed: ${e instanceof Error?e.message:String(e)}`,row:-1,column:null,value:null,level:"error",suggestion:null}])}finally{this.pyodideValidating.set(!1),this.pyodideHasValidated.set(!0)}}})}toggleTemplate(e){let t=this.selectedTemplates();t.includes(e)?this.selectedTemplates.set(t.filter(i=>i!==e)):this.selectedTemplates.set([...t,e])}jumpToValidationError(e){if(e.row>=0&&e.column){let t=this.findColumnIndex(e.column);if(t>=0){let i={id:"validation-"+Date.now(),type:"fill_value",column:e.column,columnIndex:t,sampleIndices:[e.row+1],currentValue:e.value||"",suggestedValue:e.suggestion||"",confidence:"high",reasoning:e.message,applied:!1};this.previewRecommendation.emit(i)}}}buildValidationContext(){let e=this.pyodideErrors();if(e.length===0)return"";let t=e.slice(0,15).map(i=>{let o=i.row>=0?`Row ${i.row+1}`:"General",r=i.column?`, ${i.column}`:"",s=i.value?` (value: "${i.value}")`:"",a=i.suggestion?` Fix: ${i.suggestion}`:"";return`- [${i.level.toUpperCase()}] ${o}${r}${s}: ${i.message}${a}`});return`
SDRF-PIPELINES VALIDATION (${this.selectedTemplates().join(", ")}):
${e.length} issues found (${this.pyodideErrorCount()} errors, ${this.pyodideWarningCount()} warnings)
${t.join(`
`)}
${e.length>15?`...and ${e.length-15} more`:""}`}findColumnIndex(e){if(!this.table)return-1;let t=e.toLowerCase().trim();return this.table.columns.findIndex(i=>i.name.toLowerCase().trim()===t)}buildTableContext(){if(!this.table)return"No table loaded";let e=this.table.columns,t=this.table.sampleCount,i=`## SDRF Table Summary
`;i+=`- **Samples:** ${t}
`,i+=`- **Columns:** ${e.length}

`,i+=`### Column Details

`;for(let o of e){let r=[];for(let f=1;f<=t;f++){let g=de(o,f);g&&r.push(g)}let s=[...new Set(r)],a=t-r.filter(f=>f&&f.trim()!=="").length,u=r.filter(f=>f?.toLowerCase()==="not available").length;i+=`**${o.name}:**
`,i+=`- Unique values: ${s.length}
`,a>0&&(i+=`- Empty: ${a}
`),u>0&&(i+=`- "not available": ${u}
`),s.length<=8?i+=`- Values: ${s.join(", ")}
`:i+=`- Sample values: ${s.slice(0,5).join(", ")}... (${s.length} total)
`,i+=`
`}i+=`### Sample Data (first ${Math.min(3,t)} rows)

`,i+="| Sample | "+e.slice(0,6).map(o=>o.name.replace(/characteristics\[|\]/g,"")).join(" | ")+` |
`,i+="|"+"----|".repeat(Math.min(7,e.length+1))+`
`;for(let o=1;o<=Math.min(3,t);o++){let r=e.slice(0,6).map(s=>{let a=de(s,o);return a&&a.length>20?a.substring(0,17)+"...":a||""});i+=`| ${o} | ${r.join(" | ")} |
`}return i}buildQualityContext(){if(!this.qualityResult())return"Quality analysis not yet performed";let t=this.columnsWithIssues();return t.length===0?"No quality issues detected":`Found ${t.length} columns with issues:
${t.slice(0,5).map(i=>`- ${i.name}: ${i.reason}`).join(`
`)}
${t.length>5?`...and ${t.length-5} more`:""}`}buildExamplesContext(){if(!this.examplesLoaded()||!this.table)return"";let e=this.detectOrganism(),t=["characteristics[disease]","characteristics[organism part]","characteristics[developmental stage]","characteristics[sex]","characteristics[cell line]","characteristics[cell type]"],i=this.table.columns.map(r=>r.name.toLowerCase()),o=t.filter(r=>i.includes(r));return o.length===0?"":this.examplesService.getContextForColumns(o,e,5)}detectOrganism(){if(!this.table)return;let e=this.table.columns.find(r=>r.name.toLowerCase()==="characteristics[organism]");if(!e)return;let t=e.value?.toLowerCase().trim();if(t&&t!=="not available"&&t!=="not applicable")return t;let i={};for(let r of e.modifiers){let s=r.value?.toLowerCase().trim();if(s&&s!=="not available"&&s!=="not applicable"){let a=this.countSamplesInRange(r.samples);i[s]=(i[s]||0)+a}}return Object.entries(i).sort((r,s)=>s[1]-r[1])[0]?.[0]}countSamplesInRange(e){let t=0,i=e.split(",");for(let o of i){let r=o.trim();if(r.includes("-")){let[s,a]=r.split("-").map(Number);!isNaN(s)&&!isNaN(a)&&(t+=a-s+1)}else{let s=Number(r);isNaN(s)||(t+=1)}}return t}onMaxSamplesChange(e){this.maxSampleRows.set(parseInt(e.target.value)||10)}onMaxUniqueChange(e){this.maxUniqueValues.set(parseInt(e.target.value)||20)}onCustomInstructionsChange(e){this.customInstructions.set(e.target.value)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ee({type:n,selectors:[["sdrf-recommend-panel"]],inputs:{table:"table"},outputs:{close:"close",openSettings:"openSettings",applyRecommendation:"applyRecommendation",batchApply:"batchApply",previewRecommendation:"previewRecommendation",applyFix:"applyFix"},features:[Fe],decls:16,vars:2,consts:[[1,"ai-panel"],[1,"panel-header"],[1,"header-title"],[1,"ai-icon"],[1,"provider-tag"],[1,"header-actions"],["type","button","title","Settings",1,"icon-btn",3,"click"],["type","button","title","Close",1,"icon-btn",3,"click"],[1,"initializing-state"],[1,"empty-state"],[1,"initializing-spinner"],["type","button",1,"btn","btn-primary",3,"click"],[1,"panel-tabs"],["type","button",1,"tab",3,"click"],[1,"tab-badge","tab-badge-warn"],[1,"tab-badge"],[1,"panel-content"],[1,"quality-tab"],[1,"recommendations-tab"],[1,"advanced-tab"],[1,"quality-actions"],["type","button",1,"btn","btn-primary","btn-block",3,"click","disabled"],[1,"quality-hint"],[1,"quality-error"],[1,"empty-quality"],[1,"spinner"],[1,"quality-summary"],[1,"summary-stats"],[1,"stat"],[1,"stat-value"],[1,"stat-label"],[1,"stat","stat-error"],[1,"stat","stat-warn"],[1,"fixes-section"],[1,"issues-section"],[1,"good-section"],[1,"section-header"],["type","button",1,"btn","btn-sm",3,"click","disabled"],[1,"fixes-list"],[1,"fix-card",3,"fix-safe"],[1,"fix-card"],[1,"fix-icon"],[1,"fix-content"],[1,"fix-desc"],[1,"fix-preview"],[1,"fix-meta"],[1,"safe-badge"],[1,"review-badge"],["type","button",1,"btn","btn-xs","btn-primary",3,"click","disabled"],[1,"preview-item"],[1,"preview-more"],[1,"prev-old"],[1,"prev-arrow"],[1,"prev-new"],[1,"issues-list"],[1,"issue-card",3,"class"],[1,"issue-card"],[1,"issue-header"],[1,"issue-col-name"],[1,"action-badge"],[1,"issue-reason"],[1,"issue-fix"],[1,"issue-stats"],[1,"good-list"],[1,"good-item"],[1,"large-table-warning"],[1,"quality-checks"],[1,"analysis-section"],[1,"focus-options"],[1,"focus-option"],["type","checkbox",3,"change","checked"],[1,"focus-option","ols-toggle"],[1,"ols-label"],["title","Validates suggestions against the Ontology Lookup Service",1,"ols-hint"],[1,"error-msg"],[1,"validation-errors-section"],[1,"stream-section",3,"open"],[1,"ai-recommendations-header"],[1,"results-section"],[1,"no-results","empty-state-suggestions"],["type","button",1,"dismiss-btn",3,"click"],[1,"section-header-line"],[1,"section-title"],[1,"error-count-badge"],[1,"validation-errors-list"],[1,"validation-error-item",3,"error-level-warning"],[1,"more-errors-notice"],[1,"validation-error-item"],[1,"error-level-badge"],[1,"error-content"],[1,"error-message"],[1,"error-location"],[1,"error-suggestion"],["type","button","title","Jump to cell",1,"btn","btn-xs","btn-jump"],[1,"error-value"],["type","button","title","Jump to cell",1,"btn","btn-xs","btn-jump",3,"click"],[1,"stream-output"],[1,"spinner-sm"],[1,"section-subtitle"],[1,"ols-stats-banner"],[1,"ols-stat"],[1,"material-icons"],[1,"batch-actions"],["type","button",1,"btn","btn-sm","btn-success"],["type","button",1,"btn","btn-sm",3,"click"],[1,"actionable-suggestions-list"],[3,"suggestion"],["type","button",1,"btn","btn-sm","btn-success",3,"click"],[3,"actionTriggered","alternativeSelected","suggestion"],[1,"results-bar"],[1,"results-count"],[1,"sort-select",3,"change","value"],["value","confidence"],["value","column"],["value","type"],["value","samples"],[1,"filter-pills"],["type","button",1,"pill",3,"click"],[1,"recommendations-list"],[1,"no-results"],[1,"rec-card",3,"applied"],[1,"rec-card"],[1,"rec-confidence-bar"],[1,"rec-content"],[1,"rec-header"],[1,"rec-type-badge"],[1,"rec-column-name"],[1,"rec-confidence-badge"],[1,"rec-change"],[1,"new-val"],[1,"rec-meta"],[1,"sample-list"],[1,"rec-reasoning"],[1,"rec-actions"],[1,"applied-label"],[1,"old-val"],[1,"arrow"],["type","button",1,"btn","btn-primary","btn-xs",3,"click"],["type","button",1,"btn","btn-xs",3,"click"],["type","button",1,"btn","btn-xs","btn-muted",3,"click"],[1,"hint"],[1,"adv-section"],[1,"adv-option"],["type","number","min","1","max","50",1,"num-input",3,"input","value"],["type","number","min","5","max","100",1,"num-input",3,"input","value"],[1,"adv-hint"],["placeholder","e.g., Focus on human samples only. Suggest UBERON terms for organism parts. Be conservative with low-confidence suggestions.","rows","4",1,"adv-textarea",3,"input","value"],[1,"prompt-preview"],[1,"prompt-content"],[1,"raw-output"]],template:function(t,i){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),d(4,"\u2728"),l(),c(5,"span"),d(6,"AI Assistant"),l(),x(7,gw,2,1,"span",4),l(),c(8,"div",5)(9,"button",6),_("click",function(){return i.openSettings.emit()}),d(10," \u2699\uFE0F "),l(),c(11,"button",7),_("click",function(){return i.close.emit()}),d(12,"\xD7"),l()()(),x(13,hw,4,0,"div",8)(14,_w,5,0,"div",9)(15,IE,13,11),l()),t&2&&(p(7),S(i.isConfigured()?7:-1),p(6),S(i.isInitializing()?13:i.isConfigured()?15:14))},dependencies:[te,ce,Ue,qe,fl],styles:[".ai-panel[_ngcontent-%COMP%]{width:100%;height:100%;background:#fff;display:flex;flex-direction:column;font-size:13px}.panel-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;background:#667eea;color:#fff;flex-shrink:0}.header-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-weight:600}.ai-icon[_ngcontent-%COMP%]{font-size:16px}.provider-tag[_ngcontent-%COMP%]{font-size:10px;background:#fff3;padding:2px 8px;border-radius:10px;font-weight:400}.header-actions[_ngcontent-%COMP%]{display:flex;gap:4px}.icon-btn[_ngcontent-%COMP%]{background:#ffffff26;border:none;color:#fff;width:28px;height:28px;border-radius:6px;cursor:pointer;font-size:14px}.icon-btn[_ngcontent-%COMP%]:hover{background:#ffffff40}.empty-state[_ngcontent-%COMP%]{padding:40px 20px;text-align:center;color:#6b7280}.initializing-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;color:#6b7280;gap:16px}.initializing-spinner[_ngcontent-%COMP%]{width:32px;height:32px;border:3px solid #e5e7eb;border-top-color:#6366f1;border-radius:50%;animation:_ngcontent-%COMP%_init-spin .8s linear infinite}@keyframes _ngcontent-%COMP%_init-spin{to{transform:rotate(360deg)}}.initializing-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;margin:0}.panel-tabs[_ngcontent-%COMP%]{display:flex;border-bottom:1px solid #e5e7eb;flex-shrink:0}.tab[_ngcontent-%COMP%]{flex:1;padding:10px 12px;background:none;border:none;border-bottom:2px solid transparent;cursor:pointer;font-size:12px;color:#6b7280;display:flex;align-items:center;justify-content:center;gap:6px}.tab[_ngcontent-%COMP%]:hover{background:#f9fafb}.tab.active[_ngcontent-%COMP%]{color:#667eea;border-bottom-color:#667eea;font-weight:500}.tab-badge[_ngcontent-%COMP%]{background:#667eea;color:#fff;font-size:10px;padding:1px 6px;border-radius:10px}.tab-badge-warn[_ngcontent-%COMP%]{background:#f59e0b}.panel-content[_ngcontent-%COMP%]{flex:1;overflow:hidden;display:flex;flex-direction:column}.recommendations-tab[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;overflow:hidden}.analysis-section[_ngcontent-%COMP%]{padding:12px 16px;border-bottom:1px solid #e5e7eb;flex-shrink:0}.focus-options[_ngcontent-%COMP%]{display:flex;gap:12px;margin-bottom:10px;flex-wrap:wrap}.focus-option[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;font-size:11px;color:#4b5563;cursor:pointer}.error-msg[_ngcontent-%COMP%]{margin:8px 16px;padding:8px 12px;background:#fee2e2;color:#b91c1c;border-radius:6px;font-size:12px;display:flex;justify-content:space-between;align-items:center}.dismiss-btn[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;font-size:16px;color:inherit}.stream-section[_ngcontent-%COMP%]{margin:8px 16px;font-size:11px}.stream-section[_ngcontent-%COMP%]   summary[_ngcontent-%COMP%]{cursor:pointer;color:#6b7280;display:flex;align-items:center;gap:6px}.stream-output[_ngcontent-%COMP%]{background:#1e1e1e;color:#d4d4d4;padding:10px;border-radius:6px;font-size:10px;max-height:150px;overflow:auto;margin-top:6px;white-space:pre-wrap;word-break:break-word}.validation-errors-section[_ngcontent-%COMP%]{margin:12px 16px;padding:12px;background:#fef2f2;border:2px solid #fecaca;border-radius:8px}.section-header-line[_ngcontent-%COMP%]{margin-bottom:12px}.section-title[_ngcontent-%COMP%]{font-size:14px;font-weight:600;margin:0;color:#1f2937;display:flex;align-items:center;gap:8px}.error-count-badge[_ngcontent-%COMP%]{font-size:11px;font-weight:500;background:#fee2e2;color:#991b1b;padding:2px 8px;border-radius:10px}.validation-errors-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.validation-error-item[_ngcontent-%COMP%]{display:flex;gap:10px;padding:10px;background:#fff;border:1px solid #fecaca;border-radius:6px;align-items:flex-start}.validation-error-item.error-level-warning[_ngcontent-%COMP%]{background:#fffbeb;border-color:#fde68a}.error-level-badge[_ngcontent-%COMP%]{font-size:16px;flex-shrink:0;width:24px;text-align:center}.error-content[_ngcontent-%COMP%]{flex:1;min-width:0}.error-message[_ngcontent-%COMP%]{font-size:13px;color:#1f2937;margin-bottom:4px;font-weight:500}.error-location[_ngcontent-%COMP%]{display:flex;gap:10px;flex-wrap:wrap;font-size:11px;color:#6b7280;margin-bottom:4px}.error-location[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background:#f3f4f6;padding:2px 6px;border-radius:3px}.error-value[_ngcontent-%COMP%]{font-family:monospace;color:#991b1b}.error-suggestion[_ngcontent-%COMP%]{font-size:12px;color:#059669;margin-top:4px;padding:4px 8px;background:#d1fae5;border-radius:4px}.btn-jump[_ngcontent-%COMP%]{flex-shrink:0;font-size:11px}.more-errors-notice[_ngcontent-%COMP%]{text-align:center;font-size:12px;color:#6b7280;padding:8px;background:#fff;border-radius:4px}.ai-recommendations-header[_ngcontent-%COMP%]{margin:12px 16px 8px;padding-bottom:8px;border-bottom:2px solid #e5e7eb}.ai-recommendations-header[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{margin-bottom:4px}.section-subtitle[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;margin:0}.results-section[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;overflow:hidden}.results-bar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:8px 16px;border-bottom:1px solid #e5e7eb;flex-shrink:0}.results-count[_ngcontent-%COMP%]{font-size:12px;color:#6b7280}.sort-select[_ngcontent-%COMP%]{font-size:11px;padding:4px 8px;border:1px solid #d1d5db;border-radius:4px;background:#fff}.filter-pills[_ngcontent-%COMP%]{display:flex;gap:6px;padding:8px 16px;border-bottom:1px solid #e5e7eb;flex-shrink:0;flex-wrap:wrap}.pill[_ngcontent-%COMP%]{padding:4px 10px;border:1px solid #d1d5db;border-radius:12px;background:#fff;font-size:11px;cursor:pointer;color:#6b7280}.pill[_ngcontent-%COMP%]:hover{background:#f3f4f6}.pill.active[_ngcontent-%COMP%]{background:#667eea;color:#fff;border-color:#667eea}.batch-actions[_ngcontent-%COMP%]{display:flex;gap:8px;padding:8px 16px;border-bottom:1px solid #e5e7eb;flex-shrink:0}.recommendations-list[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:8px 12px}.no-results[_ngcontent-%COMP%]{padding:30px 20px;text-align:center;color:#9ca3af;font-size:13px}.rec-card[_ngcontent-%COMP%]{display:flex;background:#fff;border:1px solid #e5e7eb;border-radius:8px;margin-bottom:8px;overflow:hidden}.rec-card.applied[_ngcontent-%COMP%]{opacity:.5}.rec-confidence-bar[_ngcontent-%COMP%]{width:4px;flex-shrink:0}.rec-confidence-bar.conf-high[_ngcontent-%COMP%]{background:#22c55e}.rec-confidence-bar.conf-medium[_ngcontent-%COMP%]{background:#f59e0b}.rec-confidence-bar.conf-low[_ngcontent-%COMP%]{background:#9ca3af}.rec-content[_ngcontent-%COMP%]{flex:1;padding:10px 12px}.rec-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;margin-bottom:6px;flex-wrap:wrap}.rec-type-badge[_ngcontent-%COMP%]{font-size:9px;font-weight:600;text-transform:uppercase;padding:2px 6px;border-radius:3px}.type-fill_value[_ngcontent-%COMP%]{background:#dbeafe;color:#1d4ed8}.type-correct_value[_ngcontent-%COMP%]{background:#fef3c7;color:#b45309}.type-ontology_suggestion[_ngcontent-%COMP%]{background:#f3e8ff;color:#7c3aed}.type-consistency_fix[_ngcontent-%COMP%]{background:#e0e7ff;color:#4338ca}.rec-column-name[_ngcontent-%COMP%]{font-weight:600;color:#374151;font-size:12px}.rec-confidence-badge[_ngcontent-%COMP%]{margin-left:auto;font-size:9px;padding:2px 6px;border-radius:3px}.conf-high[_ngcontent-%COMP%]{background:#d1fae5;color:#059669}.conf-medium[_ngcontent-%COMP%]{background:#fef3c7;color:#d97706}.conf-low[_ngcontent-%COMP%]{background:#f3f4f6;color:#6b7280}.rec-change[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;margin-bottom:4px;flex-wrap:wrap}.old-val[_ngcontent-%COMP%]{color:#9ca3af;text-decoration:line-through;font-size:11px}.arrow[_ngcontent-%COMP%]{color:#6b7280;font-size:10px}.new-val[_ngcontent-%COMP%]{background:#d1fae5;color:#059669;padding:2px 6px;border-radius:3px;font-size:11px;font-weight:500}.rec-meta[_ngcontent-%COMP%]{font-size:10px;color:#9ca3af;margin-bottom:4px}.sample-list[_ngcontent-%COMP%]{opacity:.7}.rec-reasoning[_ngcontent-%COMP%]{font-size:11px;color:#6b7280;font-style:italic;background:#f9fafb;padding:6px 8px;border-radius:4px;margin-bottom:8px;line-height:1.4}.rec-actions[_ngcontent-%COMP%]{display:flex;gap:6px}.applied-label[_ngcontent-%COMP%]{color:#059669;font-size:11px;font-weight:500}.advanced-tab[_ngcontent-%COMP%]{padding:16px;overflow-y:auto}.adv-section[_ngcontent-%COMP%]{margin-bottom:20px}.adv-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 10px;font-size:12px;color:#374151}.adv-hint[_ngcontent-%COMP%]{font-size:11px;color:#9ca3af;margin:0 0 8px}.adv-option[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:12px;color:#4b5563;margin-bottom:8px;cursor:pointer}.num-input[_ngcontent-%COMP%]{width:60px;padding:4px 8px;border:1px solid #d1d5db;border-radius:4px;font-size:12px}.adv-textarea[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #d1d5db;border-radius:6px;font-size:12px;font-family:inherit;resize:vertical}.prompt-preview[_ngcontent-%COMP%]   summary[_ngcontent-%COMP%]{cursor:pointer;font-size:11px;color:#667eea}.prompt-content[_ngcontent-%COMP%]{background:#f9fafb;padding:10px;border-radius:6px;font-size:10px;max-height:200px;overflow:auto;margin-top:8px;white-space:pre-wrap}.raw-output[_ngcontent-%COMP%]{background:#1e1e1e;color:#d4d4d4;padding:10px;border-radius:6px;font-size:10px;max-height:200px;overflow:auto;margin-top:8px;white-space:pre-wrap}.btn[_ngcontent-%COMP%]{padding:8px 14px;border:1px solid #d1d5db;border-radius:6px;font-size:12px;cursor:pointer;background:#fff;color:#374151;font-weight:500}.btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#f3f4f6}.btn-primary[_ngcontent-%COMP%]{background:#667eea;color:#fff;border:none}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){opacity:.9}.btn-block[_ngcontent-%COMP%]{width:100%}.btn-sm[_ngcontent-%COMP%]{padding:5px 10px;font-size:11px}.btn-xs[_ngcontent-%COMP%]{padding:4px 8px;font-size:10px}.btn-muted[_ngcontent-%COMP%]{color:#9ca3af;border-color:#e5e7eb}.spinner[_ngcontent-%COMP%]{display:inline-block;width:14px;height:14px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}.spinner-sm[_ngcontent-%COMP%]{display:inline-block;width:10px;height:10px;border:2px solid #d1d5db;border-top-color:#667eea;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.quality-tab[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;overflow-y:auto}.quality-actions[_ngcontent-%COMP%]{padding:12px 16px;border-bottom:1px solid #e5e7eb;flex-shrink:0}.quality-hint[_ngcontent-%COMP%]{margin:8px 0 0;font-size:11px;color:#9ca3af;text-align:center}.quality-error[_ngcontent-%COMP%]{margin:12px 16px;padding:10px 12px;background:#fef2f2;border:1px solid #fecaca;border-radius:6px;color:#dc2626;font-size:12px}.quality-summary[_ngcontent-%COMP%]{padding:12px 16px;border-bottom:1px solid #e5e7eb;flex-shrink:0}.summary-stats[_ngcontent-%COMP%]{display:flex;gap:12px;flex-wrap:wrap}.stat[_ngcontent-%COMP%]{text-align:center;padding:8px 12px;background:#f3f4f6;border-radius:6px;min-width:60px}.stat-value[_ngcontent-%COMP%]{display:block;font-size:18px;font-weight:600;color:#374151}.stat-label[_ngcontent-%COMP%]{font-size:10px;color:#6b7280}.stat-warn[_ngcontent-%COMP%]{background:#fef3c7}.stat-warn[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{color:#d97706}.stat-error[_ngcontent-%COMP%]{background:#fee2e2}.stat-error[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{color:#dc2626}.stat.hidden[_ngcontent-%COMP%]{display:none}.fixes-section[_ngcontent-%COMP%], .issues-section[_ngcontent-%COMP%]{padding:12px 16px;border-bottom:1px solid #e5e7eb}.section-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}.section-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-size:12px;font-weight:600;color:#374151}.fixes-list[_ngcontent-%COMP%], .issues-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.fix-card[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:10px;padding:10px;background:#f9fafb;border:1px solid #e5e7eb;border-radius:6px}.fix-card.fix-safe[_ngcontent-%COMP%]{border-left:3px solid #22c55e}.fix-icon[_ngcontent-%COMP%]{font-size:14px;width:24px;text-align:center;flex-shrink:0}.fix-content[_ngcontent-%COMP%]{flex:1;min-width:0}.fix-desc[_ngcontent-%COMP%]{font-size:12px;color:#374151;margin-bottom:4px}.fix-preview[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:6px;margin-bottom:4px}.preview-item[_ngcontent-%COMP%]{font-size:10px;display:inline-flex;align-items:center;gap:4px}.prev-old[_ngcontent-%COMP%]{color:#9ca3af;text-decoration:line-through}.prev-arrow[_ngcontent-%COMP%]{color:#6b7280}.prev-new[_ngcontent-%COMP%]{color:#059669;background:#d1fae5;padding:1px 4px;border-radius:2px}.preview-more[_ngcontent-%COMP%]{font-size:10px;color:#9ca3af}.fix-meta[_ngcontent-%COMP%]{font-size:10px;color:#9ca3af;display:flex;align-items:center;gap:8px}.safe-badge[_ngcontent-%COMP%]{background:#d1fae5;color:#059669;padding:1px 6px;border-radius:8px;font-size:9px}.review-badge[_ngcontent-%COMP%]{background:#fef3c7;color:#d97706;padding:1px 6px;border-radius:8px;font-size:9px}.issue-card[_ngcontent-%COMP%]{padding:10px 12px;background:#f9fafb;border:1px solid #e5e7eb;border-radius:6px;border-left:3px solid #9ca3af}.issue-card.action-remove[_ngcontent-%COMP%]{border-left-color:#dc2626}.issue-card.action-review[_ngcontent-%COMP%]{border-left-color:#f59e0b}.issue-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px}.issue-col-name[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#374151}.action-badge[_ngcontent-%COMP%]{font-size:9px;padding:2px 6px;border-radius:8px;text-transform:uppercase;font-weight:500}.badge-remove[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626}.badge-review[_ngcontent-%COMP%]{background:#fef3c7;color:#d97706}.badge-keep[_ngcontent-%COMP%]{background:#d1fae5;color:#059669}.issue-reason[_ngcontent-%COMP%]{font-size:11px;color:#6b7280;margin-bottom:4px}.issue-fix[_ngcontent-%COMP%]{font-size:11px;color:#059669;background:#f0fdf4;padding:4px 8px;border-radius:4px;margin-bottom:4px}.issue-stats[_ngcontent-%COMP%]{display:flex;gap:12px;font-size:10px;color:#9ca3af}.good-section[_ngcontent-%COMP%]{padding:12px 16px}.good-section[_ngcontent-%COMP%]   summary[_ngcontent-%COMP%]{cursor:pointer;font-size:12px;color:#059669;font-weight:500}.good-list[_ngcontent-%COMP%]{margin-top:8px;display:flex;flex-wrap:wrap;gap:6px}.good-item[_ngcontent-%COMP%]{font-size:11px;padding:4px 8px;background:#f3f4f6;border-radius:4px;color:#4b5563}.empty-quality[_ngcontent-%COMP%]{padding:30px 20px;text-align:center;color:#6b7280;font-size:12px}.quality-checks[_ngcontent-%COMP%]{text-align:left;margin:16px auto;max-width:250px;padding-left:20px}.quality-checks[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:6px;font-size:11px;color:#9ca3af}.large-table-warning[_ngcontent-%COMP%]{background:#fef3c7;border:1px solid #f59e0b;border-radius:8px;padding:16px;margin:8px;text-align:left}.large-table-warning[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 8px;font-size:12px;color:#92400e}.large-table-warning[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:last-child{margin-bottom:0}.ols-toggle[_ngcontent-%COMP%]{margin-top:8px;padding-top:8px;border-top:1px dashed #e5e7eb}.ols-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}.ols-hint[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;width:14px;height:14px;border-radius:50%;background:#e5e7eb;color:#6b7280;font-size:9px;cursor:help}.ols-stats-banner[_ngcontent-%COMP%]{display:flex;gap:16px;padding:8px 16px;background:linear-gradient(90deg,#e0f2fe,#f0fdf4);border-bottom:1px solid #e5e7eb;flex-shrink:0}.ols-stat[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;font-size:11px;color:#4b5563}.ols-stat[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:14px;color:#059669}.actionable-suggestions-list[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:8px 12px}.empty-state-suggestions[_ngcontent-%COMP%]{padding:40px 20px;text-align:center}.empty-state-suggestions[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 8px;color:#6b7280;font-size:13px}.empty-state-suggestions[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{font-size:11px;color:#9ca3af}.btn-success[_ngcontent-%COMP%]{background:#059669;color:#fff;border-color:#059669}.btn-success[_ngcontent-%COMP%]:hover{background:#047857}"],changeDetection:0})};var PE=(n,e)=>e.value;function OE(n,e){n&1&&(c(0,"span",22),d(1,"Local"),l())}function AE(n,e){if(n&1){let t=N();c(0,"button",20),_("click",function(){let o=v(t).$implicit,r=m();return y(r.selectProvider(o.value))}),c(1,"span",21),d(2),l(),x(3,OE,2,0,"span",22),l()}if(n&2){let t=e.$implicit,i=m();B("selected",i.selectedProvider()===t.value),p(2),P(t.label),p(),S(t.requiresKey?-1:3)}}function NE(n,e){n&1&&(c(0,"span",23),d(1,"*"),l())}function kE(n,e){if(n&1){let t=N();c(0,"div",24)(1,"p"),d(2),l(),c(3,"p")(4,"strong"),d(5,"Storage options:"),l()(),c(6,"div",25)(7,"button",18),_("click",function(){v(t);let o=m(2);return y(o.setStorageConsent("session"))}),d(8," Session Only "),c(9,"span",26),d(10,"Cleared when you close the browser"),l()(),c(11,"button",27),_("click",function(){v(t);let o=m(2);return y(o.setStorageConsent("persistent"))}),d(12," Remember (Encrypted) "),c(13,"span",26),d(14,"Stored securely in your browser"),l()()()()}if(n&2){let t=m(2);p(2),j(" Your API key will be used to make direct requests from your browser to ",t.getProviderDisplayName(t.selectedProvider()),". ")}}function RE(n,e){if(n&1){let t=N();c(0,"button",32),_("click",function(){v(t);let o=m(3);return y(o.clearApiKey())}),d(1," \xD7 "),l()}}function FE(n,e){n&1&&d(0," Your key is encrypted and stored in your browser. ")}function VE(n,e){n&1&&d(0," Your key will be cleared when you close this tab. ")}function LE(n,e){if(n&1){let t=N();c(0,"div",28)(1,"input",29),_("input",function(o){v(t);let r=m(2);return y(r.onApiKeyInput(o))}),l(),x(2,RE,2,0,"button",30),l(),c(3,"p",11),x(4,FE,1,0)(5,VE,1,0),c(6,"button",31),_("click",function(){v(t);let o=m(2);return y(o.resetConsent())}),d(7,"Change storage"),l()()}if(n&2){let t=m(2);p(),B("has-value",t.hasApiKey()),I("value",t.apiKeyDisplay()),p(),S(t.hasApiKey()?2:-1),p(2),S(t.hasStorageConsent()&&t.storageMode()==="persistent"?4:5)}}function jE(n,e){if(n&1&&(c(0,"div",5)(1,"label",6),d(2," API Key "),x(3,NE,2,0,"span",23),l(),x(4,kE,15,1,"div",24)(5,LE,8,5),l()),n&2){let t=m();p(3),S(t.hasApiKey()?-1:3),p(),S(!t.hasStorageConsent()&&!t.consentShown()?4:5)}}function zE(n,e){if(n&1&&(c(0,"div",33)(1,"div",37),d(2,"\u26A0\uFE0F"),l(),c(3,"div",38)(4,"p")(5,"strong"),d(6,"CORS Restriction"),l()(),c(7,"p"),d(8," You're running this app from "),c(9,"strong"),d(10),l(),d(11,". Browsers block requests from remote sites to localhost for security. "),l(),c(12,"p")(13,"strong"),d(14,"To use Ollama with this remote site:"),l()(),c(15,"ol")(16,"li"),d(17," Configure Ollama with CORS headers: "),c(18,"div",39)(19,"code"),d(20),l()()(),c(21,"li"),d(22,"Or run this editor locally at "),c(23,"code",40),d(24,"localhost"),l()(),c(25,"li"),d(26,"Or use a cloud AI provider (OpenAI, Anthropic, Gemini)"),l()()()()),n&2){let t=m(2);p(10),P(t.getHostname()),p(10),j("OLLAMA_ORIGINS=",t.getOrigin()," ollama serve")}}function $E(n,e){n&1&&(c(0,"span",35),d(1,"Checking connection..."),l())}function BE(n,e){if(n&1&&d(0),n&2){let t=m(3);j(" (",t.ollamaModels().length," models available) ")}}function HE(n,e){if(n&1){let t=N();c(0,"span",41),d(1," Connected to Ollama "),x(2,BE,1,1),l(),c(3,"button",42),_("click",function(){v(t);let o=m(2);return y(o.refreshOllamaModels())}),d(4," Refresh Models "),l()}if(n&2){let t=m(2);p(2),S(t.ollamaModels().length>0?2:-1),p(),I("disabled",t.ollamaChecking())}}function UE(n,e){if(n&1){let t=N();c(0,"div",36)(1,"div",43),d(2),l(),c(3,"div",44)(4,"p")(5,"strong"),d(6,"To use Ollama:"),l()(),c(7,"ol")(8,"li")(9,"strong"),d(10,"Install Ollama:"),l(),c(11,"a",45),d(12,"Download from ollama.ai"),l(),c(13,"div",39)(14,"code"),d(15,"macOS/Linux: curl -fsSL https://ollama.ai/install.sh | sh"),l()()(),c(16,"li")(17,"strong"),d(18,"Pull a model:"),l(),c(19,"div",39)(20,"code"),d(21,"ollama pull llama3.2"),l()()(),c(22,"li")(23,"strong"),d(24,"Start Ollama:"),l(),d(25," Run the Ollama app or use "),c(26,"code",40),d(27,"ollama serve"),l()()()(),c(28,"button",46),_("click",function(){v(t);let o=m(2);return y(o.refreshOllamaModels())}),d(29," Retry Connection "),l()()}if(n&2){let t=m(2);p(2),j(" Cannot connect to Ollama at ",t.ollamaUrl()," "),p(26),I("disabled",t.ollamaChecking())}}function qE(n,e){if(n&1&&(c(0,"div",5)(1,"label",6),d(2,"Ollama Status"),l(),x(3,zE,27,2,"div",33),c(4,"div",34),x(5,$E,2,0,"span",35)(6,HE,5,2)(7,UE,30,2,"div",36),l()()),n&2){let t=m();p(3),S(t.isRemoteHost()?3:-1),p(2),S(t.ollamaChecking()?5:t.ollamaRunning()?6:7)}}function WE(n,e){if(n&1&&(c(0,"option",10),d(1),l()),n&2){let t=e.$implicit;I("value",t),p(),P(t)}}function GE(n,e){n&1&&d(0," GPT-4o is recommended for best results. ")}function QE(n,e){n&1&&d(0," Claude Sonnet is recommended for balanced speed and quality. ")}function YE(n,e){n&1&&d(0," Gemini Flash offers fast responses. ")}function KE(n,e){n&1&&d(0," Llama 3 models work well for this task. ")}function ZE(n,e){if(n&1){let t=N();c(0,"div",5)(1,"label",6),d(2,"Ollama URL"),l(),c(3,"input",47),_("input",function(o){v(t);let r=m();return y(r.onOllamaUrlChange(o))}),l()()}if(n&2){let t=m();p(3),I("value",t.ollamaUrl())}}function JE(n,e){n&1&&d(0," Testing... ")}function XE(n,e){n&1&&d(0," Test Connection ")}function eM(n,e){n&1&&d(0," Connection successful ")}function tM(n,e){if(n&1&&d(0),n&2){let t=m(2);j(" ",t.testResult().error," ")}}function nM(n,e){if(n&1&&(c(0,"span",48),x(1,eM,1,0)(2,tM,1,1),l()),n&2){let t=m();B("success",t.testResult().success)("error",!t.testResult().success),p(),S(t.testResult().success?1:2)}}var gl=class n{isOpen=!0;close=new W;settingsSaved=new W;providerOptions=[{value:"openai",label:"OpenAI",requiresKey:!0},{value:"anthropic",label:"Anthropic",requiresKey:!0},{value:"gemini",label:"Google Gemini",requiresKey:!0},{value:"ollama",label:"Ollama",requiresKey:!1}];selectedProvider=w("openai");selectedModel=w("gpt-4o-mini");temperature=w(.3);ollamaUrl=w("http://localhost:11434");apiKey=w("");hasApiKey=w(!1);consentShown=w(!1);testing=w(!1);testResult=w(null);ollamaChecking=w(!1);ollamaRunning=w(!1);ollamaModels=w([]);settingsService;recommendationService;constructor(){this.settingsService=Oo,this.recommendationService=ll}availableModels=A(()=>{let e=this.selectedProvider();if(e==="ollama"){let t=this.ollamaModels();return t.length>0?t:Hr.ollama}return Hr[e]||[]});requiresApiKey=A(()=>Pp(this.selectedProvider()));apiKeyDisplay=A(()=>this.hasApiKey()&&!this.apiKey()?"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022":this.apiKey());ngOnInit(){this.loadSettings()}hasStorageConsent(){return this.settingsService.hasStorageConsent()}storageMode(){return this.settingsService.getSettings().storageMode}getProviderDisplayName(e){return qr(e)}selectProvider(e){this.selectedProvider.set(e),this.testResult.set(null);let t=Hr[e];this.selectedModel.set(t[0]);let i=this.settingsService.getProviderConfig(e);if(i)this.selectedModel.set(i.model),this.temperature.set(i.temperature||.3),e==="ollama"&&i.baseUrl&&this.ollamaUrl.set(i.baseUrl);else{let o=Hi[e];this.temperature.set(o.temperature||.3),e==="ollama"&&this.ollamaUrl.set(o.baseUrl||"http://localhost:11434")}this.loadApiKeyStatus(),e==="ollama"&&this.checkOllamaStatus()}setStorageConsent(e){return k(this,null,function*(){yield this.settingsService.setStorageConsent(!0,e),this.consentShown.set(!0)})}resetConsent(){this.consentShown.set(!1)}onApiKeyInput(e){let t=e.target;this.apiKey.set(t.value),this.testResult.set(null)}clearApiKey(){return k(this,null,function*(){yield this.settingsService.clearApiKey(this.selectedProvider()),this.apiKey.set(""),this.hasApiKey.set(!1),this.testResult.set(null)})}onModelChange(e){let t=e.target;this.selectedModel.set(t.value)}onTemperatureChange(e){let t=e.target;this.temperature.set(parseFloat(t.value))}onOllamaUrlChange(e){let t=e.target;this.ollamaUrl.set(t.value)}canTest(){return this.selectedProvider()==="ollama"?!0:this.hasApiKey()||this.apiKey().length>0}isConfigValid(){return this.selectedProvider()==="ollama"?!0:this.hasApiKey()||this.apiKey().length>0}testConnection(){return k(this,null,function*(){this.testing.set(!0),this.testResult.set(null);try{yield this.saveSettings();let e=yield this.recommendationService.testConnection();this.testResult.set(e)}catch(e){this.testResult.set({success:!1,error:e instanceof Error?e.message:"Unknown error"})}finally{this.testing.set(!1)}})}saveAndClose(){return k(this,null,function*(){yield this.saveSettings(),this.settingsSaved.emit(),this.close.emit()})}onOverlayClick(e){e.target===e.currentTarget&&this.close.emit()}loadSettings(){let e=this.settingsService.getSettings();this.selectedProvider.set(e.activeProvider),this.consentShown.set(e.storageConsent);let t=this.settingsService.getProviderConfig(e.activeProvider);t&&(this.selectedModel.set(t.model),this.temperature.set(t.temperature||.3),e.activeProvider==="ollama"&&t.baseUrl&&this.ollamaUrl.set(t.baseUrl)),this.loadApiKeyStatus(),e.activeProvider==="ollama"&&this.checkOllamaStatus()}loadApiKeyStatus(){return k(this,null,function*(){let e=yield this.settingsService.getApiKey(this.selectedProvider());this.hasApiKey.set(!!e),this.apiKey.set("")})}saveSettings(){return k(this,null,function*(){let e=this.selectedProvider();this.settingsService.setActiveProvider(e);let t={model:this.selectedModel(),temperature:this.temperature()};e==="ollama"&&(t.baseUrl=this.ollamaUrl()),yield this.settingsService.setProviderConfig(e,t),this.apiKey()&&(yield this.settingsService.setApiKey(e,this.apiKey()),this.hasApiKey.set(!0))})}checkOllamaStatus(){return k(this,null,function*(){this.ollamaChecking.set(!0);try{let e=yield fetch(`${this.ollamaUrl()}/api/tags`,{signal:AbortSignal.timeout(5e3)});if(e.ok){this.ollamaRunning.set(!0);let t=yield e.json();if(t.models&&Array.isArray(t.models)){let i=t.models.map(r=>r.name);this.ollamaModels.set(i);let o=this.selectedModel();i.length>0&&!i.includes(o)&&this.selectedModel.set(i[0])}}else this.ollamaRunning.set(!1),this.ollamaModels.set([])}catch{this.ollamaRunning.set(!1),this.ollamaModels.set([])}finally{this.ollamaChecking.set(!1)}})}refreshOllamaModels(){this.checkOllamaStatus()}isRemoteHost(){if(typeof window>"u")return!1;let e=window.location.hostname;return!e.includes("localhost")&&!e.includes("127.0.0.1")}getHostname(){return typeof window<"u"?window.location.hostname:""}getOrigin(){return typeof window<"u"?window.location.origin:""}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ee({type:n,selectors:[["llm-settings-dialog"]],inputs:{isOpen:"isOpen"},outputs:{close:"close",settingsSaved:"settingsSaved"},decls:49,vars:11,consts:[[1,"settings-dialog-overlay",3,"click"],[1,"settings-dialog",3,"click"],[1,"dialog-header"],["title","Close",1,"btn-close",3,"click"],[1,"dialog-body"],[1,"form-section"],[1,"form-label"],[1,"provider-cards"],[1,"provider-card",3,"selected"],[1,"form-select",3,"change","value"],[3,"value"],[1,"form-hint"],[1,"advanced-settings"],["type","range","min","0","max","1","step","0.1",1,"form-range",3,"input","value"],[1,"range-value"],[1,"btn","btn-secondary","btn-test",3,"click","disabled"],[1,"test-result",3,"success","error"],[1,"dialog-footer"],[1,"btn","btn-secondary",3,"click"],[1,"btn","btn-primary",3,"click","disabled"],[1,"provider-card",3,"click"],[1,"provider-name"],[1,"provider-badge"],[1,"required"],[1,"consent-notice"],[1,"consent-options"],[1,"btn-hint"],[1,"btn","btn-primary",3,"click"],[1,"api-key-input"],["type","password","placeholder","Enter your API key",1,"form-input",3,"input","value"],["title","Clear API key",1,"btn-icon"],[1,"link-btn",3,"click"],["title","Clear API key",1,"btn-icon",3,"click"],[1,"cors-warning"],[1,"ollama-status"],[1,"status-checking"],[1,"ollama-not-found"],[1,"warning-icon"],[1,"warning-content"],[1,"install-commands"],[1,"inline-code"],[1,"status-ok"],["title","Refresh model list",1,"btn","btn-sm","btn-refresh",3,"click","disabled"],[1,"status-error"],[1,"install-instructions"],["href","https://ollama.ai/download","target","_blank"],[1,"btn","btn-sm",3,"click","disabled"],["type","text","placeholder","http://localhost:11434",1,"form-input",3,"input","value"],[1,"test-result"]],template:function(t,i){if(t&1&&(c(0,"div",0),_("click",function(r){return i.onOverlayClick(r)}),c(1,"div",1),_("click",function(r){return r.stopPropagation()}),c(2,"div",2)(3,"h2"),d(4,"AI Assistant Settings"),l(),c(5,"button",3),_("click",function(){return i.close.emit()}),d(6,"\xD7"),l()(),c(7,"div",4)(8,"div",5)(9,"label",6),d(10,"AI Provider"),l(),c(11,"div",7),z(12,AE,4,4,"button",8,PE),l()(),x(14,jE,6,2,"div",5),x(15,qE,8,2,"div",5),c(16,"div",5)(17,"label",6),d(18,"Model"),l(),c(19,"select",9),_("change",function(r){return i.onModelChange(r)}),z(20,WE,2,2,"option",10,Ut),l(),c(22,"p",11),x(23,GE,1,0)(24,QE,1,0)(25,YE,1,0)(26,KE,1,0),l()(),c(27,"details",12)(28,"summary"),d(29,"Advanced Settings"),l(),c(30,"div",5)(31,"label",6),d(32,"Temperature"),l(),c(33,"input",13),_("input",function(r){return i.onTemperatureChange(r)}),l(),c(34,"span",14),d(35),l(),c(36,"p",11),d(37," Lower values produce more focused responses. Higher values increase creativity. "),l()(),x(38,ZE,4,1,"div",5),l(),c(39,"div",5)(40,"button",15),_("click",function(){return i.testConnection()}),x(41,JE,1,0)(42,XE,1,0),l(),x(43,nM,3,5,"span",16),l()(),c(44,"div",17)(45,"button",18),_("click",function(){return i.close.emit()}),d(46,"Cancel"),l(),c(47,"button",19),_("click",function(){return i.saveAndClose()}),d(48," Save Settings "),l()()()()),t&2){let o;p(12),$(i.providerOptions),p(2),S(i.requiresApiKey()?14:-1),p(),S(i.selectedProvider()==="ollama"?15:-1),p(4),I("value",i.selectedModel()),p(),$(i.availableModels()),p(3),S((o=i.selectedProvider())==="openai"?23:o==="anthropic"?24:o==="gemini"?25:o==="ollama"?26:-1),p(10),I("value",i.temperature()),p(2),P(i.temperature()),p(3),S(i.selectedProvider()==="ollama"?38:-1),p(2),I("disabled",!i.canTest()||i.testing()),p(),S(i.testing()?41:42),p(2),S(i.testResult()?43:-1),p(4),I("disabled",!i.isConfigValid())}},dependencies:[te,ce,Ue,qe],styles:[".settings-dialog-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000;animation:_ngcontent-%COMP%_fadeIn .15s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.settings-dialog[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 20px 60px #0000004d;width:100%;max-width:520px;max-height:90vh;display:flex;flex-direction:column;animation:_ngcontent-%COMP%_slideUp .2s ease-out}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px 24px;border-bottom:1px solid #e5e7eb}.dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:600}.btn-close[_ngcontent-%COMP%]{background:none;border:none;font-size:24px;cursor:pointer;color:#6b7280;padding:0;line-height:1}.btn-close[_ngcontent-%COMP%]:hover{color:#374151}.dialog-body[_ngcontent-%COMP%]{padding:24px;overflow-y:auto;flex:1}.dialog-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;padding:16px 24px;border-top:1px solid #e5e7eb;background:#f9fafb;border-radius:0 0 12px 12px}.form-section[_ngcontent-%COMP%]{margin-bottom:20px}.form-label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#374151;margin-bottom:8px}.form-label[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:#ef4444}.form-input[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{width:100%;padding:10px 12px;border:1px solid #d1d5db;border-radius:6px;font-size:14px;transition:border-color .15s,box-shadow .15s}.form-input[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.form-input.has-value[_ngcontent-%COMP%]{background:#f0fdf4;border-color:#22c55e}.form-hint[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;margin-top:6px}.provider-cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}.provider-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:16px 12px;border:2px solid #e5e7eb;border-radius:8px;background:#fff;cursor:pointer;transition:all .15s}.provider-card[_ngcontent-%COMP%]:hover{border-color:#d1d5db;background:#f9fafb}.provider-card.selected[_ngcontent-%COMP%]{border-color:#3b82f6;background:#eff6ff}.provider-name[_ngcontent-%COMP%]{font-size:14px;font-weight:500}.provider-badge[_ngcontent-%COMP%]{font-size:10px;color:#059669;background:#d1fae5;padding:2px 6px;border-radius:4px;margin-top:4px}.consent-notice[_ngcontent-%COMP%]{background:#fef3c7;border:1px solid #fcd34d;border-radius:8px;padding:16px}.consent-notice[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 12px;font-size:13px;color:#92400e}.consent-options[_ngcontent-%COMP%]{display:flex;gap:10px}.consent-options[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{flex:1;flex-direction:column;padding:12px}.btn-hint[_ngcontent-%COMP%]{display:block;font-size:11px;font-weight:400;opacity:.8;margin-top:4px}.api-key-input[_ngcontent-%COMP%]{display:flex;gap:8px}.api-key-input[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{flex:1}.btn-icon[_ngcontent-%COMP%]{padding:10px 14px;border:1px solid #d1d5db;border-radius:6px;background:#fff;cursor:pointer;font-size:16px;color:#6b7280}.btn-icon[_ngcontent-%COMP%]:hover{background:#f3f4f6;color:#374151}.link-btn[_ngcontent-%COMP%]{background:none;border:none;color:#3b82f6;cursor:pointer;font-size:12px;padding:0;text-decoration:underline}.link-btn[_ngcontent-%COMP%]:hover{color:#2563eb}.ollama-status[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;gap:10px;padding:12px;border-radius:6px;font-size:13px}.status-checking[_ngcontent-%COMP%]{color:#6b7280}.status-ok[_ngcontent-%COMP%]{color:#059669;background:#d1fae5;padding:8px 12px;border-radius:6px;flex:1}.status-error[_ngcontent-%COMP%]{color:#dc2626;background:#fee2e2;padding:8px 12px;border-radius:6px;flex:1}.status-error[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#dc2626}.btn-sm[_ngcontent-%COMP%]{padding:6px 12px;font-size:12px}.btn-refresh[_ngcontent-%COMP%]{background:#ecfdf5;border-color:#059669;color:#059669}.btn-refresh[_ngcontent-%COMP%]:hover:not(:disabled){background:#d1fae5}.form-range[_ngcontent-%COMP%]{width:calc(100% - 50px);vertical-align:middle}.range-value[_ngcontent-%COMP%]{display:inline-block;width:40px;text-align:right;font-size:13px;color:#6b7280}.advanced-settings[_ngcontent-%COMP%]{margin-top:20px;border:1px solid #e5e7eb;border-radius:8px}.advanced-settings[_ngcontent-%COMP%]   summary[_ngcontent-%COMP%]{padding:12px 16px;cursor:pointer;font-size:14px;font-weight:500;color:#6b7280}.advanced-settings[open][_ngcontent-%COMP%]   summary[_ngcontent-%COMP%]{border-bottom:1px solid #e5e7eb}.advanced-settings[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]{padding:16px;margin-bottom:0}.btn-test[_ngcontent-%COMP%]{margin-right:12px}.test-result[_ngcontent-%COMP%]{font-size:13px}.test-result.success[_ngcontent-%COMP%]{color:#059669}.test-result.error[_ngcontent-%COMP%]{color:#dc2626}.btn[_ngcontent-%COMP%]{padding:10px 20px;border:1px solid #d1d5db;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:all .15s}.btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-primary[_ngcontent-%COMP%]{background:#3b82f6;color:#fff;border-color:#3b82f6}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#2563eb}.btn-secondary[_ngcontent-%COMP%]{background:#fff;color:#374151}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:#f3f4f6}.ollama-not-found[_ngcontent-%COMP%]{background:#fef2f2;border:1px solid #fecaca;border-radius:8px;padding:16px}.ollama-not-found[_ngcontent-%COMP%]   .status-error[_ngcontent-%COMP%]{background:none;padding:0;margin-bottom:12px;flex:none}.install-instructions[_ngcontent-%COMP%]{font-size:13px;color:#374151;margin-bottom:12px}.install-instructions[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 8px}.install-instructions[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]{margin:0;padding-left:20px}.install-instructions[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:10px;line-height:1.5}.install-instructions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#2563eb}.install-commands[_ngcontent-%COMP%]{margin-top:4px}.install-commands[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{display:block;background:#1f2937;color:#e5e7eb;padding:8px 12px;border-radius:4px;font-family:ui-monospace,monospace;font-size:12px;overflow-x:auto}.inline-code[_ngcontent-%COMP%]{display:inline!important;background:#e5e7eb;color:#1f2937;padding:2px 6px;border-radius:3px;font-family:ui-monospace,monospace;font-size:12px}.cors-warning[_ngcontent-%COMP%]{display:flex;gap:12px;background:#fef3c7;border:2px solid #fbbf24;border-radius:8px;padding:16px;margin-bottom:16px}.warning-icon[_ngcontent-%COMP%]{font-size:24px;flex-shrink:0}.warning-content[_ngcontent-%COMP%]{flex:1;font-size:13px;color:#78350f}.warning-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 10px}.warning-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:last-child{margin-bottom:0}.warning-content[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#92400e}.warning-content[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]{margin:8px 0 0;padding-left:20px}.warning-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:8px;line-height:1.5}"],changeDetection:0})};var hl=[{id:"human",name:"Human Samples",description:"Clinical samples, patient tissues, human-derived materials",icon:"person",examples:["Patient biopsies","Blood samples","Tumor tissues"]},{id:"cell-lines",name:"Cell Lines",description:"Cultured cell lines (HeLa, HEK293, etc.)",icon:"science",examples:["HeLa cells","HEK293","MCF-7","A549"]},{id:"vertebrates",name:"Vertebrates (Non-Human)",description:"Mouse, rat, zebrafish, and other vertebrate samples",icon:"pets",examples:["Mouse liver","Rat brain","Zebrafish embryo"]},{id:"ms-proteomics",name:"MS Proteomics",description:"Mass spectrometry-based proteomics experiments",icon:"analytics",examples:["DDA","DIA","PRM","SRM"]}];function _l(n){return n==="human"}function Cl(n){return n==="cell-line"||n==="cell-lines"}function vl(n){return n==="vertebrate"||n==="vertebrates"}var wt=[{id:"lf",name:"Label-free (LFQ)",labels:["label free sample"]},{id:"tmt6",name:"TMT 6-plex",labels:["TMT126","TMT127N","TMT127C","TMT128N","TMT128C","TMT129N"]},{id:"tmt10",name:"TMT 10-plex",labels:["TMT126","TMT127N","TMT127C","TMT128N","TMT128C","TMT129N","TMT129C","TMT130N","TMT130C","TMT131"]},{id:"tmt11",name:"TMT 11-plex",labels:["TMT126","TMT127N","TMT127C","TMT128N","TMT128C","TMT129N","TMT129C","TMT130N","TMT130C","TMT131","TMT131C"]},{id:"tmt16",name:"TMT 16-plex",labels:["TMT126","TMT127N","TMT127C","TMT128N","TMT128C","TMT129N","TMT129C","TMT130N","TMT130C","TMT131","TMT131C","TMT132N","TMT132C","TMT133N","TMT133C","TMT134N"]},{id:"tmt18",name:"TMT 18-plex",labels:["TMT126","TMT127N","TMT127C","TMT128N","TMT128C","TMT129N","TMT129C","TMT130N","TMT130C","TMT131","TMT131C","TMT132N","TMT132C","TMT133N","TMT133C","TMT134N","TMT134C","TMT135N"]},{id:"itraq4",name:"iTRAQ 4-plex",labels:["iTRAQ4plex-114","iTRAQ4plex-115","iTRAQ4plex-116","iTRAQ4plex-117"]},{id:"itraq8",name:"iTRAQ 8-plex",labels:["iTRAQ8plex-113","iTRAQ8plex-114","iTRAQ8plex-115","iTRAQ8plex-116","iTRAQ8plex-117","iTRAQ8plex-118","iTRAQ8plex-119","iTRAQ8plex-121"]},{id:"silac",name:"SILAC",labels:["SILAC light","SILAC medium","SILAC heavy"]}],vp=[{name:"Carbamidomethyl",targetAminoAcids:"C",type:"fixed",unimodAccession:"UNIMOD:4"},{name:"Oxidation",targetAminoAcids:"M",type:"variable",unimodAccession:"UNIMOD:35"},{name:"Acetyl",targetAminoAcids:"Protein N-term",type:"variable",unimodAccession:"UNIMOD:1"},{name:"Phospho",targetAminoAcids:"S,T,Y",type:"variable",unimodAccession:"UNIMOD:21"},{name:"Deamidated",targetAminoAcids:"N,Q",type:"variable",unimodAccession:"UNIMOD:7"},{name:"TMT6plex",targetAminoAcids:"K,Peptide N-term",type:"fixed",unimodAccession:"UNIMOD:737"}],N0=[{name:"Trypsin",msAccession:"MS:1001251"},{name:"Trypsin/P",msAccession:"MS:1001313"},{name:"Lys-C",msAccession:"MS:1001309"},{name:"Chymotrypsin",msAccession:"MS:1001306"},{name:"Asp-N",msAccession:"MS:1001304"},{name:"Glu-C",msAccession:"MS:1001917"},{name:"Arg-C",msAccession:"MS:1001303"},{name:"No cleavage",msAccession:"MS:1001955"}];function yl(n){return{index:n,sourceName:`sample_${n}`,biologicalReplicate:1}}function yp(){return{template:null,sampleCount:1,experimentDescription:"",organism:null,disease:null,organismPart:null,defaultSex:null,defaultAge:"",defaultCellLine:"",strainBreed:"",developmentalStage:"",dynamicColumnDefaults:[],samples:[yl(1)],labelConfigId:"lf",customLabels:[],hasFractions:!1,fractionCount:1,technicalReplicates:1,acquisitionMethod:"dda",instrument:null,cleavageAgent:null,modifications:[],fileNamingPattern:"{sourceName}.raw",dataFiles:[]}}var bl=[{id:"setup",title:"Experiment Setup",description:"Select template and number of samples",isRequired:!0},{id:"characteristics",title:"Sample Characteristics",description:"Define organism, disease, and tissue",isRequired:!0},{id:"samples",title:"Sample Values",description:"Enter sample-specific information",isRequired:!0},{id:"technical",title:"Technical Config",description:"Labels, fractions, and replicates",isRequired:!0},{id:"protocol",title:"Instrument & Protocol",description:"Instrument, enzyme, and modifications",isRequired:!0},{id:"files",title:"Data Files",description:"Map raw files to samples",isRequired:!0},{id:"review",title:"Review & Create",description:"Preview and generate SDRF",isRequired:!0}];var at=class n{_state=w(yp());_currentStep=w(0);state=this._state.asReadonly();currentStep=this._currentStep.asReadonly();totalSteps=bl.length;steps=bl;currentStepConfig=A(()=>bl[this._currentStep()]);template=A(()=>this._state().template);sampleCount=A(()=>this._state().sampleCount);samples=A(()=>this._state().samples);labelConfig=A(()=>{let e=this._state().labelConfigId;return wt.find(t=>t.id===e)||wt[0]});hasFractions=A(()=>this._state().hasFractions);fractionCount=A(()=>this._state().fractionCount);technicalReplicates=A(()=>this._state().technicalReplicates);dataFiles=A(()=>this._state().dataFiles);modifications=A(()=>this._state().modifications);isStep1Valid=A(()=>{let e=this._state();return e.template!==null&&e.sampleCount>=1});isStep2Valid=A(()=>{let e=this._state();return e.organism!==null&&e.disease!==null&&e.organismPart!==null});isStep3Valid=A(()=>{let e=this._state();return e.samples.length>0&&e.samples.every(t=>t.sourceName.trim().length>0)});isStep4Valid=A(()=>{let e=this._state();return e.labelConfigId!==""||e.customLabels.length>0});isStep5Valid=A(()=>{let e=this._state();return e.instrument!==null&&e.cleavageAgent!==null});isStep6Valid=A(()=>this._state().dataFiles.length>0);isAllValid=A(()=>this.isStep1Valid()&&this.isStep2Valid()&&this.isStep3Valid()&&this.isStep4Valid()&&this.isStep5Valid()&&this.isStep6Valid());isCurrentStepValid=A(()=>{switch(this._currentStep()){case 0:return this.isStep1Valid();case 1:return this.isStep2Valid();case 2:return this.isStep3Valid();case 3:return this.isStep4Valid();case 4:return this.isStep5Valid();case 5:return this.isStep6Valid();case 6:return this.isAllValid();default:return!1}});canProceed=A(()=>this.isCurrentStepValid()&&this._currentStep()<this.totalSteps-1);canGoBack=A(()=>this._currentStep()>0);canCreate=A(()=>this._currentStep()===this.totalSteps-1&&this.isAllValid());progressPercent=A(()=>Math.round((this._currentStep()+1)/this.totalSteps*100));nextStep(){this.canProceed()&&this._currentStep.update(e=>e+1)}previousStep(){this.canGoBack()&&this._currentStep.update(e=>e-1)}goToStep(e){e>=0&&e<this.totalSteps&&this._currentStep.set(e)}setTemplate(e){this._state.update(t=>O(E({},t),{template:e}))}setSampleCount(e){let t=Math.max(1,Math.floor(e));this._state.update(i=>{let o=[...i.samples];for(;o.length<t;)o.push(yl(o.length+1));for(;o.length>t;)o.pop();return O(E({},i),{sampleCount:t,samples:o})})}setExperimentDescription(e){this._state.update(t=>O(E({},t),{experimentDescription:e}))}setOrganism(e){this._state.update(t=>O(E({},t),{organism:e}))}setDisease(e){this._state.update(t=>O(E({},t),{disease:e}))}setOrganismPart(e){this._state.update(t=>O(E({},t),{organismPart:e}))}setDefaultSex(e){this._state.update(t=>O(E({},t),{defaultSex:e}))}setDefaultAge(e){this._state.update(t=>O(E({},t),{defaultAge:e}))}setDefaultCellLine(e){this._state.update(t=>O(E({},t),{defaultCellLine:e}))}setStrainBreed(e){this._state.update(t=>O(E({},t),{strainBreed:e}))}setDevelopmentalStage(e){this._state.update(t=>O(E({},t),{developmentalStage:e}))}setColumnDefault(e,t,i){this._state.update(o=>{let r=[...o.dynamicColumnDefaults],s=r.findIndex(a=>a.columnName===e);return s>=0?r[s]={columnName:e,value:t,ontologyTerm:i}:r.push({columnName:e,value:t,ontologyTerm:i}),O(E({},o),{dynamicColumnDefaults:r})})}getColumnDefault(e){return this._state().dynamicColumnDefaults.find(t=>t.columnName===e)}removeColumnDefault(e){this._state.update(t=>O(E({},t),{dynamicColumnDefaults:t.dynamicColumnDefaults.filter(i=>i.columnName!==e)}))}clearColumnDefaults(){this._state.update(e=>O(E({},e),{dynamicColumnDefaults:[]}))}isHumanTemplate=A(()=>_l(this._state().template));isCellLineTemplate=A(()=>Cl(this._state().template));isVertebrateTemplate=A(()=>vl(this._state().template));updateSample(e,t){this._state.update(i=>{let o=[...i.samples];return e>=0&&e<o.length&&(o[e]=E(E({},o[e]),t)),O(E({},i),{samples:o})})}setSamples(e){this._state.update(t=>O(E({},t),{samples:e}))}autoGenerateSourceNames(e="sample_{n}"){this._state.update(t=>{let i=t.samples.map((o,r)=>O(E({},o),{sourceName:e.replace("{n}",String(r+1))}));return O(E({},t),{samples:i})})}copyToAllSamples(e){this._state.update(t=>{if(t.samples.length===0)return t;let i=t.samples[0][e],o=t.samples.map(r=>O(E({},r),{[e]:i}));return O(E({},t),{samples:o})})}setLabelConfig(e){this._state.update(t=>O(E({},t),{labelConfigId:e}))}setCustomLabels(e){this._state.update(t=>O(E({},t),{customLabels:e}))}setHasFractions(e){this._state.update(t=>O(E({},t),{hasFractions:e,fractionCount:e?Math.max(1,t.fractionCount):1}))}setFractionCount(e){this._state.update(t=>O(E({},t),{fractionCount:Math.max(1,Math.floor(e))}))}setTechnicalReplicates(e){this._state.update(t=>O(E({},t),{technicalReplicates:Math.max(1,Math.floor(e))}))}setAcquisitionMethod(e){this._state.update(t=>O(E({},t),{acquisitionMethod:e}))}setInstrument(e){this._state.update(t=>O(E({},t),{instrument:e}))}setCleavageAgent(e){this._state.update(t=>O(E({},t),{cleavageAgent:e}))}addModification(e){this._state.update(t=>O(E({},t),{modifications:[...t.modifications,e]}))}removeModification(e){this._state.update(t=>O(E({},t),{modifications:t.modifications.filter((i,o)=>o!==e)}))}setModifications(e){this._state.update(t=>O(E({},t),{modifications:e}))}setFileNamingPattern(e){this._state.update(t=>O(E({},t),{fileNamingPattern:e}))}setDataFiles(e){this._state.update(t=>O(E({},t),{dataFiles:e}))}autoGenerateDataFiles(){let e=this._state(),t=[],i=e.fileNamingPattern||"{sourceName}.raw",o=wt.find(s=>s.id===e.labelConfigId),r=e.customLabels.length>0?e.customLabels:o?.labels||["label free sample"];for(let s of e.samples)for(let a=1;a<=(e.hasFractions?e.fractionCount:1);a++)for(let u=1;u<=e.technicalReplicates;u++)if(o?.id==="lf"){let f=i.replace("{sourceName}",s.sourceName).replace("{fraction}",`F${a}`).replace("{replicate}",`R${u}`).replace("{n}",String(s.index));t.push({fileName:f,sampleIndex:s.index,fractionId:e.hasFractions?a:void 0,technicalReplicate:e.technicalReplicates>1?u:void 0,label:"label free sample"})}else for(let f of r){let g=i.replace("{sourceName}",s.sourceName).replace("{fraction}",`F${a}`).replace("{replicate}",`R${u}`).replace("{label}",f).replace("{n}",String(s.index));t.push({fileName:g,sampleIndex:s.index,fractionId:e.hasFractions?a:void 0,technicalReplicate:e.technicalReplicates>1?u:void 0,label:f})}this._state.update(s=>O(E({},s),{dataFiles:t}))}reset(){this._state.set(yp()),this._currentStep.set(0)}ensureSamplesInitialized(){this._state.update(e=>{if(e.samples.length>=e.sampleCount)return e;let t=[...e.samples];for(;t.length<e.sampleCount;)t.push(yl(t.length+1));return O(E({},e),{samples:t})})}getState(){return this._state()}static \u0275fac=function(t){return new(t||n)};static \u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})};var Ao=class n{generate(e){let t=Qa(this.calculateRowCount(e)),i=0;t.columns.push(this.createSourceNameColumn(e,i++)),t.columns.push(this.createOrganismColumn(e,i++)),t.columns.push(this.createDiseaseColumn(e,i++)),t.columns.push(this.createOrganismPartColumn(e,i++)),_l(e.template)&&((e.defaultSex||e.samples.some(o=>o.sex))&&t.columns.push(this.createSexColumn(e,i++)),(e.defaultAge||e.samples.some(o=>o.age))&&t.columns.push(this.createAgeColumn(e,i++))),Cl(e.template)&&(e.defaultCellLine||e.samples.some(o=>o.cellLine))&&t.columns.push(this.createCellLineColumn(e,i++)),vl(e.template)&&(e.strainBreed&&t.columns.push(this.createStrainBreedColumn(e,i++)),e.developmentalStage&&t.columns.push(this.createDevelopmentalStageColumn(e,i++)));for(let o of e.dynamicColumnDefaults)["organism","disease","organism part","sex","age","cell line","strain","developmental stage"].some(s=>o.columnName.includes(s))||t.columns.push(this.createDynamicColumn(o,i++));t.columns.push(this.createBiologicalReplicateColumn(e,i++)),t.columns.push(this.createAssayNameColumn(e,i++)),t.columns.push(this.createTechnologyTypeColumn(i++)),t.columns.push(this.createFractionColumn(e,i++)),t.columns.push(this.createLabelColumn(e,i++)),t.columns.push(this.createDataAcquisitionMethodColumn(e,i++)),e.technicalReplicates>1&&t.columns.push(this.createTechnicalReplicateColumn(e,i++)),t.columns.push(this.createInstrumentColumn(e,i++)),t.columns.push(this.createCleavageAgentColumn(e,i++));for(let o of e.modifications)t.columns.push(this.createModificationColumn(o,i++));return t.columns.push(this.createDataFileColumn(e,i++)),t}calculateRowCount(e){let t=wt.find(o=>o.id===e.labelConfigId);if(t&&t.id!=="lf"){let o=e.hasFractions?e.fractionCount:1,r=e.technicalReplicates;return e.samples.length*o*r}else{let o=e.hasFractions?e.fractionCount:1,r=e.technicalReplicates;return e.samples.length*o*r}}createSourceNameColumn(e,t){let i=[],o=1;for(let r of e.samples){let s=e.hasFractions?e.fractionCount:1,a=e.technicalReplicates,u=s*a;u===1?i.push({samples:String(o),value:r.sourceName}):i.push({samples:`${o}-${o+u-1}`,value:r.sourceName}),o+=u}return{name:"source name",type:"source_name",value:e.samples[0]?.sourceName||"",modifiers:i,columnPosition:t,isRequired:!0}}createOrganismColumn(e,t){return{name:"characteristics[organism]",type:"characteristics",value:e.organism?e.organism.label.toLowerCase():"not available",modifiers:[],columnPosition:t,isRequired:!0,ontologyType:"ncbitaxon"}}createDiseaseColumn(e,t){let i="not available";e.disease==="normal"||e.disease===null?i=e.disease==="normal"?"normal":"not available":typeof e.disease=="object"&&(i=e.disease.label.toLowerCase());let o=[],r=1;for(let s of e.samples){let a=e.hasFractions?e.fractionCount:1,u=e.technicalReplicates,f=a*u;if(s.disease&&s.disease!==e.disease){let g=typeof s.disease=="string"?s.disease:s.disease.label.toLowerCase();o.push({samples:f===1?String(r):`${r}-${r+f-1}`,value:g})}r+=f}return{name:"characteristics[disease]",type:"characteristics",value:i,modifiers:o,columnPosition:t,isRequired:!0,ontologyType:"mondo"}}createOrganismPartColumn(e,t){return{name:"characteristics[organism part]",type:"characteristics",value:e.organismPart?e.organismPart.label.toLowerCase():"not available",modifiers:[],columnPosition:t,isRequired:!0,ontologyType:"uberon"}}createSexColumn(e,t){let i=e.defaultSex||"not available",o=[],r=1;for(let s of e.samples){let a=e.hasFractions?e.fractionCount:1,u=e.technicalReplicates,f=a*u;s.sex&&s.sex!==e.defaultSex&&o.push({samples:f===1?String(r):`${r}-${r+f-1}`,value:s.sex}),r+=f}return{name:"characteristics[sex]",type:"characteristics",value:i,modifiers:o,columnPosition:t}}createAgeColumn(e,t){let i=e.defaultAge||"not available",o=[],r=1;for(let s of e.samples){let a=e.hasFractions?e.fractionCount:1,u=e.technicalReplicates,f=a*u;s.age&&s.age!==e.defaultAge&&o.push({samples:f===1?String(r):`${r}-${r+f-1}`,value:s.age}),r+=f}return{name:"characteristics[age]",type:"characteristics",value:i,modifiers:o,columnPosition:t}}createCellLineColumn(e,t){let i=e.defaultCellLine||"not applicable",o=[],r=1;for(let s of e.samples){let a=e.hasFractions?e.fractionCount:1,u=e.technicalReplicates,f=a*u;s.cellLine&&s.cellLine!==e.defaultCellLine&&o.push({samples:f===1?String(r):`${r}-${r+f-1}`,value:s.cellLine}),r+=f}return{name:"characteristics[cell line]",type:"characteristics",value:i,modifiers:o,columnPosition:t}}createStrainBreedColumn(e,t){return{name:"characteristics[strain/breed]",type:"characteristics",value:e.strainBreed||"not available",modifiers:[],columnPosition:t}}createDevelopmentalStageColumn(e,t){return{name:"characteristics[developmental stage]",type:"characteristics",value:e.developmentalStage||"not available",modifiers:[],columnPosition:t}}createBiologicalReplicateColumn(e,t){let i=[],o=1;for(let r of e.samples){let s=e.hasFractions?e.fractionCount:1,a=e.technicalReplicates,u=s*a;i.push({samples:u===1?String(o):`${o}-${o+u-1}`,value:String(r.biologicalReplicate)}),o+=u}return{name:"characteristics[biological replicate]",type:"characteristics",value:"1",modifiers:i,columnPosition:t}}createAssayNameColumn(e,t){let i=[],o=1;for(let r of e.samples){let s=e.hasFractions?e.fractionCount:1,a=e.technicalReplicates;for(let u=1;u<=s;u++)for(let f=1;f<=a;f++){let g=r.sourceName;s>1&&(g+=`_F${u}`),a>1&&(g+=`_R${f}`),i.push({samples:String(o),value:g}),o++}}return{name:"assay name",type:"special",value:i[0]?.value||"",modifiers:i,columnPosition:t,isRequired:!0}}createTechnologyTypeColumn(e){return{name:"technology type",type:"special",value:"proteomic profiling by mass spectrometry",modifiers:[],columnPosition:e,isRequired:!0}}createDataAcquisitionMethodColumn(e,t){let i=e.acquisitionMethod||"dda",o;return i==="dia"?o="NT=Data-independent acquisition;AC=PRIDE:0000450":o="NT=Data-dependent acquisition;AC=PRIDE:0000627",{name:"comment[proteomics data acquisition method]",type:"comment",value:o,modifiers:[],columnPosition:t,isRequired:!0}}createFractionColumn(e,t){if(!e.hasFractions||e.fractionCount<=1)return{name:"comment[fraction identifier]",type:"comment",value:"1",modifiers:[],columnPosition:t,isRequired:!0};let i=[],o=1;for(let r of e.samples)for(let s=1;s<=e.fractionCount;s++)for(let a=1;a<=e.technicalReplicates;a++)i.push({samples:String(o),value:String(s)}),o++;return{name:"comment[fraction identifier]",type:"comment",value:"1",modifiers:i,columnPosition:t,isRequired:!0}}createLabelColumn(e,t){let i=wt.find(a=>a.id===e.labelConfigId),o=e.customLabels.length>0?e.customLabels:i?.labels||["label free sample"];if(i?.id==="lf"||o.length===1)return{name:"comment[label]",type:"comment",value:o[0],modifiers:[],columnPosition:t,isRequired:!0};let r=[],s=1;for(let a=0;a<e.samples.length;a++){let u=o[a%o.length],f=e.hasFractions?e.fractionCount:1,g=e.technicalReplicates,h=f*g;r.push({samples:h===1?String(s):`${s}-${s+h-1}`,value:u}),s+=h}return{name:"comment[label]",type:"comment",value:o[0],modifiers:r,columnPosition:t,isRequired:!0}}createTechnicalReplicateColumn(e,t){let i=[],o=1;for(let r of e.samples){let s=e.hasFractions?e.fractionCount:1;for(let a=1;a<=s;a++)for(let u=1;u<=e.technicalReplicates;u++)i.push({samples:String(o),value:String(u)}),o++}return{name:"comment[technical replicate]",type:"comment",value:"1",modifiers:i,columnPosition:t}}createInstrumentColumn(e,t){return{name:"comment[instrument]",type:"comment",value:e.instrument?e.instrument.label:"not available",modifiers:[],columnPosition:t,isRequired:!0,ontologyType:"ms"}}createCleavageAgentColumn(e,t){let i="not available";return e.cleavageAgent&&(i=`NT=${e.cleavageAgent.name};AC=${e.cleavageAgent.msAccession}`),{name:"comment[cleavage agent details]",type:"comment",value:i,modifiers:[],columnPosition:t,isRequired:!0}}createModificationColumn(e,t){let i=[`NT=${e.name}`,`MT=${e.type}`,`TA=${e.targetAminoAcids}`];return e.unimodAccession&&i.push(`AC=${e.unimodAccession}`),{name:"comment[modification parameters]",type:"comment",value:i.join(";"),modifiers:[],columnPosition:t,isRequired:!0}}createDataFileColumn(e,t){let i=[];if(e.dataFiles.length>0)for(let o=0;o<e.dataFiles.length;o++)i.push({samples:String(o+1),value:e.dataFiles[o].fileName});else{let o=1;for(let r of e.samples){let s=e.hasFractions?e.fractionCount:1,a=e.technicalReplicates;for(let u=1;u<=s;u++)for(let f=1;f<=a;f++){let g=e.fileNamingPattern.replace("{sourceName}",r.sourceName).replace("{fraction}",`F${u}`).replace("{replicate}",`R${f}`).replace("{n}",String(r.index));i.push({samples:String(o),value:g}),o++}}}return{name:"comment[data file]",type:"comment",value:i[0]?.value||"data.raw",modifiers:i,columnPosition:t,isRequired:!0}}createDynamicColumn(e,t){let i="comment";return e.columnName.startsWith("characteristics[")?i="characteristics":e.columnName.startsWith("factor value[")&&(i="factor_value"),{name:e.columnName,type:i,value:e.value,modifiers:[],columnPosition:t}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})};function k0(n){return{name:n.name,description:n.description,version:n.version,extends:n.extends||null,usableAlone:n.usable_alone??!1,layer:n.layer||null,mutuallyExclusiveWith:n.mutually_exclusive_with,status:n.status,validators:n.validators?.map(e=>R0(e)),columns:n.columns?.map(e=>iM(e))||[]}}function iM(n){return{name:n.name,description:n.description,requirement:n.requirement,allowNotApplicable:n.allow_not_applicable,allowNotAvailable:n.allow_not_available,allowAnonymized:n.allow_anonymized,allowPooled:n.allow_pooled,cardinality:n.cardinality,type:n.type,validators:n.validators?.map(e=>R0(e))}}function R0(n){return{validatorName:n.validator_name,params:{ontologies:n.params?.ontologies,pattern:n.params?.pattern,values:n.params?.values,errorLevel:n.params?.error_level,description:n.params?.description,examples:n.params?.examples,caseSensitive:n.params?.case_sensitive,minColumns:n.params?.min_columns,columnName:n.params?.column_name,columnNameWarning:n.params?.column_name_warning}}}function bp(n){return{human:"person","cell-lines":"science",vertebrates:"pets",invertebrates:"bug_report",plants:"eco","ms-proteomics":"analytics","affinity-proteomics":"biotech","dda-acquisition":"scatter_plot","dia-acquisition":"assessment","single-cell":"grain",crosslinking:"link",immunopeptidomics:"vaccines",metaproteomics:"diversity_3",olink:"hub",somascan:"developer_board"}[n]||"category"}function xp(n){return{human:"Human Samples","cell-lines":"Cell Lines",vertebrates:"Vertebrates (Non-Human)",invertebrates:"Invertebrates",plants:"Plants","ms-proteomics":"MS Proteomics","affinity-proteomics":"Affinity Proteomics","dda-acquisition":"DDA Acquisition","dia-acquisition":"DIA Acquisition","single-cell":"Single Cell",crosslinking:"Crosslinking (XL-MS)",immunopeptidomics:"Immunopeptidomics",metaproteomics:"Metaproteomics",olink:"Olink",somascan:"SomaScan"}[n]||n.replace(/-/g," ").replace(/\b\w/g,t=>t.toUpperCase())}function F0(n){let e=n.split(`
`),t={},i=[{obj:t,indent:-1}],o=null,r=null,s=0;for(let a=0;a<e.length;a++){let u=e[a],f=u.trim();if(f.startsWith("#")||f==="")continue;let g=u.search(/\S/);if(f.startsWith("- ")){let h=f.substring(2).trim();if(o===null||g<=s){let b=i[i.length-1].obj;r&&(o=b[r]||[],b[r]=o),s=g}if(h.includes(":")){let b={},[C,...T]=h.split(":"),F=T.join(":").trim();F&&(b[C.trim()]=Li(F));let U=a+1,K=g+2;for(;U<e.length;){let We=e[U],Et=We.trim();if(Et===""||Et.startsWith("#")){U++;continue}let Re=We.search(/\S/);if(Re<=g||Et.startsWith("- "))break;if(Et.includes(":")){let[Ce,...M]=Et.split(":"),D=M.join(":").trim(),R=Ce.trim();D===""||D==="|"||D===">"?b[R]=oM(e,U+1,Re+2):D.startsWith("[")&&D.endsWith("]")?b[R]=D.slice(1,-1).split(",").map(H=>Li(H.trim())):b[R]=Li(D)}U++}a=U-1,o&&o.push(b)}else o&&o.push(Li(h));continue}if(f.includes(":")){let h=f.indexOf(":"),b=f.substring(0,h).trim(),C=f.substring(h+1).trim();for(;i.length>1&&g<=i[i.length-1].indent;)i.pop();let T=i[i.length-1].obj;if(C===""||C==="|"||C===">"){let F=C===""?{}:"";T[b]=F,typeof F=="object"&&(i.push({obj:F,indent:g,key:b}),r=b,o=null)}else C.startsWith("[")&&C.endsWith("]")?(T[b]=C.slice(1,-1).split(",").map(F=>Li(F.trim())),o=null,r=null):(T[b]=Li(C),o=null,r=null)}}return t}function oM(n,e,t){let i={};for(let o=e;o<n.length;o++){let r=n[o],s=r.trim();if(s===""||s.startsWith("#"))continue;if(r.search(/\S/)<t)break;if(s.includes(":")){let[u,...f]=s.split(":"),g=f.join(":").trim();i[u.trim()]=Li(g)}}return i}function Li(n){return n===""||n==="null"?null:n==="true"?!0:n==="false"?!1:/^-?\d+$/.test(n)?parseInt(n,10):/^-?\d+\.\d+$/.test(n)?parseFloat(n):n.startsWith("'")&&n.endsWith("'")||n.startsWith('"')&&n.endsWith('"')?n.slice(1,-1):n}var V0="https://raw.githubusercontent.com/bigbio/sdrf-templates/main";var rM=300*1e3,No=class n{_templates=w(new Map);_resolvedCache=w(new Map);_isLoading=w(!1);_error=w(null);_manifest=w(null);_lastFetchTime=w(0);templates=this._templates.asReadonly();isLoading=this._isLoading.asReadonly();error=this._error.asReadonly();allTemplates=A(()=>Array.from(this._templates().values()));usableTemplates=A(()=>this.allTemplates().filter(e=>e.usableAlone));sampleTemplates=A(()=>this.allTemplates().filter(e=>e.layer==="sample"));technologyTemplates=A(()=>this.allTemplates().filter(e=>e.layer==="technology"));experimentTemplates=A(()=>this.allTemplates().filter(e=>e.layer==="experiment"));fetchTemplates(){return k(this,null,function*(){let e=Date.now();if(!(e-this._lastFetchTime()<rM&&this._templates().size>0)){this._isLoading.set(!0),this._error.set(null);try{let t=yield this.fetchManifest();this._manifest.set(t);let i=new Map,o=Object.keys(t.templates),r=5;for(let s=0;s<o.length;s+=r){let a=o.slice(s,s+r),u=yield Promise.allSettled(a.map(f=>this.fetchTemplateDefinition(f,t.templates[f].latest)));for(let f=0;f<u.length;f++){let g=u[f];g.status==="fulfilled"&&g.value?i.set(a[f],g.value):g.status==="rejected"&&console.warn(`Failed to fetch template ${a[f]}:`,g.reason)}}this._templates.set(i),this._lastFetchTime.set(e)}catch(t){let i=t instanceof Error?t.message:String(t);this._error.set(i),console.error("Failed to fetch templates:",t),this._templates().size===0&&(yield this.loadFallbackTemplates())}finally{this._isLoading.set(!1)}}})}fetchManifest(){return k(this,null,function*(){let e=yield fetch(`${V0}/templates.yaml`);if(!e.ok)throw new Error(`Failed to fetch manifest: ${e.status}`);let t=yield e.text(),i=F0(t);return{schemaVersion:i.schema_version||"1.0",generatedAt:i.generated_at||new Date().toISOString(),templates:this.convertManifestTemplates(i.templates||{})}})}convertManifestTemplates(e){let t={};for(let[i,o]of Object.entries(e))t[i]={latest:o.latest||"1.0.0",versions:o.versions||[o.latest||"1.0.0"],extends:o.extends||null,usableAlone:o.usable_alone??!1,layer:o.layer||null,status:o.status||"stable",description:o.description||""};return t}fetchTemplateDefinition(e,t){return k(this,null,function*(){try{let i=`${V0}/${e}/${t}/${e}.yaml`,o=yield fetch(i);if(!o.ok)throw new Error(`HTTP ${o.status}`);let r=yield o.text(),s=F0(r);return k0(s)}catch(i){return console.warn(`Failed to fetch template ${e}@${t}:`,i),null}})}loadFallbackTemplates(){return k(this,null,function*(){let e=[{name:"human",description:"Human Samples",version:"1.0.0",extends:null,usableAlone:!0,layer:"sample",columns:this.getBaseColumns()},{name:"cell-lines",description:"Cell Lines",version:"1.0.0",extends:null,usableAlone:!0,layer:"sample",columns:this.getBaseColumns()},{name:"vertebrates",description:"Vertebrates (Non-Human)",version:"1.0.0",extends:null,usableAlone:!0,layer:"sample",columns:this.getBaseColumns()},{name:"ms-proteomics",description:"MS Proteomics",version:"1.0.0",extends:null,usableAlone:!0,layer:"technology",columns:this.getMsProteomicsColumns()}],t=new Map;for(let i of e)t.set(i.name,i);this._templates.set(t)})}getBaseColumns(){return[{name:"source name",description:"Unique sample identifier",requirement:"required"},{name:"characteristics[organism]",description:"Species",requirement:"required",validators:[{validatorName:"ontology",params:{ontologies:["ncbitaxon"]}}]},{name:"characteristics[organism part]",description:"Anatomical part",requirement:"required",validators:[{validatorName:"ontology",params:{ontologies:["uberon","bto"]}}]},{name:"characteristics[disease]",description:"Disease state",requirement:"required",validators:[{validatorName:"ontology",params:{ontologies:["mondo","efo","doid"]}}]},{name:"characteristics[biological replicate]",description:"Biological replicate number",requirement:"required"}]}getMsProteomicsColumns(){return[...this.getBaseColumns(),{name:"assay name",description:"Unique assay identifier",requirement:"required"},{name:"technology type",description:"Technology used",requirement:"required"},{name:"comment[instrument]",description:"Instrument used",requirement:"required",validators:[{validatorName:"ontology",params:{ontologies:["ms"]}}]},{name:"comment[label]",description:"Labeling strategy",requirement:"required"},{name:"comment[fraction identifier]",description:"Fraction number",requirement:"required"},{name:"comment[cleavage agent details]",description:"Enzyme used",requirement:"required"},{name:"comment[modification parameters]",description:"PTMs searched",requirement:"recommended",cardinality:"multiple"},{name:"comment[proteomics data acquisition method]",description:"Acquisition method",requirement:"required"},{name:"comment[data file]",description:"Data file name",requirement:"required"}]}getResolvedTemplate(e){return k(this,null,function*(){let t=this._resolvedCache().get(e);if(t)return t;this._templates().size===0&&(yield this.fetchTemplates());let i=this._templates().get(e);if(!i)throw new Error(`Template not found: ${e}`);let o=yield this.resolveInheritance(i);return this._resolvedCache.update(r=>{let s=new Map(r);return s.set(e,o),s}),o})}resolveInheritance(e){return k(this,null,function*(){let t=[],i=[...e.columns],o=[...e.validators||[]],r=e;for(;r.extends;){let s=r.extends;t.unshift(s);let a=this._templates().get(s);if(!a){console.warn(`Parent template not found: ${s}`);break}i=this.mergeColumns(a.columns,i),o=[...a.validators||[],...o],r=a}return O(E({},e),{resolvedColumns:i,parentChain:t,resolvedValidators:o})})}mergeColumns(e,t){let i=new Map;for(let o of e)i.set(o.name,E({},o));for(let o of t){let r=i.get(o.name);r?i.set(o.name,this.mergeColumn(r,o)):i.set(o.name,E({},o))}return Array.from(i.values())}mergeColumn(e,t){let i=["required","recommended","optional"],o=i.indexOf(e.requirement),s=i.indexOf(t.requirement)<=o?t.requirement:e.requirement,a=[...e.validators||[],...(t.validators||[]).filter(u=>!(e.validators||[]).some(f=>f.validatorName===u.validatorName))];return O(E(E({},e),t),{requirement:s,allowNotApplicable:e.allowNotApplicable===!1?!1:t.allowNotApplicable,allowNotAvailable:e.allowNotAvailable===!1?!1:t.allowNotAvailable,validators:a.length>0?a:void 0})}getTemplateInfoList(e){let t=this.allTemplates();return(e?t.filter(o=>e.includes(o.name)):t).map(o=>({id:o.name,name:xp(o.name),description:o.description,layer:o.layer,usableAlone:o.usableAlone,extends:o.extends,icon:bp(o.name),status:o.status}))}getTemplateInfo(e){let t=this._templates().get(e);return t?{id:t.name,name:xp(t.name),description:t.description,layer:t.layer,usableAlone:t.usableAlone,extends:t.extends,icon:bp(t.name),status:t.status}:null}getCompatibleTemplates(e){let t=this._templates().get(e);if(!t)return[];let i=this.getTemplateInfoList(),o=t.mutuallyExclusiveWith||[];return i.filter(r=>r.id===e||o.includes(r.id)?!1:t.layer==="sample"&&r.layer==="technology"||t.layer==="technology"&&r.layer==="sample"||t.layer==="experiment"&&(r.layer==="sample"||r.layer==="technology")||(t.layer==="sample"||t.layer==="technology")&&r.layer==="experiment")}clearCache(){this._resolvedCache.set(new Map),this._lastFetchTime.set(0)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})};var sM=(n,e)=>e.id;function aM(n,e){n&1&&(c(0,"div",17),d(1,"\u2713"),l())}function lM(n,e){if(n&1){let t=N();c(0,"button",12),_("click",function(){let o=v(t).$implicit,r=m();return y(r.selectTemplate(o.id))}),c(1,"div",13),d(2),l(),c(3,"div",14)(4,"h4"),d(5),l(),c(6,"p"),d(7),l(),c(8,"div",15)(9,"span",16),d(10,"Examples:"),l(),d(11),l()(),x(12,aM,2,0,"div",17),l()}if(n&2){let t=e.$implicit,i=m();B("selected",i.wizardState.template()===t.id),p(2),P(i.getIcon(t.id)),p(3),P(t.name),p(2),P(t.description),p(4),j(" ",t.examples.join(", ")," "),p(),S(i.wizardState.template()===t.id?12:-1)}}function cM(n,e){if(n&1){let t=N();c(0,"div",5)(1,"label",6),d(2," Describe your experiment "),c(3,"span",18),d(4,"Optional - helps AI suggestions"),l()(),c(5,"textarea",19),_("ngModelChange",function(o){v(t);let r=m();return y(r.setDescription(o))}),l()()}if(n&2){let t=m();p(5),I("ngModel",t.state().experimentDescription)}}function dM(n,e){n&1&&(c(0,"div",11)(1,"span",20),d(2,"!"),l(),d(3," Please select a template and specify the number of samples to continue. "),l())}var xl=class n{aiEnabled=!1;availableTemplates=["human","cell-lines","vertebrates","ms-proteomics"];wizardState=q(at);templateService=q(No);staticTemplates=hl;state=this.wizardState.state;templates=A(()=>{let e=this.templateService.getTemplateInfoList(this.availableTemplates);return e.length>0?e.map(t=>({id:t.id,name:t.name,description:t.description,icon:t.icon||"category",examples:[]})):this.staticTemplates.filter(t=>this.availableTemplates.includes(t.id)||this.availableTemplates.includes(t.id.replace("-","-")))});isLoading=this.templateService.isLoading;selectTemplate(e){this.wizardState.setTemplate(e)}setSampleCount(e){this.wizardState.setSampleCount(e)}incrementSamples(){this.wizardState.setSampleCount(this.wizardState.sampleCount()+1)}decrementSamples(){this.wizardState.setSampleCount(this.wizardState.sampleCount()-1)}setDescription(e){this.wizardState.setExperimentDescription(e)}getIcon(e){let t=this.templateService.getTemplateInfo(e);if(t?.icon)return this.iconToEmoji(t.icon);switch(e){case"human":return"\u{1F9D1}";case"cell-line":case"cell-lines":return"\u{1F9EB}";case"vertebrate":case"vertebrates":return"\u{1F42D}";case"ms-proteomics":return"\u{1F4CA}";case"other":return"\u{1F9EC}";default:return"\u2753"}}iconToEmoji(e){return{person:"\u{1F9D1}",science:"\u{1F9EB}",pets:"\u{1F42D}",category:"\u{1F9EC}",analytics:"\u{1F4CA}",biotech:"\u{1F9EA}",eco:"\u{1F331}",bug_report:"\u{1FAB2}",scatter_plot:"\u{1F4C8}",assessment:"\u{1F4CA}",grain:"\u{1F33E}",link:"\u{1F517}",vaccines:"\u{1F489}",diversity_3:"\u{1F9A0}",hub:"\u{1F517}",developer_board:"\u{1F4DF}"}[e]||"\u2753"}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ee({type:n,selectors:[["wizard-experiment-setup"]],inputs:{aiEnabled:"aiEnabled",availableTemplates:"availableTemplates"},decls:22,vars:5,consts:[[1,"step-container"],[1,"step-header"],[1,"step-description"],[1,"template-grid"],[1,"template-card",3,"selected"],[1,"form-section"],[1,"form-label"],[1,"help-text"],[1,"sample-count-input"],[1,"count-btn",3,"click","disabled"],["type","number","min","1","max","1000",1,"count-input",3,"ngModelChange","ngModel"],[1,"validation-message"],[1,"template-card",3,"click"],[1,"template-icon"],[1,"template-info"],[1,"template-examples"],[1,"example-label"],[1,"selected-badge"],[1,"optional-badge"],["placeholder","E.g., Comparing protein expression between healthy and cancer tissues from 8 patients using TMT labeling...","rows","3",1,"form-textarea",3,"ngModelChange","ngModel"],[1,"warning-icon"]],template:function(t,i){t&1&&(c(0,"div",0)(1,"div",1)(2,"h3"),d(3,"What type of experiment is this?"),l(),c(4,"p",2),d(5," Select the template that best describes your samples. This will determine which metadata fields are required. "),l()(),c(6,"div",3),z(7,lM,13,7,"button",4,sM),l(),c(9,"div",5)(10,"label",6),d(11," How many samples do you have? "),c(12,"span",7),d(13," Biological samples (not including fractions or technical replicates) "),l()(),c(14,"div",8)(15,"button",9),_("click",function(){return i.decrementSamples()}),d(16," - "),l(),c(17,"input",10),_("ngModelChange",function(r){return i.setSampleCount(r)}),l(),c(18,"button",9),_("click",function(){return i.incrementSamples()}),d(19," + "),l()()(),x(20,cM,6,1,"div",5),x(21,dM,4,0,"div",11),l()),t&2&&(p(7),$(i.templates()),p(8),I("disabled",i.wizardState.sampleCount()<=1),p(2),I("ngModel",i.wizardState.sampleCount()),p(),I("disabled",i.wizardState.sampleCount()>=1e3),p(2),S(i.aiEnabled?20:-1),p(),S(i.wizardState.isStep1Valid()?-1:21))},dependencies:[te,ce,ye,tn,Me,nn,Rn,xe],styles:[".step-container[_ngcontent-%COMP%]{max-width:700px}.step-header[_ngcontent-%COMP%]{margin-bottom:24px}.step-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;font-size:18px;font-weight:600;color:#1f2937}.step-description[_ngcontent-%COMP%]{margin:0;color:#6b7280;font-size:14px}.template-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:16px;margin-bottom:32px}.template-card[_ngcontent-%COMP%]{position:relative;display:flex;align-items:flex-start;gap:16px;padding:20px;border:2px solid #e5e7eb;border-radius:12px;background:#fff;cursor:pointer;text-align:left;transition:all .15s}.template-card[_ngcontent-%COMP%]:hover{border-color:#d1d5db;background:#f9fafb}.template-card.selected[_ngcontent-%COMP%]{border-color:#3b82f6;background:#eff6ff}.template-icon[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:10px;background:#f3f4f6;display:flex;align-items:center;justify-content:center;font-size:24px;flex-shrink:0}.template-card.selected[_ngcontent-%COMP%]   .template-icon[_ngcontent-%COMP%]{background:#dbeafe}.template-info[_ngcontent-%COMP%]{flex:1;min-width:0}.template-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 4px;font-size:15px;font-weight:600;color:#1f2937}.template-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 8px;font-size:13px;color:#6b7280;line-height:1.4}.template-examples[_ngcontent-%COMP%]{font-size:12px;color:#9ca3af}.example-label[_ngcontent-%COMP%]{font-weight:500}.selected-badge[_ngcontent-%COMP%]{position:absolute;top:12px;right:12px;width:24px;height:24px;border-radius:50%;background:#3b82f6;color:#fff;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:700}.form-section[_ngcontent-%COMP%]{margin-bottom:24px}.form-label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#374151;margin-bottom:8px}.help-text[_ngcontent-%COMP%]{display:block;font-size:12px;font-weight:400;color:#6b7280;margin-top:4px}.optional-badge[_ngcontent-%COMP%]{display:inline-block;font-size:11px;font-weight:400;color:#8b5cf6;background:#f3e8ff;padding:2px 8px;border-radius:4px;margin-left:8px}.sample-count-input[_ngcontent-%COMP%]{display:flex;align-items:center;gap:0;width:fit-content}.count-btn[_ngcontent-%COMP%]{width:40px;height:40px;border:1px solid #d1d5db;background:#fff;font-size:20px;font-weight:500;color:#374151;cursor:pointer;transition:all .15s}.count-btn[_ngcontent-%COMP%]:first-child{border-radius:8px 0 0 8px}.count-btn[_ngcontent-%COMP%]:last-child{border-radius:0 8px 8px 0}.count-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#f3f4f6}.count-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.count-input[_ngcontent-%COMP%]{width:80px;height:40px;border:1px solid #d1d5db;border-left:none;border-right:none;text-align:center;font-size:16px;font-weight:500}.count-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6}.form-textarea[_ngcontent-%COMP%]{width:100%;padding:12px;border:1px solid #d1d5db;border-radius:8px;font-size:14px;resize:vertical;font-family:inherit}.form-textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.form-textarea[_ngcontent-%COMP%]::placeholder{color:#9ca3af}.validation-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 16px;background:#fef3c7;border:1px solid #fcd34d;border-radius:8px;font-size:13px;color:#92400e}.warning-icon[_ngcontent-%COMP%]{width:20px;height:20px;border-radius:50%;background:#f59e0b;color:#fff;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700}@media (max-width: 600px){.template-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"],changeDetection:0})};var Sp=(n,e)=>e.id;function uM(n,e){if(n&1){let t=N();c(0,"button",19),_("click",function(){let o=v(t).$implicit,r=m(2);return y(r.selectOrganism(o))}),c(1,"span",20),d(2),l(),c(3,"span",21),d(4),l()()}if(n&2){let t=e.$implicit;p(2),P(t.label),p(2),P(t.id)}}function pM(n,e){if(n&1&&(c(0,"div",9),z(1,uM,5,2,"button",18,Sp),l()),n&2){let t=m();p(),$(t.organismResults())}}function fM(n,e){if(n&1){let t=N();c(0,"div",10)(1,"span",22),d(2),l(),c(3,"span",23),d(4),l(),c(5,"button",24),_("click",function(){v(t);let o=m();return y(o.clearOrganism())}),d(6,"\xD7"),l()()}if(n&2){let t=m();p(2),P(t.state().organism.label),p(2),P(t.state().organism.id)}}function mM(n,e){if(n&1){let t=N();c(0,"button",19),_("click",function(){let o=v(t).$implicit,r=m(2);return y(r.selectDisease(o))}),c(1,"span",20),d(2),l(),c(3,"span",21),d(4),l()()}if(n&2){let t=e.$implicit;p(2),P(t.label),p(2),P(t.id)}}function gM(n,e){if(n&1&&(c(0,"div",9),z(1,mM,5,2,"button",18,Sp),l()),n&2){let t=m();p(),$(t.diseaseResults())}}function hM(n,e){if(n&1&&(c(0,"span",22),d(1),l()),n&2){let t=m(2);p(),P(t.state().disease)}}function _M(n,e){if(n&1&&(c(0,"span",22),d(1),l(),c(2,"span",23),d(3),l()),n&2){let t=m(2);p(),P(t.getDiseaseLabel()),p(2),P(t.getDiseaseId())}}function CM(n,e){if(n&1){let t=N();c(0,"div",10),x(1,hM,2,1,"span",22)(2,_M,4,2),c(3,"button",24),_("click",function(){v(t);let o=m();return y(o.clearDisease())}),d(4,"\xD7"),l()()}if(n&2){let t=m();p(),S(t.isDiseaseString()?1:2)}}function vM(n,e){if(n&1){let t=N();c(0,"button",19),_("click",function(){let o=v(t).$implicit,r=m(2);return y(r.selectOrganismPart(o))}),c(1,"span",20),d(2),l(),c(3,"span",21),d(4),l()()}if(n&2){let t=e.$implicit;p(2),P(t.label),p(2),P(t.id)}}function yM(n,e){if(n&1&&(c(0,"div",9),z(1,vM,5,2,"button",18,Sp),l()),n&2){let t=m();p(),$(t.organismPartResults())}}function bM(n,e){if(n&1){let t=N();c(0,"div",10)(1,"span",22),d(2),l(),c(3,"span",23),d(4),l(),c(5,"button",24),_("click",function(){v(t);let o=m();return y(o.clearOrganismPart())}),d(6,"\xD7"),l()()}if(n&2){let t=m();p(2),P(t.state().organismPart.label),p(2),P(t.state().organismPart.id)}}function xM(n,e){if(n&1){let t=N();c(0,"div",16)(1,"h4"),d(2,"Human-specific Fields"),l(),c(3,"div",25)(4,"div",3)(5,"label",4),d(6," Default Sex "),c(7,"span",6),d(8,"Biological sex (can be overridden per sample)"),l()(),c(9,"select",26),_("ngModelChange",function(o){v(t);let r=m();return y(r.wizardState.setDefaultSex(o))}),c(10,"option",27),d(11,"-- Select --"),l(),c(12,"option",28),d(13,"male"),l(),c(14,"option",29),d(15,"female"),l(),c(16,"option",30),d(17,"not available"),l()()(),c(18,"div",3)(19,"label",4),d(20," Default Age "),c(21,"span",6),d(22,"Format: 25Y (years), 6M (months), or not available"),l()(),c(23,"input",31),_("ngModelChange",function(o){v(t);let r=m();return y(r.wizardState.setDefaultAge(o))}),l()()()()}if(n&2){let t=m();p(9),I("ngModel",t.state().defaultSex),p(),I("ngValue",null),p(13),I("ngModel",t.state().defaultAge)}}function SM(n,e){if(n&1){let t=N();c(0,"div",16)(1,"h4"),d(2,"Cell Line Fields"),l(),c(3,"div",3)(4,"label",4),d(5," Cell Line Name "),c(6,"span",6),d(7,"Name of the cell line (e.g., HeLa, HEK293, MCF-7)"),l()(),c(8,"input",32),_("ngModelChange",function(o){v(t);let r=m();return y(r.wizardState.setDefaultCellLine(o))}),l(),c(9,"div",11)(10,"span",12),d(11,"Common:"),l(),c(12,"button",13),_("click",function(){v(t);let o=m();return y(o.wizardState.setDefaultCellLine("HeLa"))}),d(13,"HeLa"),l(),c(14,"button",13),_("click",function(){v(t);let o=m();return y(o.wizardState.setDefaultCellLine("HEK293"))}),d(15,"HEK293"),l(),c(16,"button",13),_("click",function(){v(t);let o=m();return y(o.wizardState.setDefaultCellLine("MCF-7"))}),d(17,"MCF-7"),l(),c(18,"button",13),_("click",function(){v(t);let o=m();return y(o.wizardState.setDefaultCellLine("A549"))}),d(19,"A549"),l()()()()}if(n&2){let t=m();p(8),I("ngModel",t.state().defaultCellLine)}}function wM(n,e){if(n&1){let t=N();c(0,"div",16)(1,"h4"),d(2,"Vertebrate-specific Fields"),l(),c(3,"div",25)(4,"div",3)(5,"label",4),d(6," Strain / Breed "),c(7,"span",6),d(8,"For mice/rats (e.g., C57BL/6, Sprague-Dawley)"),l()(),c(9,"input",33),_("ngModelChange",function(o){v(t);let r=m();return y(r.wizardState.setStrainBreed(o))}),l()(),c(10,"div",3)(11,"label",4),d(12," Developmental Stage "),c(13,"span",6),d(14,"Life stage (e.g., adult, embryonic day 14)"),l()(),c(15,"input",34),_("ngModelChange",function(o){v(t);let r=m();return y(r.wizardState.setDevelopmentalStage(o))}),l()()()()}if(n&2){let t=m();p(9),I("ngModel",t.state().strainBreed),p(6),I("ngModel",t.state().developmentalStage)}}function EM(n,e){n&1&&(c(0,"div",17)(1,"span",35),d(2,"!"),l(),d(3," Please fill in organism, disease, and organism part to continue. "),l())}var Sl=class n{aiEnabled=!1;wizardState=q(at);ols=Do;state=this.wizardState.state;organismSearch=w("");diseaseSearch=w("");organismPartSearch=w("");organismResults=w([]);diseaseResults=w([]);organismPartResults=w([]);showOrganismResults=w(!1);showDiseaseResults=w(!1);showOrganismPartResults=w(!1);searchOrganism(e){return k(this,null,function*(){if(this.organismSearch.set(e),e.length<2){this.organismResults.set([]);return}try{let t=yield this.ols.searchOrganism(e);this.organismResults.set(t.map(i=>({id:i.id,label:i.label,ontology:i.ontologyPrefix?.toUpperCase()||"NCBITAXON"}))),this.showOrganismResults.set(!0)}catch{this.organismResults.set([])}})}selectOrganism(e){this.wizardState.setOrganism(e),this.organismSearch.set(""),this.organismResults.set([]),this.showOrganismResults.set(!1)}selectQuickOrganism(e,t){this.selectOrganism({id:t,label:e,ontology:"NCBITAXON"})}clearOrganism(){this.wizardState.setOrganism(null)}searchDisease(e){return k(this,null,function*(){if(this.diseaseSearch.set(e),e.toLowerCase()==="normal"){this.diseaseResults.set([{id:"PATO:0000461",label:"normal",ontology:"PATO"}]),this.showDiseaseResults.set(!0);return}if(e.length<2){this.diseaseResults.set([]);return}try{let t=yield this.ols.searchDisease(e);this.diseaseResults.set(t.map(i=>({id:i.id,label:i.label,ontology:i.ontologyPrefix?.toUpperCase()||"MONDO"}))),this.showDiseaseResults.set(!0)}catch{this.diseaseResults.set([])}})}selectDisease(e){this.wizardState.setDisease(e),this.diseaseSearch.set(""),this.diseaseResults.set([]),this.showDiseaseResults.set(!1)}selectQuickDisease(e){this.wizardState.setDisease(e),this.diseaseSearch.set(""),this.diseaseResults.set([]),this.showDiseaseResults.set(!1)}selectQuickDiseaseOntology(e,t){this.selectDisease({id:t,label:e,ontology:"MONDO"})}clearDisease(){this.wizardState.setDisease(null)}isDiseaseString(){return typeof this.state().disease=="string"}getDiseaseLabel(){let e=this.state().disease;return e?typeof e=="string"?e:e.label:""}getDiseaseId(){let e=this.state().disease;return!e||typeof e=="string"?"":e.id}searchOrganismPart(e){return k(this,null,function*(){if(this.organismPartSearch.set(e),e.length<2){this.organismPartResults.set([]);return}try{let t=yield this.ols.searchTissue(e);this.organismPartResults.set(t.map(i=>({id:i.id,label:i.label,ontology:i.ontologyPrefix?.toUpperCase()||"UBERON"}))),this.showOrganismPartResults.set(!0)}catch{this.organismPartResults.set([])}})}selectOrganismPart(e){this.wizardState.setOrganismPart(e),this.organismPartSearch.set(""),this.organismPartResults.set([]),this.showOrganismPartResults.set(!1)}selectQuickOrganismPart(e,t){this.selectOrganismPart({id:t,label:e,ontology:"UBERON"})}clearOrganismPart(){this.wizardState.setOrganismPart(null)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ee({type:n,selectors:[["wizard-sample-characteristics"]],inputs:{aiEnabled:"aiEnabled"},decls:73,vars:13,consts:[[1,"step-container"],[1,"step-header"],[1,"step-description"],[1,"form-section"],[1,"form-label"],[1,"required"],[1,"help-text"],[1,"autocomplete-container"],["type","text","placeholder","Search for organism...",1,"form-input",3,"ngModelChange","focus","ngModel"],[1,"autocomplete-dropdown"],[1,"selected-value"],[1,"quick-select"],[1,"quick-label"],[1,"quick-btn",3,"click"],["type","text","placeholder","Search for disease or type 'normal'...",1,"form-input",3,"ngModelChange","focus","ngModel"],["type","text","placeholder","Search for tissue/organ...",1,"form-input",3,"ngModelChange","focus","ngModel"],[1,"template-fields"],[1,"validation-message"],[1,"autocomplete-option"],[1,"autocomplete-option",3,"click"],[1,"option-label"],[1,"option-id"],[1,"selected-label"],[1,"selected-id"],[1,"btn-clear",3,"click"],[1,"form-row"],[1,"form-select",3,"ngModelChange","ngModel"],[3,"ngValue"],["value","male"],["value","female"],["value","not available"],["type","text","placeholder","e.g., 45Y or not available",1,"form-input",3,"ngModelChange","ngModel"],["type","text","placeholder","e.g., HeLa",1,"form-input",3,"ngModelChange","ngModel"],["type","text","placeholder","e.g., C57BL/6",1,"form-input",3,"ngModelChange","ngModel"],["type","text","placeholder","e.g., adult",1,"form-input",3,"ngModelChange","ngModel"],[1,"warning-icon"]],template:function(t,i){t&1&&(c(0,"div",0)(1,"div",1)(2,"h3"),d(3,"Sample Characteristics"),l(),c(4,"p",2),d(5," Define the biological characteristics shared by all your samples. These values will be used as "),c(6,"strong"),d(7,"defaults"),l(),d(8," for cells not specified individually. Sample-specific overrides can be set in the next step. "),l()(),c(9,"div",3)(10,"label",4),d(11," Organism "),c(12,"span",5),d(13,"*"),l(),c(14,"span",6),d(15,"Species of your samples (e.g., Homo sapiens, Mus musculus)"),l()(),c(16,"div",7)(17,"input",8),_("ngModelChange",function(r){return i.searchOrganism(r)})("focus",function(){return i.showOrganismResults.set(!0)}),l(),x(18,pM,3,0,"div",9),l(),x(19,fM,7,2,"div",10),c(20,"div",11)(21,"span",12),d(22,"Common:"),l(),c(23,"button",13),_("click",function(){return i.selectQuickOrganism("Homo sapiens","NCBITaxon:9606")}),d(24,"Homo sapiens"),l(),c(25,"button",13),_("click",function(){return i.selectQuickOrganism("Mus musculus","NCBITaxon:10090")}),d(26,"Mus musculus"),l(),c(27,"button",13),_("click",function(){return i.selectQuickOrganism("Rattus norvegicus","NCBITaxon:10116")}),d(28,"Rattus norvegicus"),l()()(),c(29,"div",3)(30,"label",4),d(31," Disease "),c(32,"span",5),d(33,"*"),l(),c(34,"span",6),d(35,"Disease being studied or 'normal' for healthy samples"),l()(),c(36,"div",7)(37,"input",14),_("ngModelChange",function(r){return i.searchDisease(r)})("focus",function(){return i.showDiseaseResults.set(!0)}),l(),x(38,gM,3,0,"div",9),l(),x(39,CM,5,1,"div",10),c(40,"div",11)(41,"span",12),d(42,"Common:"),l(),c(43,"button",13),_("click",function(){return i.selectQuickDisease("normal")}),d(44,"normal"),l(),c(45,"button",13),_("click",function(){return i.selectQuickDiseaseOntology("breast cancer","MONDO:0007254")}),d(46,"breast cancer"),l(),c(47,"button",13),_("click",function(){return i.selectQuickDiseaseOntology("colorectal cancer","MONDO:0005575")}),d(48,"colorectal cancer"),l()()(),c(49,"div",3)(50,"label",4),d(51," Organism Part / Tissue "),c(52,"span",5),d(53,"*"),l(),c(54,"span",6),d(55,"Tissue or body part (e.g., liver, blood plasma, whole organism)"),l()(),c(56,"div",7)(57,"input",15),_("ngModelChange",function(r){return i.searchOrganismPart(r)})("focus",function(){return i.showOrganismPartResults.set(!0)}),l(),x(58,yM,3,0,"div",9),l(),x(59,bM,7,2,"div",10),c(60,"div",11)(61,"span",12),d(62,"Common:"),l(),c(63,"button",13),_("click",function(){return i.selectQuickOrganismPart("liver","UBERON:0002107")}),d(64,"liver"),l(),c(65,"button",13),_("click",function(){return i.selectQuickOrganismPart("blood plasma","UBERON:0001969")}),d(66,"blood plasma"),l(),c(67,"button",13),_("click",function(){return i.selectQuickOrganismPart("whole organism","UBERON:0000468")}),d(68,"whole organism"),l()()(),x(69,xM,24,3,"div",16),x(70,SM,20,1,"div",16),x(71,wM,16,2,"div",16),x(72,EM,4,0,"div",17),l()),t&2&&(p(17),I("ngModel",i.organismSearch()),p(),S(i.showOrganismResults()&&i.organismResults().length>0?18:-1),p(),S(i.state().organism?19:-1),p(18),I("ngModel",i.diseaseSearch()),p(),S(i.showDiseaseResults()&&i.diseaseResults().length>0?38:-1),p(),S(i.state().disease?39:-1),p(18),I("ngModel",i.organismPartSearch()),p(),S(i.showOrganismPartResults()&&i.organismPartResults().length>0?58:-1),p(),S(i.state().organismPart?59:-1),p(10),S(i.wizardState.isHumanTemplate()?69:-1),p(),S(i.wizardState.isCellLineTemplate()?70:-1),p(),S(i.wizardState.isVertebrateTemplate()?71:-1),p(),S(i.wizardState.isStep2Valid()?-1:72))},dependencies:[te,ce,Ue,qe,ye,st,Me,xe],styles:[".step-container[_ngcontent-%COMP%]{max-width:700px}.step-header[_ngcontent-%COMP%]{margin-bottom:24px}.step-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;font-size:18px;font-weight:600;color:#1f2937}.step-description[_ngcontent-%COMP%]{margin:0;color:#6b7280;font-size:14px}.form-section[_ngcontent-%COMP%]{margin-bottom:24px}.form-label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#374151;margin-bottom:8px}.required[_ngcontent-%COMP%]{color:#ef4444;margin-left:4px}.help-text[_ngcontent-%COMP%]{display:block;font-size:12px;font-weight:400;color:#6b7280;margin-top:4px}.form-input[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{width:100%;padding:10px 12px;border:1px solid #d1d5db;border-radius:8px;font-size:14px;transition:border-color .15s,box-shadow .15s}.form-input[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.autocomplete-container[_ngcontent-%COMP%]{position:relative}.autocomplete-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;right:0;background:#fff;border:1px solid #d1d5db;border-radius:8px;box-shadow:0 10px 25px #00000026;max-height:200px;overflow-y:auto;z-index:100;margin-top:4px}.autocomplete-option[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;width:100%;padding:10px 12px;border:none;background:none;text-align:left;cursor:pointer;transition:background .15s}.autocomplete-option[_ngcontent-%COMP%]:hover{background:#f3f4f6}.option-label[_ngcontent-%COMP%]{font-size:14px;color:#1f2937}.option-id[_ngcontent-%COMP%]{font-size:12px;color:#6b7280}.selected-value[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-top:8px;padding:8px 12px;background:#eff6ff;border:1px solid #bfdbfe;border-radius:6px}.selected-label[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#1e40af}.selected-id[_ngcontent-%COMP%]{font-size:12px;color:#3b82f6}.btn-clear[_ngcontent-%COMP%]{margin-left:auto;background:none;border:none;font-size:18px;color:#6b7280;cursor:pointer;padding:0 4px}.btn-clear[_ngcontent-%COMP%]:hover{color:#ef4444}.quick-select[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-top:8px;flex-wrap:wrap}.quick-label[_ngcontent-%COMP%]{font-size:12px;color:#6b7280}.quick-btn[_ngcontent-%COMP%]{padding:4px 10px;background:#f3f4f6;border:1px solid #e5e7eb;border-radius:4px;font-size:12px;color:#374151;cursor:pointer;transition:all .15s}.quick-btn[_ngcontent-%COMP%]:hover{background:#e5e7eb;border-color:#d1d5db}.template-fields[_ngcontent-%COMP%]{margin-top:32px;padding-top:24px;border-top:1px solid #e5e7eb}.template-fields[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 16px;font-size:15px;font-weight:600;color:#374151}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:16px}.validation-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 16px;background:#fef3c7;border:1px solid #fcd34d;border-radius:8px;font-size:13px;color:#92400e;margin-top:24px}.warning-icon[_ngcontent-%COMP%]{width:20px;height:20px;border-radius:50%;background:#f59e0b;color:#fff;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700}@media (max-width: 600px){.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}}"],changeDetection:0})};var MM=(n,e)=>e.index;function DM(n,e){n&1&&(c(0,"th",13),d(1,"Disease Override"),l())}function TM(n,e){n&1&&(c(0,"th",14),d(1,"Age"),l())}function IM(n,e){n&1&&(c(0,"th",15),d(1,"Sex"),l())}function PM(n,e){if(n&1){let t=N();c(0,"td",13)(1,"input",26),_("ngModelChange",function(o){v(t);let r=m().$index,s=m();return y(s.updateSample(r,"disease",o))}),l()()}if(n&2){let t=m().$implicit;p(),I("ngModel",t.disease||"")}}function OM(n,e){if(n&1){let t=N();c(0,"td",14)(1,"input",27),_("ngModelChange",function(o){v(t);let r=m().$index,s=m();return y(s.updateSample(r,"age",o))}),l()()}if(n&2){let t=m().$implicit,i=m();p(),I("ngModel",t.age||"")("placeholder",i.state().defaultAge||"e.g., 45Y")}}function AM(n,e){if(n&1){let t=N();c(0,"td",15)(1,"select",28),_("ngModelChange",function(o){v(t);let r=m().$index,s=m();return y(s.updateSample(r,"sex",o))}),c(2,"option",29),d(3,"Same as default"),l(),c(4,"option",30),d(5,"male"),l(),c(6,"option",31),d(7,"female"),l(),c(8,"option",32),d(9,"not available"),l()()()}if(n&2){let t=m().$implicit;p(),I("ngModel",t.sex||"")}}function NM(n,e){if(n&1){let t=N();c(0,"tr")(1,"td",9),d(2),l(),c(3,"td",10)(4,"input",24),_("ngModelChange",function(o){let r=v(t).$index,s=m();return y(s.updateSample(r,"sourceName",o))}),l()(),c(5,"td",12)(6,"input",25),_("ngModelChange",function(o){let r=v(t).$index,s=m();return y(s.updateSample(r,"biologicalReplicate",o))}),l()(),x(7,PM,2,1,"td",13),x(8,OM,2,2,"td",14),x(9,AM,10,1,"td",15),l()}if(n&2){let t=e.$implicit,i=m();p(2),P(t.index),p(2),I("ngModel",t.sourceName),p(2),I("ngModel",t.biologicalReplicate),p(),S(i.showDiseaseColumn()?7:-1),p(),S(i.showAgeColumn()?8:-1),p(),S(i.showSexColumn()?9:-1)}}function kM(n,e){n&1&&(c(0,"div",23)(1,"span",33),d(2,"!"),l(),d(3," All samples must have a source name to continue. "),l())}var wl=class n{aiEnabled=!1;wizardState=q(at);state=this.wizardState.state;namePattern=w("sample_{n}");ngOnInit(){this.wizardState.ensureSamplesInitialized()}showDiseaseColumn(){return!1}showAgeColumn(){return this.wizardState.isHumanTemplate()}showSexColumn(){return this.wizardState.isHumanTemplate()}updateSample(e,t,i){this.wizardState.updateSample(e,{[t]:i})}autoGenerateNames(){this.wizardState.autoGenerateSourceNames(this.namePattern())}copyFirstToAll(e){this.wizardState.copyToAllSamples(e)}uniqueBioReplicates(){let e=this.wizardState.samples();return new Set(e.map(i=>i.biologicalReplicate)).size}assignSequentialReplicates(){let t=this.wizardState.samples().map((i,o)=>O(E({},i),{biologicalReplicate:o+1}));this.wizardState.setSamples(t)}assignPairedReplicates(){let t=this.wizardState.samples().map((i,o)=>O(E({},i),{biologicalReplicate:Math.floor(o/2)+1}));this.wizardState.setSamples(t)}assignTriplicates(){let t=this.wizardState.samples().map((i,o)=>O(E({},i),{biologicalReplicate:Math.floor(o/3)+1}));this.wizardState.setSamples(t)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ee({type:n,selectors:[["wizard-sample-values"]],inputs:{aiEnabled:"aiEnabled"},decls:54,vars:7,consts:[[1,"step-container"],[1,"step-header"],[1,"step-description"],[1,"toolbar"],[1,"toolbar-group"],[1,"toolbar-btn",3,"click"],["type","text","placeholder","sample_{n}","title","Pattern: use {n} for number",1,"pattern-input",3,"ngModelChange","ngModel"],[1,"table-container"],[1,"sample-table"],[1,"col-index"],[1,"col-name"],[1,"required"],[1,"col-biorep"],[1,"col-disease"],[1,"col-age"],[1,"col-sex"],[1,"summary"],[1,"summary-item"],[1,"summary-label"],[1,"summary-value"],[1,"quick-actions"],[1,"action-buttons"],[1,"action-btn",3,"click"],[1,"validation-message"],["type","text","placeholder","Enter name...",1,"cell-input",3,"ngModelChange","ngModel"],["type","number","min","1",1,"cell-input",3,"ngModelChange","ngModel"],["type","text","placeholder","Same as default",1,"cell-input",3,"ngModelChange","ngModel"],["type","text",1,"cell-input",3,"ngModelChange","ngModel","placeholder"],[1,"cell-select",3,"ngModelChange","ngModel"],["value",""],["value","male"],["value","female"],["value","not available"],[1,"warning-icon"]],template:function(t,i){t&1&&(c(0,"div",0)(1,"div",1)(2,"h3"),d(3,"Sample-Specific Values"),l(),c(4,"p",2),d(5," Enter values for each sample. Use the toolbar to auto-fill or copy values across samples. "),l()(),c(6,"div",3)(7,"div",4)(8,"button",5),_("click",function(){return i.autoGenerateNames()}),d(9," Auto-name samples "),l(),c(10,"input",6),_("ngModelChange",function(r){return i.namePattern.set(r)}),l()(),c(11,"div",4)(12,"button",5),_("click",function(){return i.copyFirstToAll("biologicalReplicate")}),d(13," Copy Bio. Rep. to all "),l()()(),c(14,"div",7)(15,"table",8)(16,"thead")(17,"tr")(18,"th",9),d(19,"#"),l(),c(20,"th",10),d(21,"Source Name "),c(22,"span",11),d(23,"*"),l()(),c(24,"th",12),d(25,"Bio. Replicate"),l(),x(26,DM,2,0,"th",13),x(27,TM,2,0,"th",14),x(28,IM,2,0,"th",15),l()(),c(29,"tbody"),z(30,NM,10,6,"tr",null,MM),l()()(),c(32,"div",16)(33,"div",17)(34,"span",18),d(35,"Total samples:"),l(),c(36,"span",19),d(37),l()(),c(38,"div",17)(39,"span",18),d(40,"Unique bio. replicates:"),l(),c(41,"span",19),d(42),l()()(),c(43,"div",20)(44,"h4"),d(45,"Quick Actions"),l(),c(46,"div",21)(47,"button",22),_("click",function(){return i.assignSequentialReplicates()}),d(48," Sequential bio. replicates (1, 2, 3...) "),l(),c(49,"button",22),_("click",function(){return i.assignPairedReplicates()}),d(50," Paired replicates (1, 1, 2, 2...) "),l(),c(51,"button",22),_("click",function(){return i.assignTriplicates()}),d(52," Triplicates (1, 1, 1, 2, 2, 2...) "),l()()(),x(53,kM,4,0,"div",23),l()),t&2&&(p(10),I("ngModel",i.namePattern()),p(16),S(i.showDiseaseColumn()?26:-1),p(),S(i.showAgeColumn()?27:-1),p(),S(i.showSexColumn()?28:-1),p(2),$(i.wizardState.samples()),p(7),P(i.wizardState.sampleCount()),p(5),P(i.uniqueBioReplicates()),p(11),S(i.wizardState.isStep3Valid()?-1:53))},dependencies:[te,ce,Ue,qe,ye,tn,st,Me,nn,xe],styles:[".step-container[_ngcontent-%COMP%]{max-width:900px}.step-header[_ngcontent-%COMP%]{margin-bottom:24px}.step-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;font-size:18px;font-weight:600;color:#1f2937}.step-description[_ngcontent-%COMP%]{margin:0;color:#6b7280;font-size:14px}.toolbar[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:16px;padding:12px;background:#f9fafb;border-radius:8px;flex-wrap:wrap}.toolbar-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.toolbar-btn[_ngcontent-%COMP%]{padding:8px 12px;background:#fff;border:1px solid #d1d5db;border-radius:6px;font-size:13px;color:#374151;cursor:pointer;transition:all .15s}.toolbar-btn[_ngcontent-%COMP%]:hover{background:#f3f4f6;border-color:#9ca3af}.pattern-input[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid #d1d5db;border-radius:6px;font-size:13px;width:120px}.pattern-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6}.table-container[_ngcontent-%COMP%]{border:1px solid #e5e7eb;border-radius:8px;overflow:hidden;margin-bottom:16px}.sample-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.sample-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .sample-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 12px;border-bottom:1px solid #e5e7eb;text-align:left}.sample-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f9fafb;font-size:12px;font-weight:600;color:#6b7280;text-transform:uppercase;letter-spacing:.05em}.sample-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#f9fafb}.sample-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:none}.col-index[_ngcontent-%COMP%]{width:40px;text-align:center;color:#9ca3af;font-size:12px}.col-name[_ngcontent-%COMP%]{min-width:200px}.col-biorep[_ngcontent-%COMP%]{width:100px}.col-disease[_ngcontent-%COMP%]{min-width:150px}.col-age[_ngcontent-%COMP%]{width:100px}.col-sex[_ngcontent-%COMP%]{width:140px}.required[_ngcontent-%COMP%]{color:#ef4444}.cell-input[_ngcontent-%COMP%], .cell-select[_ngcontent-%COMP%]{width:100%;padding:6px 8px;border:1px solid transparent;border-radius:4px;font-size:13px;background:transparent;transition:all .15s}.cell-input[_ngcontent-%COMP%]:hover, .cell-select[_ngcontent-%COMP%]:hover{border-color:#d1d5db}.cell-input[_ngcontent-%COMP%]:focus, .cell-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;background:#fff;box-shadow:0 0 0 2px #3b82f61a}.cell-input[_ngcontent-%COMP%]::placeholder{color:#9ca3af}.summary[_ngcontent-%COMP%]{display:flex;gap:24px;padding:12px 16px;background:#f3f4f6;border-radius:8px;margin-bottom:24px}.summary-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.summary-label[_ngcontent-%COMP%]{font-size:13px;color:#6b7280}.summary-value[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#1f2937}.quick-actions[_ngcontent-%COMP%]{margin-bottom:24px}.quick-actions[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;font-size:14px;font-weight:600;color:#374151}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:8px;flex-wrap:wrap}.action-btn[_ngcontent-%COMP%]{padding:8px 14px;background:#fff;border:1px solid #d1d5db;border-radius:6px;font-size:13px;color:#374151;cursor:pointer;transition:all .15s}.action-btn[_ngcontent-%COMP%]:hover{background:#f3f4f6;border-color:#9ca3af}.validation-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 16px;background:#fef3c7;border:1px solid #fcd34d;border-radius:8px;font-size:13px;color:#92400e}.warning-icon[_ngcontent-%COMP%]{width:20px;height:20px;border-radius:50%;background:#f59e0b;color:#fff;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700}"],changeDetection:0})};var RM=(n,e)=>e.id;function FM(n,e){n&1&&(c(0,"div",27),d(1,"\u2713"),l())}function VM(n,e){if(n&1){let t=N();c(0,"button",24),_("click",function(){let o=v(t).$implicit,r=m();return y(r.wizardState.setLabelConfig(o.id))}),c(1,"div",25),d(2),l(),c(3,"div",26),d(4),l(),x(5,FM,2,0,"div",27),l()}if(n&2){let t=e.$implicit,i=m();B("selected",i.state().labelConfigId===t.id),p(2),P(t.name),p(2),j("",t.labels.length," channel(s)"),p(),S(i.state().labelConfigId===t.id?5:-1)}}function LM(n,e){if(n&1&&(c(0,"span",30),d(1),l()),n&2){let t=e.$implicit;p(),P(t)}}function jM(n,e){n&1&&(c(0,"div",8)(1,"span",28),d(2,"Labels:"),l(),c(3,"div",29),z(4,LM,2,1,"span",30,Ut),l()()),n&2&&(p(4),$(e.labels))}function zM(n,e){if(n&1){let t=N();c(0,"div",11)(1,"label",31),d(2,"Number of fractions per sample:"),l(),c(3,"div",12)(4,"button",13),_("click",function(){v(t);let o=m();return y(o.decrementFractions())}),d(5," - "),l(),c(6,"input",32),_("ngModelChange",function(o){v(t);let r=m();return y(r.wizardState.setFractionCount(o))}),l(),c(7,"button",13),_("click",function(){v(t);let o=m();return y(o.incrementFractions())}),d(8," + "),l()(),c(9,"div",33)(10,"span",34),d(11,"Common:"),l(),c(12,"button",35),_("click",function(){v(t);let o=m();return y(o.wizardState.setFractionCount(8))}),d(13,"8"),l(),c(14,"button",35),_("click",function(){v(t);let o=m();return y(o.wizardState.setFractionCount(12))}),d(15,"12"),l(),c(16,"button",35),_("click",function(){v(t);let o=m();return y(o.wizardState.setFractionCount(24))}),d(17,"24"),l(),c(18,"button",35),_("click",function(){v(t);let o=m();return y(o.wizardState.setFractionCount(48))}),d(19,"48"),l()()()}if(n&2){let t=m();p(4),I("disabled",t.state().fractionCount<=1),p(2),I("ngModel",t.state().fractionCount),p(),I("disabled",t.state().fractionCount>=100)}}function $M(n,e){if(n&1&&(c(0,"div",15),d(1),l()),n&2){let t=m();p(),j(" Each sample will have ",t.state().technicalReplicates," technical replicates. ")}}function BM(n,e){if(n&1&&(c(0,"div",21),d(1,"\xD7"),l(),c(2,"div",18)(3,"span",19),d(4,"Labels"),l(),c(5,"span",20),d(6),l()()),n&2){let t,i=m();p(6),P(((t=i.selectedConfig())==null||t.labels==null?null:t.labels.length)||1)}}function HM(n,e){n&1&&(c(0,"div",23)(1,"span",36),d(2,"!"),l(),d(3," Please select a label type to continue. "),l())}var El=class n{aiEnabled=!1;wizardState=q(at);state=this.wizardState.state;labelConfigs=wt;selectedConfig=A(()=>{let e=this.state().labelConfigId;return wt.find(t=>t.id===e)});isMultiplexed(){let e=this.selectedConfig();return e?e.id!=="lf":!1}totalRows(){let e=this.state(),t=e.sampleCount,i=e.hasFractions?e.fractionCount:1,o=e.technicalReplicates,r=this.isMultiplexed()&&this.selectedConfig()?.labels?.length||1;return t*i*o*r}incrementFractions(){this.wizardState.setFractionCount(this.state().fractionCount+1)}decrementFractions(){this.wizardState.setFractionCount(this.state().fractionCount-1)}incrementReplicates(){this.wizardState.setTechnicalReplicates(this.state().technicalReplicates+1)}decrementReplicates(){this.wizardState.setTechnicalReplicates(this.state().technicalReplicates-1)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ee({type:n,selectors:[["wizard-technical-config"]],inputs:{aiEnabled:"aiEnabled"},decls:80,vars:20,consts:[[1,"step-container"],[1,"step-header"],[1,"step-description"],[1,"form-section"],[1,"form-label"],[1,"help-text"],[1,"label-grid"],[1,"label-card",3,"selected"],[1,"selected-labels"],[1,"toggle-group"],[1,"toggle-btn",3,"click"],[1,"fraction-config"],[1,"number-input-group"],[1,"number-btn",3,"click","disabled"],["type","number","min","1","max","10",1,"number-input",3,"ngModelChange","ngModel"],[1,"info-note"],[1,"summary-section"],[1,"summary-grid"],[1,"summary-item"],[1,"summary-label"],[1,"summary-value"],[1,"summary-operator"],[1,"summary-item","total"],[1,"validation-message"],[1,"label-card",3,"click"],[1,"label-name"],[1,"label-count"],[1,"selected-badge"],[1,"labels-title"],[1,"labels-list"],[1,"label-tag"],[1,"sub-label"],["type","number","min","1","max","100",1,"number-input",3,"ngModelChange","ngModel"],[1,"quick-presets"],[1,"preset-label"],[1,"preset-btn",3,"click"],[1,"warning-icon"]],template:function(t,i){if(t&1&&(c(0,"div",0)(1,"div",1)(2,"h3"),d(3,"Technical Configuration"),l(),c(4,"p",2),d(5," Configure the labeling strategy, fractionation, and replication scheme. "),l()(),c(6,"div",3)(7,"label",4),d(8," Label Type "),c(9,"span",5),d(10,"Select the quantification strategy used in your experiment"),l()(),c(11,"div",6),z(12,VM,6,5,"button",7,RM),l(),x(14,jM,6,0,"div",8),l(),c(15,"div",3)(16,"label",4),d(17," Fractionation "),c(18,"span",5),d(19,"Did you fractionate your samples before MS analysis?"),l()(),c(20,"div",9)(21,"button",10),_("click",function(){return i.wizardState.setHasFractions(!1)}),d(22," No fractionation "),l(),c(23,"button",10),_("click",function(){return i.wizardState.setHasFractions(!0)}),d(24," Fractionated "),l()(),x(25,zM,20,3,"div",11),l(),c(26,"div",3)(27,"label",4),d(28," Technical Replicates "),c(29,"span",5),d(30,"Number of MS runs per sample/fraction (separate injections of same preparation)"),l()(),c(31,"div",12)(32,"button",13),_("click",function(){return i.decrementReplicates()}),d(33," - "),l(),c(34,"input",14),_("ngModelChange",function(r){return i.wizardState.setTechnicalReplicates(r)}),l(),c(35,"button",13),_("click",function(){return i.incrementReplicates()}),d(36," + "),l()(),x(37,$M,2,1,"div",15),l(),c(38,"div",3)(39,"label",4),d(40," Data Acquisition Method "),c(41,"span",5),d(42,"How was the MS data acquired?"),l()(),c(43,"div",9)(44,"button",10),_("click",function(){return i.wizardState.setAcquisitionMethod("dda")}),d(45," DDA (Data-Dependent) "),l(),c(46,"button",10),_("click",function(){return i.wizardState.setAcquisitionMethod("dia")}),d(47," DIA (Data-Independent) "),l()()(),c(48,"div",16)(49,"h4"),d(50,"Data File Summary"),l(),c(51,"div",17)(52,"div",18)(53,"span",19),d(54,"Samples"),l(),c(55,"span",20),d(56),l()(),c(57,"div",21),d(58,"\xD7"),l(),c(59,"div",18)(60,"span",19),d(61,"Fractions"),l(),c(62,"span",20),d(63),l()(),c(64,"div",21),d(65,"\xD7"),l(),c(66,"div",18)(67,"span",19),d(68,"Tech. Reps"),l(),c(69,"span",20),d(70),l()(),x(71,BM,7,1),c(72,"div",21),d(73,"="),l(),c(74,"div",22)(75,"span",19),d(76,"Total Rows"),l(),c(77,"span",20),d(78),l()()()(),x(79,HM,4,0,"div",23),l()),t&2){let o;p(12),$(i.labelConfigs),p(2),S((o=i.selectedConfig())?14:-1,o),p(7),B("active",!i.state().hasFractions),p(2),B("active",i.state().hasFractions),p(2),S(i.state().hasFractions?25:-1),p(7),I("disabled",i.state().technicalReplicates<=1),p(2),I("ngModel",i.state().technicalReplicates),p(),I("disabled",i.state().technicalReplicates>=10),p(2),S(i.state().technicalReplicates>1?37:-1),p(7),B("active",i.state().acquisitionMethod==="dda"),p(2),B("active",i.state().acquisitionMethod==="dia"),p(10),P(i.wizardState.sampleCount()),p(7),P(i.state().hasFractions?i.state().fractionCount:1),p(7),P(i.state().technicalReplicates),p(),S(i.isMultiplexed()?71:-1),p(7),P(i.totalRows()),p(),S(i.wizardState.isStep4Valid()?-1:79)}},dependencies:[te,ce,ye,tn,Me,nn,Rn,xe],styles:[".step-container[_ngcontent-%COMP%]{max-width:700px}.step-header[_ngcontent-%COMP%]{margin-bottom:24px}.step-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;font-size:18px;font-weight:600;color:#1f2937}.step-description[_ngcontent-%COMP%]{margin:0;color:#6b7280;font-size:14px}.form-section[_ngcontent-%COMP%]{margin-bottom:32px}.form-label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#374151;margin-bottom:12px}.help-text[_ngcontent-%COMP%]{display:block;font-size:12px;font-weight:400;color:#6b7280;margin-top:4px}.label-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-bottom:16px}.label-card[_ngcontent-%COMP%]{position:relative;padding:16px;background:#fff;border:2px solid #e5e7eb;border-radius:10px;cursor:pointer;text-align:left;transition:all .15s}.label-card[_ngcontent-%COMP%]:hover{border-color:#d1d5db;background:#f9fafb}.label-card.selected[_ngcontent-%COMP%]{border-color:#3b82f6;background:#eff6ff}.label-name[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#1f2937;margin-bottom:4px}.label-count[_ngcontent-%COMP%]{font-size:12px;color:#6b7280}.selected-badge[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px;width:20px;height:20px;border-radius:50%;background:#3b82f6;color:#fff;display:flex;align-items:center;justify-content:center;font-size:12px}.selected-labels[_ngcontent-%COMP%]{padding:12px;background:#f3f4f6;border-radius:8px}.labels-title[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;margin-right:8px}.labels-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:6px;margin-top:8px}.label-tag[_ngcontent-%COMP%]{padding:4px 8px;background:#fff;border:1px solid #d1d5db;border-radius:4px;font-size:11px;color:#374151}.toggle-group[_ngcontent-%COMP%]{display:flex;background:#f3f4f6;border-radius:8px;padding:4px;width:fit-content}.toggle-btn[_ngcontent-%COMP%]{padding:10px 20px;border:none;background:transparent;border-radius:6px;font-size:14px;color:#6b7280;cursor:pointer;transition:all .15s}.toggle-btn.active[_ngcontent-%COMP%]{background:#fff;color:#1f2937;font-weight:500;box-shadow:0 1px 3px #0000001a}.fraction-config[_ngcontent-%COMP%]{margin-top:16px;padding:16px;background:#f9fafb;border-radius:8px}.sub-label[_ngcontent-%COMP%]{display:block;font-size:13px;color:#374151;margin-bottom:8px}.number-input-group[_ngcontent-%COMP%]{display:flex;align-items:center;width:fit-content}.number-btn[_ngcontent-%COMP%]{width:36px;height:36px;border:1px solid #d1d5db;background:#fff;font-size:18px;cursor:pointer;transition:all .15s}.number-btn[_ngcontent-%COMP%]:first-child{border-radius:6px 0 0 6px}.number-btn[_ngcontent-%COMP%]:last-child{border-radius:0 6px 6px 0}.number-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#f3f4f6}.number-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.number-input[_ngcontent-%COMP%]{width:60px;height:36px;border:1px solid #d1d5db;border-left:none;border-right:none;text-align:center;font-size:14px;font-weight:500}.number-input[_ngcontent-%COMP%]:focus{outline:none}.quick-presets[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-top:12px}.preset-label[_ngcontent-%COMP%]{font-size:12px;color:#6b7280}.preset-btn[_ngcontent-%COMP%]{padding:4px 12px;background:#fff;border:1px solid #d1d5db;border-radius:4px;font-size:12px;cursor:pointer;transition:all .15s}.preset-btn[_ngcontent-%COMP%]:hover{background:#f3f4f6;border-color:#9ca3af}.info-note[_ngcontent-%COMP%]{margin-top:8px;font-size:13px;color:#6b7280}.summary-section[_ngcontent-%COMP%]{margin-top:32px;padding:20px;background:#f0fdf4;border:1px solid #bbf7d0;border-radius:10px}.summary-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 16px;font-size:14px;font-weight:600;color:#166534}.summary-grid[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;flex-wrap:wrap}.summary-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:8px 12px;background:#fff;border-radius:6px;min-width:60px}.summary-item.total[_ngcontent-%COMP%]{background:#166534}.summary-item.total[_ngcontent-%COMP%]   .summary-label[_ngcontent-%COMP%], .summary-item.total[_ngcontent-%COMP%]   .summary-value[_ngcontent-%COMP%]{color:#fff}.summary-label[_ngcontent-%COMP%]{font-size:11px;color:#6b7280}.summary-value[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#1f2937}.summary-operator[_ngcontent-%COMP%]{font-size:18px;color:#6b7280}.validation-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 16px;background:#fef3c7;border:1px solid #fcd34d;border-radius:8px;font-size:13px;color:#92400e;margin-top:24px}.warning-icon[_ngcontent-%COMP%]{width:20px;height:20px;border-radius:50%;background:#f59e0b;color:#fff;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700}@media (max-width: 600px){.label-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.summary-grid[_ngcontent-%COMP%]{justify-content:center}}"],changeDetection:0})};var UM=(n,e)=>e.msAccession,wp=(n,e)=>e.name,qM=(n,e)=>e.id;function WM(n,e){if(n&1){let t=N();c(0,"button",23),_("click",function(){let o=v(t).$implicit,r=m(2);return y(r.selectInstrument(o))}),c(1,"span",24),d(2),l(),c(3,"span",25),d(4),l()()}if(n&2){let t=e.$implicit;p(2),P(t.label),p(2),P(t.id)}}function GM(n,e){if(n&1&&(c(0,"div",9),z(1,WM,5,2,"button",22,qM),l()),n&2){let t=m();p(),$(t.instrumentResults())}}function QM(n,e){if(n&1){let t=N();c(0,"div",10)(1,"span",26),d(2),l(),c(3,"span",27),d(4),l(),c(5,"button",28),_("click",function(){v(t);let o=m();return y(o.clearInstrument())}),d(6,"\xD7"),l()()}if(n&2){let t=m();p(2),P(t.state().instrument.label),p(2),P(t.state().instrument.id)}}function YM(n,e){if(n&1){let t=N();c(0,"button",29),_("click",function(){let o=v(t).$implicit,r=m();return y(r.selectCleavageAgent(o))}),c(1,"div",30),d(2),l(),c(3,"div",31),d(4),l()()}if(n&2){let t,i=e.$implicit,o=m();B("selected",((t=o.state().cleavageAgent)==null?null:t.msAccession)===i.msAccession),p(2),P(i.name),p(2),P(i.msAccession)}}function KM(n,e){if(n&1&&(c(0,"div",10)(1,"span",26),d(2),l(),c(3,"span",27),d(4),l()()),n&2){let t=m();p(2),P(t.state().cleavageAgent.name),p(2),P(t.state().cleavageAgent.msAccession)}}function ZM(n,e){if(n&1){let t=N();c(0,"button",32),_("click",function(){let o=v(t).$implicit,r=m();return y(r.toggleModification(o))}),d(1),l()}if(n&2){let t=e.$implicit,i=m();B("selected",i.isModSelected(t)),p(),ve(" ",t.name," (",t.targetAminoAcids,") ")}}function JM(n,e){if(n&1){let t=N();c(0,"button",32),_("click",function(){let o=v(t).$implicit,r=m();return y(r.toggleModification(o))}),d(1),l()}if(n&2){let t=e.$implicit,i=m();B("selected",i.isModSelected(t)),p(),ve(" ",t.name," (",t.targetAminoAcids,") ")}}function XM(n,e){if(n&1){let t=N();c(0,"div",35)(1,"span",36),d(2),l(),c(3,"span",37),d(4),l(),c(5,"span",38),d(6),l(),c(7,"button",39),_("click",function(){let o=v(t).$index,r=m(2);return y(r.removeModification(o))}),d(8,"\xD7"),l()()}if(n&2){let t=e.$implicit;B("fixed",t.type==="fixed"),p(2),P(t.type),p(2),P(t.name),p(2),j("(",t.targetAminoAcids,")")}}function eD(n,e){if(n&1&&(c(0,"div",20)(1,"h4"),d(2,"Selected Modifications"),l(),c(3,"div",33),z(4,XM,9,5,"div",34,wp),l()()),n&2){let t=m();p(4),$(t.state().modifications)}}function tD(n,e){n&1&&(c(0,"div",21)(1,"span",40),d(2,"!"),l(),d(3," Please select an instrument and cleavage agent to continue. "),l())}var Ml=class n{aiEnabled=!1;wizardState=q(at);ols=Do;state=this.wizardState.state;cleavageAgents=N0;fixedMods=vp.filter(e=>e.type==="fixed");variableMods=vp.filter(e=>e.type==="variable");instrumentSearch=w("");instrumentResults=w([]);showInstrumentResults=w(!1);searchInstrument(e){return k(this,null,function*(){if(this.instrumentSearch.set(e),e.length<2){this.instrumentResults.set([]);return}try{let t=yield this.ols.searchInstrument(e);this.instrumentResults.set(t.map(i=>({id:i.id,label:i.label,ontology:i.ontologyPrefix?.toUpperCase()||"MS"}))),this.showInstrumentResults.set(!0)}catch{this.instrumentResults.set([])}})}selectInstrument(e){this.wizardState.setInstrument(e),this.instrumentSearch.set(""),this.instrumentResults.set([]),this.showInstrumentResults.set(!1)}selectQuickInstrument(e,t){this.selectInstrument({id:t,label:e,ontology:"MS"})}clearInstrument(){this.wizardState.setInstrument(null)}selectCleavageAgent(e){this.wizardState.setCleavageAgent(e)}isModSelected(e){return this.state().modifications.some(t=>t.name===e.name)}toggleModification(e){if(this.isModSelected(e)){let t=this.state().modifications.findIndex(i=>i.name===e.name);t>=0&&this.wizardState.removeModification(t)}else this.wizardState.addModification(e)}removeModification(e){this.wizardState.removeModification(e)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ee({type:n,selectors:[["wizard-instrument-protocol"]],inputs:{aiEnabled:"aiEnabled"},decls:62,vars:6,consts:[[1,"step-container"],[1,"step-header"],[1,"step-description"],[1,"form-section"],[1,"form-label"],[1,"required"],[1,"help-text"],[1,"autocomplete-container"],["type","text","placeholder","Search for instrument...",1,"form-input",3,"ngModelChange","focus","ngModel"],[1,"autocomplete-dropdown"],[1,"selected-value"],[1,"quick-select"],[1,"quick-label"],[1,"quick-btn",3,"click"],[1,"enzyme-grid"],[1,"enzyme-card",3,"selected"],[1,"mod-section"],[1,"mod-description"],[1,"mod-grid"],[1,"mod-btn",3,"selected"],[1,"selected-mods"],[1,"validation-message"],[1,"autocomplete-option"],[1,"autocomplete-option",3,"click"],[1,"option-label"],[1,"option-id"],[1,"selected-label"],[1,"selected-id"],[1,"btn-clear",3,"click"],[1,"enzyme-card",3,"click"],[1,"enzyme-name"],[1,"enzyme-id"],[1,"mod-btn",3,"click"],[1,"mod-list"],[1,"mod-tag",3,"fixed"],[1,"mod-tag"],[1,"mod-type"],[1,"mod-name"],[1,"mod-site"],[1,"mod-remove",3,"click"],[1,"warning-icon"]],template:function(t,i){t&1&&(c(0,"div",0)(1,"div",1)(2,"h3"),d(3,"Instrument & Protocol"),l(),c(4,"p",2),d(5," Configure the mass spectrometer, enzyme, and post-translational modifications. "),l()(),c(6,"div",3)(7,"label",4),d(8," Mass Spectrometer "),c(9,"span",5),d(10,"*"),l(),c(11,"span",6),d(12,"Select the instrument used for analysis"),l()(),c(13,"div",7)(14,"input",8),_("ngModelChange",function(r){return i.searchInstrument(r)})("focus",function(){return i.showInstrumentResults.set(!0)}),l(),x(15,GM,3,0,"div",9),l(),x(16,QM,7,2,"div",10),c(17,"div",11)(18,"span",12),d(19,"Common:"),l(),c(20,"button",13),_("click",function(){return i.selectQuickInstrument("Q Exactive","MS:1001911")}),d(21,"Q Exactive"),l(),c(22,"button",13),_("click",function(){return i.selectQuickInstrument("Orbitrap Fusion","MS:1002416")}),d(23,"Orbitrap Fusion"),l(),c(24,"button",13),_("click",function(){return i.selectQuickInstrument("Orbitrap Exploris 480","MS:1003028")}),d(25,"Exploris 480"),l(),c(26,"button",13),_("click",function(){return i.selectQuickInstrument("timsTOF Pro","MS:1003005")}),d(27,"timsTOF Pro"),l()()(),c(28,"div",3)(29,"label",4),d(30," Cleavage Agent / Enzyme "),c(31,"span",5),d(32,"*"),l(),c(33,"span",6),d(34,"Enzyme used for protein digestion"),l()(),c(35,"div",14),z(36,YM,5,4,"button",15,UM),l(),x(38,KM,5,2,"div",10),l(),c(39,"div",3)(40,"label",4),d(41," Post-Translational Modifications "),c(42,"span",6),d(43,"Select fixed and variable modifications (optional)"),l()(),c(44,"div",16)(45,"h4"),d(46,"Fixed Modifications"),l(),c(47,"p",17),d(48,"Applied to all occurrences of the residue"),l(),c(49,"div",18),z(50,ZM,2,4,"button",19,wp),l()(),c(52,"div",16)(53,"h4"),d(54,"Variable Modifications"),l(),c(55,"p",17),d(56,"May or may not be present on peptides"),l(),c(57,"div",18),z(58,JM,2,4,"button",19,wp),l()(),x(60,eD,6,0,"div",20),l(),x(61,tD,4,0,"div",21),l()),t&2&&(p(14),I("ngModel",i.instrumentSearch()),p(),S(i.showInstrumentResults()&&i.instrumentResults().length>0?15:-1),p(),S(i.state().instrument?16:-1),p(20),$(i.cleavageAgents),p(2),S(i.state().cleavageAgent?38:-1),p(12),$(i.fixedMods),p(8),$(i.variableMods),p(2),S(i.state().modifications.length>0?60:-1),p(),S(i.wizardState.isStep5Valid()?-1:61))},dependencies:[te,ce,ye,Me,xe],styles:[".step-container[_ngcontent-%COMP%]{max-width:700px}.step-header[_ngcontent-%COMP%]{margin-bottom:24px}.step-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;font-size:18px;font-weight:600;color:#1f2937}.step-description[_ngcontent-%COMP%]{margin:0;color:#6b7280;font-size:14px}.form-section[_ngcontent-%COMP%]{margin-bottom:32px}.form-label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#374151;margin-bottom:12px}.required[_ngcontent-%COMP%]{color:#ef4444;margin-left:4px}.help-text[_ngcontent-%COMP%]{display:block;font-size:12px;font-weight:400;color:#6b7280;margin-top:4px}.form-input[_ngcontent-%COMP%]{width:100%;padding:10px 12px;border:1px solid #d1d5db;border-radius:8px;font-size:14px;transition:border-color .15s,box-shadow .15s}.form-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.autocomplete-container[_ngcontent-%COMP%]{position:relative}.autocomplete-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;right:0;background:#fff;border:1px solid #d1d5db;border-radius:8px;box-shadow:0 10px 25px #00000026;max-height:200px;overflow-y:auto;z-index:100;margin-top:4px}.autocomplete-option[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;width:100%;padding:10px 12px;border:none;background:none;text-align:left;cursor:pointer;transition:background .15s}.autocomplete-option[_ngcontent-%COMP%]:hover{background:#f3f4f6}.option-label[_ngcontent-%COMP%]{font-size:14px;color:#1f2937}.option-id[_ngcontent-%COMP%]{font-size:12px;color:#6b7280}.selected-value[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-top:8px;padding:8px 12px;background:#eff6ff;border:1px solid #bfdbfe;border-radius:6px}.selected-label[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#1e40af}.selected-id[_ngcontent-%COMP%]{font-size:12px;color:#3b82f6}.btn-clear[_ngcontent-%COMP%]{margin-left:auto;background:none;border:none;font-size:18px;color:#6b7280;cursor:pointer;padding:0 4px}.btn-clear[_ngcontent-%COMP%]:hover{color:#ef4444}.quick-select[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-top:12px;flex-wrap:wrap}.quick-label[_ngcontent-%COMP%]{font-size:12px;color:#6b7280}.quick-btn[_ngcontent-%COMP%]{padding:6px 12px;background:#f3f4f6;border:1px solid #e5e7eb;border-radius:4px;font-size:12px;color:#374151;cursor:pointer;transition:all .15s}.quick-btn[_ngcontent-%COMP%]:hover{background:#e5e7eb;border-color:#d1d5db}.enzyme-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}.enzyme-card[_ngcontent-%COMP%]{padding:12px;background:#fff;border:2px solid #e5e7eb;border-radius:8px;cursor:pointer;text-align:left;transition:all .15s}.enzyme-card[_ngcontent-%COMP%]:hover{border-color:#d1d5db;background:#f9fafb}.enzyme-card.selected[_ngcontent-%COMP%]{border-color:#3b82f6;background:#eff6ff}.enzyme-name[_ngcontent-%COMP%]{font-size:13px;font-weight:600;color:#1f2937}.enzyme-id[_ngcontent-%COMP%]{font-size:11px;color:#6b7280;margin-top:2px}.mod-section[_ngcontent-%COMP%]{margin-top:16px;padding:16px;background:#f9fafb;border-radius:8px}.mod-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 4px;font-size:13px;font-weight:600;color:#374151}.mod-description[_ngcontent-%COMP%]{margin:0 0 12px;font-size:12px;color:#6b7280}.mod-grid[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px}.mod-btn[_ngcontent-%COMP%]{padding:8px 12px;background:#fff;border:1px solid #d1d5db;border-radius:6px;font-size:12px;color:#374151;cursor:pointer;transition:all .15s}.mod-btn[_ngcontent-%COMP%]:hover{background:#f3f4f6;border-color:#9ca3af}.mod-btn.selected[_ngcontent-%COMP%]{background:#dbeafe;border-color:#3b82f6;color:#1e40af}.selected-mods[_ngcontent-%COMP%]{margin-top:16px;padding:12px;background:#f0fdf4;border:1px solid #bbf7d0;border-radius:8px}.selected-mods[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;font-size:13px;font-weight:600;color:#166534}.mod-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px}.mod-tag[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:6px 10px;background:#fff;border:1px solid #d1d5db;border-radius:6px}.mod-tag.fixed[_ngcontent-%COMP%]{background:#fef3c7;border-color:#fcd34d}.mod-type[_ngcontent-%COMP%]{font-size:10px;text-transform:uppercase;font-weight:600;color:#6b7280}.mod-name[_ngcontent-%COMP%]{font-size:12px;font-weight:500;color:#1f2937}.mod-site[_ngcontent-%COMP%]{font-size:11px;color:#6b7280}.mod-remove[_ngcontent-%COMP%]{background:none;border:none;font-size:14px;color:#9ca3af;cursor:pointer;padding:0 2px;margin-left:4px}.mod-remove[_ngcontent-%COMP%]:hover{color:#ef4444}.validation-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 16px;background:#fef3c7;border:1px solid #fcd34d;border-radius:8px;font-size:13px;color:#92400e;margin-top:24px}.warning-icon[_ngcontent-%COMP%]{width:20px;height:20px;border-radius:50%;background:#f59e0b;color:#fff;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700}@media (max-width: 600px){.enzyme-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}"],changeDetection:0})};var nD=(n,e)=>e.index;function iD(n,e){n&1&&(c(0,"th"),d(1,"Fraction"),l())}function oD(n,e){n&1&&(c(0,"th"),d(1,"Tech. Rep."),l())}function rD(n,e){n&1&&(c(0,"th"),d(1,"Label"),l())}function sD(n,e){if(n&1&&(c(0,"td"),d(1),l()),n&2){let t=m().$implicit;p(),P(t.fractionId||"-")}}function aD(n,e){if(n&1&&(c(0,"td"),d(1),l()),n&2){let t=m().$implicit;p(),P(t.technicalReplicate||"-")}}function lD(n,e){if(n&1&&(c(0,"td"),d(1),l()),n&2){let t=m().$implicit;p(),P(t.label||"-")}}function cD(n,e){if(n&1){let t=N();c(0,"tr")(1,"td")(2,"input",27),_("ngModelChange",function(o){let r=v(t).$index,s=m(2);return y(s.updateFile(r,"fileName",o))}),l()(),c(3,"td"),d(4),l(),x(5,sD,2,1,"td"),x(6,aD,2,1,"td"),x(7,lD,2,1,"td"),c(8,"td",25)(9,"button",28),_("click",function(){let o=v(t).$index,r=m(2);return y(r.removeFile(o))}),d(10,"\xD7"),l()()()}if(n&2){let t=e.$implicit,i=m(2);p(2),I("ngModel",t.fileName),p(2),P(i.getSampleName(t.sampleIndex)),p(),S(i.hasFractions()?5:-1),p(),S(i.hasTechReplicates()?6:-1),p(),S(i.hasLabels()?7:-1)}}function dD(n,e){if(n&1){let t=N();c(0,"div",26),d(1),c(2,"button",29),_("click",function(){v(t);let o=m(2);return y(o.showAll.set(!0))}),d(3,"Show all"),l()()}if(n&2){let t=m(2);p(),ve(" Showing ",t.maxDisplayed," of ",t.state().dataFiles.length," files. ")}}function uD(n,e){if(n&1){let t=N();c(0,"div",13)(1,"div",21)(2,"h4"),d(3),l(),c(4,"button",22),_("click",function(){v(t);let o=m();return y(o.clearFiles())}),d(5,"Clear all"),l()(),c(6,"div",23)(7,"table",24)(8,"thead")(9,"tr")(10,"th"),d(11,"File Name"),l(),c(12,"th"),d(13,"Sample"),l(),x(14,iD,2,0,"th"),x(15,oD,2,0,"th"),x(16,rD,2,0,"th"),re(17,"th",25),l()(),c(18,"tbody"),z(19,cD,11,5,"tr",null,Ve),l()()(),x(21,dD,4,2,"div",26),l()}if(n&2){let t=m();p(3),j("Data Files (",t.state().dataFiles.length,")"),p(11),S(t.hasFractions()?14:-1),p(),S(t.hasTechReplicates()?15:-1),p(),S(t.hasLabels()?16:-1),p(3),$(t.displayedFiles()),p(2),S(t.state().dataFiles.length>t.maxDisplayed?21:-1)}}function pD(n,e){if(n&1&&(c(0,"option",18),d(1),l()),n&2){let t=e.$implicit;I("ngValue",t.index),p(),P(t.sourceName)}}function fD(n,e){n&1&&(c(0,"div",20)(1,"span",30),d(2,"!"),l(),d(3," At least one data file is required. Use auto-generate or add files manually. "),l())}var Dl=class n{aiEnabled=!1;wizardState=q(at);state=this.wizardState.state;maxDisplayed=20;showAll=w(!1);newFileName="";newSampleIndex=1;displayedFiles=A(()=>{let e=this.state().dataFiles;return this.showAll()||e.length<=this.maxDisplayed?e:e.slice(0,this.maxDisplayed)});hasFractions(){return this.state().hasFractions}hasTechReplicates(){return this.state().technicalReplicates>1}hasLabels(){let e=wt.find(t=>t.id===this.state().labelConfigId);return e?e.id!=="lf":!1}expectedFileCount(){let e=this.state(),t=e.sampleCount,i=e.hasFractions?e.fractionCount:1,o=e.technicalReplicates,r=wt.find(a=>a.id===e.labelConfigId),s=r?.id==="lf"?1:r?.labels.length||1;return t*i*o*s}getSampleName(e){return this.wizardState.samples().find(i=>i.index===e)?.sourceName||`Sample ${e}`}setPattern(e){this.wizardState.setFileNamingPattern(e)}autoGenerate(){this.wizardState.autoGenerateDataFiles()}clearFiles(){this.wizardState.setDataFiles([]),this.showAll.set(!1)}updateFile(e,t,i){let o=[...this.state().dataFiles];e>=0&&e<o.length&&(o[e]=O(E({},o[e]),{[t]:i}),this.wizardState.setDataFiles(o))}removeFile(e){let t=this.state().dataFiles.filter((i,o)=>o!==e);this.wizardState.setDataFiles(t)}addFile(){if(!this.newFileName.trim())return;let e={fileName:this.newFileName.trim(),sampleIndex:this.newSampleIndex},t=[...this.state().dataFiles,e];this.wizardState.setDataFiles(t),this.newFileName=""}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ee({type:n,selectors:[["wizard-data-files"]],inputs:{aiEnabled:"aiEnabled"},decls:38,vars:30,consts:[[1,"step-container"],[1,"step-header"],[1,"step-description"],[1,"form-section"],[1,"form-label"],[1,"help-text"],["type","text",1,"form-input",3,"ngModelChange","ngModel","placeholder"],[1,"pattern-examples"],[1,"examples-label"],[1,"pattern-btn",3,"click"],[1,"generate-section"],[1,"generate-btn",3,"click"],[1,"generate-info"],[1,"files-section"],[1,"manual-add"],[1,"add-row"],["type","text","placeholder","Enter file name...",1,"form-input",3,"ngModelChange","ngModel"],[1,"form-select",3,"ngModelChange","ngModel"],[3,"ngValue"],[1,"add-btn",3,"click","disabled"],[1,"validation-message"],[1,"files-header"],[1,"clear-btn",3,"click"],[1,"files-table-container"],[1,"files-table"],[1,"col-actions"],[1,"more-files"],["type","text",1,"cell-input",3,"ngModelChange","ngModel"],[1,"remove-btn",3,"click"],[1,"show-more-btn",3,"click"],[1,"warning-icon"]],template:function(t,i){t&1&&(c(0,"div",0)(1,"div",1)(2,"h3"),d(3,"Data Files"),l(),c(4,"p",2),d(5," Specify how your data files are named and map them to samples. "),l()(),c(6,"div",3)(7,"label",4),d(8," File Naming Pattern "),c(9,"span",5),d(10),l()(),c(11,"input",6),_("ngModelChange",function(r){return i.wizardState.setFileNamingPattern(r)}),l(),c(12,"div",7)(13,"span",8),d(14,"Examples:"),l(),c(15,"button",9),_("click",function(){return i.setPattern("{sourceName}.raw")}),d(16),l(),c(17,"button",9),_("click",function(){return i.setPattern("sample_{n}_F{fraction}.raw")}),d(18),l(),c(19,"button",9),_("click",function(){return i.setPattern("{sourceName}_{fraction}_{replicate}.raw")}),d(20),l()()(),c(21,"div",10)(22,"button",11),_("click",function(){return i.autoGenerate()}),d(23," Auto-generate Files from Pattern "),l(),c(24,"span",12),d(25),l()(),x(26,uD,22,5,"div",13),c(27,"div",14)(28,"h4"),d(29,"Or add files manually"),l(),c(30,"div",15)(31,"input",16),ft("ngModelChange",function(r){return vt(i.newFileName,r)||(i.newFileName=r),r}),l(),c(32,"select",17),ft("ngModelChange",function(r){return vt(i.newSampleIndex,r)||(i.newSampleIndex=r),r}),z(33,pD,2,2,"option",18,nD),l(),c(35,"button",19),_("click",function(){return i.addFile()}),d(36," Add File "),l()()(),x(37,fD,4,0,"div",20),l()),t&2&&(p(10),Aa([" Use placeholders: ","{","sourceName","}",", ","{","n","}"," (sample number), ","{","fraction","}",", ","{","replicate","}",", ","{","label","}"," "]),p(),I("ngModel",i.state().fileNamingPattern)("placeholder","{sourceName}.raw"),p(5),ve("","{","sourceName","}",".raw"),p(2),Pa("sample_","{","n","}","_F","{","fraction","}",".raw"),p(2),Oa("","{","sourceName","}","_","{","fraction","}","_","{","replicate","}",".raw"),p(5),j(" Will create ",i.expectedFileCount()," file entries based on your configuration "),p(),S(i.state().dataFiles.length>0?26:-1),p(5),pt("ngModel",i.newFileName),p(),pt("ngModel",i.newSampleIndex),p(),$(i.wizardState.samples()),p(2),I("disabled",!i.newFileName.trim()),p(2),S(i.wizardState.isStep6Valid()?-1:37))},dependencies:[te,ce,Ue,qe,ye,st,Me,xe],styles:[".step-container[_ngcontent-%COMP%]{max-width:800px}.step-header[_ngcontent-%COMP%]{margin-bottom:24px}.step-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;font-size:18px;font-weight:600;color:#1f2937}.step-description[_ngcontent-%COMP%]{margin:0;color:#6b7280;font-size:14px}.form-section[_ngcontent-%COMP%]{margin-bottom:24px}.form-label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#374151;margin-bottom:8px}.help-text[_ngcontent-%COMP%]{display:block;font-size:12px;font-weight:400;color:#6b7280;margin-top:4px}.form-input[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{width:100%;padding:10px 12px;border:1px solid #d1d5db;border-radius:8px;font-size:14px;transition:border-color .15s,box-shadow .15s}.form-input[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.pattern-examples[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-top:8px;flex-wrap:wrap}.examples-label[_ngcontent-%COMP%]{font-size:12px;color:#6b7280}.pattern-btn[_ngcontent-%COMP%]{padding:4px 10px;background:#f3f4f6;border:1px solid #e5e7eb;border-radius:4px;font-size:11px;font-family:monospace;color:#374151;cursor:pointer;transition:all .15s}.pattern-btn[_ngcontent-%COMP%]:hover{background:#e5e7eb;border-color:#d1d5db}.generate-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;margin-bottom:24px;padding:16px;background:#f0fdf4;border:1px solid #bbf7d0;border-radius:8px}.generate-btn[_ngcontent-%COMP%]{padding:10px 20px;background:#10b981;border:none;border-radius:6px;font-size:14px;font-weight:500;color:#fff;cursor:pointer;transition:background .15s}.generate-btn[_ngcontent-%COMP%]:hover{background:#059669}.generate-info[_ngcontent-%COMP%]{font-size:13px;color:#166534}.files-section[_ngcontent-%COMP%]{margin-bottom:24px}.files-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.files-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-size:14px;font-weight:600;color:#374151}.clear-btn[_ngcontent-%COMP%]{padding:4px 10px;background:none;border:1px solid #d1d5db;border-radius:4px;font-size:12px;color:#6b7280;cursor:pointer}.clear-btn[_ngcontent-%COMP%]:hover{background:#fef2f2;border-color:#fca5a5;color:#dc2626}.files-table-container[_ngcontent-%COMP%]{border:1px solid #e5e7eb;border-radius:8px;overflow:hidden;max-height:400px;overflow-y:auto}.files-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.files-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .files-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 12px;border-bottom:1px solid #e5e7eb;text-align:left;font-size:13px}.files-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f9fafb;font-weight:600;color:#6b7280;text-transform:uppercase;font-size:11px;letter-spacing:.05em;position:sticky;top:0}.files-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#f9fafb}.col-actions[_ngcontent-%COMP%]{width:40px;text-align:center}.cell-input[_ngcontent-%COMP%]{width:100%;padding:6px 8px;border:1px solid transparent;border-radius:4px;font-size:13px;font-family:monospace;background:transparent}.cell-input[_ngcontent-%COMP%]:hover{border-color:#d1d5db}.cell-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;background:#fff}.remove-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:16px;color:#9ca3af;cursor:pointer;padding:4px}.remove-btn[_ngcontent-%COMP%]:hover{color:#ef4444}.more-files[_ngcontent-%COMP%]{padding:12px;background:#f3f4f6;text-align:center;font-size:13px;color:#6b7280;border-top:1px solid #e5e7eb}.show-more-btn[_ngcontent-%COMP%]{background:none;border:none;color:#3b82f6;cursor:pointer;font-size:13px;margin-left:8px}.show-more-btn[_ngcontent-%COMP%]:hover{text-decoration:underline}.manual-add[_ngcontent-%COMP%]{margin-bottom:24px;padding:16px;background:#f9fafb;border-radius:8px}.manual-add[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;font-size:14px;font-weight:500;color:#374151}.add-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr auto auto;gap:8px;align-items:center}.add-row[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]{width:180px}.add-btn[_ngcontent-%COMP%]{padding:10px 16px;background:#3b82f6;border:none;border-radius:6px;font-size:14px;color:#fff;cursor:pointer;transition:background .15s}.add-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#2563eb}.add-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.validation-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 16px;background:#fef3c7;border:1px solid #fcd34d;border-radius:8px;font-size:13px;color:#92400e}.warning-icon[_ngcontent-%COMP%]{width:20px;height:20px;border-radius:50%;background:#f59e0b;color:#fff;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700}@media (max-width: 600px){.add-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.add-row[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]{width:100%}}"],changeDetection:0})};var mD=(n,e)=>e.columnPosition;function gD(n,e){if(n&1&&(L(0,"th"),d(1),V()),n&2){let t=e.$implicit;p(),P(t.name)}}function hD(n,e){if(n&1&&(L(0,"td"),d(1),V()),n&2){let t=e.$implicit;p(),P(t)}}function _D(n,e){if(n&1&&(L(0,"tr"),z(1,hD,2,1,"td",null,Ve),V()),n&2){let t=e.$implicit;p(),$(t)}}function CD(n,e){if(n&1&&(L(0,"tr",19)(1,"td"),d(2),V()()),n&2){let t=m(),i=m();p(),Cn("colspan",t.columns.length),p(),j(" ... and ",i.previewTable().sampleCount-5," more rows ")}}function vD(n,e){if(n&1&&(L(0,"table",16)(1,"thead")(2,"tr"),z(3,gD,2,1,"th",null,mD),V()(),L(5,"tbody"),z(6,_D,3,0,"tr",null,Ve),x(8,CD,3,2,"tr",19),V()()),n&2){let t=m();p(3),$(e.columns),p(3),$(t.previewRows()),p(2),S(t.previewTable().sampleCount>5?8:-1)}}function yD(n,e){n&1&&(L(0,"div",17),d(1," Complete all required steps to preview the SDRF. "),V())}function bD(n,e){n&1&&(L(0,"span",20),d(1,"\u2713"),V(),L(2,"span"),d(3,"All required fields are complete. Ready to create SDRF!"),V())}function xD(n,e){n&1&&(L(0,"span",20),d(1,"!"),V(),L(2,"span"),d(3,"Please complete all required steps before creating."),V())}var Tl=class n{aiEnabled=!1;createTable=new W;wizardState=q(at);generator=q(Ao);state=this.wizardState.state;previewTable=A(()=>{try{return this.generator.generate(this.state())}catch{return null}});previewRows=A(()=>{let e=this.previewTable();return e?Vr(e).slice(0,5):[]});templateName=A(()=>{let e=this.state().template;return hl.find(i=>i.id===e)?.name||"Not selected"});templateIcon=A(()=>{switch(this.state().template){case"human":return"\u{1F9D1}";case"cell-line":return"\u{1F9EB}";case"vertebrate":return"\u{1F42D}";case"other":return"\u{1F9EC}";default:return"?"}});labelConfigName=A(()=>{let e=this.state().labelConfigId;return wt.find(i=>i.id===e)?.name||"Unknown"});getDiseaseLabel(){let e=this.state().disease;return e?typeof e=="string"?e:e.label:"Not set"}onCreate(){let e=this.previewTable();e&&this.createTable.emit(e)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ee({type:n,selectors:[["wizard-review-create"]],inputs:{aiEnabled:"aiEnabled"},outputs:{createTable:"createTable"},decls:92,vars:19,consts:[[1,"step-container"],[1,"step-header"],[1,"step-description"],[1,"summary-grid"],[1,"summary-card"],[1,"summary-icon"],[1,"summary-content"],[1,"summary-label"],[1,"summary-value"],[1,"config-summary"],[1,"config-grid"],[1,"config-item"],[1,"config-label"],[1,"config-value"],[1,"preview-section"],[1,"table-preview-container"],[1,"preview-table"],[1,"no-preview"],[1,"validation-status"],[1,"more-rows"],[1,"status-icon"]],template:function(t,i){if(t&1&&(L(0,"div",0)(1,"div",1)(2,"h3"),d(3,"Review Your SDRF"),V(),L(4,"p",2),d(5," Preview the generated SDRF table before creating it. "),V()(),L(6,"div",3)(7,"div",4)(8,"div",5),d(9),V(),L(10,"div",6)(11,"span",7),d(12,"Template"),V(),L(13,"span",8),d(14),V()()(),L(15,"div",4)(16,"div",5),d(17,"#"),V(),L(18,"div",6)(19,"span",7),d(20,"Samples"),V(),L(21,"span",8),d(22),V()()(),L(23,"div",4)(24,"div",5),d(25,"C"),V(),L(26,"div",6)(27,"span",7),d(28,"Columns"),V(),L(29,"span",8),d(30),V()()(),L(31,"div",4)(32,"div",5),d(33,"R"),V(),L(34,"div",6)(35,"span",7),d(36,"Rows"),V(),L(37,"span",8),d(38),V()()()(),L(39,"div",9)(40,"h4"),d(41,"Configuration Summary"),V(),L(42,"div",10)(43,"div",11)(44,"span",12),d(45,"Organism:"),V(),L(46,"span",13),d(47),V()(),L(48,"div",11)(49,"span",12),d(50,"Disease:"),V(),L(51,"span",13),d(52),V()(),L(53,"div",11)(54,"span",12),d(55,"Organism Part:"),V(),L(56,"span",13),d(57),V()(),L(58,"div",11)(59,"span",12),d(60,"Label Type:"),V(),L(61,"span",13),d(62),V()(),L(63,"div",11)(64,"span",12),d(65,"Fractions:"),V(),L(66,"span",13),d(67),V()(),L(68,"div",11)(69,"span",12),d(70,"Tech. Replicates:"),V(),L(71,"span",13),d(72),V()(),L(73,"div",11)(74,"span",12),d(75,"Instrument:"),V(),L(76,"span",13),d(77),V()(),L(78,"div",11)(79,"span",12),d(80,"Enzyme:"),V(),L(81,"span",13),d(82),V()()()(),L(83,"div",14)(84,"h4"),d(85,"Table Preview"),V(),L(86,"div",15),x(87,vD,9,1,"table",16)(88,yD,2,0,"div",17),V()(),L(89,"div",18),x(90,bD,4,0)(91,xD,4,0),V()()),t&2){let o,r,s,a,u,f,g;p(9),P(i.templateIcon()),p(5),P(i.templateName()),p(8),P(i.state().sampleCount),p(8),P(((o=i.previewTable())==null||o.columns==null?null:o.columns.length)||0),p(8),P(((r=i.previewTable())==null?null:r.sampleCount)||0),p(9),P(((s=i.state().organism)==null?null:s.label)||"Not set"),p(5),P(i.getDiseaseLabel()),p(5),P(((a=i.state().organismPart)==null?null:a.label)||"Not set"),p(5),P(i.labelConfigName()),p(5),P(i.state().hasFractions?i.state().fractionCount:"None"),p(5),P(i.state().technicalReplicates),p(5),P(((u=i.state().instrument)==null?null:u.label)||"Not set"),p(5),P(((f=i.state().cleavageAgent)==null?null:f.name)||"Not set"),p(5),S((g=i.previewTable())?87:88,g),p(2),B("valid",i.wizardState.isAllValid())("invalid",!i.wizardState.isAllValid()),p(),S(i.wizardState.isAllValid()?90:91)}},dependencies:[te],styles:[".step-container[_ngcontent-%COMP%]{max-width:800px}.step-header[_ngcontent-%COMP%]{margin-bottom:24px}.step-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;font-size:18px;font-weight:600;color:#1f2937}.step-description[_ngcontent-%COMP%]{margin:0;color:#6b7280;font-size:14px}.summary-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-bottom:24px}.summary-card[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:16px;background:#f9fafb;border-radius:10px;border:1px solid #e5e7eb}.summary-icon[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:8px;background:#3b82f6;color:#fff;display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:600}.summary-content[_ngcontent-%COMP%]{display:flex;flex-direction:column}.summary-label[_ngcontent-%COMP%]{font-size:12px;color:#6b7280}.summary-value[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#1f2937}.config-summary[_ngcontent-%COMP%]{margin-bottom:24px;padding:20px;background:#f9fafb;border-radius:10px;border:1px solid #e5e7eb}.config-summary[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 16px;font-size:14px;font-weight:600;color:#374151}.config-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}.config-item[_ngcontent-%COMP%]{display:flex;gap:8px}.config-label[_ngcontent-%COMP%]{font-size:13px;color:#6b7280;min-width:120px}.config-value[_ngcontent-%COMP%]{font-size:13px;color:#1f2937;font-weight:500}.preview-section[_ngcontent-%COMP%]{margin-bottom:24px}.preview-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;font-size:14px;font-weight:600;color:#374151}.table-preview-container[_ngcontent-%COMP%]{border:1px solid #e5e7eb;border-radius:8px;overflow:hidden}.preview-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:12px}.preview-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .preview-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 12px;border-bottom:1px solid #e5e7eb;text-align:left;white-space:nowrap;max-width:200px;overflow:hidden;text-overflow:ellipsis}.preview-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f3f4f6;font-weight:600;color:#374151;position:sticky;top:0}.preview-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#f9fafb}.preview-table[_ngcontent-%COMP%]   .more-rows[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-align:center;color:#6b7280;font-style:italic;background:#f9fafb}.no-preview[_ngcontent-%COMP%]{padding:40px;text-align:center;color:#6b7280}.validation-status[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:16px 20px;border-radius:10px;font-size:14px}.validation-status.valid[_ngcontent-%COMP%]{background:#d1fae5;color:#065f46}.validation-status.invalid[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.status-icon[_ngcontent-%COMP%]{width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:700}.validation-status.valid[_ngcontent-%COMP%]   .status-icon[_ngcontent-%COMP%]{background:#10b981;color:#fff}.validation-status.invalid[_ngcontent-%COMP%]   .status-icon[_ngcontent-%COMP%]{background:#f59e0b;color:#fff}@media (max-width: 600px){.summary-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.config-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"],changeDetection:0})};var SD=(n,e)=>e.id;function wD(n,e){n&1&&(c(0,"span",15),d(1,"\u2713"),l())}function ED(n,e){if(n&1&&d(0),n&2){let t=m().$index;j(" ",t+1," ")}}function MD(n,e){if(n&1&&re(0,"div",18),n&2){let t=m().$index,i=m();B("completed",t<i.wizardState.currentStep())}}function DD(n,e){if(n&1){let t=N();c(0,"button",13),_("click",function(){let o=v(t).$index,r=m();return y(r.goToStep(o))}),c(1,"span",14),x(2,wD,2,0,"span",15)(3,ED,1,1),l(),c(4,"span",16),d(5),l()(),x(6,MD,1,2,"div",17)}if(n&2){let t=e.$implicit,i=e.$index,o=m();B("active",i===o.wizardState.currentStep())("completed",i<o.wizardState.currentStep())("clickable",i<=o.wizardState.currentStep()),I("disabled",i>o.wizardState.currentStep()),p(2),S(i<o.wizardState.currentStep()?2:3),p(3),P(t.title),p(),S(i<o.wizardState.steps.length-1?6:-1)}}function TD(n,e){if(n&1&&re(0,"wizard-experiment-setup",6),n&2){let t=m();I("aiEnabled",t.aiEnabled)("availableTemplates",t.availableTemplates)}}function ID(n,e){if(n&1&&re(0,"wizard-sample-characteristics",7),n&2){let t=m();I("aiEnabled",t.aiEnabled)}}function PD(n,e){if(n&1&&re(0,"wizard-sample-values",7),n&2){let t=m();I("aiEnabled",t.aiEnabled)}}function OD(n,e){if(n&1&&re(0,"wizard-technical-config",7),n&2){let t=m();I("aiEnabled",t.aiEnabled)}}function AD(n,e){if(n&1&&re(0,"wizard-instrument-protocol",7),n&2){let t=m();I("aiEnabled",t.aiEnabled)}}function ND(n,e){if(n&1&&re(0,"wizard-data-files",7),n&2){let t=m();I("aiEnabled",t.aiEnabled)}}function kD(n,e){if(n&1){let t=N();c(0,"wizard-review-create",19),_("createTable",function(o){v(t);let r=m();return y(r.onCreate(o))}),l()}if(n&2){let t=m();I("aiEnabled",t.aiEnabled)}}function RD(n,e){if(n&1){let t=N();c(0,"button",20),_("click",function(){v(t);let o=m();return y(o.wizardState.nextStep())}),d(1," Next "),l()}if(n&2){let t=m();I("disabled",!t.wizardState.canProceed())}}function FD(n,e){if(n&1){let t=N();c(0,"button",21),_("click",function(){v(t);let o=m();return y(o.onCreateClick())}),d(1," Create SDRF "),l()}if(n&2){let t=m();I("disabled",!t.wizardState.canCreate())}}var Il=class n{aiEnabled=!1;availableTemplates=["human","cell-lines","vertebrates","ms-proteomics"];complete=new W;cancel=new W;wizardState=q(at);generator=q(Ao);templateService=q(No);constructor(){this.wizardState.reset()}ngOnInit(){this.templateService.fetchTemplates()}goToStep(e){e<=this.wizardState.currentStep()&&this.wizardState.goToStep(e)}onOverlayClick(e){e.target===e.currentTarget&&this.onCancel()}onCancel(){this.wizardState.reset(),this.cancel.emit()}onCreateClick(){let e=this.generator.generate(this.wizardState.getState());this.onCreate(e)}onCreate(e){this.complete.emit(e),this.wizardState.reset()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ee({type:n,selectors:[["sdrf-wizard"]],inputs:{aiEnabled:"aiEnabled",availableTemplates:"availableTemplates"},outputs:{complete:"complete",cancel:"cancel"},decls:25,vars:5,consts:[[1,"wizard-overlay",3,"click"],[1,"wizard-container",3,"click"],[1,"wizard-header"],["title","Close",1,"btn-close",3,"click"],[1,"wizard-progress"],[1,"wizard-content"],[3,"aiEnabled","availableTemplates"],[3,"aiEnabled"],[1,"wizard-footer"],[1,"btn","btn-secondary",3,"click","disabled"],[1,"step-info"],[1,"btn","btn-primary",3,"disabled"],[1,"btn","btn-primary","btn-create",3,"disabled"],[1,"step-indicator",3,"click","disabled"],[1,"step-number"],[1,"check-icon"],[1,"step-title"],[1,"step-connector",3,"completed"],[1,"step-connector"],[3,"createTable","aiEnabled"],[1,"btn","btn-primary",3,"click","disabled"],[1,"btn","btn-primary","btn-create",3,"click","disabled"]],template:function(t,i){if(t&1&&(c(0,"div",0),_("click",function(r){return i.onOverlayClick(r)}),c(1,"div",1),_("click",function(r){return r.stopPropagation()}),c(2,"div",2)(3,"h2"),d(4,"Create New SDRF"),l(),c(5,"button",3),_("click",function(){return i.onCancel()}),d(6,"\xD7"),l()(),c(7,"div",4),z(8,DD,7,10,null,null,SD),l(),c(10,"div",5),x(11,TD,1,2,"wizard-experiment-setup",6)(12,ID,1,1,"wizard-sample-characteristics",7)(13,PD,1,1,"wizard-sample-values",7)(14,OD,1,1,"wizard-technical-config",7)(15,AD,1,1,"wizard-instrument-protocol",7)(16,ND,1,1,"wizard-data-files",7)(17,kD,1,1,"wizard-review-create",7),l(),c(18,"div",8)(19,"button",9),_("click",function(){return i.wizardState.previousStep()}),d(20," Back "),l(),c(21,"div",10),d(22),l(),x(23,RD,2,1,"button",11)(24,FD,2,1,"button",12),l()()()),t&2){let o;p(8),$(i.wizardState.steps),p(3),S((o=i.wizardState.currentStep())===0?11:o===1?12:o===2?13:o===3?14:o===4?15:o===5?16:o===6?17:-1),p(8),I("disabled",!i.wizardState.canGoBack()),p(3),ve(" Step ",i.wizardState.currentStep()+1," of ",i.wizardState.totalSteps," "),p(),S(i.wizardState.currentStep()<i.wizardState.totalSteps-1?23:24)}},dependencies:[te,xl,Sl,wl,El,Ml,Dl,Tl],styles:[".wizard-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#0009;display:flex;align-items:center;justify-content:center;z-index:1000;animation:_ngcontent-%COMP%_fadeIn .2s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.wizard-container[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 25px 80px #0000004d;width:95%;max-width:900px;max-height:90vh;display:flex;flex-direction:column;animation:_ngcontent-%COMP%_slideUp .25s ease-out}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}.wizard-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px 24px;border-bottom:1px solid #e5e7eb;flex-shrink:0}.wizard-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:20px;font-weight:600;color:#1f2937}.btn-close[_ngcontent-%COMP%]{background:none;border:none;font-size:28px;cursor:pointer;color:#6b7280;padding:0;line-height:1;transition:color .15s}.btn-close[_ngcontent-%COMP%]:hover{color:#374151}.wizard-progress[_ngcontent-%COMP%]{display:flex;align-items:center;padding:20px 24px;background:#f9fafb;border-bottom:1px solid #e5e7eb;flex-shrink:0;overflow-x:auto}.step-indicator[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;background:none;border:none;cursor:default;padding:0;min-width:80px;opacity:.5;transition:opacity .2s}.step-indicator.active[_ngcontent-%COMP%], .step-indicator.completed[_ngcontent-%COMP%]{opacity:1}.step-indicator.clickable[_ngcontent-%COMP%]{cursor:pointer}.step-indicator.clickable[_ngcontent-%COMP%]:hover   .step-number[_ngcontent-%COMP%]{transform:scale(1.1)}.step-number[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;background:#e5e7eb;color:#6b7280;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:600;margin-bottom:6px;transition:all .2s}.step-indicator.active[_ngcontent-%COMP%]   .step-number[_ngcontent-%COMP%]{background:#3b82f6;color:#fff}.step-indicator.completed[_ngcontent-%COMP%]   .step-number[_ngcontent-%COMP%]{background:#10b981;color:#fff}.check-icon[_ngcontent-%COMP%]{font-size:16px}.step-title[_ngcontent-%COMP%]{font-size:11px;color:#6b7280;text-align:center;white-space:nowrap}.step-indicator.active[_ngcontent-%COMP%]   .step-title[_ngcontent-%COMP%]{color:#3b82f6;font-weight:500}.step-indicator.completed[_ngcontent-%COMP%]   .step-title[_ngcontent-%COMP%]{color:#10b981}.step-connector[_ngcontent-%COMP%]{flex:1;height:2px;background:#e5e7eb;margin:0 8px 20px;min-width:20px;transition:background .2s}.step-connector.completed[_ngcontent-%COMP%]{background:#10b981}.wizard-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:24px}.wizard-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 24px;border-top:1px solid #e5e7eb;background:#f9fafb;border-radius:0 0 12px 12px;flex-shrink:0}.step-info[_ngcontent-%COMP%]{font-size:13px;color:#6b7280}.btn[_ngcontent-%COMP%]{padding:10px 24px;border:1px solid #d1d5db;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:all .15s}.btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-primary[_ngcontent-%COMP%]{background:#3b82f6;color:#fff;border-color:#3b82f6}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#2563eb}.btn-secondary[_ngcontent-%COMP%]{background:#fff;color:#374151}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:#f3f4f6}.btn-create[_ngcontent-%COMP%]{background:#10b981;border-color:#10b981}.btn-create[_ngcontent-%COMP%]:hover:not(:disabled){background:#059669}"],changeDetection:0})};var L0=(n,e)=>e.value;function VD(n,e){if(n&1){let t=N();c(0,"div",32),_("click",function(){let o=v(t).$implicit,r=m(2);return y(r.selectValueSamples(o))}),c(1,"div",33)(2,"span",34),d(3),l(),c(4,"span",35),d(5),l()(),c(6,"button",36),_("click",function(o){let r=v(t).$implicit;return m(2).startEditingValue(r),y(o.stopPropagation())}),d(7," Edit "),l()()}if(n&2){let t=e.$implicit;p(3),P(t.value||"(empty)"),p(2),j("",t.sampleCount," samples")}}function LD(n,e){n&1&&(c(0,"div",15),d(1,"No values in this column"),l())}function jD(n,e){if(n&1&&(c(0,"div",16),d(1," Replacing: "),c(2,"strong"),d(3),l(),d(4),l()),n&2){let t=m(2);p(3),P(t.editingValue()),p(),j(" (",t.editingSampleCount()," samples) ")}}function zD(n,e){if(n&1){let t=N();c(0,"sdrf-ontology-input",37),_("valueChange",function(o){v(t);let r=m(2);return y(r.newValue.set(o))})("termSelected",function(o){v(t);let r=m(2);return y(r.onTermSelected(o))}),l()}if(n&2){let t=m(2);I("value",t.newValue())("columnName",t.column().name)("placeholder","Search "+t.getColumnTypeLabel()+"...")}}function $D(n,e){if(n&1){let t=N();c(0,"input",38),_("input",function(o){v(t);let r=m(2);return y(r.newValue.set(o.target.value))}),l()}if(n&2){let t=m(2);I("value",t.newValue())}}function BD(n,e){if(n&1){let t=N();c(0,"div",25)(1,"input",39),_("input",function(o){v(t);let r=m(2);return y(r.rangeStart.set(+o.target.value))}),l(),c(2,"span"),d(3,"to"),l(),c(4,"input",40),_("input",function(o){v(t);let r=m(2);return y(r.rangeEnd.set(+o.target.value))}),l()()}if(n&2){let t=m(2);p(),I("value",t.rangeStart())("min",1)("max",t.table().sampleCount),p(3),I("value",t.rangeEnd())("min",1)("max",t.table().sampleCount)}}function HD(n,e){if(n&1&&(c(0,"p",43),d(1),l()),n&2){let t=m(3);p(),P(t.customSelectionError())}}function UD(n,e){if(n&1&&(c(0,"p",44),d(1),l()),n&2){let t=m(3);p(),ve(" \u2713 ",t.customSelection().length," sample(s) selected: ",t.formatSampleRange(t.customSelection())," ")}}function qD(n,e){if(n&1){let t=N();c(0,"button",49),_("click",function(){let o=v(t).$implicit,r=m(3);return y(r.addValueSamplesToSelection(o))}),d(1),l()}if(n&2){let t=e.$implicit;p(),ve(" ",t.value||"(empty)"," (",t.sampleCount,") ")}}function WD(n,e){if(n&1){let t=N();c(0,"div",27)(1,"p",41),d(2,' Enter sample numbers (comma-separated) or ranges (e.g., "1-10, 15, 20, 25-30") '),l(),c(3,"textarea",42),_("input",function(o){v(t);let r=m(2);return y(r.onCustomSelectionInput(o.target.value))}),l(),x(4,HD,2,1,"p",43),x(5,UD,2,2,"p",44),c(6,"div",45)(7,"p",46),d(8,"Quick select from current values:"),l(),z(9,qD,2,2,"button",47,L0),c(11,"button",48),_("click",function(){v(t);let o=m(2);return y(o.clearCustomSelection())}),d(12,"Clear All"),l()()()}if(n&2){let t=m(2);p(3),I("value",t.customSelectionInput()),p(),S(t.customSelectionError()?4:-1),p(),S(t.customSelection().length>0&&!t.customSelectionError()?5:-1),p(4),$(t.valueDistribution().slice(0,5))}}function GD(n,e){if(n&1&&(c(0,"div",28)(1,"strong"),d(2),l(),d(3," sample(s) will be updated "),l()),n&2){let t=m(2);p(2),P(t.selectedSampleCount())}}function QD(n,e){if(n&1){let t=N();c(0,"button",50),_("click",function(){v(t);let o=m(2);return y(o.cancelEditing())}),d(1," Cancel "),l()}}function YD(n,e){if(n&1){let t=N();c(0,"div",10)(1,"div",11)(2,"h3",12),d(3,"Current Values"),l(),c(4,"div",13),z(5,VD,8,2,"div",14,L0),x(7,LD,2,0,"div",15),l()(),c(8,"div",11)(9,"h3",12),d(10),l(),x(11,jD,5,2,"div",16),c(12,"div",17)(13,"label"),d(14,"New Value"),l(),x(15,zD,1,3,"sdrf-ontology-input",18)(16,$D,1,1,"input",19),l(),c(17,"div",17)(18,"label"),d(19,"Apply to"),l(),c(20,"div",20)(21,"label",21)(22,"input",22),_("change",function(){v(t);let o=m();return y(o.setSelectionMode("all"))}),l(),c(23,"span"),d(24),l()(),c(25,"label",21)(26,"input",23),_("change",function(){v(t);let o=m();return y(o.setSelectionMode("empty"))}),l(),c(27,"span"),d(28),l()(),c(29,"label",21)(30,"input",24),_("change",function(){v(t);let o=m();return y(o.setSelectionMode("range"))}),l(),c(31,"span"),d(32,"Sample range"),l()(),x(33,BD,5,6,"div",25),c(34,"label",21)(35,"input",26),_("change",function(){v(t);let o=m();return y(o.setSelectionMode("custom"))}),l(),c(36,"span"),d(37),l()(),x(38,WD,13,3,"div",27),l()(),x(39,GD,4,1,"div",28),c(40,"div",29),x(41,QD,2,0,"button",30),c(42,"button",31),_("click",function(){v(t);let o=m();return y(o.applyChanges())}),d(43),l()()()()}if(n&2){let t=m();p(5),$(t.valueDistribution()),p(2),S(t.valueDistribution().length===0?7:-1),p(3),j(" ",t.editingExisting()?"Replace Value":"Add/Edit Value"," "),p(),S(t.editingExisting()?11:-1),p(4),S(t.isOntologyColumn()?15:16),p(7),I("checked",t.selectionMode()==="all"),p(2),j("All samples (",t.table().sampleCount,")"),p(2),I("checked",t.selectionMode()==="empty"),p(2),j("Empty cells only (",t.emptyCellCount(),")"),p(2),I("checked",t.selectionMode()==="range"),p(3),S(t.selectionMode()==="range"?33:-1),p(2),I("checked",t.selectionMode()==="custom"),p(2),j("Custom selection (",t.customSelection().length,")"),p(),S(t.selectionMode()==="custom"?38:-1),p(),S(t.selectedSampleCount()>0?39:-1),p(2),S(t.editingExisting()?41:-1),p(),I("disabled",!t.canApply()),p(),j(" Apply to ",t.selectedSampleCount()," Sample(s) ")}}var Pl=class n{isOpen=w(!1);table=w(null);columnIndex=w(-1);close=new W;applyBulkEdit=new W;column=A(()=>{let e=this.table(),t=this.columnIndex();return!e||t<0||t>=e.columns.length?null:e.columns[t]});valueDistribution=A(()=>{let e=this.column(),t=this.table();if(!e||!t)return[];let i=new Map;for(let o=1;o<=t.sampleCount;o++){let s=de(e,o)||"";i.has(s)||i.set(s,[]),i.get(s).push(o)}return Array.from(i.entries()).map(([o,r])=>({value:o,sampleCount:r.length,sampleIndices:r})).sort((o,r)=>r.sampleCount-o.sampleCount)});emptyCellCount=A(()=>{let t=this.valueDistribution().find(i=>i.value==="");return t?t.sampleCount:0});selectedSampleCount=A(()=>this.getSelectedSamples().length);newValue=w("");selectedOntology=w(null);selectionMode=w("all");rangeStart=w(1);rangeEnd=w(1);customSelection=w([]);customSelectionInput=w("");customSelectionError=w("");editingExisting=w(!1);editingValue=w("");editingSampleCount=w(0);ngOnInit(){let e=this.table();e&&this.rangeEnd.set(e.sampleCount)}ngOnChanges(e){e.table&&this.table()&&this.rangeEnd.set(this.table().sampleCount),(e.isOpen||e.columnIndex)&&this.resetState()}isOntologyColumn(){let e=this.column();if(!e)return!1;let t=["organism","disease","cell type","cell line","tissue","organ","organism part","developmental stage","sex","ancestry category","instrument","enrichment process"],i=e.name.toLowerCase();return t.some(o=>i.includes(o))}getColumnTypeLabel(){let e=this.column();if(!e)return"term";let t=e.name.toLowerCase().match(/\[(.*?)\]/);return t?t[1]:"term"}setSelectionMode(e){this.selectionMode.set(e)}selectValueSamples(e){}clearCustomSelection(){this.customSelection.set([]),this.customSelectionInput.set(""),this.customSelectionError.set("")}onCustomSelectionInput(e){this.customSelectionInput.set(e);let t=this.parseCustomSelection(e);t.error?(this.customSelectionError.set(t.error),this.customSelection.set([])):(this.customSelectionError.set(""),this.customSelection.set(t.samples))}addValueSamplesToSelection(e){let t=this.customSelection(),i=[...new Set([...t,...e.sampleIndices])];this.customSelection.set(i.sort((o,r)=>o-r)),this.customSelectionInput.set(this.samplesToInputString(i)),this.customSelectionError.set("")}parseCustomSelection(e){let t=this.table();if(!t)return{samples:[],error:"No table loaded"};let i=e.trim();if(!i)return{samples:[]};let o=[],r=i.split(",");try{for(let a of r){let u=a.trim();if(u)if(u.includes("-")){let f=u.split("-").map(b=>b.trim());if(f.length!==2)return{samples:[],error:`Invalid range: "${u}"`};let g=parseInt(f[0]),h=parseInt(f[1]);if(isNaN(g)||isNaN(h))return{samples:[],error:`Invalid range numbers: "${u}"`};if(g<1||h>t.sampleCount||g>h)return{samples:[],error:`Range "${u}" out of bounds (1-${t.sampleCount})`};for(let b=g;b<=h;b++)o.push(b)}else{let f=parseInt(u);if(isNaN(f))return{samples:[],error:`Invalid sample number: "${u}"`};if(f<1||f>t.sampleCount)return{samples:[],error:`Sample ${f} out of bounds (1-${t.sampleCount})`};o.push(f)}}return{samples:[...new Set(o)].sort((a,u)=>a-u)}}catch{return{samples:[],error:"Invalid input format"}}}samplesToInputString(e){if(e.length===0)return"";let t=[],i=e[0],o=e[0];for(let r=1;r<=e.length;r++)r<e.length&&e[r]===o+1?o=e[r]:(i===o?t.push(i.toString()):o===i+1?t.push(`${i}, ${o}`):t.push(`${i}-${o}`),r<e.length&&(i=e[r],o=e[r]));return t.join(", ")}startEditingValue(e){this.editingExisting.set(!0),this.editingValue.set(e.value),this.editingSampleCount.set(e.sampleCount),this.customSelection.set(e.sampleIndices),this.selectionMode.set("custom")}cancelEditing(){this.editingExisting.set(!1),this.editingValue.set(""),this.editingSampleCount.set(0),this.customSelection.set([]),this.selectionMode.set("all")}onTermSelected(e){this.selectedOntology.set(e)}getSelectedSamples(){let e=this.selectionMode(),t=this.table();if(!t)return[];switch(e){case"all":return Array.from({length:t.sampleCount},(i,o)=>o+1);case"empty":{let i=this.column();if(!i)return[];let o=[];for(let r=1;r<=t.sampleCount;r++){let s=de(i,r);(!s||s.trim()==="")&&o.push(r)}return o}case"range":{let i=Math.max(1,this.rangeStart()),o=Math.min(t.sampleCount,this.rangeEnd());return i>o?[]:Array.from({length:o-i+1},(r,s)=>i+s)}case"custom":return this.customSelection();default:return[]}}canApply(){return this.newValue().trim()!==""&&this.selectedSampleCount()>0}applyChanges(){let e=this.newValue().trim(),t=this.getSelectedSamples();if(!e||t.length===0)return;let i={columnIndex:this.columnIndex(),value:e,sampleIndices:t,ontologyId:this.selectedOntology()?.id,ontologyLabel:this.selectedOntology()?.label};this.applyBulkEdit.emit(i),this.resetState()}formatSampleRange(e){if(e.length===0)return"None";if(e.length<=5)return e.join(", ");let t=[...e].sort((i,o)=>i-o);return`${t[0]}-${t[t.length-1]} (${e.length} samples)`}resetState(){this.newValue.set(""),this.selectedOntology.set(null),this.selectionMode.set("all"),this.customSelection.set([]),this.customSelectionInput.set(""),this.customSelectionError.set(""),this.editingExisting.set(!1),this.editingValue.set(""),this.editingSampleCount.set(0);let e=this.table();e&&(this.rangeStart.set(1),this.rangeEnd.set(e.sampleCount))}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ee({type:n,selectors:[["column-editor-panel"]],inputs:{isOpen:"isOpen",table:"table",columnIndex:"columnIndex"},outputs:{close:"close",applyBulkEdit:"applyBulkEdit"},features:[Fe],decls:15,vars:5,consts:[[1,"column-editor-panel"],[1,"panel-backdrop",3,"click"],[1,"panel-content"],[1,"panel-header"],[1,"header-title"],[1,"icon"],[1,"title-text"],[1,"column-name"],[1,"sample-count"],["title","Close",1,"close-btn",3,"click"],[1,"panel-body"],[1,"section"],[1,"section-title"],[1,"value-distribution"],[1,"value-item"],[1,"empty-state"],[1,"editing-info"],[1,"form-group"],[3,"value","columnName","placeholder"],["type","text","placeholder","Enter value...",1,"text-input",3,"value"],[1,"selection-options"],[1,"radio-option"],["type","radio","name","selectionMode","value","all",3,"change","checked"],["type","radio","name","selectionMode","value","empty",3,"change","checked"],["type","radio","name","selectionMode","value","range",3,"change","checked"],[1,"range-inputs"],["type","radio","name","selectionMode","value","custom",3,"change","checked"],[1,"custom-selection-panel"],[1,"preview"],[1,"actions"],[1,"btn","btn-secondary"],[1,"btn","btn-primary",3,"click","disabled"],[1,"value-item",3,"click"],[1,"value-info"],[1,"value-text"],[1,"value-count"],["title","Replace this value",1,"edit-value-btn",3,"click"],[3,"valueChange","termSelected","value","columnName","placeholder"],["type","text","placeholder","Enter value...",1,"text-input",3,"input","value"],["type","number","placeholder","From",1,"range-input",3,"input","value","min","max"],["type","number","placeholder","To",1,"range-input",3,"input","value","min","max"],[1,"hint"],["placeholder","e.g., 1-10, 15, 20, 25-30","rows","3",1,"sample-input",3,"input","value"],[1,"error-text"],[1,"success-text"],[1,"quick-actions"],[1,"hint-small"],["title","Add samples with this value",1,"quick-select-btn"],[1,"clear-btn",3,"click"],["title","Add samples with this value",1,"quick-select-btn",3,"click"],[1,"btn","btn-secondary",3,"click"]],template:function(t,i){if(t&1&&(c(0,"div",0)(1,"div",1),_("click",function(){return i.close.emit()}),l(),c(2,"div",2)(3,"div",3)(4,"div",4)(5,"span",5),d(6,"\u{1F4DD}"),l(),c(7,"div",6)(8,"div",7),d(9),l(),c(10,"div",8),d(11),l()()(),c(12,"button",9),_("click",function(){return i.close.emit()}),d(13,"\xD7"),l()(),x(14,YD,44,17,"div",10),l()()),t&2){let o,r;B("open",i.isOpen()),p(9),P(((o=i.column())==null?null:o.name)||"Column Editor"),p(2),j("",((r=i.table())==null?null:r.sampleCount)||0," samples"),p(3),S(i.column()&&i.table()?14:-1)}},dependencies:[te,ce,Po],styles:[".column-editor-panel[_ngcontent-%COMP%]{position:fixed;top:0;right:-100%;width:100%;height:100%;z-index:1000;transition:right .3s ease}.column-editor-panel.open[_ngcontent-%COMP%]{right:0}.panel-backdrop[_ngcontent-%COMP%]{position:absolute;inset:0;background:#00000080;cursor:pointer}.panel-content[_ngcontent-%COMP%]{position:absolute;top:0;right:0;width:450px;max-width:90vw;height:100%;background:#fff;box-shadow:-2px 0 8px #00000026;display:flex;flex-direction:column;overflow:hidden}.panel-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;border-bottom:1px solid #e0e0e0;background:#f8f9fa}.header-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;flex:1}.icon[_ngcontent-%COMP%]{font-size:20px}.title-text[_ngcontent-%COMP%]{flex:1}.column-name[_ngcontent-%COMP%]{font-weight:600;font-size:14px;color:#1a1a1a}.sample-count[_ngcontent-%COMP%]{font-size:12px;color:#666}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:24px;cursor:pointer;color:#666;padding:0;width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:4px;transition:all .2s}.close-btn[_ngcontent-%COMP%]:hover{background:#e0e0e0;color:#1a1a1a}.panel-body[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:20px}.section[_ngcontent-%COMP%]{margin-bottom:24px}.section-title[_ngcontent-%COMP%]{font-size:13px;font-weight:600;color:#1a1a1a;margin:0 0 12px;text-transform:uppercase;letter-spacing:.5px}.value-distribution[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.value-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;background:#f8f9fa;border:1px solid #e0e0e0;border-radius:4px;cursor:pointer;transition:all .2s}.value-item[_ngcontent-%COMP%]:hover{background:#e8f4f8;border-color:#2196f3}.value-info[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:4px}.value-text[_ngcontent-%COMP%]{font-size:13px;color:#1a1a1a;font-weight:500}.value-count[_ngcontent-%COMP%]{font-size:11px;color:#666}.edit-value-btn[_ngcontent-%COMP%]{padding:4px 12px;font-size:11px;background:#fff;border:1px solid #ccc;border-radius:3px;cursor:pointer;color:#666;transition:all .2s}.edit-value-btn[_ngcontent-%COMP%]:hover{background:#2196f3;color:#fff;border-color:#2196f3}.empty-state[_ngcontent-%COMP%]{padding:20px;text-align:center;color:#999;font-size:13px}.editing-info[_ngcontent-%COMP%]{padding:8px 12px;background:#fff3cd;border:1px solid #ffc107;border-radius:4px;font-size:12px;margin-bottom:12px}.form-group[_ngcontent-%COMP%]{margin-bottom:16px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:12px;font-weight:600;color:#555;margin-bottom:6px}.text-input[_ngcontent-%COMP%]{width:100%;padding:8px 12px;border:1px solid #ccc;border-radius:4px;font-size:13px}.text-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#2196f3;box-shadow:0 0 0 2px #2196f333}.selection-options[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.radio-option[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px;cursor:pointer;border-radius:4px;transition:background .2s}.radio-option[_ngcontent-%COMP%]:hover{background:#f5f5f5}.radio-option[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{cursor:pointer}.radio-option[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px;color:#1a1a1a}.range-inputs[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-left:28px;margin-top:4px}.range-input[_ngcontent-%COMP%]{width:80px;padding:6px 8px;border:1px solid #ccc;border-radius:4px;font-size:13px}.custom-selection-info[_ngcontent-%COMP%]{margin-left:28px;margin-top:4px}.custom-selection-panel[_ngcontent-%COMP%]{margin-left:28px;margin-top:8px;padding:12px;background:#f8f9fa;border:1px solid #e0e0e0;border-radius:4px}.sample-input[_ngcontent-%COMP%]{width:100%;padding:8px;border:1px solid #ccc;border-radius:4px;font-size:12px;font-family:monospace;resize:vertical;margin-top:4px}.sample-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#2196f3;box-shadow:0 0 0 2px #2196f333}.error-text[_ngcontent-%COMP%]{color:#d32f2f;font-size:11px;margin:4px 0}.success-text[_ngcontent-%COMP%]{color:#2e7d32;font-size:11px;margin:4px 0;font-weight:500}.quick-actions[_ngcontent-%COMP%]{margin-top:12px;padding-top:12px;border-top:1px solid #e0e0e0}.hint-small[_ngcontent-%COMP%]{font-size:10px;color:#666;margin:0 0 6px}.quick-select-btn[_ngcontent-%COMP%]{display:inline-block;padding:4px 8px;font-size:10px;background:#fff;border:1px solid #ccc;border-radius:3px;cursor:pointer;margin:2px 4px 2px 0;transition:all .2s}.quick-select-btn[_ngcontent-%COMP%]:hover{background:#e3f2fd;border-color:#2196f3}.hint[_ngcontent-%COMP%]{font-size:11px;color:#666;margin:4px 0}.clear-btn[_ngcontent-%COMP%]{padding:4px 12px;font-size:11px;background:#fff;border:1px solid #ccc;border-radius:3px;cursor:pointer;color:#666;margin-top:4px}.clear-btn[_ngcontent-%COMP%]:hover{background:#f5f5f5}.preview[_ngcontent-%COMP%]{padding:12px;background:#e8f5e9;border:1px solid #4caf50;border-radius:4px;font-size:13px;color:#2e7d32;margin-bottom:16px}.actions[_ngcontent-%COMP%]{display:flex;gap:8px;justify-content:flex-end}.btn[_ngcontent-%COMP%]{padding:8px 16px;border:none;border-radius:4px;font-size:13px;font-weight:500;cursor:pointer;transition:all .2s}.btn-primary[_ngcontent-%COMP%]{background:#2196f3;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#1976d2}.btn-primary[_ngcontent-%COMP%]:disabled{background:#ccc;cursor:not-allowed}.btn-secondary[_ngcontent-%COMP%]{background:#fff;color:#666;border:1px solid #ccc}.btn-secondary[_ngcontent-%COMP%]:hover{background:#f5f5f5}"]})};var ji="sdrf_cache_",Ol="sdrf_cache_index",KD=10*1024*1024,ZD=10,Ep=class{saveTable(e,t,i,o=1){try{let r=this.generateId(t,i),s={id:r,fileName:t,originalHash:i||this.hashTable(e),tableData:JSON.stringify(e),lastModified:Date.now(),changeCount:o,metadata:{sampleCount:e.sampleCount,columnCount:e.columns.length,firstColumn:e.columns[0]?.name||"",lastColumn:e.columns[e.columns.length-1]?.name||""}},a=JSON.stringify(s);return a.length>KD?(console.warn("Table too large to cache:",a.length),null):(localStorage.setItem(ji+r,a),this.updateIndex(r),console.log(`Cached table "${t}" (${s.changeCount} changes)`),r)}catch(r){return console.error("Failed to cache table:",r),null}}loadTable(e){try{let t=localStorage.getItem(ji+e);if(!t)return null;let i=JSON.parse(t);return{table:JSON.parse(i.tableData),entry:i}}catch(t){return console.error("Failed to load cached table:",t),null}}listCachedTables(){let e=this.getIndex(),t=[];for(let i of e)try{let o=localStorage.getItem(ji+i);if(!o)continue;let r=JSON.parse(o);t.push({id:r.id,fileName:r.fileName,lastModified:new Date(r.lastModified),changeCount:r.changeCount,sampleCount:r.metadata.sampleCount,columnCount:r.metadata.columnCount})}catch(o){console.warn("Failed to read cache entry:",i,o)}return t.sort((i,o)=>o.lastModified.getTime()-i.lastModified.getTime())}deleteCache(e){localStorage.removeItem(ji+e),this.removeFromIndex(e),console.log("Deleted cache:",e)}clearAllCaches(){let e=this.getIndex();for(let t of e)localStorage.removeItem(ji+t);localStorage.removeItem(Ol),console.log("Cleared all caches")}hasCachedTables(){return this.getIndex().length>0}getCacheCount(){return this.getIndex().length}estimateCacheSize(){let e=this.getIndex(),t=0;for(let i of e){let o=localStorage.getItem(ji+i);o&&(t+=o.length*2)}return t}formatCacheSize(e){return e<1024?`${e} B`:e<1024*1024?`${(e/1024).toFixed(1)} KB`:`${(e/(1024*1024)).toFixed(1)} MB`}generateId(e,t){let i=Date.now(),o=e.replace(/[^a-zA-Z0-9]/g,"_").substring(0,30),r=t?t.substring(0,8):i.toString(36);return`${o}_${r}`}hashTable(e){let t=`${e.sampleCount}_${e.columns.length}_${e.columns.map(o=>o.name).join("_")}`,i=0;for(let o=0;o<t.length;o++){let r=t.charCodeAt(o);i=(i<<5)-i+r,i=i&i}return Math.abs(i).toString(36)}getIndex(){try{let e=localStorage.getItem(Ol);return e?JSON.parse(e):[]}catch{return[]}}updateIndex(e){let t=this.getIndex();if(!t.includes(e)){if(t.push(e),t.length>ZD){let i=t.shift();i&&localStorage.removeItem(ji+i)}localStorage.setItem(Ol,JSON.stringify(t))}}removeFromIndex(e){let i=this.getIndex().filter(o=>o!==e);localStorage.setItem(Ol,JSON.stringify(i))}},Al=new Ep;var JD=(n,e)=>e.id;function XD(n,e){if(n&1){let t=N();L(0,"div",10)(1,"div",14),d(2,"\u{1F4C4}"),V(),L(3,"div",15)(4,"div",16),d(5),V(),L(6,"div",17),d(7),V(),L(8,"div",17),d(9),V()(),L(10,"div",18)(11,"button",19),qt("click",function(){let o=v(t).$implicit,r=m(2);return y(r.recoverCache(o.id))}),d(12," Recover "),V(),L(13,"button",20),qt("click",function(){let o=v(t).$implicit,r=m(2);return y(r.deleteCache(o.id))}),d(14," Discard "),V()()()}if(n&2){let t=e.$implicit,i=m(2);p(5),P(t.fileName),p(2),ve(" ",t.sampleCount," samples, ",t.columnCount," columns "),p(2),ve(" ",t.changeCount," change(s) \u2022 Last saved ",i.formatTime(t.lastModified)," ")}}function eT(n,e){if(n&1){let t=N();L(0,"div",9),z(1,XD,15,5,"div",10,JD),V(),L(3,"div",11)(4,"div",12),d(5),V(),L(6,"button",13),qt("click",function(){v(t);let o=m();return y(o.clearAll())}),d(7," Clear All Caches "),V()()}if(n&2){let t=m();p(),$(t.cachedTables()),p(4),j(" Total cache size: ",t.cacheSize()," ")}}function tT(n,e){n&1&&(L(0,"div",5)(1,"p"),d(2,"All caches have been cleared."),V()())}var Nl=class n{recover=new W;dismiss=new W;cacheService=Al;cachedTables=w([]);cacheSize=w("0 KB");ngOnInit(){this.loadCachedTables()}loadCachedTables(){let e=this.cacheService.listCachedTables();this.cachedTables.set(e);let t=this.cacheService.estimateCacheSize();this.cacheSize.set(this.cacheService.formatCacheSize(t))}recoverCache(e){this.recover.emit({cacheId:e})}deleteCache(e){this.cacheService.deleteCache(e),this.loadCachedTables()}clearAll(){confirm("Are you sure you want to discard all cached files? This cannot be undone.")&&(this.cacheService.clearAllCaches(),this.loadCachedTables())}formatTime(e){let i=new Date().getTime()-e.getTime(),o=Math.floor(i/6e4),r=Math.floor(o/60),s=Math.floor(r/24);return o<1?"just now":o<60?`${o}m ago`:r<24?`${r}h ago`:s<7?`${s}d ago`:e.toLocaleDateString()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ee({type:n,selectors:[["cache-recovery-panel"]],outputs:{recover:"recover",dismiss:"dismiss"},decls:15,vars:2,consts:[[1,"recovery-overlay"],[1,"recovery-panel"],[1,"panel-header"],[1,"subtitle"],[1,"panel-body"],[1,"empty-state"],[1,"panel-footer"],[1,"btn","btn-secondary","btn-large",3,"click"],[1,"hint"],[1,"cache-list"],[1,"cache-item"],[1,"cache-summary"],[1,"summary-text"],[1,"btn","btn-secondary",3,"click"],[1,"cache-icon"],[1,"cache-info"],[1,"cache-name"],[1,"cache-meta"],[1,"cache-actions"],["title","Recover this file",1,"btn","btn-primary",3,"click"],["title","Discard this cache",1,"btn","btn-danger",3,"click"]],template:function(t,i){t&1&&(L(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2"),d(4,"\u{1F4BE} Recover Your Work"),V(),L(5,"p",3),d(6),V()(),L(7,"div",4),x(8,eT,8,1)(9,tT,3,0,"div",5),V(),L(10,"div",6)(11,"button",7),qt("click",function(){return i.dismiss.emit()}),d(12," Start Fresh "),V(),L(13,"p",8),d(14,"Or load a new file to begin"),V()()()()),t&2&&(p(6),j("Found ",i.cachedTables().length," unsaved file(s)"),p(2),S(i.cachedTables().length>0?8:9))},dependencies:[te],styles:[".recovery-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000c;display:flex;align-items:center;justify-content:center;z-index:10000;padding:20px}.recovery-panel[_ngcontent-%COMP%]{background:#fff;border-radius:8px;max-width:700px;width:100%;max-height:90vh;display:flex;flex-direction:column;box-shadow:0 10px 40px #0000004d}.panel-header[_ngcontent-%COMP%]{padding:24px 24px 16px;border-bottom:2px solid #e0e0e0}.panel-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 8px;font-size:24px;color:#1a1a1a}.subtitle[_ngcontent-%COMP%]{margin:0;font-size:14px;color:#666}.panel-body[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:20px 24px}.cache-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.cache-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:16px;background:#f8f9fa;border:2px solid #e0e0e0;border-radius:6px;transition:all .2s}.cache-item[_ngcontent-%COMP%]:hover{border-color:#2196f3;box-shadow:0 2px 8px #2196f333}.cache-icon[_ngcontent-%COMP%]{font-size:32px;flex-shrink:0}.cache-info[_ngcontent-%COMP%]{flex:1;min-width:0}.cache-name[_ngcontent-%COMP%]{font-size:15px;font-weight:600;color:#1a1a1a;margin-bottom:4px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.cache-meta[_ngcontent-%COMP%]{font-size:12px;color:#666;margin-bottom:2px}.cache-actions[_ngcontent-%COMP%]{display:flex;gap:8px;flex-shrink:0}.cache-summary[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:20px;padding-top:20px;border-top:1px solid #e0e0e0}.summary-text[_ngcontent-%COMP%]{font-size:13px;color:#666}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#999}.panel-footer[_ngcontent-%COMP%]{padding:16px 24px;border-top:2px solid #e0e0e0;text-align:center}.hint[_ngcontent-%COMP%]{margin:8px 0 0;font-size:12px;color:#999}.btn[_ngcontent-%COMP%]{padding:8px 16px;border:none;border-radius:4px;font-size:13px;font-weight:500;cursor:pointer;transition:all .2s}.btn-primary[_ngcontent-%COMP%]{background:#2196f3;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background:#1976d2}.btn-secondary[_ngcontent-%COMP%]{background:#f5f5f5;color:#666;border:1px solid #ccc}.btn-secondary[_ngcontent-%COMP%]:hover{background:#e0e0e0}.btn-danger[_ngcontent-%COMP%]{background:#fff;color:#d32f2f;border:1px solid #d32f2f}.btn-danger[_ngcontent-%COMP%]:hover{background:#d32f2f;color:#fff}.btn-large[_ngcontent-%COMP%]{padding:12px 32px;font-size:14px}"]})};var nT=["scrollContainer"];function iT(n,e){n&1&&(c(0,"div",19)(1,"div",21)(2,"h1",22),d(3,"SDRF Editor"),l()(),c(4,"div",23)(5,"a",24),d(6,"SDRF Project"),l(),c(7,"a",25),d(8,"Specification"),l()()())}function oT(n,e){if(n&1){let t=N();c(0,"div",18),x(1,iT,9,0,"div",19),c(2,"button",20),_("click",function(){v(t);let o=m();return y(o.toggleBanner())}),d(3),l()()}if(n&2){let t=m();B("collapsed",t.bannerCollapsed()),p(),S(t.bannerCollapsed()?-1:1),p(),I("title",t.bannerCollapsed()?"Show banner":"Hide banner"),p(),j(" ",t.bannerCollapsed()?"\u25BC":"\u25B2"," ")}}function rT(n,e){if(n&1&&(c(0,"span",27),d(1),l()),n&2){let t=m(2);I("title",Cu("",t.changeCount()," unsaved change(s)")),p(),j(" \u{1F4BE} ",t.changeCount()," ")}}function sT(n,e){if(n&1){let t=N();c(0,"button",26),_("click",function(){v(t);let o=m();return y(o.exportTsv())}),d(1," Export TSV "),l(),c(2,"button",26),_("click",function(){v(t);let o=m();return y(o.validate())}),d(3," Validate "),l(),x(4,rT,2,3,"span",27),re(5,"span",28),c(6,"button",29),_("click",function(){v(t);let o=m();return y(o.addRowAtEnd())}),d(7," + Row "),l(),c(8,"button",30),_("click",function(){v(t);let o=m();return y(o.showAddColumnDialog())}),d(9," + Column "),l(),re(10,"span",28),c(11,"button",31),_("click",function(){v(t);let o=m();return y(o.toggleFilterBar())}),d(12," Filter "),l(),c(13,"button",32),_("click",function(){v(t);let o=m();return y(o.toggleStatsPanel())}),d(14," Stats "),l(),c(15,"button",33),_("click",function(){v(t);let o=m();return y(o.toggleRecommendPanel())}),d(16," AI Assistant "),l()}if(n&2){let t=m();p(4),S(t.changeCount()>0?4:-1),p(7),B("btn-active",t.showFilterBar()),p(2),B("btn-active",t.showStatsPanel()),p(2),B("btn-active",t.showRecommendPanel())}}function aT(n,e){if(n&1&&d(0),n&2){let t=m(2);ve(" (showing ",t.visibleRange().start,"-",t.visibleRange().end,") ")}}function lT(n,e){if(n&1&&(c(0,"div",34)(1,"span",35),d(2,"Sample Accession"),l(),c(3,"span",36),d(4,"Sample Properties"),l(),c(5,"span",37),d(6,"Data Properties"),l(),c(7,"span",38),d(8,"Factor Values"),l()(),c(9,"span",39),d(10),x(11,aT,1,2),l()),n&2){let t=m();p(10),ve(" ",t.table().columns.length," columns, ",t.table().sampleCount," samples "),p(),S(t.visibleRange()?11:-1)}}function cT(n,e){if(n&1&&(c(0,"div",11),re(1,"div",40),c(2,"span"),d(3),l()()),n&2){let t=m();p(3),P(t.loadingMessage())}}function dT(n,e){if(n&1){let t=N();c(0,"div",12)(1,"span"),d(2),l(),c(3,"button",41),_("click",function(){v(t);let o=m();return y(o.clearError())}),d(4,"\xD7"),l()()}if(n&2){let t=m();p(2),P(t.error())}}function uT(n,e){if(n&1){let t=N();c(0,"sdrf-filter-bar",42),_("filterChange",function(o){v(t);let r=m();return y(r.onFilterChange(o))}),l()}if(n&2){let t=m();I("table",t.table())}}function pT(n,e){n&1&&re(0,"col",50)}function fT(n,e){n&1&&(c(0,"span",72),d(1,"*"),l())}function mT(n,e){if(n&1&&(c(0,"span",73),d(1),l()),n&2){let t=m(3);p(),P(t.sortDirection()==="asc"?"\u25B2":"\u25BC")}}function gT(n,e){if(n&1){let t=N();c(0,"th",69),_("click",function(o){let r=v(t).$index,s=m(2);return y(s.onHeaderClick(r,o))}),c(1,"div",70)(2,"span",71),d(3),l(),x(4,fT,2,0,"span",72),x(5,mT,2,1,"span",73),c(6,"button",74),_("click",function(o){let r=v(t).$index;return m(2).openColumnEditor(r),y(o.stopPropagation())}),d(7," \u{1F4DD} "),l()()()}if(n&2){let t,i=e.$implicit,o=e.$index,r=m(2);B("col-type-source",r.getColumnTypeClass(i.name)==="source")("col-type-characteristic",r.getColumnTypeClass(i.name)==="characteristic")("col-type-comment",r.getColumnTypeClass(i.name)==="comment")("col-type-factor",r.getColumnTypeClass(i.name)==="factor")("required",i.isRequired)("selected",((t=r.selectedCell())==null?null:t.col)===o)("sorted",r.sortColumn()===o),I("title",r.getColumnTooltip(i.name)),p(3),P(i.name),p(),S(i.isRequired?4:-1),p(),S(r.sortColumn()===o?5:-1)}}function hT(n,e){if(n&1&&(c(0,"tr",75),re(1,"td"),l()),n&2){let t,i=m(2);vn("height",i.tableOffset(),"px"),p(),Cn("colspan",(((t=i.table())==null||t.columns==null?null:t.columns.length)||0)+2)}}function _T(n,e){if(n&1){let t=N();c(0,"td",79),_("click",function(){let o=v(t).$index,r=m().$implicit,s=m(2);return y(s.selectCell(r,o))})("dblclick",function(){let o=v(t).$index,r=m().$implicit,s=m(2);return y(s.startEditing(r,o))})("contextmenu",function(o){let r=v(t).$index,s=m().$implicit,a=m(2);return y(a.onCellContextMenu(o,s,r))}),c(1,"span",80),d(2),l()()}if(n&2){let t=e.$index,i=m().$implicit,o=m(2);B("selected",o.isSelected(i,t))("has-error",o.hasCellError(i,t)),p(),B("reserved-value",o.isReservedValue(o.getCellValue(i,t)))("reserved-not-available",o.isReservedValueType(o.getCellValue(i,t),"not available"))("reserved-not-applicable",o.isReservedValueType(o.getCellValue(i,t),"not applicable"))("reserved-anonymized",o.isReservedValueType(o.getCellValue(i,t),"anonymized"))("reserved-pooled",o.isReservedValueType(o.getCellValue(i,t),"pooled")),p(),j(" ",o.getCellValue(i,t)," ")}}function CT(n,e){if(n&1){let t=N();c(0,"tr")(1,"td",51)(2,"input",76),_("change",function(o){let r=v(t).$implicit,s=m(2);return y(s.toggleRowSelection(r,o))})("click",function(o){return v(t),y(o.stopPropagation())}),l()(),c(3,"td",77),_("click",function(o){let r=v(t).$implicit,s=m(2);return y(s.onRowHeaderClick(r,o))}),d(4),l(),z(5,_T,3,15,"td",78,Ve),l()}if(n&2){let t,i=e.$implicit,o=m(2);vn("height",o.ROW_HEIGHT,"px"),B("selected",((t=o.selectedCell())==null?null:t.row)===i)("row-selected",o.isRowSelected(i)),p(2),I("checked",o.isRowSelected(i)),p(2),j(" ",i," "),p(),$(o.table().columns)}}function vT(n,e){if(n&1){let t=N();c(0,"sdrf-column-stats",81),_("close",function(){v(t);let o=m(2);return y(o.toggleStatsPanel())})("selectByValue",function(o){v(t);let r=m(2);return y(r.onSelectByValue(o))})("bulkEdit",function(o){v(t);let r=m(2);return y(r.onStatsPanelBulkEdit(o))})("selectSamples",function(o){v(t);let r=m(2);return y(r.onSelectSamples(o))}),l()}if(n&2){let t=m(2);I("table",t.table())("selectedSamples",t.selectedSamples())}}function yT(n,e){n&1&&(c(0,"span",84),d(1,"API"),l())}function bT(n,e){if(n&1&&(c(0,"span",85),d(1),l()),n&2){let t=m(3);p(),P(t.pyodideLoadProgress())}}function xT(n,e){n&1&&(c(0,"span",86),d(1,"Ready"),l())}function ST(n,e){n&1&&(c(0,"span",87),d(1,"Error"),l())}function wT(n,e){if(n&1){let t=N();c(0,"label",98)(1,"input",99),_("change",function(){let o=v(t).$implicit,r=m(4);return y(r.toggleTemplate(o))}),l(),d(2),l()}if(n&2){let t=e.$implicit,i=m(4);B("selected",i.selectedTemplates().includes(t)),p(),I("checked",i.selectedTemplates().includes(t)),p(),j(" ",t," ")}}function ET(n,e){if(n&1&&(c(0,"div",91),z(1,wT,3,4,"label",97,Ut),l()),n&2){let t=m(3);p(),$(t.pyodideAvailableTemplates())}}function MT(n,e){n&1&&(c(0,"span",92),d(1,"Loading templates..."),l())}function DT(n,e){n&1&&(c(0,"span",92),d(1,"Load validator to see templates"),l())}function TT(n,e){n&1&&(c(0,"span",92),d(1,"Templates unavailable"),l())}function IT(n,e){n&1&&(c(0,"span",92),d(1,"No templates available"),l())}function PT(n,e){n&1&&(re(0,"span",100),d(1," Validating... "))}function OT(n,e){n&1&&d(0," Validate (API) ")}function AT(n,e){n&1&&d(0," Load & Validate ")}function NT(n,e){n&1&&d(0," Validate ")}function kT(n,e){n&1&&(c(0,"span",101),d(1,"\u2713 Validation passed - no issues found"),l())}function RT(n,e){if(n&1&&(c(0,"span",102),d(1),l()),n&2){let t=m(5);p(),j("",t.pyodideErrorCount()," errors")}}function FT(n,e){if(n&1&&(c(0,"span",103),d(1),l()),n&2){let t=m(5);p(),j("",t.pyodideWarningCount()," warnings")}}function VT(n,e){if(n&1&&(x(0,RT,2,1,"span",102),x(1,FT,2,1,"span",103)),n&2){let t=m(4);S(t.pyodideErrorCount()>0?0:-1),p(),S(t.pyodideWarningCount()>0?1:-1)}}function LT(n,e){if(n&1&&(c(0,"div",94),x(1,kT,2,0,"span",101)(2,VT,2,2),l()),n&2){let t=m(3);p(),S(t.pyodideErrorCount()===0&&t.pyodideWarningCount()===0?1:2)}}function jT(n,e){if(n&1&&(c(0,"div",110),d(1,"Column: "),c(2,"strong"),d(3),l()()),n&2){let t=m().$implicit;p(3),P(t.column)}}function zT(n,e){if(n&1){let t=N();c(0,"button",118),_("click",function(){let o=v(t).$implicit,r=m(2).$implicit,s=m(4);return y(s.jumpToValidationCell(o.row,r.column))}),d(1),l()}if(n&2){let t=e.$implicit;p(),j(" ",t.row+1," ")}}function $T(n,e){if(n&1&&(c(0,"span",117),d(1),l()),n&2){let t=m(2).$implicit;p(),j("+",t.cells.length-8," more")}}function BT(n,e){if(n&1&&(c(0,"div",111)(1,"span",114),d(2,"Affected rows:"),l(),c(3,"div",115),z(4,zT,2,1,"button",116,Ve),x(6,$T,2,1,"span",117),l()()),n&2){let t=m().$implicit;p(4),$(t.cells.slice(0,8)),p(2),S(t.cells.length>8?6:-1)}}function HT(n,e){if(n&1&&(c(0,"div",112),d(1),l()),n&2){let t=m().$implicit;p(),j("\u{1F4A1} ",t.suggestion)}}function UT(n,e){if(n&1){let t=N();c(0,"div",105)(1,"div",106)(2,"span",107),d(3),l(),c(4,"div",108)(5,"div",109),d(6),l(),x(7,jT,4,1,"div",110),x(8,BT,7,1,"div",111),x(9,HT,2,1,"div",112),l(),c(10,"button",113),_("click",function(){let o=v(t).$implicit,r=m(4);return y(r.sendErrorToAI(o))}),d(11," AI Assist "),l()()()}if(n&2){let t=e.$implicit;B("level-error",t.level==="error")("level-warning",t.level==="warning"),p(3),P(t.level==="error"?"\u274C":"\u26A0\uFE0F"),p(3),P(t.message),p(),S(t.column?7:-1),p(),S(t.cells.length>0?8:-1),p(),S(t.suggestion?9:-1)}}function qT(n,e){if(n&1&&(c(0,"div",95),z(1,UT,12,9,"div",104,Ve),l()),n&2){let t=m(3);p(),$(t.aggregatedErrors())}}function WT(n,e){n&1&&(c(0,"div",96),re(1,"span",119),c(2,"span"),d(3,"Running validation..."),l()())}function GT(n,e){if(n&1){let t=N();c(0,"div",61)(1,"div",82)(2,"div",83)(3,"h3"),d(4,"SDRF Validation"),l(),x(5,yT,2,0,"span",84)(6,bT,2,1,"span",85)(7,xT,2,0,"span",86)(8,ST,2,0,"span",87),l(),c(9,"button",41),_("click",function(){v(t);let o=m(2);return y(o.closeValidationPanel())}),d(10,"\xD7"),l()(),c(11,"div",88)(12,"div",89)(13,"span",90),d(14,"Templates:"),l(),x(15,ET,3,0,"div",91)(16,MT,2,0,"span",92)(17,DT,2,0,"span",92)(18,TT,2,0,"span",92)(19,IT,2,0,"span",92),c(20,"button",93),_("click",function(){v(t);let o=m(2);return y(o.runPyodideValidation())}),x(21,PT,2,0)(22,OT,1,0)(23,AT,1,0)(24,NT,1,0),l()(),x(25,LT,3,1,"div",94),x(26,qT,3,0,"div",95),x(27,WT,4,0,"div",96),l()()}if(n&2){let t=m(2);p(5),S(t.usingApiFallback()?5:t.pyodideState()==="loading"?6:t.pyodideState()==="ready"?7:t.pyodideState()==="error"?8:-1),p(10),S(t.pyodideAvailableTemplates().length>0?15:t.pyodideState()==="loading"?16:t.pyodideState()==="not-loaded"?17:t.pyodideState()==="error"?18:19),p(5),I("disabled",t.pyodideValidating()||t.selectedTemplates().length===0),p(),S(t.pyodideValidating()?21:t.usingApiFallback()?22:t.pyodideState()==="not-loaded"?23:24),p(4),S(t.pyodideHasValidated()&&!t.pyodideValidating()?25:-1),p(),S(t.aggregatedErrors().length>0?26:-1),p(),S(t.pyodideValidating()?27:-1)}}function QT(n,e){if(n&1){let t=N();c(0,"div",120)(1,"button",121),_("click",function(){v(t);let o=m(2);return y(o.selectAllWithSameValue())}),d(2," Select all with same value "),l(),c(3,"button",121),_("click",function(){v(t);let o=m(2);return y(o.selectAllInColumn())}),d(4," Select all in this column "),l(),re(5,"hr"),c(6,"button",121),_("click",function(){v(t);let o=m(2);return y(o.editSelectedCells())}),d(7," Edit selected cells "),l(),c(8,"button",121),_("click",function(){v(t);let o=m(2);return y(o.clearSelectedCells())}),d(9," Clear selected cells "),l(),re(10,"hr"),c(11,"button",121),_("click",function(){v(t);let o=m(2);return y(o.insertRowAbove())}),d(12," Insert row above "),l(),c(13,"button",121),_("click",function(){v(t);let o=m(2);return y(o.insertRowBelow())}),d(14," Insert row below "),l(),c(15,"button",121),_("click",function(){v(t);let o=m(2);return y(o.deleteSelectedRows())}),d(16," Delete selected rows "),l(),re(17,"hr"),c(18,"button",121),_("click",function(){v(t);let o=m(2);return y(o.showAddColumnDialog())}),d(19," Add column... "),l(),c(20,"button",121),_("click",function(){v(t);let o=m(2);return y(o.deleteColumn())}),d(21," Delete this column "),l(),re(22,"hr"),c(23,"button",121),_("click",function(){v(t);let o=m(2);return y(o.closeContextMenu())}),d(24," Cancel "),l()()}if(n&2){let t=m(2);vn("top",t.contextMenu().y,"px")("left",t.contextMenu().x,"px")}}function YT(n,e){if(n&1){let t=N();c(0,"div",122),_("click",function(){v(t);let o=m(2);return y(o.closeAddColumnDialog())}),c(1,"div",123),_("click",function(o){return v(t),y(o.stopPropagation())}),c(2,"h3"),d(3,"Add New Column"),l(),c(4,"div",124)(5,"label"),d(6,"Column Name:"),l(),c(7,"input",125,2),_("input",function(o){v(t);let r=m(2);return y(r.newColumnName.set(o.target.value))})("keydown.enter",function(){v(t);let o=m(2);return y(o.addNewColumn())}),l(),c(9,"p",126),d(10," Use SDRF format: characteristics[name], comment[name], factor value[name] "),l()(),c(11,"div",127)(12,"button",128),_("click",function(){v(t);let o=m(2);return y(o.addNewColumn())}),d(13," Add Column "),l(),c(14,"button",129),_("click",function(){v(t);let o=m(2);return y(o.closeAddColumnDialog())}),d(15," Cancel "),l()()()()}if(n&2){let t=m(2);p(7),I("value",t.newColumnName()),p(5),I("disabled",!t.newColumnName().trim())}}function KT(n,e){if(n&1){let t=N();c(0,"div",43)(1,"div",44)(2,"div",45,1),_("scroll",function(o){v(t);let r=m();return y(r.onScroll(o))}),c(4,"div",46)(5,"table",47)(6,"colgroup"),re(7,"col",48)(8,"col",49),z(9,pT,1,0,"col",50,Ve),l(),c(11,"thead")(12,"tr")(13,"th",51)(14,"input",52),_("change",function(){v(t);let o=m();return y(o.toggleSelectAllVisible())}),l()(),c(15,"th",53),d(16,"#"),l(),z(17,gT,8,18,"th",54,Ve),l()(),c(19,"tbody"),x(20,hT,2,3,"tr",55),z(21,CT,7,8,"tr",56,Ut),l()()()(),x(23,vT,1,2,"sdrf-column-stats",57),l(),c(24,"div",58)(25,"label"),d(26," Go to row: "),c(27,"input",59),ft("ngModelChange",function(o){v(t);let r=m();return vt(r.jumpToRowInput,o)||(r.jumpToRowInput=o),y(o)}),_("keydown.enter",function(){v(t);let o=m();return y(o.jumpToRow())}),l()(),c(28,"button",60),_("click",function(){v(t);let o=m();return y(o.jumpToRow())}),d(29,"Go"),l()(),x(30,GT,28,7,"div",61),x(31,QT,25,4,"div",62),x(32,YT,16,2,"div",63),l(),c(33,"div",64)(34,"div",65),_("click",function(){v(t);let o=m();return y(o.toggleRecommendPanel())}),l(),c(35,"div",66)(36,"sdrf-recommend-panel",67),_("close",function(){v(t);let o=m();return y(o.toggleRecommendPanel())})("openSettings",function(){v(t);let o=m();return y(o.openLlmSettings())})("applyRecommendation",function(o){v(t);let r=m();return y(r.onApplyRecommendation(o))})("batchApply",function(o){v(t);let r=m();return y(r.onBatchApplyRecommendations(o))})("previewRecommendation",function(o){v(t);let r=m();return y(r.onPreviewRecommendation(o))})("applyFix",function(o){v(t);let r=m();return y(r.onApplyFix(o))}),l()()(),c(37,"column-editor-panel",68),_("close",function(){v(t);let o=m();return y(o.closeColumnEditor())})("applyBulkEdit",function(o){v(t);let r=m();return y(r.onBulkEditColumn(o))}),l()}if(n&2){let t=m();p(),B("with-sidebar",t.showStatsPanel()),p(3),vn("height",t.totalHeight()+40,"px"),p(5),$(t.table().columns),p(5),I("checked",t.isAllVisibleSelected())("indeterminate",t.isSomeVisibleSelected()),p(3),$(t.table().columns),p(3),S(t.tableOffset()>0?20:-1),p(),$(t.visibleRows()),p(2),S(t.showStatsPanel()?23:-1),p(4),I("max",t.table().sampleCount),pt("ngModel",t.jumpToRowInput),p(3),S(t.showValidationPanel()?30:-1),p(),S(t.contextMenu()?31:-1),p(),S(t.showAddColumnDialogFlag()?32:-1),p(),B("open",t.showRecommendPanel()),p(3),I("table",t.table()),p(),I("isOpen",t.showColumnEditor)("table",t.table)("columnIndex",t.columnEditorIndex)}}function ZT(n,e){if(n&1){let t=N();c(0,"div",15)(1,"div",130)(2,"h1"),d(3,"SDRF Editor"),l(),c(4,"p",131),d(5,"Sample and Data Relationship Format editor for proteomics metadata"),l()(),c(6,"div",132)(7,"button",133),_("click",function(){v(t);let o=m();return y(o.openWizard())}),d(8," \u2728 Create New SDRF "),l(),c(9,"button",134),_("click",function(){v(t),m();let o=Ta(5);return y(o.click())}),d(10," \u{1F4C2} Import SDRF File "),l(),c(11,"input",135),ft("ngModelChange",function(o){v(t);let r=m();return vt(r.loadUrlValue,o)||(r.loadUrlValue=o),y(o)}),_("keydown.enter",function(){v(t);let o=m();return y(o.onLoadUrlClick())}),l(),c(12,"button",26),_("click",function(){v(t);let o=m();return y(o.onLoadUrlClick())}),d(13,"Load URL"),l(),c(14,"button",26),_("click",function(){v(t);let o=m();return y(o.onLoadExampleClick())}),d(15,"Load Example"),l()(),c(16,"div",136)(17,"div",137)(18,"h2"),d(19,"What is SDRF?"),l(),c(20,"p"),d(21," The Sample and Data Relationship Format (SDRF) is a standardized format for annotating proteomics experiments. It captures the relationships between samples, experimental design, and data files in a structured, machine-readable way. "),l(),c(22,"p"),d(23," SDRF is part of the HUPO Proteomics Standards Initiative (PSI) and is widely used for submitting proteomics data to public repositories like PRIDE and ProteomeXchange. "),l()(),c(24,"div",137)(25,"h2"),d(26,"Getting Started"),l(),c(27,"ul",138)(28,"li")(29,"strong"),d(30,"Import:"),l(),d(31," Load an existing SDRF file (.tsv) from your computer"),l(),c(32,"li")(33,"strong"),d(34,"Create:"),l(),d(35," Build a new SDRF from scratch using our guided wizard"),l(),c(36,"li")(37,"strong"),d(38,"Edit:"),l(),d(39," Modify metadata with intelligent autocomplete and validation"),l(),c(40,"li")(41,"strong"),d(42,"Validate:"),l(),d(43," Check your SDRF against the official specification"),l(),c(44,"li")(45,"strong"),d(46,"AI Assist:"),l(),d(47," Get smart suggestions for filling and fixing metadata"),l()()(),c(48,"div",137)(49,"h2"),d(50,"Resources"),l(),c(51,"div",139)(52,"a",140)(53,"span",141),d(54,"\u{1F3E0}"),l(),c(55,"div")(56,"div",142),d(57,"SDRF Project"),l(),c(58,"div",143),d(59,"Official SDRF documentation and examples"),l()()(),c(60,"a",144)(61,"span",141),d(62,"\u{1F4CB}"),l(),c(63,"div")(64,"div",142),d(65,"Specification"),l(),c(66,"div",143),d(67,"Detailed format specification and rules"),l()()(),c(68,"a",145)(69,"span",141),d(70,"\u{1F4BB}"),l(),c(71,"div")(72,"div",142),d(73,"GitHub Repository"),l(),c(74,"div",143),d(75,"Source code, examples, and issue tracker"),l()()()()()(),c(76,"div",146)(77,"p",147),d(78,"Supported by the proteomics community"),l(),c(79,"div",148)(80,"a",149),re(81,"img",150),l(),c(82,"a",151),re(83,"img",152),l(),c(84,"a",153),re(85,"img",154),l()()()()}if(n&2){let t=m();p(11),pt("ngModel",t.loadUrlValue)}}function JT(n,e){if(n&1){let t=N();c(0,"div",155)(1,"div",156)(2,"span",157),d(3," Editing Row "),c(4,"strong"),d(5),l(),d(6,", Column: "),c(7,"strong"),d(8),l()(),c(9,"button",158),_("click",function(){v(t);let o=m();return y(o.cancelEditing())}),d(10,"\xD7"),l()(),c(11,"sdrf-cell-editor",159),_("save",function(o){v(t);let r=m();return y(r.onCellEditorSave(o))})("cancel",function(){v(t);let o=m();return y(o.cancelEditing())}),l()()}if(n&2){let t=m();vn("top",t.editorPosition().top,"px")("left",t.editorPosition().left,"px"),p(5),P(t.editingCell().row),p(3),P(t.editingColumn().name),p(3),I("value",t.getCellValue(t.editingCell().row,t.editingCell().col))("column",t.editingColumn())("rowIndex",t.editingCell().row)}}function XT(n,e){if(n&1){let t=N();c(0,"llm-settings-dialog",160),_("close",function(){v(t);let o=m();return y(o.closeLlmSettings())})("settingsSaved",function(){v(t);let o=m();return y(o.onLlmSettingsSaved())}),l()}}function eI(n,e){if(n&1){let t=N();c(0,"sdrf-wizard",161),_("complete",function(o){v(t);let r=m();return y(r.onWizardComplete(o))})("cancel",function(){v(t);let o=m();return y(o.closeWizard())}),l()}if(n&2){let t=m();I("aiEnabled",t.isAiConfigured())("availableTemplates",t.availableWizardTemplates)}}function tI(n,e){if(n&1){let t=N();c(0,"cache-recovery-panel",162),_("recover",function(o){v(t);let r=m();return y(r.onRecoverCache(o))})("dismiss",function(){v(t);let o=m();return y(o.dismissCacheRecovery())}),l()}}var zi=32,j0=10,kl=class n{constructor(e){this.ngZone=e;this.pyodideService=pl}ROW_HEIGHT=zi;url;exampleUrl;content;readonly=!1;availableWizardTemplates=["human","cell-lines","vertebrates","ms-proteomics"];tableChange=new W;validationComplete=new W;loadUrlRequested=new W;loadExampleRequested=new W;scrollContainer;table=w(null);loading=w(!1);loadingMessage=w("Loading...");error=w(null);selectedCell=w(null);editingCell=w(null);editingColumn=w(null);editorPosition=w({top:0,left:0});validationResult=w(null);scrollTop=w(0);containerHeight=w(500);jumpToRowInput=1;selectedSamples=w(new Set);selectedColumnForBulk=w(null);showStatsPanel=w(!1);showRecommendPanel=w(!1);bannerCollapsed=w(!1);showLlmSettingsDialog=w(!1);showWizard=w(!1);showValidationPanel=w(!1);showColumnEditor=w(!1);columnEditorIndex=w(-1);showCacheRecovery=w(!1);currentCacheId=w(null);changeCount=w(0);fileName=w("untitled.sdrf.tsv");pyodideService;cacheService=Al;pyodideValidating=w(!1);pyodideErrors=w([]);pyodideHasValidated=w(!1);selectedTemplates=w(["ms-proteomics"]);aggregatedErrors=A(()=>this.aggregateErrors(this.pyodideErrors()));pyodideState=A(()=>this.pyodideService.state());pyodideIsReady=A(()=>this.pyodideService.isReady());pyodideIsLoading=A(()=>this.pyodideService.isLoading());pyodideLoadProgress=A(()=>this.pyodideService.loadProgress());pyodideAvailableTemplates=A(()=>this.pyodideService.availableTemplates());pyodideErrorCount=A(()=>this.pyodideErrors().filter(e=>e.level==="error").length);pyodideWarningCount=A(()=>this.pyodideErrors().filter(e=>e.level==="warning").length);usingApiFallback=A(()=>this.pyodideService.usingApiFallback());apiAvailable=A(()=>this.pyodideService.apiAvailable());contextMenu=w(null);lastSelectedRow=null;loadUrlValue="";showFilterBar=w(!1);filteredIndices=w([]);sortColumn=w(-1);sortDirection=w("asc");sortedIndices=w([]);totalHeight=A(()=>{let e=this.table();return e?(this.filteredIndices().length>0?this.filteredIndices().length:e.sampleCount)*zi+zi+100:0});tableOffset=A(()=>{let e=this.visibleRange();return e?(e.start-1)*zi:0});visibleRange=A(()=>{let e=this.table();if(!e)return null;let t=this.scrollTop(),i=this.containerHeight(),o=Math.max(1,Math.floor(t/zi)-j0),r=Math.ceil(i/zi)+j0*2,s=Math.min(e.sampleCount,o+r);return{start:o,end:s}});effectiveRows=A(()=>{let e=this.table();if(!e)return[];let t=this.filteredIndices().length>0?[...this.filteredIndices()]:Array.from({length:e.sampleCount},(o,r)=>r+1),i=this.sortedIndices();if(i.length>0){let o=new Set(t);t=i.filter(r=>o.has(r))}return t});visibleRows=A(()=>{let e=this.visibleRange();if(!e)return[];let t=this.effectiveRows(),i=[];for(let o=e.start-1;o<e.end&&o<t.length;o++)t[o]&&i.push(t[o]);return i});parser=new Lr;validator=new jr;exporter=new zr;resizeObserver;ngOnInit(){if(this.cacheService.hasCachedTables()&&!this.url&&!this.content){this.showCacheRecovery.set(!0);return}this.url?this.loadFromUrl(this.url):this.content&&this.loadFromContent(this.content)}ngAfterViewInit(){this.scrollContainer&&(this.updateContainerHeight(),this.resizeObserver=new ResizeObserver(()=>{this.ngZone.run(()=>{this.updateContainerHeight()})}),this.resizeObserver.observe(this.scrollContainer.nativeElement))}ngOnChanges(e){e.url&&!e.url.firstChange&&this.url&&this.loadFromUrl(this.url),e.content&&!e.content.firstChange&&this.content&&this.loadFromContent(this.content)}ngOnDestroy(){this.resizeObserver?.disconnect()}loadFromUrl(e){return k(this,null,function*(){this.loading.set(!0),this.loadingMessage.set("Fetching file..."),this.error.set(null);try{let t=yield this.parser.parseFromUrl(e);this.handleParseResult(t)}catch(t){this.error.set(`Failed to load: ${t instanceof Error?t.message:String(t)}`)}finally{this.loading.set(!1)}})}loadFromContent(e){return k(this,null,function*(){this.loading.set(!0),this.loadingMessage.set("Parsing file..."),this.error.set(null);try{yield new Promise(i=>setTimeout(i,10));let t=this.parser.parseFromContent(e);this.handleParseResult(t)}catch(t){this.error.set(`Failed to parse: ${t instanceof Error?t.message:String(t)}`)}finally{this.loading.set(!1)}})}getTable(){return this.table()}validate(){return k(this,null,function*(){return this.table()&&(this.showValidationPanel.set(!0),yield this.runPyodideValidation()),null})}initPyodide(){return k(this,null,function*(){try{yield this.pyodideService.initialize();let e=this.pyodideAvailableTemplates();if(e.length===0)return;if(this.table()){let t=Io.exportToTsv(this.table()),o=this.pyodideService.detectTemplates(t).filter(s=>e.includes(s)),r=e.includes("ms-proteomics")?"ms-proteomics":e[0];this.selectedTemplates.set(o.length>0?o:[r])}else{let t=this.selectedTemplates().filter(o=>e.includes(o)),i=e.includes("ms-proteomics")?"ms-proteomics":e[0];this.selectedTemplates.set(t.length>0?t:[i])}}catch(e){console.error("Failed to initialize Pyodide:",e)}})}runPyodideValidation(){return k(this,null,function*(){if(!(!this.table()||this.pyodideValidating())){this.pyodideIsReady()||(yield this.initPyodide()),this.pyodideValidating.set(!0),this.pyodideErrors.set([]);try{let e=this.table(),t=Io.exportToTsv(e),i=e.columns.find(a=>a.name.includes("sdrf template"));if(i){console.log(`[Validate] Template column state: value="${i.value}", modifiers=${JSON.stringify(i.modifiers)}`);let a=t.split(`
`).slice(0,3);console.log("[Validate] First 3 TSV lines:",a)}let o=this.pyodideAvailableTemplates(),r=this.selectedTemplates().filter(a=>o.includes(a));r.length===0&&o.length>0&&(r=[o.includes("ms-proteomics")?"ms-proteomics":o[0]],this.selectedTemplates.set(r));let s=yield this.pyodideService.validate(t,r,{skipOntology:!0});this.pyodideErrors.set(s)}catch(e){console.error("Pyodide validation failed:",e),this.pyodideErrors.set([{message:`Validation failed: ${e instanceof Error?e.message:String(e)}`,row:-1,column:null,value:null,level:"error",suggestion:null}])}finally{this.pyodideValidating.set(!1),this.pyodideHasValidated.set(!0)}}})}aggregateErrors(e){let t=new Map;for(let i of e){let o=`${i.message}||${i.column||""}`;if(t.has(o)){let r=t.get(o);i.row>=0&&r.cells.push({row:i.row,value:i.value})}else t.set(o,{message:i.message,level:i.level,column:i.column,cells:i.row>=0?[{row:i.row,value:i.value}]:[],suggestion:i.suggestion})}return Array.from(t.values()).sort((i,o)=>i.level!==o.level?i.level==="error"?-1:1:o.cells.length-i.cells.length)}toggleTemplate(e){let t=this.selectedTemplates();t.includes(e)?this.selectedTemplates.set(t.filter(i=>i!==e)):this.selectedTemplates.set([...t,e])}closeValidationPanel(){this.showValidationPanel.set(!1)}jumpToValidationCell(e,t){if(e<0)return;let i=this.table();if(!i)return;let o=-1;t&&(o=i.columns.findIndex(r=>r.name===t)),this.jumpToRowInput=e+1,this.jumpToRow(),o>=0&&this.selectedCell.set({row:e+1,col:o})}sendErrorToAI(e){this.showRecommendPanel.set(!0)}exportTsv(){let e=this.table();if(!e)return;let t=e.metadata?.filename?.replace(/\.[^.]+$/,".tsv")||"sdrf.tsv";this.exporter.downloadTsv(e,t)}exportExcel(){return k(this,null,function*(){let e=this.table();if(!e)return;let t=e.metadata?.filename?.replace(/\.[^.]+$/,".xlsx")||"sdrf.xlsx";yield this.exporter.downloadExcel(e,t)})}onFileSelected(e){let t=e.target,i=t.files?.[0];i&&(this.loading.set(!0),this.loadingMessage.set(`Parsing ${i.name}...`),this.error.set(null),this.parser.parseFromFile(i).then(o=>{this.handleParseResult(o),this.loading.set(!1),t.value=""}))}onLoadUrlClick(){let e=this.loadUrlValue?.trim();e&&this.loadUrlRequested.emit(e)}onLoadExampleClick(){this.loadExampleRequested.emit()}onScroll(e){let t=e.target;this.scrollTop.set(t.scrollTop)}selectCell(e,t){this.selectedCell.set({row:e,col:t})}selectColumn(e){this.selectedCell.set({row:0,col:e})}startEditing(e,t){if(this.readonly)return;let i=this.table();if(!i||t>=i.columns.length)return;let o=`tr:nth-child(${e-(this.visibleRange()?.start??1)+1}) td:nth-child(${t+2})`,r=this.scrollContainer?.nativeElement.querySelector(o);if(r){let s=r.getBoundingClientRect(),a=s.bottom+4,u=s.left,f=400,g=300;u+f>window.innerWidth-20&&(u=window.innerWidth-f-20),u<20&&(u=20),a+g>window.innerHeight-20&&(a=s.top-g-4,a<20&&(a=20)),this.editorPosition.set({top:a,left:u})}else this.editorPosition.set({top:window.innerHeight/2-150,left:window.innerWidth/2-200});this.editingCell.set({row:e,col:t}),this.editingColumn.set(i.columns[t])}onCellEditorSave(e){let t=this.editingCell();if(!t){this.cancelEditing();return}this.setCellValue(t.row,t.col,e),this.editingCell.set(null),this.editingColumn.set(null)}cancelEditing(){this.editingCell.set(null),this.editingColumn.set(null)}clearError(){this.error.set(null)}clearValidation(){this.validationResult.set(null)}jumpToRow(){let e=this.table();if(!e||!this.scrollContainer)return;let t=Math.max(1,Math.min(this.jumpToRowInput,e.sampleCount)),i=(t-1)*zi;this.scrollContainer.nativeElement.scrollTop=i,this.scrollTop.set(i),this.selectedCell.set({row:t,col:0})}getCellValue(e,t){let i=this.table();if(!i||t>=i.columns.length)return"";let o=i.columns[t];return de(o,e)}setCellValue(e,t,i){let o=this.table();if(!o||t>=o.columns.length)return;let r=O(E({},o),{columns:[...o.columns]}),s=O(E({},r.columns[t]),{modifiers:[...r.columns[t].modifiers]});if(i===s.value)s.modifiers=s.modifiers.filter(a=>!a.samples.split(",").map(f=>parseInt(f.trim(),10)).includes(e));else{let a=s.modifiers.find(u=>u.value===i);a?a.samples=`${a.samples},${e}`:s.modifiers.push({samples:String(e),value:i})}r.columns[t]=s,this.table.set(r),this.tableChange.emit(r),this.autoSaveTable()}isSelected(e,t){let i=this.selectedCell();return i?.row===e&&i?.col===t}hasCellError(e,t){let i=this.validationResult();if(!i)return!1;let o=this.table();if(!o)return!1;let r=o.columns[t];return i.errors.some(s=>s.column?.toLowerCase()===r.name.toLowerCase()&&(!s.row||s.row===e))}RESERVED_VALUES=["not available","not applicable","anonymized","pooled"];isReservedValue(e){if(!e)return!1;let t=e.toLowerCase().trim();return this.RESERVED_VALUES.includes(t)}isReservedValueType(e,t){return e?e.toLowerCase().trim()===t.toLowerCase():!1}updateContainerHeight(){this.scrollContainer&&this.containerHeight.set(this.scrollContainer.nativeElement.clientHeight)}handleParseResult(e){e.success&&e.table?(this.table.set(e.table),this.tableChange.emit(e.table),this.validationResult.set(null),this.scrollTop.set(0),this.clearSelection(),this.currentCacheId.set(null),this.changeCount.set(0),e.warnings.length>0&&console.warn("Parse warnings:",e.warnings),console.log(`Loaded ${e.table.sampleCount} samples, ${e.table.columns.length} columns in ${e.stats.parseTimeMs.toFixed(0)}ms`)):this.error.set(e.error||"Unknown error")}toggleStatsPanel(){this.showStatsPanel.set(!this.showStatsPanel())}toggleRecommendPanel(){this.showRecommendPanel.set(!this.showRecommendPanel())}toggleBanner(){this.bannerCollapsed.set(!this.bannerCollapsed())}openLlmSettings(){this.showLlmSettingsDialog.set(!0)}closeLlmSettings(){this.showLlmSettingsDialog.set(!1)}onLlmSettingsSaved(){console.log("LLM settings saved")}openColumnEditor(e){this.columnEditorIndex.set(e),this.showColumnEditor.set(!0)}closeColumnEditor(){this.showColumnEditor.set(!1),this.columnEditorIndex.set(-1)}onBulkEditColumn(e){let t=this.table();if(!t||e.columnIndex<0||e.columnIndex>=t.columns.length){console.error("Invalid column index for bulk edit:",e.columnIndex);return}let i=t.columns[e.columnIndex];for(let o of e.sampleIndices)o>=1&&o<=t.sampleCount&&Xu(i,o,e.value);this.table.set(E({},t)),this.tableChange.emit(t),this.autoSaveTable(),console.log(`Bulk edited column "${i.name}" for ${e.sampleIndices.length} samples`),this.closeColumnEditor()}onRecoverCache(e){let t=this.cacheService.loadTable(e.cacheId);if(!t){console.error("Failed to load cached table:",e.cacheId);return}this.table.set(t.table),this.tableChange.emit(t.table),this.currentCacheId.set(e.cacheId),this.changeCount.set(t.entry.changeCount),this.fileName.set(t.entry.fileName),this.showCacheRecovery.set(!1),console.log(`Recovered table from cache: ${t.entry.fileName}`)}dismissCacheRecovery(){this.showCacheRecovery.set(!1)}autoSaveTable(){let e=this.table(),t=this.fileName();if(!e||!t)return;let i=this.changeCount()+1;this.changeCount.set(i);let o=this.cacheService.saveTable(e,t,this.currentCacheId()||void 0,i);o&&!this.currentCacheId()&&this.currentCacheId.set(o)}onApplyRecommendation(e){let t=e.recommendation;if(t.type==="add_column"){this.addColumnWithValue(t.column,t.suggestedValue,t.sampleIndices);return}this.applyRecommendationToTable(t)}addColumnWithValue(e,t,i){let o=this.table();if(!o)return;console.log(`[AddColumn] Adding column "${e}" with value "${t}" for ${i.length} samples`);let r=e.toLowerCase(),s="special";r.startsWith("characteristics[")?s="characteristics":r.startsWith("comment[")?s="comment":r.startsWith("factor value[")?s="factor_value":r==="source name"&&(s="source_name");let a={name:e.toLowerCase().trim(),type:s,value:t,modifiers:[],columnPosition:o.columns.length,isRequired:!1},u=O(E({},o),{columns:[...o.columns,a]});this.table.set(u),this.tableChange.emit(u),console.log(`[AddColumn] Added column "${e}" to table`)}onBatchApplyRecommendations(e){for(let t of e.recommendations)this.applyRecommendationToTable(t);console.log(`Applied ${e.recommendations.length} recommendations`)}onApplyFix(e){this.table.set(e.table),this.tableChange.emit(e.table),this.selectedCell.set(null),this.clearSelection(),this.scrollContainer&&(this.scrollContainer.nativeElement.scrollTop=0,this.scrollTop.set(0)),console.log(`Applied fix: ${e.fix.description} (${e.result.changesCount} changes)`)}onPreviewRecommendation(e){if(e.sampleIndices.length>0){let t=e.sampleIndices[0];this.jumpToRowInput=t,this.jumpToRow(),this.selectCell(t,e.columnIndex)}}applyRecommendationToTable(e){let t=this.table();if(!t||e.columnIndex<0||e.columnIndex>=t.columns.length)return;let i=t.columns[e.columnIndex],o=e.sampleIndices;if(console.log(`[ApplyRec] Starting: column="${e.column}", currentValue="${e.currentValue}", suggestedValue="${e.suggestedValue}", sampleIndices=${JSON.stringify(o)}`),console.log(`[ApplyRec] Column state: value="${i.value}", modifiers=${JSON.stringify(i.modifiers)}`),o.length===0)if(e.currentValue!==void 0&&e.currentValue!=="")o=this.findSamplesWithValue(i,e.currentValue,t.sampleCount),console.log(`[ApplyRec] Found ${o.length} samples with currentValue "${e.currentValue}"`);else{this.setColumnDefaultValue(e.columnIndex,e.suggestedValue),console.log(`[ApplyRec] Applied to all samples: set default value to "${e.suggestedValue}"`);return}if(o.length===0){console.warn(`[ApplyRec] No samples found to apply recommendation for ${e.column}. Column value="${i.value}", searching for="${e.currentValue}"`);return}if(o.length===t.sampleCount&&i.modifiers.length===0){this.setColumnDefaultValue(e.columnIndex,e.suggestedValue),console.log(`[ApplyRec] Applied to all ${t.sampleCount} samples via default value: "${e.suggestedValue}"`);return}this.setCellValuesBulk(e.columnIndex,o,e.suggestedValue),console.log(`[ApplyRec] Applied recommendation to ${e.column}: "${e.suggestedValue}" for ${o.length} samples`)}findSamplesWithValue(e,t,i){let o=t.toLowerCase().trim(),r=e.value.toLowerCase().trim(),s=[],a=r===o;console.log(`[FindSamples] Searching for: "${o}"`),console.log(`[FindSamples] Column default: "${r}", matches=${a}`),console.log(`[FindSamples] Modifiers count: ${e.modifiers.length}`);let u=new Set;for(let f of e.modifiers){let g=f.value.toLowerCase().trim(),h=g===o,b=this.parseSampleRange(f.samples);console.log(`[FindSamples] Modifier: "${g}", matches=${h}, samples=${b.length}`);for(let C of b)u.add(C),h&&s.push(C)}if(a){for(let f=1;f<=i;f++)u.has(f)||s.push(f);console.log(`[FindSamples] Added ${i-u.size} samples from default value`)}return console.log(`[FindSamples] Total samples found: ${s.length}`),s}parseSampleRange(e){let t=[],i=e.split(",");for(let o of i){let r=o.trim();if(r.includes("-")){let[s,a]=r.split("-").map(Number);if(!isNaN(s)&&!isNaN(a))for(let u=s;u<=a;u++)t.push(u)}else{let s=Number(r);isNaN(s)||t.push(s)}}return t}setColumnDefaultValue(e,t){let i=this.table();if(!i||e>=i.columns.length)return;let o=O(E({},i),{columns:[...i.columns]}),r=E({},o.columns[e]);r.value=t,r.modifiers=[],o.columns[e]=r,this.table.set(o),this.tableChange.emit(o)}setCellValuesBulk(e,t,i){let o=this.table();if(!o||e>=o.columns.length)return;let r=O(E({},o),{columns:[...o.columns]}),s=O(E({},r.columns[e]),{modifiers:[...r.columns[e].modifiers]}),a=new Set(t);if(i===s.value)s.modifiers=s.modifiers.map(u=>{let g=this.parseSampleRange(u.samples).filter(h=>!a.has(h));return g.length===0?null:O(E({},u),{samples:this.compactSampleRange(g)})}).filter(u=>u!==null);else{s.modifiers=s.modifiers.map(f=>{let h=this.parseSampleRange(f.samples).filter(b=>!a.has(b));return h.length===0?null:O(E({},f),{samples:this.compactSampleRange(h)})}).filter(f=>f!==null);let u=s.modifiers.find(f=>f.value===i);if(u){let f=this.parseSampleRange(u.samples),g=[...new Set([...f,...t])].sort((h,b)=>h-b);u.samples=this.compactSampleRange(g)}else s.modifiers.push({samples:this.compactSampleRange(t.sort((f,g)=>f-g)),value:i})}r.columns[e]=s,this.table.set(r),this.tableChange.emit(r)}compactSampleRange(e){if(e.length===0)return"";if(e.length===1)return String(e[0]);let t=[...e].sort((s,a)=>s-a),i=[],o=t[0],r=t[0];for(let s=1;s<t.length;s++)t[s]===r+1||(i.push(o===r?String(o):`${o}-${r}`),o=t[s]),r=t[s];return i.push(o===r?String(o):`${o}-${r}`),i.join(",")}isRowSelected(e){return this.selectedSamples().has(e)}toggleRowSelection(e,t){let i=t.target,o=new Set(this.selectedSamples());i.checked?o.add(e):o.delete(e),this.selectedSamples.set(o),this.lastSelectedRow=e}onRowHeaderClick(e,t){let i=new Set(this.selectedSamples());if(t.shiftKey&&this.lastSelectedRow!==null){let o=Math.min(this.lastSelectedRow,e),r=Math.max(this.lastSelectedRow,e);for(let s=o;s<=r;s++)i.add(s)}else t.ctrlKey||t.metaKey?i.has(e)?i.delete(e):i.add(e):(i.clear(),i.add(e));this.selectedSamples.set(i),this.lastSelectedRow=e}isAllVisibleSelected(){let e=this.visibleRows();return e.length===0?!1:e.every(t=>this.selectedSamples().has(t))}isSomeVisibleSelected(){let e=this.visibleRows(),t=this.selectedSamples(),i=e.some(r=>t.has(r)),o=e.every(r=>t.has(r));return i&&!o}toggleSelectAllVisible(){let e=this.visibleRows(),t=new Set(this.selectedSamples());if(this.isAllVisibleSelected())for(let i of e)t.delete(i);else for(let i of e)t.add(i);this.selectedSamples.set(t)}clearSelection(){this.selectedSamples.set(new Set),this.selectedColumnForBulk.set(null),this.lastSelectedRow=null}onCellContextMenu(e,t,i){e.preventDefault(),this.contextMenu.set({x:e.clientX,y:e.clientY,row:t,col:i})}closeContextMenu(){this.contextMenu.set(null)}selectAllWithSameValue(){let e=this.contextMenu();if(!e)return;let t=this.getCellValue(e.row,e.col),i=this.table();if(!i)return;let o=new Set(this.selectedSamples());for(let r=1;r<=i.sampleCount;r++)this.getCellValue(r,e.col)===t&&o.add(r);this.selectedSamples.set(o),this.closeContextMenu()}selectAllInColumn(){let e=this.contextMenu(),t=this.table();if(!e||!t)return;let i=new Set;for(let o=1;o<=t.sampleCount;o++)i.add(o);this.selectedSamples.set(i),this.selectedColumnForBulk.set(e.col),this.closeContextMenu()}editSelectedCells(){let e=this.contextMenu();e&&this.startEditing(e.row,e.col),this.closeContextMenu()}clearSelectedCells(){let e=this.contextMenu(),t=this.selectedSamples();if(!e||t.size===0){this.closeContextMenu();return}this.bulkSetValue(e.col,"",Array.from(t)),this.closeContextMenu()}addRowAtEnd(){let e=this.table();if(!e)return;let t=O(E({},e),{sampleCount:e.sampleCount+1,columns:e.columns.map(i=>i.modifiers.length>0?O(E({},i),{modifiers:[...i.modifiers,{samples:`${e.sampleCount+1}`,value:""}]}):i)});this.table.set(t),this.closeContextMenu()}insertRowAbove(){let e=this.contextMenu();e&&this.insertRowAt(e.row)}insertRowBelow(){let e=this.contextMenu();e&&this.insertRowAt(e.row+1)}insertRowAt(e){let t=this.table();if(!t)return;let i=t.columns.map(r=>{if(r.modifiers.length===0)return O(E({},r),{modifiers:[{samples:`${e}`,value:""}]});let s=r.modifiers.map(a=>{let u=a.samples.split(",").map(f=>{if(f.includes("-")){let[h,b]=f.split("-").map(Number),C=h>=e?h+1:h,T=b>=e?b+1:b;return`${C}-${T}`}let g=parseInt(f);return g>=e?`${g+1}`:f});return O(E({},a),{samples:u.join(",")})});return s.push({samples:`${e}`,value:""}),O(E({},r),{modifiers:s})}),o=O(E({},t),{sampleCount:t.sampleCount+1,columns:i});this.table.set(o),this.closeContextMenu()}deleteSelectedRows(){let e=this.table(),t=this.selectedSamples();if(!e||t.size===0){this.closeContextMenu();return}let i=Array.from(t).sort((a,u)=>u-a),o=e.columns.map(a=>{if(a.modifiers.length===0)return a;let u=a.modifiers.filter(f=>{let g=f.samples.split(",");for(let h of g)if(h.includes("-")){let[b,C]=h.split("-").map(Number);if(!Array.from({length:C-b+1},(F,U)=>b+U).every(F=>t.has(F)))return!0}else if(!t.has(parseInt(h)))return!0;return!1});for(let f of i)u=u.map(g=>{let h=g.samples.split(",").map(b=>{if(b.includes("-")){let[T,F]=b.split("-").map(Number),U=T>f?T-1:T,K=F>f?F-1:F;return`${U}-${K}`}let C=parseInt(b);return C>f?`${C-1}`:b});return O(E({},g),{samples:h.join(",")})});return O(E({},a),{modifiers:u})}),r=e.sampleCount-t.size,s=O(E({},e),{sampleCount:r,columns:o});this.table.set(s),this.clearSelection(),this.closeContextMenu()}showAddColumnDialogFlag=w(!1);newColumnName=w("");showAddColumnDialog(){this.showAddColumnDialogFlag.set(!0),this.newColumnName.set(""),this.closeContextMenu()}closeAddColumnDialog(){this.showAddColumnDialogFlag.set(!1),this.newColumnName.set("")}addNewColumn(){let e=this.newColumnName().trim();if(!e)return;let t=this.table();if(!t)return;let i="special",o=e.toLowerCase();o.startsWith("characteristics[")?i="characteristics":o.startsWith("comment[")?i="comment":o.startsWith("factor value[")&&(i="factor_value");let r=this.findColumnInsertPosition(t.columns,i),s={name:e,type:i,columnPosition:r,value:"",modifiers:[],isRequired:!1},a=[...t.columns];a.splice(r,0,s);for(let f=r;f<a.length;f++)a[f]=O(E({},a[f]),{columnPosition:f});let u=O(E({},t),{columns:a});this.table.set(u),this.closeAddColumnDialog()}findColumnInsertPosition(e,t){let i={source_name:0,characteristics:1,comment:2,factor_value:3,special:4},o=i[t]??4,r=-1,s=e.length;for(let a=0;a<e.length;a++){let u=e[a].type,f=i[u]??4;u===t?r=a:f>o&&s===e.length&&(s=a)}return r>=0?r+1:s}deleteColumn(){let e=this.contextMenu(),t=this.table();if(!e||!t)return;let i=e.col;if(i<0||i>=t.columns.length){this.closeContextMenu();return}let o=t.columns[i].name;if(!confirm(`Delete column "${o}"? This cannot be undone.`)){this.closeContextMenu();return}let r=t.columns.filter((a,u)=>u!==i).map((a,u)=>O(E({},a),{columnPosition:u})),s=O(E({},t),{columns:r});this.table.set(s),this.closeContextMenu()}onSelectByValue(e){let t=new Set(this.selectedSamples());for(let i of e.sampleIndices)t.add(i);this.selectedSamples.set(t)}onSelectSamples(e){this.selectedSamples.set(new Set(e))}onStatsPanelBulkEdit(e){this.bulkSetValue(e.columnIndex,e.newValue,e.sampleIndices)}onBulkColumnEdit(e){this.bulkSetValue(e.columnIndex,e.newValue,e.sampleIndices)}onCopyFromFirst(e){let t=Array.from(this.selectedSamples()).sort((r,s)=>r-s);if(t.length<2)return;let i=this.getCellValue(t[0],e),o=t.slice(1);this.bulkSetValue(e,i,o)}bulkSetValue(e,t,i){let o=this.table();if(!o||e>=o.columns.length)return;let r=O(E({},o),{columns:[...o.columns]}),s=O(E({},r.columns[e]),{modifiers:[...r.columns[e].modifiers]});for(let a of i)Xu(s,a,t);r.columns[e]=s,this.table.set(r),this.tableChange.emit(r),console.log(`Bulk updated ${i.length} samples in column "${s.name}" to "${t}"`)}getColumnTypeClass(e){let t=e.toLowerCase().trim();return t==="source name"||t==="sample name"?"source":t.startsWith("characteristics[")?"characteristic":t.startsWith("factor value[")||t.startsWith("factorvalue[")?"factor":"comment"}getColumnTooltip(e){let t=Eo(e);if(!t)return e;let i=[];if(t.description&&i.push(t.description),t.isRequired&&i.push("(Required column)"),t.ontologies&&t.ontologies.length>0&&i.push(`Ontologies: ${t.ontologies.join(", ")}`),t.examples&&t.examples.length>0){let o=t.examples.slice(0,3).join(", ");i.push(`Examples: ${o}`)}return i.length>0?i.join(`
`):e}onHeaderClick(e,t){if(t.ctrlKey||t.metaKey||t.shiftKey){this.selectColumn(e);return}if(this.sortColumn()===e)if(this.sortDirection()==="asc")this.sortDirection.set("desc");else{this.sortColumn.set(-1),this.sortedIndices.set([]);return}else this.sortColumn.set(e),this.sortDirection.set("asc");this.applySorting()}applySorting(){let e=this.table(),t=this.sortColumn();if(!e||t<0){this.sortedIndices.set([]);return}let i=[];for(let r=1;r<=e.sampleCount;r++)i.push([r,this.getCellValue(r,t)]);let o=this.sortDirection()==="asc"?1:-1;i.sort((r,s)=>{let a=r[1].toLowerCase(),u=s[1].toLowerCase(),f=parseFloat(a),g=parseFloat(u);return!isNaN(f)&&!isNaN(g)?(f-g)*o:a.localeCompare(u)*o}),this.sortedIndices.set(i.map(r=>r[0]))}getActualRowIndex(e){let t=this.sortedIndices();return t.length===0?e:t[e-1]||e}toggleFilterBar(){this.showFilterBar.set(!this.showFilterBar())}onFilterChange(e){e.matchingIndices.length===e.totalCount?this.filteredIndices.set([]):this.filteredIndices.set(e.matchingIndices),this.scrollTop.set(0),this.scrollContainer&&(this.scrollContainer.nativeElement.scrollTop=0)}openWizard(){this.showWizard.set(!0)}closeWizard(){this.showWizard.set(!1)}onWizardComplete(e){this.showWizard.set(!1),this.table.set(e),this.tableChange.emit(e),this.selectedCell.set(null),this.clearSelection(),this.filteredIndices.set([]),this.scrollTop.set(0),this.validate()}isAiConfigured(){let e=localStorage.getItem("llm_settings");if(!e)return!1;try{let t=JSON.parse(e);return!!(t.provider&&(t.apiKey||t.provider==="ollama"))}catch{return!1}}static \u0275fac=function(t){return new(t||n)(Ee(Je))};static \u0275cmp=ee({type:n,selectors:[["sdrf-editor-table"]],viewQuery:function(t,i){if(t&1&&_r(nT,5),t&2){let o;Cr(o=vr())&&(i.scrollContainer=o.first)}},inputs:{url:"url",exampleUrl:"exampleUrl",content:"content",readonly:"readonly",availableWizardTemplates:"availableWizardTemplates"},outputs:{tableChange:"tableChange",validationComplete:"validationComplete",loadUrlRequested:"loadUrlRequested",loadExampleRequested:"loadExampleRequested"},features:[Fe],decls:23,vars:17,consts:[["fileInput",""],["scrollContainer",""],["newColInput",""],[1,"sdrf-editor"],[1,"top-banner",3,"collapsed"],[1,"sdrf-toolbar"],[1,"toolbar-left"],["type","file","accept",".tsv,.txt,.sdrf",2,"display","none",3,"change"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-create",3,"click"],[1,"toolbar-right"],[1,"loading-overlay"],[1,"error-banner"],[3,"clearSelection","bulkEdit","copyFromFirst","table","selectedCount","selectedSamples","preselectedColumn"],[3,"table"],[1,"landing-page"],[1,"cell-editor-popup",3,"top","left"],[3,"aiEnabled","availableTemplates"],[1,"top-banner"],[1,"banner-content"],[1,"banner-toggle",3,"click","title"],[1,"banner-left"],[1,"banner-title"],[1,"banner-nav"],["href","https://sdrf.quantms.org/","target","_blank",1,"nav-link"],["href","https://sdrf.quantms.org/specification.html","target","_blank",1,"nav-link"],[1,"btn","btn-secondary",3,"click"],[1,"unsaved-indicator",3,"title"],[1,"toolbar-divider"],["title","Add a new row at the end",1,"btn","btn-secondary",3,"click"],["title","Add a new column",1,"btn","btn-secondary",3,"click"],["title","Filter rows",1,"btn",3,"click"],["title","Show column statistics",1,"btn",3,"click"],["title","AI-powered recommendations",1,"btn","btn-ai",3,"click"],[1,"column-legend"],[1,"legend-item","source"],[1,"legend-item","characteristic"],[1,"legend-item","comment"],[1,"legend-item","factor"],[1,"table-info"],[1,"loading-spinner"],[1,"btn-close",3,"click"],[3,"filterChange","table"],[1,"sdrf-content"],[1,"table-row"],[1,"sdrf-table-container",3,"scroll"],[1,"table-scroll-area"],[1,"sdrf-table"],[1,"col-checkbox"],[1,"col-rownum"],[1,"col-data"],[1,"row-header","checkbox-col"],["type","checkbox","title","Select all visible rows",3,"change","checked","indeterminate"],[1,"row-header"],[1,"data-col",3,"col-type-source","col-type-characteristic","col-type-comment","col-type-factor","required","selected","sorted","title"],[1,"virtual-spacer",3,"height"],[3,"selected","row-selected","height"],[3,"table","selectedSamples"],[1,"jump-to-row"],["type","number","min","1",1,"jump-input",3,"ngModelChange","keydown.enter","max","ngModel"],[1,"btn","btn-small",3,"click"],[1,"validation-panel-container"],[1,"context-menu",3,"top","left"],[1,"dialog-backdrop"],[1,"ai-panel-container"],[1,"ai-panel-backdrop",3,"click"],[1,"ai-panel-wrapper"],[3,"close","openSettings","applyRecommendation","batchApply","previewRecommendation","applyFix","table"],[3,"close","applyBulkEdit","isOpen","table","columnIndex"],[1,"data-col",3,"click","title"],[1,"col-header-content"],[1,"col-name"],[1,"required-marker"],[1,"sort-indicator"],["title","Bulk edit this column",1,"bulk-edit-btn",3,"click"],[1,"virtual-spacer"],["type","checkbox",3,"change","click","checked"],[1,"row-header",3,"click"],[3,"selected","has-error"],[3,"click","dblclick","contextmenu"],[1,"cell-value"],[3,"close","selectByValue","bulkEdit","selectSamples","table","selectedSamples"],[1,"validation-panel-header"],[1,"validation-title"],["title","Using EBI PRIDE SDRF Validator API",1,"pyodide-status","api-fallback"],[1,"pyodide-status","loading"],[1,"pyodide-status","ready"],[1,"pyodide-status","error"],[1,"validation-panel-body"],[1,"template-selector-row"],[1,"template-label"],[1,"template-chips"],[1,"template-loading"],[1,"btn","btn-primary","btn-sm",3,"click","disabled"],[1,"validation-summary-row"],[1,"validation-errors-list"],[1,"validation-loading"],[1,"template-chip",3,"selected"],[1,"template-chip"],["type","checkbox",3,"change","checked"],[1,"spinner-sm"],[1,"validation-success"],[1,"error-badge"],[1,"warning-badge"],[1,"validation-error-card",3,"level-error","level-warning"],[1,"validation-error-card"],[1,"error-main"],[1,"error-icon"],[1,"error-content"],[1,"error-message"],[1,"error-column"],[1,"error-cells"],[1,"error-suggestion"],["title","Ask AI for help",1,"btn","btn-ai-assist",3,"click"],[1,"cells-label"],[1,"cells-list"],[1,"cell-link"],[1,"cells-more"],[1,"cell-link",3,"click"],[1,"spinner"],[1,"context-menu"],[3,"click"],[1,"dialog-backdrop",3,"click"],[1,"dialog-content",3,"click"],[1,"dialog-form"],["type","text","placeholder","e.g., characteristics[tissue], comment[notes]",3,"input","keydown.enter","value"],[1,"dialog-hint"],[1,"dialog-actions"],[1,"btn","btn-primary",3,"click","disabled"],[1,"btn",3,"click"],[1,"landing-header"],[1,"tagline"],[1,"landing-actions"],[1,"btn","btn-create","btn-large",3,"click"],[1,"btn","btn-primary","btn-large",3,"click"],["type","text","placeholder","Enter SDRF URL...",1,"url-input",3,"ngModelChange","keydown.enter","ngModel"],[1,"landing-content"],[1,"info-section"],[1,"feature-list"],[1,"resource-links"],["href","https://sdrf.quantms.org/","target","_blank",1,"resource-link"],[1,"link-icon"],[1,"link-title"],[1,"link-desc"],["href","https://sdrf.quantms.org/specification.html","target","_blank",1,"resource-link"],["href","https://github.com/bigbio/proteomics-metadata-standard","target","_blank",1,"resource-link"],[1,"landing-footer"],[1,"footer-text"],[1,"partner-logos"],["href","https://eubic-ms.org/","target","_blank","title","EuBIC-MS",1,"partner-logo"],["src","assets/images/eubic-logo.png","alt","EuBIC-MS Logo",1,"logo-image"],["href","https://psidev.info/","target","_blank","title","HUPO-PSI",1,"partner-logo"],["src","assets/images/psi-logo.png","alt","HUPO-PSI Logo",1,"logo-image"],["href","https://quantms.org/","target","_blank","title","QuantMS",1,"partner-logo"],["src","assets/images/quantms-logo.png","alt","QuantMS Logo",1,"logo-image"],[1,"cell-editor-popup"],[1,"cell-editor-context"],[1,"context-info"],["title","Close",1,"btn-close",3,"click"],[3,"save","cancel","value","column","rowIndex"],[3,"close","settingsSaved"],[3,"complete","cancel","aiEnabled","availableTemplates"],[3,"recover","dismiss"]],template:function(t,i){if(t&1){let o=N();c(0,"div",3),x(1,oT,4,5,"div",4),c(2,"div",5)(3,"div",6)(4,"input",7,0),_("change",function(s){return v(o),y(i.onFileSelected(s))}),l(),c(6,"button",8),_("click",function(){v(o);let s=Ta(5);return y(s.click())}),d(7," Import File "),l(),c(8,"button",9),_("click",function(){return v(o),y(i.openWizard())}),d(9," Create New "),l(),x(10,sT,17,7),l(),c(11,"div",10),x(12,lT,12,3),l()(),x(13,cT,4,1,"div",11),x(14,dT,5,1,"div",12),c(15,"sdrf-bulk-toolbar",13),_("clearSelection",function(){return v(o),y(i.clearSelection())})("bulkEdit",function(s){return v(o),y(i.onBulkColumnEdit(s))})("copyFromFirst",function(s){return v(o),y(i.onCopyFromFirst(s))}),l(),x(16,uT,1,1,"sdrf-filter-bar",14),x(17,KT,38,19)(18,ZT,86,1,"div",15),x(19,JT,12,9,"div",16),x(20,XT,1,0,"llm-settings-dialog"),x(21,eI,1,2,"sdrf-wizard",17),x(22,tI,1,0,"cache-recovery-panel"),l()}t&2&&(B("loading",i.loading()),p(),S(i.table()?1:-1),p(9),S(i.table()?10:-1),p(2),S(i.table()?12:-1),p(),S(i.loading()?13:-1),p(),S(i.error()?14:-1),p(),I("table",i.table())("selectedCount",i.selectedSamples().size)("selectedSamples",i.selectedSamples())("preselectedColumn",i.selectedColumnForBulk()),p(),S(i.table()&&i.showFilterBar()?16:-1),p(),S(i.table()?17:!i.loading()&&!i.error()?18:-1),p(2),S(i.editingCell()&&i.editingColumn()?19:-1),p(),S(i.showLlmSettingsDialog()?20:-1),p(),S(i.showWizard()?21:-1),p(),S(i.showCacheRecovery()?22:-1))},dependencies:[te,ce,ye,tn,Me,nn,Rn,xe,Xa,el,tl,nl,ml,gl,Il,Pl,Nl],styles:["[_nghost-%COMP%]{display:block;height:100%;overflow:hidden}.sdrf-editor[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;font-size:14px;overflow:hidden}sdrf-bulk-toolbar[_ngcontent-%COMP%], sdrf-filter-bar[_ngcontent-%COMP%]{display:block;flex-shrink:0}.top-banner[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:16px 24px;border-bottom:3px solid #5a67d8;flex-shrink:0;transition:all .3s ease}.top-banner.collapsed[_ngcontent-%COMP%]{padding:8px 24px}.banner-content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;flex:1;gap:24px}.banner-left[_ngcontent-%COMP%]{flex:1}.banner-title[_ngcontent-%COMP%]{margin:0;font-size:20px;font-weight:600}.banner-subtitle[_ngcontent-%COMP%]{margin:4px 0 0;font-size:13px;opacity:.9}.banner-nav[_ngcontent-%COMP%]{display:flex;gap:16px}.nav-link[_ngcontent-%COMP%]{color:#fff;text-decoration:none;font-size:13px;font-weight:500;padding:6px 12px;border-radius:4px;background:#ffffff26;transition:all .2s}.nav-link[_ngcontent-%COMP%]:hover{background:#ffffff40;transform:translateY(-1px)}.banner-toggle[_ngcontent-%COMP%]{background:#fff3;border:none;color:#fff;padding:4px 12px;border-radius:4px;cursor:pointer;font-size:14px;transition:all .2s;margin-left:12px}.banner-toggle[_ngcontent-%COMP%]:hover{background:#ffffff4d}.landing-page[_ngcontent-%COMP%]{flex:1;overflow-y:auto;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;display:flex;flex-direction:column}.landing-header[_ngcontent-%COMP%]{text-align:center;padding:60px 40px 40px}.landing-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:48px;margin:0 0 16px;font-weight:700;text-shadow:0 2px 4px rgba(0,0,0,.2)}.tagline[_ngcontent-%COMP%]{font-size:18px;margin:0;opacity:.95}.landing-actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;align-items:center;justify-content:center;gap:12px;padding:0 40px 40px}.landing-actions[_ngcontent-%COMP%]   .url-input[_ngcontent-%COMP%]{padding:10px 14px;border:1px solid rgba(255,255,255,.5);border-radius:6px;font-size:14px;min-width:280px;background:#ffffff26;color:#fff}.landing-actions[_ngcontent-%COMP%]   .url-input[_ngcontent-%COMP%]::placeholder{color:#ffffffb3}.btn-large[_ngcontent-%COMP%]{padding:14px 32px;font-size:16px;font-weight:600;box-shadow:0 4px 12px #00000026;transition:all .2s}.btn-large[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 6px 16px #0003}.landing-content[_ngcontent-%COMP%]{flex:1;background:#fff;color:#1f2937;border-radius:24px 24px 0 0;padding:48px 40px;display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:40px;max-width:1200px;margin:0 auto;width:100%}.info-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:22px;margin:0 0 16px;color:#667eea;font-weight:600}.info-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 12px;line-height:1.6;color:#4b5563}.feature-list[_ngcontent-%COMP%]{margin:0;padding-left:20px;line-height:1.8}.feature-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:8px;color:#4b5563}.feature-list[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#1f2937}.resource-links[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.resource-link[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:16px;background:#f9fafb;border:2px solid #e5e7eb;border-radius:8px;text-decoration:none;transition:all .2s}.resource-link[_ngcontent-%COMP%]:hover{border-color:#667eea;background:#f3f4f6;transform:translate(4px)}.link-icon[_ngcontent-%COMP%]{font-size:28px;flex-shrink:0}.link-title[_ngcontent-%COMP%]{font-weight:600;color:#1f2937;margin-bottom:2px}.link-desc[_ngcontent-%COMP%]{font-size:12px;color:#6b7280}.landing-footer[_ngcontent-%COMP%]{background:#fff;padding:32px 40px;text-align:center;border-top:2px solid #e5e7eb}.footer-text[_ngcontent-%COMP%]{margin:0 0 16px;color:#6b7280;font-size:14px}.partner-logos[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:48px;flex-wrap:wrap}.partner-logo[_ngcontent-%COMP%]{text-decoration:none;transition:all .3s;display:block}.partner-logo[_ngcontent-%COMP%]:hover{transform:translateY(-4px)}.logo-image[_ngcontent-%COMP%]{height:60px;width:auto;object-fit:contain;filter:grayscale(20%);transition:filter .3s}.logo-image[_ngcontent-%COMP%]:hover{filter:grayscale(0%)}.sdrf-toolbar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:8px 16px;background:#f5f5f5;border-bottom:1px solid #ddd;gap:8px;flex-shrink:0}.toolbar-left[_ngcontent-%COMP%], .toolbar-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.btn[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid #ccc;border-radius:4px;background:#fff;cursor:pointer;font-size:13px}.btn[_ngcontent-%COMP%]:hover{background:#f0f0f0}.btn-primary[_ngcontent-%COMP%]{background:#06c;color:#fff;border-color:#06c}.btn-primary[_ngcontent-%COMP%]:hover{background:#05a}.btn-secondary[_ngcontent-%COMP%]{background:#6c757d;color:#fff;border-color:#6c757d}.btn-secondary[_ngcontent-%COMP%]:hover{background:#5a6268}.btn-create[_ngcontent-%COMP%]{background:#10b981;color:#fff;border-color:#10b981}.btn-create[_ngcontent-%COMP%]:hover{background:#059669}.btn-small[_ngcontent-%COMP%]{padding:4px 8px;font-size:12px}.table-info[_ngcontent-%COMP%]{color:#666;font-size:12px}.column-legend[_ngcontent-%COMP%]{display:flex;gap:8px;margin-right:16px;padding-right:16px;border-right:1px solid #ddd}.legend-item[_ngcontent-%COMP%]{font-size:11px;padding:2px 6px;border-radius:3px;border-left:3px solid}.legend-item.source[_ngcontent-%COMP%]{border-left-color:#4caf50;background:#4caf501a}.legend-item.characteristic[_ngcontent-%COMP%]{border-left-color:#2196f3;background:#2196f31a}.legend-item.comment[_ngcontent-%COMP%]{border-left-color:#9e9e9e;background:#9e9e9e1a}.legend-item.factor[_ngcontent-%COMP%]{border-left-color:#ff9800;background:#ff98001a}.loading-overlay[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px;color:#666;flex:1}.loading-spinner[_ngcontent-%COMP%]{width:32px;height:32px;border:3px solid #f3f3f3;border-top:3px solid #0066cc;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:12px}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.error-banner[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;background:#fee2e2;color:#b91c1c;border-bottom:1px solid #fca5a5;flex-shrink:0}.btn-close[_ngcontent-%COMP%]{background:none;border:none;font-size:20px;cursor:pointer;padding:0 4px}.sdrf-content[_ngcontent-%COMP%], .table-row[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;overflow:hidden;min-height:0}.table-row.with-sidebar[_ngcontent-%COMP%]{flex-direction:row}.table-row.with-sidebar[_ngcontent-%COMP%]   .sdrf-table-container[_ngcontent-%COMP%]{flex:1;min-width:0}.table-row.with-sidebar[_ngcontent-%COMP%]   sdrf-column-stats[_ngcontent-%COMP%]{flex-shrink:0}.sdrf-table-container[_ngcontent-%COMP%]{flex:1;overflow:auto;position:relative;min-height:0;overflow-y:scroll;overflow-x:auto}.sdrf-table-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:12px;height:12px}.sdrf-table-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:6px}.sdrf-table-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:6px;border:2px solid #f1f1f1}.sdrf-table-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a1a1a1}.sdrf-table-container[_ngcontent-%COMP%]{scrollbar-width:auto;scrollbar-color:#c1c1c1 #f1f1f1}.table-scroll-area[_ngcontent-%COMP%]{position:relative;width:fit-content;min-width:100%}.sdrf-table[_ngcontent-%COMP%]{border-collapse:separate;border-spacing:0;font-size:13px;table-layout:auto;width:max-content;min-width:100%}.sdrf-table[_ngcontent-%COMP%]   colgroup[_ngcontent-%COMP%]   .col-checkbox[_ngcontent-%COMP%]{width:36px;min-width:36px}.sdrf-table[_ngcontent-%COMP%]   colgroup[_ngcontent-%COMP%]   .col-rownum[_ngcontent-%COMP%]{width:60px;min-width:60px}.sdrf-table[_ngcontent-%COMP%]   colgroup[_ngcontent-%COMP%]   .col-data[_ngcontent-%COMP%]{min-width:120px}.sdrf-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{position:sticky;top:0;z-index:10}.sdrf-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%], .sdrf-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f8f9fa}.sdrf-table[_ngcontent-%COMP%]   .virtual-spacer[_ngcontent-%COMP%]{height:0;padding:0!important;border:none!important;line-height:0;font-size:0;visibility:hidden}.sdrf-table[_ngcontent-%COMP%]   .virtual-spacer[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:0!important;border:none!important;height:inherit;line-height:0}.sdrf-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .sdrf-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-left:1px solid #ddd;border-bottom:1px solid #ddd;padding:6px 8px;text-align:left;white-space:nowrap;min-width:100px;max-width:300px;overflow:hidden;text-overflow:ellipsis;height:32px;box-sizing:border-box}.sdrf-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child, .sdrf-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{border-left:1px solid #ddd}.sdrf-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child, .sdrf-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{border-right:1px solid #ddd}.sdrf-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-top:1px solid #ddd}.sdrf-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f8f9fa;font-weight:600;box-shadow:inset 0 -1px #ddd}.sdrf-table[_ngcontent-%COMP%]   th.required[_ngcontent-%COMP%]{background:#fff3cd!important}.sdrf-table[_ngcontent-%COMP%]   th.selected[_ngcontent-%COMP%]{background:#e3f2fd!important;outline:2px solid #2196f3;outline-offset:-2px}.sdrf-table[_ngcontent-%COMP%]   th.sorted[_ngcontent-%COMP%]{background:#e3f2fd!important}.required-marker[_ngcontent-%COMP%]{color:#dc3545;margin-left:2px}.row-header[_ngcontent-%COMP%]{background:#f8f9fa;font-weight:500;text-align:center;width:60px;min-width:60px;max-width:60px;position:sticky;left:0;z-index:5}.sdrf-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   .row-header[_ngcontent-%COMP%]{z-index:15;background:#f8f9fa}.checkbox-col[_ngcontent-%COMP%]{width:32px;min-width:32px;max-width:32px;text-align:center;padding:4px!important}.checkbox-col[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{margin:0;cursor:pointer}.sdrf-table[_ngcontent-%COMP%]   td.selected[_ngcontent-%COMP%], .sdrf-table[_ngcontent-%COMP%]   th.selected[_ngcontent-%COMP%]{background:#e3f2fd;outline:2px solid #2196f3;outline-offset:-2px}.sdrf-table[_ngcontent-%COMP%]   td.has-error[_ngcontent-%COMP%]{background:#ffebee}.cell-value[_ngcontent-%COMP%]{display:block;min-height:1em}.cell-value.reserved-value[_ngcontent-%COMP%]{color:#9e9e9e;font-style:italic}.cell-value.reserved-not-available[_ngcontent-%COMP%]{color:#e65100;font-style:italic;font-weight:500;background:#fff3e0;border:1px dashed #ffb74d;border-radius:3px;padding:2px 6px;margin:-2px -6px}.cell-value.reserved-not-applicable[_ngcontent-%COMP%]{color:#546e7a;font-style:italic;background:#eceff1;border:1px solid #cfd8dc;border-radius:3px;padding:2px 6px;margin:-2px -6px}.cell-value.reserved-anonymized[_ngcontent-%COMP%]{color:#7b1fa2;font-style:italic;background:#f3e5f5;border-radius:3px;padding:2px 6px;margin:-2px -6px}.cell-value.reserved-pooled[_ngcontent-%COMP%]{color:#1565c0;font-style:italic;background:#e3f2fd;border-radius:3px;padding:2px 6px;margin:-2px -6px}.cell-editor-popup[_ngcontent-%COMP%]{position:fixed;z-index:500;background:#fff;border-radius:8px;box-shadow:0 8px 32px #0003;animation:_ngcontent-%COMP%_fadeIn .15s ease-out;max-width:400px;max-height:80vh;overflow:auto}.cell-editor-context[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:8px 12px;background:#1a237e;color:#fff;border-radius:8px 8px 0 0;font-size:12px}.cell-editor-context[_ngcontent-%COMP%]   .context-info[_ngcontent-%COMP%]{flex:1}.cell-editor-context[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#90caf9}.cell-editor-context[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{background:none;border:none;color:#fff;font-size:18px;cursor:pointer;padding:0 4px;margin-left:8px;opacity:.8}.cell-editor-context[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]:hover{opacity:1}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-4px)}to{opacity:1;transform:translateY(0)}}.jump-to-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 16px;background:#f8f9fa;border-top:1px solid #ddd;flex-shrink:0}.jump-to-row[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:13px}.jump-input[_ngcontent-%COMP%]{width:80px;padding:4px 8px;border:1px solid #ccc;border-radius:4px;font-size:13px}.validation-panel-container[_ngcontent-%COMP%]{border-top:2px solid #667eea;background:#f8f9fa;max-height:300px;display:flex;flex-direction:column;flex-shrink:0}.validation-panel-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:10px 16px;background:#667eea;color:#fff}.validation-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.validation-title[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:14px;font-weight:600}.pyodide-status[_ngcontent-%COMP%]{font-size:11px;padding:2px 8px;border-radius:10px;background:#fff3}.pyodide-status.loading[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.pyodide-status.ready[_ngcontent-%COMP%]{background:#d1fae5;color:#059669}.pyodide-status.error[_ngcontent-%COMP%]{background:#fee2e2;color:#b91c1c}.pyodide-status.api-fallback[_ngcontent-%COMP%]{background:#dbeafe;color:#1e40af}.validation-panel-body[_ngcontent-%COMP%]{padding:12px 16px;overflow-y:auto;flex:1}.template-selector-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:12px;flex-wrap:wrap}.template-label[_ngcontent-%COMP%]{font-size:12px;font-weight:500;color:#4b5563}.template-chips[_ngcontent-%COMP%]{display:flex;gap:6px;flex-wrap:wrap;flex:1}.template-chip[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;padding:4px 10px;background:#fff;border:1px solid #d1d5db;border-radius:16px;font-size:11px;cursor:pointer;transition:all .2s}.template-chip[_ngcontent-%COMP%]:hover{background:#f3f4f6}.template-chip.selected[_ngcontent-%COMP%]{background:#e0e7ff;border-color:#667eea;color:#4338ca}.template-chip[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin:0;width:12px;height:12px}.template-loading[_ngcontent-%COMP%]{font-size:13px;color:#666;font-style:italic}.btn-sm[_ngcontent-%COMP%]{padding:6px 12px;font-size:12px}.spinner-sm[_ngcontent-%COMP%]{display:inline-block;width:12px;height:12px;border:2px solid #fff;border-top-color:transparent;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}.validation-summary-row[_ngcontent-%COMP%]{display:flex;gap:12px;margin-bottom:12px;padding:8px 12px;background:#fff;border-radius:6px}.validation-success[_ngcontent-%COMP%]{color:#059669;font-weight:500;font-size:13px}.error-badge[_ngcontent-%COMP%]{background:#fee2e2;color:#b91c1c;padding:4px 10px;border-radius:12px;font-size:12px;font-weight:500}.warning-badge[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e;padding:4px 10px;border-radius:12px;font-size:12px;font-weight:500}.validation-errors-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.validation-error-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e5e7eb;border-radius:8px;border-left:4px solid #9ca3af;overflow:hidden}.validation-error-card.level-error[_ngcontent-%COMP%]{border-left-color:#dc2626}.validation-error-card.level-warning[_ngcontent-%COMP%]{border-left-color:#f59e0b}.error-main[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:10px;padding:10px 12px}.error-icon[_ngcontent-%COMP%]{flex-shrink:0;font-size:14px}.error-content[_ngcontent-%COMP%]{flex:1;min-width:0}.error-message[_ngcontent-%COMP%]{font-size:13px;color:#374151;margin-bottom:4px}.error-column[_ngcontent-%COMP%]{font-size:11px;color:#6b7280;margin-bottom:4px}.error-cells[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;flex-wrap:wrap;margin-bottom:4px}.cells-label[_ngcontent-%COMP%]{font-size:11px;color:#6b7280}.cells-list[_ngcontent-%COMP%]{display:flex;gap:4px;flex-wrap:wrap}.cell-link[_ngcontent-%COMP%]{background:#f3f4f6;border:none;padding:2px 6px;border-radius:4px;font-size:11px;color:#667eea;cursor:pointer;font-family:monospace}.cell-link[_ngcontent-%COMP%]:hover{background:#e0e7ff;text-decoration:underline}.cells-more[_ngcontent-%COMP%]{font-size:11px;color:#9ca3af}.error-suggestion[_ngcontent-%COMP%]{font-size:11px;color:#059669;background:#f0fdf4;padding:4px 8px;border-radius:4px;margin-top:4px}.btn-ai-assist[_ngcontent-%COMP%]{flex-shrink:0;padding:6px 12px;background:#667eea;color:#fff;border:none;border-radius:6px;font-size:11px;font-weight:500;cursor:pointer;transition:opacity .2s}.btn-ai-assist[_ngcontent-%COMP%]:hover{opacity:.9}.validation-loading[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:10px;padding:20px;color:#6b7280;font-size:13px}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px;color:#666;flex:1}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0}.empty-state[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{font-size:12px;color:#999}.sdrf-table[_ngcontent-%COMP%]   th.data-col[_ngcontent-%COMP%]{position:relative;border-left:4px solid #8d6e63}.sdrf-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .col-name[_ngcontent-%COMP%]{display:inline}.col-header-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;justify-content:space-between;width:100%}.bulk-edit-btn[_ngcontent-%COMP%]{background:#ffffffe6;border:1px solid #ccc;border-radius:3px;padding:2px 6px;font-size:12px;cursor:pointer;opacity:0;transition:opacity .2s,background .2s;flex-shrink:0}.sdrf-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:hover   .bulk-edit-btn[_ngcontent-%COMP%]{opacity:1}.bulk-edit-btn[_ngcontent-%COMP%]:hover{background:#2196f3;border-color:#2196f3;transform:scale(1.1)}.sdrf-table[_ngcontent-%COMP%]   th.col-type-source[_ngcontent-%COMP%]{border-left-color:#4caf50;background:#4caf500d}.sdrf-table[_ngcontent-%COMP%]   th.col-type-characteristic[_ngcontent-%COMP%]{border-left-color:#2196f3;background:#2196f30d}.sdrf-table[_ngcontent-%COMP%]   th.col-type-comment[_ngcontent-%COMP%]{border-left-color:#9e9e9e;background:#9e9e9e0d}.sdrf-table[_ngcontent-%COMP%]   th.col-type-factor[_ngcontent-%COMP%]{border-left-color:#ff9800;background:#ff98000d}.sort-indicator[_ngcontent-%COMP%]{margin-left:4px;font-size:10px;color:#1976d2}.sdrf-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:hover{cursor:pointer;background:#f0f0f0}.toolbar-divider[_ngcontent-%COMP%]{width:1px;height:24px;background:#ddd;margin:0 4px}.unsaved-indicator[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;padding:4px 10px;background:#fff3cd;border:1px solid #ffc107;border-radius:4px;font-size:12px;color:#856404;font-weight:500;margin-left:8px}.btn-active[_ngcontent-%COMP%]{background:#e3f2fd!important;border-color:#2196f3!important;color:#1976d2!important}.btn-ai[_ngcontent-%COMP%]{background:#667eea;color:#fff;border-color:#667eea}.btn-ai[_ngcontent-%COMP%]:hover{background:#5a67d8}.btn-ai.btn-active[_ngcontent-%COMP%]{background:#5a67d8!important;border-color:#5a67d8!important;box-shadow:0 0 0 2px #667eea4d}.ai-panel-container[_ngcontent-%COMP%]{position:fixed;inset:0;z-index:100;pointer-events:none;visibility:hidden}.ai-panel-container.open[_ngcontent-%COMP%]{pointer-events:auto;visibility:visible}.ai-panel-backdrop[_ngcontent-%COMP%]{position:absolute;inset:0;background:#0000004d;opacity:0;transition:opacity .3s ease}.ai-panel-container.open[_ngcontent-%COMP%]   .ai-panel-backdrop[_ngcontent-%COMP%]{opacity:1}.ai-panel-wrapper[_ngcontent-%COMP%]{position:absolute;top:0;right:0;bottom:0;width:420px;max-width:90vw;transform:translate(100%);transition:transform .3s ease;box-shadow:-4px 0 20px #00000026}.ai-panel-container.open[_ngcontent-%COMP%]   .ai-panel-wrapper[_ngcontent-%COMP%]{transform:translate(0)}.ai-panel-wrapper[_ngcontent-%COMP%]   sdrf-recommend-panel[_ngcontent-%COMP%]{display:block;height:100%}tr.row-selected[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background:#e8f5e9!important}tr.row-selected[_ngcontent-%COMP%]   td.row-header[_ngcontent-%COMP%]{background:#c8e6c9!important}.context-menu[_ngcontent-%COMP%]{position:absolute;z-index:200;background:#fff;border:1px solid #ddd;border-radius:6px;box-shadow:0 4px 12px #00000026;padding:4px 0;min-width:200px}.context-menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:block;width:100%;padding:8px 16px;border:none;background:none;text-align:left;cursor:pointer;font-size:13px}.context-menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#f5f5f5}.context-menu[_ngcontent-%COMP%]   hr[_ngcontent-%COMP%]{margin:4px 0;border:none;border-top:1px solid #eee}.dialog-backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000}.dialog-content[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:24px;min-width:400px;max-width:500px;box-shadow:0 8px 32px #0003}.dialog-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 16px;font-size:18px;color:#333}.dialog-form[_ngcontent-%COMP%]{margin-bottom:20px}.dialog-form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-weight:500;color:#666}.dialog-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:10px 12px;border:1px solid #ddd;border-radius:4px;font-size:14px;box-sizing:border-box}.dialog-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#1a237e;box-shadow:0 0 0 2px #1a237e1a}.dialog-hint[_ngcontent-%COMP%]{margin:8px 0 0;font-size:12px;color:#888}.dialog-actions[_ngcontent-%COMP%]{display:flex;gap:8px;justify-content:flex-end}.dialog-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:8px 16px;border-radius:4px;font-size:14px;cursor:pointer}.dialog-actions[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{background:#1a237e;color:#fff;border:none}.dialog-actions[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#283593}.dialog-actions[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:disabled{background:#9e9e9e;cursor:not-allowed}.dialog-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:not(.btn-primary){background:#f5f5f5;border:1px solid #ddd;color:#333}.dialog-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:not(.btn-primary):hover{background:#e0e0e0}"],changeDetection:0})};var Rl=class n{activeUrl="";exampleUrl="https://raw.githubusercontent.com/bigbio/proteomics-metadata-standard/master/annotated-projects/PXD000070/PXD000070.sdrf.tsv";ngOnInit(){let t=new URLSearchParams(window.location.search).get("url");t&&(this.activeUrl=t)}onLoadUrlRequested(e){e&&(this.activeUrl=e)}onLoadExampleRequested(){this.activeUrl=this.exampleUrl}onTableChange(e){console.log("Table changed:",e)}onValidation(e){console.log("Validation result:",e)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ee({type:n,selectors:[["sdrf-editor"]],decls:3,vars:2,consts:[[1,"app-container"],[1,"app-main"],[3,"tableChange","validationComplete","loadUrlRequested","loadExampleRequested","url","exampleUrl"]],template:function(t,i){t&1&&(c(0,"div",0)(1,"main",1)(2,"sdrf-editor-table",2),_("tableChange",function(r){return i.onTableChange(r)})("validationComplete",function(r){return i.onValidation(r)})("loadUrlRequested",function(r){return i.onLoadUrlRequested(r)})("loadExampleRequested",function(){return i.onLoadExampleRequested()}),l()()()),t&2&&(p(2),I("url",i.activeUrl)("exampleUrl",i.exampleUrl))},dependencies:[ce,kl],styles:[".app-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100vh}.app-main[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;overflow:hidden}sdrf-editor-table[_ngcontent-%COMP%]{display:block;height:100%}"]})};Bu(Rl,{providers:[]}).catch(n=>console.error(n));
